<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>useful-scripts | wd-z711&#39;s B10g</title>
  <meta name="author" content="wd-z711">
  
  <meta name="description" content="平时逆向中常用到的脚本">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="useful-scripts"/>
  <meta property="og:site_name" content="wd-z711&#39;s B10g"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'G-YHJSKZDC3Y', 'auto');
  ga('send', 'pageview');
</script>




<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="wd-z711's B10g" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">wd-z711&#39;s B10g</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> useful-scripts</h1>
		</div>
	



<div class="row post">

	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> 平时逆向中常用到的脚本
		 </div> <!-- alert -->
	  		

	  <h1 id="一些常用的脚本"><a href="#一些常用的脚本" class="headerlink" title="一些常用的脚本"></a>一些常用的脚本</h1><p>脚本…</p>
<span id="more"></span>
<h2 id="0x00-idapython-ida7-7"><a href="#0x00-idapython-ida7-7" class="headerlink" title="0x00 idapython-ida7.7"></a>0x00 idapython-ida7.7</h2><h3 id="memory-dump"><a href="#memory-dump" class="headerlink" title="memory_dump"></a>memory_dump</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line">start_address, data_length = <span class="number">0x11</span>, <span class="number">0x22</span></span><br><span class="line">dump_file = <span class="string">&quot;file_path&quot;</span></span><br><span class="line">data = idaapi.dbg_read_memory(start_address, data_length)</span><br><span class="line">fp = <span class="built_in">open</span>(dump_file, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">fp.write(data)</span><br><span class="line">fp.close()</span><br></pre></td></tr></table></figure>
<h3 id="array-dump"><a href="#array-dump" class="headerlink" title="array_dump"></a>array_dump</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line">addr = <span class="number">0xC000088E10</span></span><br><span class="line">arr = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    arr.append(idaapi.get_bytes(addr + i, <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br></pre></td></tr></table></figure>
<h2 id="0x01-gdb-python自动化测试"><a href="#0x01-gdb-python自动化测试" class="headerlink" title="0x01 gdb+python自动化测试"></a>0x01 gdb+python自动化测试</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">gdb ./picStore</span></span><br><span class="line"><span class="string">source wp.py</span></span><br><span class="line"><span class="string">see rctf picStore for details</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> gdb</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">startt = time.time()</span><br><span class="line">fp = <span class="built_in">open</span>(<span class="string">r&quot;./log.log&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">strr = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pt</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">global</span> strr</span><br><span class="line">    strr += p + <span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">Esp = <span class="number">0</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x55555559C078&#x27;</span>)    <span class="comment"># LoadBlock 断点</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x55555559C184&#x27;</span>)    <span class="comment"># LoadByte</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x55555559C1D1&#x27;</span>)    <span class="comment"># LoadInt</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x55555559C111&#x27;</span>)    <span class="comment"># LoadNumber</span></span><br><span class="line">gdb.execute(<span class="string">&#x27;b *0x55555559C0A1&#x27;</span>)    <span class="comment"># LoadInteger</span></span><br><span class="line"></span><br><span class="line">gdb.execute(<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    frame = gdb.selected_frame()</span><br><span class="line">    rip = frame.read_register(<span class="string">&quot;rip&quot;</span>)</span><br><span class="line">    <span class="comment"># 因为不只有LoadByte、LoadInt、LoadNumber、LoadInteger函数调用LoadBlock</span></span><br><span class="line">    <span class="keyword">if</span> rip == <span class="number">0x55555559C078</span> :</span><br><span class="line">        <span class="comment"># rdx为LoadBlock的size参数</span></span><br><span class="line">        rdx = frame.read_register(<span class="string">&quot;rdx&quot;</span>)</span><br><span class="line">        Esp += rdx</span><br><span class="line">    <span class="comment"># LoadByte</span></span><br><span class="line">    <span class="keyword">elif</span> rip == <span class="number">0x55555559C184</span>:</span><br><span class="line">        pt(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">hex</span>(Esp).ljust(<span class="number">10</span>,<span class="string">&#x27; &#x27;</span>)&#125;</span> =&gt; 1&quot;</span>)</span><br><span class="line">    <span class="comment"># LoadInt</span></span><br><span class="line">    <span class="keyword">elif</span> rip == <span class="number">0x55555559C1D1</span>:</span><br><span class="line">        pt(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">hex</span>(Esp).ljust(<span class="number">10</span>,<span class="string">&#x27; &#x27;</span>)&#125;</span> =&gt; 4&quot;</span>)</span><br><span class="line">    <span class="comment"># LoadNumber</span></span><br><span class="line">    <span class="keyword">elif</span> rip == <span class="number">0x55555559C111</span>:</span><br><span class="line">        pt(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">hex</span>(Esp).ljust(<span class="number">10</span>,<span class="string">&#x27; &#x27;</span>)&#125;</span> =&gt; 8&quot;</span>)</span><br><span class="line">    <span class="comment"># LoadInteger</span></span><br><span class="line">    <span class="keyword">elif</span> rip == <span class="number">0x55555559C0A1</span>:</span><br><span class="line">        pt(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">hex</span>(Esp).ljust(<span class="number">10</span>,<span class="string">&#x27; &#x27;</span>)&#125;</span> =&gt; 8&quot;</span>)</span><br><span class="line">    <span class="comment"># 0x19f0是lua字节码文件的大小</span></span><br><span class="line">    <span class="keyword">if</span> Esp == <span class="number">0x19f0</span>:</span><br><span class="line">        fp.write(strr)</span><br><span class="line">        fp.close()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;finish!!!&quot;</span>)</span><br><span class="line">        enddd = time.time()</span><br><span class="line">        <span class="built_in">print</span>(enddd - startt)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    gdb.execute(<span class="string">&#x27;c&#x27;</span>)      </span><br></pre></td></tr></table></figure>
<h2 id="0x02-Z3相关script"><a href="#0x02-Z3相关script" class="headerlink" title="0x02 Z3相关script"></a>0x02 Z3相关script</h2><p>&emsp;见<code>rctf picStore</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line"><span class="comment"># chk_23函数</span></span><br><span class="line">a1 = [Int(<span class="string">f&#x27;c<span class="subst">&#123;i&#125;</span>&#x27;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>)]</span><br><span class="line">v1 = a1[<span class="number">0</span>]</span><br><span class="line">v2 = a1[<span class="number">1</span>]</span><br><span class="line">v3 = a1[<span class="number">2</span>]</span><br><span class="line">v4 = a1[<span class="number">3</span>]</span><br><span class="line">v5 = a1[<span class="number">4</span>]</span><br><span class="line">v6 = a1[<span class="number">5</span>]</span><br><span class="line">v7 = a1[<span class="number">6</span>]</span><br><span class="line">v8 = a1[<span class="number">7</span>]</span><br><span class="line">v10 = a1[<span class="number">8</span>]</span><br><span class="line">v24 = a1[<span class="number">9</span>]</span><br><span class="line">v25 = a1[<span class="number">10</span>]</span><br><span class="line">v26 = a1[<span class="number">11</span>]</span><br><span class="line">v27 = a1[<span class="number">12</span>]</span><br><span class="line">v28 = a1[<span class="number">13</span>]</span><br><span class="line">v29 = a1[<span class="number">14</span>]</span><br><span class="line">v30 = a1[<span class="number">15</span>]</span><br><span class="line">v31 = a1[<span class="number">16</span>]</span><br><span class="line">v32 = a1[<span class="number">17</span>]</span><br><span class="line">v33 = a1[<span class="number">18</span>]</span><br><span class="line">v34 = a1[<span class="number">19</span>]</span><br><span class="line">v35 = a1[<span class="number">20</span>]</span><br><span class="line">v36 = a1[<span class="number">21</span>]</span><br><span class="line">v37 = a1[<span class="number">22</span>]</span><br><span class="line">v38 = a1[<span class="number">23</span>]</span><br><span class="line">v39 = a1[<span class="number">24</span>]</span><br><span class="line">v40 = a1[<span class="number">25</span>]</span><br><span class="line">v20 = a1[<span class="number">26</span>]</span><br><span class="line">v41 = a1[<span class="number">27</span>]</span><br><span class="line">v22 = a1[<span class="number">28</span>]</span><br><span class="line">solver.add(<span class="number">255036</span>*v7+-<span class="number">90989</span>*v3+-<span class="number">201344</span>*v4+<span class="number">122006</span>*v5+-<span class="number">140538</span>*v6+<span class="number">109859</span>*v2-<span class="number">109457</span>*v1-<span class="number">9396023</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">277432</span>*v6+<span class="number">110191</span>*v3+-<span class="number">186022</span>*v4+<span class="number">175123</span>*v2-<span class="number">75564</span>*v5-<span class="number">252340</span>*v1-<span class="number">12226612</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">127326</span>*v4+<span class="number">260948</span>*v2+-<span class="number">102835</span>*v1+<span class="number">225038</span>*v5-<span class="number">129683</span>*v3-<span class="number">45564209</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">170345</span>*v2+<span class="number">217412</span>*v3-<span class="number">26668</span>*v1+<span class="number">38500</span>*v4-<span class="number">27440782</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">25295</span>*v2+<span class="number">69369</span>*v3+<span class="number">191287</span>*v1-<span class="number">24434293</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">72265</span>*v1-<span class="number">2384745</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">264694</span>*v1-<span class="number">190137</span>*v2+<span class="number">19025100</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">101752</span>*v24+<span class="number">67154</span>*v8+-<span class="number">20311</span>*v1+-<span class="number">30496</span>*v6+-<span class="number">263329</span>*v7+-<span class="number">99420</span>*v10+<span class="number">255348</span>*v3+<span class="number">169511</span>*v4-<span class="number">121471</span>*v2+<span class="number">231370</span>*v5-<span class="number">33888892</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">17253</span>*v8+-<span class="number">134891</span>*v7+<span class="number">144501</span>*v4+<span class="number">220594</span>*v2+<span class="number">263746</span>*v3+<span class="number">122495</span>*v6+<span class="number">74297</span>*v10+<span class="number">205480</span>*v1-<span class="number">32973</span>*v5-<span class="number">115484799</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">251337</span>*v3+-<span class="number">198187</span>*v6+-<span class="number">217900</span>*v2+-<span class="number">62192</span>*v8+-<span class="number">138306</span>*v7+-<span class="number">165151</span>*v4-<span class="number">118227</span>*v1-<span class="number">22431</span>*v5+<span class="number">72699617</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">243012</span>*v27+-<span class="number">233931</span>*v4+<span class="number">66595</span>*v7+-<span class="number">273948</span>*v5+-<span class="number">266708</span>*v24+<span class="number">75344</span>*v8-<span class="number">108115</span>*v3-<span class="number">17090</span>*v25+<span class="number">240281</span>*v10+<span class="number">202327</span>*v1-<span class="number">253495</span>*v2+<span class="number">233118</span>*v26+<span class="number">154680</span>*v6+<span class="number">25687761</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">41011</span>*v8+-<span class="number">198187</span>*v1+-<span class="number">117171</span>*v7+-<span class="number">178912</span>*v3+<span class="number">9797</span>*v24+<span class="number">118730</span>*v10-<span class="number">193364</span>*v5-<span class="number">36072</span>*v6+<span class="number">10586</span>*v25-<span class="number">110560</span>*v4+<span class="number">173438</span>*v2-<span class="number">176575</span>*v26+<span class="number">54358815</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">250878</span>*v24+<span class="number">108430</span>*v1+-<span class="number">136296</span>*v5+<span class="number">11092</span>*v8+<span class="number">154243</span>*v7+-<span class="number">136624</span>*v3+<span class="number">179711</span>*v4+-<span class="number">128439</span>*v6+<span class="number">22681</span>*v25-<span class="number">42472</span>*v10-<span class="number">80061</span>*v2+<span class="number">34267161</span> == <span class="number">0</span>)  </span><br><span class="line">solver.add(<span class="number">65716</span>*v30+-<span class="number">18037</span>*v26+-<span class="number">42923</span>*v7+-<span class="number">33361</span>*v4+<span class="number">161566</span>*v6+<span class="number">194069</span>*v25+-<span class="number">154262</span>*v2+<span class="number">173240</span>*v3-<span class="number">31821</span>*v27-<span class="number">80881</span>*v5+<span class="number">217299</span>*v8-<span class="number">28162</span>*v10+<span class="number">192716</span>*v1+<span class="number">165565</span>*v24+<span class="number">106863</span>*v29-<span class="number">127658</span>*v28-<span class="number">75839517</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">236487</span>*v24+-<span class="number">45384</span>*v1+<span class="number">46984</span>*v26+<span class="number">148196</span>*v7+<span class="number">15692</span>*v8+-<span class="number">193664</span>*v6+<span class="number">6957</span>*v10+<span class="number">103351</span>*v29-<span class="number">217098</span>*v28+<span class="number">78149</span>*v4-<span class="number">237596</span>*v5-<span class="number">236117</span>*v3-<span class="number">142713</span>*v25+<span class="number">24413</span>*v27+<span class="number">232544</span>*v2+<span class="number">78860648</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">69129</span>*v10+-<span class="number">161882</span>*v3+-<span class="number">39324</span>*v26+<span class="number">106850</span>*v1+<span class="number">136394</span>*v5+<span class="number">129891</span>*v2+<span class="number">15216</span>*v27+<span class="number">213245</span>*v24-<span class="number">73770</span>*v28+<span class="number">24056</span>*v25-<span class="number">123372</span>*v8-<span class="number">38733</span>*v7-<span class="number">199547</span>*v4-<span class="number">10681</span>*v6+<span class="number">57424065</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">268870</span>*v30+<span class="number">103546</span>*v24+-<span class="number">124986</span>*v27+<span class="number">42015</span>*v7+<span class="number">80222</span>*v2+-<span class="number">77247</span>*v10+-<span class="number">8838</span>*v25+-<span class="number">273842</span>*v4+-<span class="number">240751</span>*v28-<span class="number">187146</span>*v26-<span class="number">150301</span>*v6-<span class="number">167844</span>*v3+<span class="number">92327</span>*v8+<span class="number">270212</span>*v5-<span class="number">87705</span>*v33-<span class="number">216624</span>*v1+<span class="number">35317</span>*v31+<span class="number">231278</span>*v32-<span class="number">213030</span>*v29+<span class="number">114317949</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">207225</span>*v1+-<span class="number">202035</span>*v3+<span class="number">81860</span>*v27+-<span class="number">114137</span>*v5+<span class="number">265497</span>*v30+-<span class="number">216722</span>*v8+<span class="number">276415</span>*v28+-<span class="number">201420</span>*v10-<span class="number">266588</span>*v32+<span class="number">174412</span>*v6+<span class="number">249222</span>*v24-<span class="number">191870</span>*v4+<span class="number">100486</span>*v2+<span class="number">37951</span>*v25+<span class="number">67406</span>*v26+<span class="number">55224</span>*v31+<span class="number">101345</span>*v7-<span class="number">76961</span>*v29+<span class="number">33370551</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">175180</span>*v29+<span class="number">25590</span>*v4+-<span class="number">35354</span>*v30+-<span class="number">173039</span>*v31+<span class="number">145220</span>*v25+<span class="number">6521</span>*v7+<span class="number">99204</span>*v24+<span class="number">72076</span>*v27+<span class="number">207349</span>*v2+<span class="number">123988</span>*v5-<span class="number">64247</span>*v8+<span class="number">169099</span>*v6-<span class="number">54799</span>*v3+<span class="number">53935</span>*v1-<span class="number">223317</span>*v26+<span class="number">215925</span>*v10-<span class="number">119961</span>*v28-<span class="number">83559622</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">43170</span>*v3+-<span class="number">145060</span>*v2+<span class="number">199653</span>*v6+<span class="number">14728</span>*v30+<span class="number">139827</span>*v24+<span class="number">59597</span>*v29+<span class="number">2862</span>*v10+-<span class="number">171413</span>*v31+-<span class="number">15355</span>*v25-<span class="number">71692</span>*v7-<span class="number">16706</span>*v26+<span class="number">264615</span>*v1-<span class="number">149167</span>*v33+<span class="number">75391</span>*v27-<span class="number">2927</span>*v4-<span class="number">187387</span>*v5-<span class="number">190782</span>*v8-<span class="number">150865</span>*v28+<span class="number">44238</span>*v32-<span class="number">276353</span>*v34+<span class="number">82818982</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">3256</span>*v27+-<span class="number">232013</span>*v25+-<span class="number">261919</span>*v29+-<span class="number">151844</span>*v26+<span class="number">11405</span>*v4+<span class="number">159913</span>*v32+<span class="number">209002</span>*v7+<span class="number">91932</span>*v34+<span class="number">270180</span>*v10+-<span class="number">195866</span>*v3-<span class="number">135274</span>*v33-<span class="number">261245</span>*v1+<span class="number">24783</span>*v35+<span class="number">262729</span>*v8-<span class="number">81293</span>*v24-<span class="number">156714</span>*v2-<span class="number">93376</span>*v28-<span class="number">163223</span>*v31-<span class="number">144746</span>*v5+<span class="number">167939</span>*v6-<span class="number">120753</span>*v30-<span class="number">13188886</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">240655</span>*v35+<span class="number">103437</span>*v30+<span class="number">236610</span>*v27+<span class="number">100948</span>*v8+<span class="number">82212</span>*v6+-<span class="number">60676</span>*v5+-<span class="number">71032</span>*v3+<span class="number">259181</span>*v7+<span class="number">100184</span>*v10+<span class="number">7797</span>*v29+<span class="number">143350</span>*v24+<span class="number">76697</span>*v2-<span class="number">172373</span>*v25-<span class="number">110023</span>*v37-<span class="number">13673</span>*v4+<span class="number">129100</span>*v31+<span class="number">86759</span>*v1-<span class="number">101103</span>*v33-<span class="number">142195</span>*v36+<span class="number">28466</span>*v32-<span class="number">27211</span>*v26-<span class="number">269662</span>*v34+<span class="number">9103</span>*v28-<span class="number">96428951</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">92750</span>*v28+-<span class="number">151740</span>*v27+<span class="number">15816</span>*v35+<span class="number">186592</span>*v24+-<span class="number">156340</span>*v29+-<span class="number">193697</span>*v2+-<span class="number">108622</span>*v8+-<span class="number">163956</span>*v5+<span class="number">78044</span>*v4+-<span class="number">280132</span>*v36-<span class="number">73939</span>*v33-<span class="number">216186</span>*v3+<span class="number">168898</span>*v30+<span class="number">81148</span>*v34-<span class="number">200942</span>*v32+<span class="number">1920</span>*v1+<span class="number">131017</span>*v26-<span class="number">229175</span>*v10-<span class="number">247717</span>*v31+<span class="number">232852</span>*v25+<span class="number">25882</span>*v7+<span class="number">144500</span>*v6+<span class="number">175681562</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">234452</span>*v34+-<span class="number">23111</span>*v29+-<span class="number">40957</span>*v2+-<span class="number">147076</span>*v8+<span class="number">16151</span>*v32+-<span class="number">250947</span>*v35+-<span class="number">111913</span>*v30+-<span class="number">233475</span>*v24+-<span class="number">2485</span>*v28+<span class="number">207006</span>*v26+<span class="number">71474</span>*v3+<span class="number">78521</span>*v1-<span class="number">37235</span>*v36+<span class="number">203147</span>*v5+<span class="number">159297</span>*v7-<span class="number">227257</span>*v38+<span class="number">141894</span>*v25-<span class="number">238939</span>*v10-<span class="number">207324</span>*v37-<span class="number">168960</span>*v33+<span class="number">212325</span>*v6+<span class="number">152097</span>*v31-<span class="number">94775</span>*v27+<span class="number">197514</span>*v4+<span class="number">62343322</span> == <span class="number">0</span>) </span><br><span class="line">solver.add(-<span class="number">142909</span>*v34+-<span class="number">111865</span>*v31+<span class="number">258666</span>*v36+-<span class="number">66780</span>*v2+-<span class="number">13109</span>*v35+-<span class="number">72310</span>*v25+-<span class="number">278193</span>*v26+-<span class="number">219709</span>*v24+<span class="number">40855</span>*v8+-<span class="number">270578</span>*v38+<span class="number">96496</span>*v5+-<span class="number">4530</span>*v1+<span class="number">63129</span>*v28-<span class="number">4681</span>*v7-<span class="number">272799</span>*v30-<span class="number">225257</span>*v10+<span class="number">128712</span>*v37-<span class="number">201687</span>*v39+<span class="number">273784</span>*v3+<span class="number">141128</span>*v29+<span class="number">93283</span>*v32+<span class="number">128210</span>*v33+<span class="number">47550</span>*v6-<span class="number">84027</span>*v4+<span class="number">52764</span>*v40-<span class="number">140487</span>*v27+<span class="number">105279220</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">216020</span>*v38+-<span class="number">248561</span>*v29+-<span class="number">86516</span>*v33+<span class="number">237852</span>*v26+-<span class="number">132193</span>*v31+-<span class="number">101471</span>*v3+<span class="number">87552</span>*v25+-<span class="number">122710</span>*v8+<span class="number">234681</span>*v5+-<span class="number">24880</span>*v7+-<span class="number">245370</span>*v1+-<span class="number">17836</span>*v36-<span class="number">225714</span>*v34-<span class="number">256029</span>*v4+<span class="number">171199</span>*v35+<span class="number">266838</span>*v10-<span class="number">32125</span>*v24-<span class="number">43141</span>*v32-<span class="number">87051</span>*v30-<span class="number">68893</span>*v39-<span class="number">242483</span>*v28-<span class="number">12823</span>*v2-<span class="number">159262</span>*v27+<span class="number">123816</span>*v37-<span class="number">180694</span>*v6+<span class="number">152819799</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">116890</span>*v3+<span class="number">67983</span>*v27+-<span class="number">131934</span>*v4+<span class="number">256114</span>*v40+<span class="number">128119</span>*v24+<span class="number">48593</span>*v33+-<span class="number">41706</span>*v2+-<span class="number">217503</span>*v26+<span class="number">49328</span>*v6+<span class="number">223466</span>*v7+-<span class="number">31184</span>*v5+-<span class="number">208422</span>*v36+<span class="number">261920</span>*v1+<span class="number">83055</span>*v20+<span class="number">115813</span>*v37+<span class="number">174499</span>*v29-<span class="number">188513</span>*v35+<span class="number">18957</span>*v25+<span class="number">15794</span>*v10-<span class="number">2906</span>*v28-<span class="number">25315</span>*v8+<span class="number">232180</span>*v32-<span class="number">102442</span>*v39-<span class="number">116930</span>*v34-<span class="number">192552</span>*v38-<span class="number">179822</span>*v31+<span class="number">265749</span>*v30-<span class="number">54143007</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">215996</span>*v4+-<span class="number">100890</span>*v40+-<span class="number">177349</span>*v7+-<span class="number">159264</span>*v6+-<span class="number">227328</span>*v27+-<span class="number">91901</span>*v24+-<span class="number">28939</span>*v10+<span class="number">206392</span>*v41+<span class="number">6473</span>*v25+-<span class="number">22051</span>*v20+-<span class="number">112044</span>*v34+-<span class="number">119414</span>*v30+-<span class="number">225267</span>*v35+<span class="number">223380</span>*v3+<span class="number">275172</span>*v5+<span class="number">95718</span>*v39-<span class="number">115127</span>*v29+<span class="number">85928</span>*v26+<span class="number">169057</span>*v38-<span class="number">204729</span>*v1+<span class="number">178788</span>*v36-<span class="number">85503</span>*v31-<span class="number">121684</span>*v2-<span class="number">18727</span>*v32+<span class="number">109947</span>*v33-<span class="number">138204</span>*v8-<span class="number">245035</span>*v28+<span class="number">134266</span>*v37+<span class="number">110228962</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(-<span class="number">165644</span>*v32+<span class="number">4586</span>*v39+<span class="number">138195</span>*v25+<span class="number">155259</span>*v35+-<span class="number">185091</span>*v3+-<span class="number">63869</span>*v31+-<span class="number">23462</span>*v30+<span class="number">150939</span>*v41+-<span class="number">217079</span>*v8+-<span class="number">122286</span>*v6+<span class="number">5460</span>*v38+-<span class="number">235719</span>*v7+<span class="number">270987</span>*v26+<span class="number">157806</span>*v34+<span class="number">262004</span>*v29-<span class="number">2963</span>*v28-<span class="number">159217</span>*v10+<span class="number">266021</span>*v33-<span class="number">190702</span>*v24-<span class="number">38473</span>*v20+<span class="number">122617</span>*v2+<span class="number">202211</span>*v36-<span class="number">143491</span>*v27-<span class="number">251332</span>*v4+<span class="number">196932</span>*v5-<span class="number">155172</span>*v22+<span class="number">209759</span>*v40-<span class="number">146511</span>*v1+<span class="number">62542</span>*v37+<span class="number">185928391</span> == <span class="number">0</span>)</span><br><span class="line">solver.add(<span class="number">57177</span>*v24+<span class="number">242367</span>*v39+<span class="number">226332</span>*v31+<span class="number">15582</span>*v26+<span class="number">159461</span>*v34+-<span class="number">260455</span>*v22+-<span class="number">179161</span>*v37+-<span class="number">251786</span>*v32+-<span class="number">66932</span>*v41+<span class="number">134581</span>*v1+-<span class="number">65235</span>*v29+-<span class="number">110258</span>*v28+<span class="number">188353</span>*v38+-<span class="number">108556</span>*v6+<span class="number">178750</span>*v40+-<span class="number">20482</span>*v25+<span class="number">127145</span>*v8+-<span class="number">203851</span>*v5+-<span class="number">263419</span>*v10+<span class="number">245204</span>*v33+-<span class="number">62740</span>*v20+<span class="number">103075</span>*v2-<span class="number">229292</span>*v36+<span class="number">142850</span>*v30-<span class="number">1027</span>*v27+<span class="number">264120</span>*v3+<span class="number">264348</span>*v4-<span class="number">41667</span>*v35+<span class="number">130195</span>*v7+<span class="number">127279</span>*a1[<span class="number">29</span>]-<span class="number">51967523</span> == <span class="number">0</span>)</span><br><span class="line"><span class="comment"># z3约束器求解</span></span><br><span class="line"><span class="keyword">assert</span> solver.check() == sat</span><br><span class="line">flag2 = []</span><br><span class="line">mol = solver.model()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a1:</span><br><span class="line">    flag2.append(mol[i].as_long())</span><br><span class="line"></span><br><span class="line">mappp = [<span class="number">105</span>, <span class="number">244</span>, <span class="number">63</span>, <span class="number">10</span>, <span class="number">24</span>, <span class="number">169</span>, <span class="number">248</span>, <span class="number">107</span>, <span class="number">129</span>, <span class="number">138</span>, <span class="number">25</span>, <span class="number">182</span>, <span class="number">96</span>, <span class="number">176</span>, <span class="number">14</span>, <span class="number">89</span>, <span class="number">56</span>, <span class="number">229</span>, <span class="number">206</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">198</span>, <span class="number">179</span>, <span class="number">167</span>, <span class="number">152</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">201</span>, <span class="number">213</span>, <span class="number">80</span>, <span class="number">162</span>, <span class="number">151</span>, <span class="number">102</span>, <span class="number">36</span>, <span class="number">91</span>, <span class="number">37</span>, <span class="number">50</span>, <span class="number">17</span>, <span class="number">170</span>, <span class="number">41</span>, <span class="number">3</span>, <span class="number">84</span>, <span class="number">85</span>, <span class="number">226</span>, <span class="number">131</span>, <span class="number">38</span>, <span class="number">71</span>, <span class="number">32</span>, <span class="number">18</span>, <span class="number">142</span>, <span class="number">70</span>, <span class="number">39</span>, <span class="number">112</span>, <span class="number">220</span>, <span class="number">16</span>, <span class="number">219</span>, <span class="number">159</span>, <span class="number">222</span>, <span class="number">11</span>, <span class="number">119</span>, <span class="number">99</span>, <span class="number">203</span>, <span class="number">47</span>, <span class="number">148</span>, <span class="number">185</span>, <span class="number">55</span>, <span class="number">93</span>, <span class="number">48</span>, <span class="number">153</span>, <span class="number">113</span>, <span class="number">1</span>, <span class="number">237</span>, <span class="number">35</span>, <span class="number">75</span>, <span class="number">67</span>, <span class="number">155</span>, <span class="number">161</span>, <span class="number">74</span>, <span class="number">108</span>, <span class="number">76</span>, <span class="number">181</span>, <span class="number">233</span>, <span class="number">186</span>, <span class="number">44</span>, <span class="number">125</span>, <span class="number">232</span>, <span class="number">88</span>, <span class="number">8</span>, <span class="number">95</span>, <span class="number">163</span>, <span class="number">200</span>, <span class="number">249</span>, <span class="number">120</span>, <span class="number">243</span>, <span class="number">174</span>, <span class="number">212</span>, <span class="number">252</span>, <span class="number">234</span>, <span class="number">58</span>, <span class="number">101</span>, <span class="number">228</span>, <span class="number">86</span>, <span class="number">109</span>, <span class="number">144</span>, <span class="number">104</span>, <span class="number">121</span>, <span class="number">117</span>, <span class="number">87</span>, <span class="number">15</span>, <span class="number">132</span>, <span class="number">12</span>, <span class="number">20</span>, <span class="number">165</span>, <span class="number">115</span>, <span class="number">136</span>, <span class="number">135</span>, <span class="number">118</span>, <span class="number">69</span>, <span class="number">68</span>, <span class="number">2</span>, <span class="number">82</span>, <span class="number">123</span>, <span class="number">250</span>, <span class="number">251</span>, <span class="number">53</span>, <span class="number">255</span>, <span class="number">51</span>, <span class="number">221</span>, <span class="number">211</span>, <span class="number">195</span>, <span class="number">145</span>, <span class="number">140</span>, <span class="number">254</span>, <span class="number">0</span>, <span class="number">116</span>, <span class="number">43</span>, <span class="number">29</span>, <span class="number">217</span>, <span class="number">197</span>, <span class="number">183</span>, <span class="number">168</span>, <span class="number">188</span>, <span class="number">34</span>, <span class="number">218</span>, <span class="number">146</span>, <span class="number">147</span>, <span class="number">98</span>, <span class="number">149</span>, <span class="number">246</span>, <span class="number">180</span>, <span class="number">103</span>, <span class="number">33</span>, <span class="number">40</span>, <span class="number">207</span>, <span class="number">208</span>, <span class="number">192</span>, <span class="number">143</span>, <span class="number">26</span>, <span class="number">154</span>, <span class="number">225</span>, <span class="number">100</span>, <span class="number">141</span>, <span class="number">175</span>, <span class="number">124</span>, <span class="number">230</span>, <span class="number">62</span>, <span class="number">177</span>, <span class="number">205</span>, <span class="number">110</span>, <span class="number">202</span>, <span class="number">253</span>, <span class="number">173</span>, <span class="number">46</span>, <span class="number">52</span>, <span class="number">114</span>, <span class="number">164</span>, <span class="number">166</span>, <span class="number">137</span>, <span class="number">158</span>, <span class="number">122</span>, <span class="number">13</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">133</span>, <span class="number">189</span>, <span class="number">187</span>, <span class="number">7</span>, <span class="number">184</span>, <span class="number">77</span>, <span class="number">245</span>, <span class="number">216</span>, <span class="number">190</span>, <span class="number">194</span>, <span class="number">72</span>, <span class="number">157</span>, <span class="number">172</span>, <span class="number">171</span>, <span class="number">199</span>, <span class="number">160</span>, <span class="number">45</span>, <span class="number">49</span>, <span class="number">27</span>, <span class="number">204</span>, <span class="number">81</span>, <span class="number">6</span>, <span class="number">92</span>, <span class="number">59</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">130</span>, <span class="number">97</span>, <span class="number">61</span>, <span class="number">214</span>, <span class="number">215</span>, <span class="number">73</span>, <span class="number">90</span>, <span class="number">126</span>, <span class="number">42</span>, <span class="number">30</span>, <span class="number">240</span>, <span class="number">79</span>, <span class="number">224</span>, <span class="number">78</span>, <span class="number">223</span>, <span class="number">111</span>, <span class="number">60</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">196</span>, <span class="number">231</span>, <span class="number">106</span>, <span class="number">64</span>, <span class="number">139</span>, <span class="number">235</span>, <span class="number">150</span>, <span class="number">227</span>, <span class="number">238</span>, <span class="number">191</span>, <span class="number">127</span>, <span class="number">31</span>, <span class="number">156</span>, <span class="number">54</span>, <span class="number">241</span>, <span class="number">242</span>, <span class="number">134</span>, <span class="number">247</span>, <span class="number">128</span>, <span class="number">65</span>, <span class="number">94</span>, <span class="number">57</span>, <span class="number">210</span>, <span class="number">236</span>, <span class="number">9</span>, <span class="number">193</span>]</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag2)):</span><br><span class="line">    ttt = mappp.index(flag2[i])</span><br><span class="line">    ttt &amp;= <span class="number">0xFF</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(ttt ^ <span class="number">0xFF</span> ^ i)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;U_90t_th3_p1c5t0re_fl49!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="0x03-实用的linux命令"><a href="#0x03-实用的linux命令" class="headerlink" title="0x03 实用的linux命令"></a>0x03 实用的linux命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grep -rn &quot;AABB&quot; /path                            # Linux在某目录下找字符串&quot;AABB&quot;</span><br><span class="line">c:\Windows\System32\findstr.exe /s &quot;AABB&quot; &quot;*.py&quot; # Windows在某目录下.py文件中找字符串&quot;AABB&quot;</span><br><span class="line">netstat -anp | grep :7777                        # 查看占用7777的进程</span><br><span class="line">sudo apt-cache madison curl                      # 查看curl包有哪些可安装的版本</span><br></pre></td></tr></table></figure>
<h2 id="0x04-密码算法相关脚本"><a href="#0x04-密码算法相关脚本" class="headerlink" title="0x04 密码算法相关脚本"></a>0x04 密码算法相关脚本</h2><h4 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">res = <span class="string">&quot;xxx&quot;</span>.encode()</span><br><span class="line">res = base64.b64decode(res)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h4 id="xxtea-tea-xtea"><a href="#xxtea-tea-xtea" class="headerlink" title="xxtea|tea|xtea"></a>xxtea|tea|xtea</h4><p>&emsp;见<code>tea-algorithm</code>。</p>
<h4 id="rc4"><a href="#rc4" class="headerlink" title="rc4"></a>rc4</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">rc4util</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(key, <span class="built_in">str</span>):</span><br><span class="line">            self.__keyGen = key.encode()</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(key, <span class="built_in">bytes</span>):</span><br><span class="line">            self.__keyGen = key        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__encrypt</span>(<span class="params">self, data</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        rc4 = ARC4.new(self.__keyGen)</span><br><span class="line">        res = rc4.encrypt(data)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__decrypt</span>(<span class="params">self, data</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        rc4 = ARC4.new(self.__keyGen)</span><br><span class="line">        res = rc4.decrypt(data)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">self, d</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">      res = self.__encrypt(d)</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">self, d</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">      res = self.__decrypt(d)</span><br><span class="line">      <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;12345678&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Entry</span>(<span class="params">d</span>):</span><br><span class="line">  rc4 = rc4util(key)</span><br><span class="line">  ret = rc4.Encrypt(d)</span><br><span class="line">  <span class="keyword">return</span> ret</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decry</span>(<span class="params">d</span>):</span><br><span class="line">  rc4 = rc4util(key)</span><br><span class="line">  ret = rc4.Decrypt(d)</span><br><span class="line">  <span class="keyword">return</span> ret</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  ciphertext = <span class="built_in">bytes</span>([<span class="number">0xe9</span>,<span class="number">0x97</span>,<span class="number">0x64</span>,<span class="number">0xe6</span>,<span class="number">0x7e</span>,<span class="number">0xeb</span>,<span class="number">0xbd</span>,<span class="number">0xc1</span>,<span class="number">0xab</span>,<span class="number">0x43</span>])</span><br><span class="line">  <span class="built_in">print</span>(Entry(ciphertext))</span><br></pre></td></tr></table></figure>
<h4 id="AES盒求逆"><a href="#AES盒求逆" class="headerlink" title="AES盒求逆"></a>AES盒求逆</h4><p>AES加解密（C语言版本）：<a target="_blank" rel="noopener" href="https://github.com/lmshao/AES">https://github.com/lmshao/AES</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">new_s_box = [...]</span><br><span class="line"> </span><br><span class="line">new_contrary_sbox = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    line = (new_s_box[i]&amp;<span class="number">0xf0</span>)&gt;&gt;<span class="number">4</span></span><br><span class="line">    rol = new_s_box[i]&amp;<span class="number">0xf</span></span><br><span class="line">    new_contrary_sbox[(line*<span class="number">16</span>)+rol] = i</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> (new_contrary_sbox)</span><br></pre></td></tr></table></figure>
<h2 id="0x05-线性规划求解"><a href="#0x05-线性规划求解" class="headerlink" title="0x05 线性规划求解"></a>0x05 线性规划求解</h2><p>&emsp;见starctf-2023的SIMPLE-WMM：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># @Time  : 2023/09/12 13:22:52</span></span><br><span class="line"><span class="string"># @Author: wd-2711</span></span><br><span class="line"><span class="string"># @Link  : https://www.cnblogs.com/joy-1120/p/8529772.html</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> optimize</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标参数</span></span><br><span class="line">c = np.array([<span class="number">70</span>, <span class="number">65</span>, <span class="number">80</span>, <span class="number">75</span>])</span><br><span class="line"><span class="comment"># 小于等于</span></span><br><span class="line">A = np.array([[<span class="number">4</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">7</span>],[<span class="number">6</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>],[<span class="number">6</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line">b = np.array([<span class="number">90</span>,<span class="number">120</span>,<span class="number">60</span>,<span class="number">100</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解</span></span><br><span class="line">res = optimize.linprog(-c,A,b,bounds=((<span class="number">0</span>,<span class="literal">None</span>),(<span class="number">0</span>,<span class="literal">None</span>),(<span class="number">0</span>,<span class="literal">None</span>),(<span class="number">0</span>,<span class="literal">None</span>)))</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="comment"># x: array([ 0., 15., 10.,  0.])</span></span><br><span class="line"><span class="comment"># max = 1775</span></span><br></pre></td></tr></table></figure>
<h2 id="0x06-frida脚本"><a href="#0x06-frida脚本" class="headerlink" title="0x06 frida脚本"></a>0x06 frida脚本</h2><p><a target="_blank" rel="noopener" href="https://2298233831.github.io/2022/10/24/So%E5%B1%82Hook/">https://2298233831.github.io/2022/10/24/So%E5%B1%82Hook/</a></p>
<h3 id="proc-self-maps检测"><a href="#proc-self-maps检测" class="headerlink" title="/proc/self/maps检测"></a>/proc/self/maps检测</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> openPtr = <span class="title class_">Module</span>.<span class="title function_">getExportByName</span>(<span class="string">&#x27;libc.so&#x27;</span>, <span class="string">&#x27;open&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> open = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(openPtr, <span class="string">&#x27;int&#x27;</span>, [<span class="string">&#x27;pointer&#x27;</span>, <span class="string">&#x27;int&#x27;</span>]);</span><br><span class="line">  <span class="keyword">var</span> readPtr = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;read&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> read = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(readPtr, <span class="string">&#x27;int&#x27;</span>, [<span class="string">&#x27;int&#x27;</span>, <span class="string">&#x27;pointer&#x27;</span>, <span class="string">&quot;int&quot;</span>]);</span><br><span class="line">  <span class="comment">// 可以事先准备好，也可以不准备，看 app 权限</span></span><br><span class="line">  <span class="keyword">var</span> fakePath = <span class="string">&quot;/data/data/com.app/maps&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> file = <span class="keyword">new</span> <span class="title class_">File</span>(fakePath, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> buffer = <span class="title class_">Memory</span>.<span class="title function_">alloc</span>(<span class="number">512</span>);</span><br><span class="line">  <span class="comment">// 替换 open 函数</span></span><br><span class="line">  <span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(openPtr, <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span> (<span class="params">pathnameptr, flag</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> pathname = <span class="title class_">Memory</span>.<span class="title function_">readUtf8String</span>(pathnameptr);</span><br><span class="line">      <span class="keyword">var</span> realFd = <span class="title function_">open</span>(pathnameptr, flag);</span><br><span class="line">      <span class="comment">// pathname 中含有 &quot;maps&quot;，此时返回 fakePath 的 fd</span></span><br><span class="line">      <span class="keyword">if</span> (pathname.<span class="title function_">indexOf</span>(<span class="string">&quot;maps&quot;</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">while</span> (<span class="built_in">parseInt</span>(<span class="title function_">read</span>(realFd, buffer, <span class="number">512</span>)) !== <span class="number">0</span>) &#123;</span><br><span class="line">              <span class="keyword">var</span> oneLine = <span class="title class_">Memory</span>.<span class="title function_">readCString</span>(buffer);</span><br><span class="line">              <span class="keyword">if</span> (oneLine.<span class="title function_">indexOf</span>(<span class="string">&quot;frida&quot;</span>) === -<span class="number">1</span>) &#123;</span><br><span class="line">                  file.<span class="title function_">write</span>(oneLine);</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">var</span> filename = <span class="title class_">Memory</span>.<span class="title function_">allocUtf8String</span>(fakePath);</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">open</span>(filename, flag);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> fd = <span class="title function_">open</span>(pathnameptr, flag);</span><br><span class="line">      <span class="keyword">return</span> fd;</span><br><span class="line">  &#125;, <span class="string">&#x27;int&#x27;</span>, [<span class="string">&#x27;pointer&#x27;</span>, <span class="string">&#x27;int&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure>
<h3 id="打印内存"><a href="#打印内存" class="headerlink" title="打印内存"></a>打印内存</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">print_mem</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> addr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libezandroid.so&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> byte_A138 = addr.<span class="title function_">add</span>(<span class="number">0xa138</span>)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">hexdump</span>(byte_A138, &#123;</span><br><span class="line">            <span class="attr">offset</span>:<span class="number">0</span>,</span><br><span class="line">            <span class="attr">length</span>: <span class="number">64</span>,</span><br><span class="line">            <span class="attr">header</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">ansi</span>: <span class="literal">true</span>,</span><br><span class="line">        &#125;))</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x07-其他"><a href="#0x07-其他" class="headerlink" title="0x07 其他"></a>0x07 其他</h2><h3 id="mgc-binary-to-mgc-code"><a href="#mgc-binary-to-mgc-code" class="headerlink" title="mgc binary to mgc code"></a>mgc binary to mgc code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hexdump</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;filepath.mgc&quot;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每次 0x178 字节，但是每 1 行是 0x30 bytes</span></span><br><span class="line">b = f.read(<span class="number">0x178</span>)</span><br><span class="line">indexes = []</span><br><span class="line">table = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    b = f.read(<span class="number">0x178</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(b) != <span class="number">0x178</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    line = b[:<span class="number">0x30</span>]</span><br><span class="line">    <span class="comment"># type</span></span><br><span class="line">    _<span class="built_in">type</span> = line[<span class="number">6</span>]</span><br><span class="line">    <span class="comment"># offset</span></span><br><span class="line">    <span class="comment"># line 的偏移量 0x0c 处开始，按照小端序解析数据，将该位置的 4 个字节解析为一个无符号的 32 位整数</span></span><br><span class="line">    off = struct.unpack_from(<span class="string">&#x27;&lt;I&#x27;</span>, line, <span class="number">0x0c</span>)[<span class="number">0</span>]</span><br><span class="line">    s = <span class="string">f&#x27;type: <span class="subst">&#123;_<span class="built_in">type</span>:02X&#125;</span>, off: <span class="subst">&#123;off:02X&#125;</span>&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> _<span class="built_in">type</span> == <span class="number">5</span>:</span><br><span class="line">        <span class="comment"># 5 代表解析 line[0x20:] 的字符串</span></span><br><span class="line">        s += <span class="string">&#x27;, str: &#x27;</span>+line[<span class="number">0x20</span>:].decode()</span><br><span class="line">    <span class="keyword">elif</span> _<span class="built_in">type</span> == <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 1 代表 line[0x18]^line[0x20] 异或的 byte</span></span><br><span class="line">        n1, n2 = line[<span class="number">0x18</span>], line[<span class="number">0x20</span>]</span><br><span class="line">        v = n1 ^ n2</span><br><span class="line">        s += <span class="string">f&#x27;, byte: <span class="subst">&#123;n1:02X&#125;</span> <span class="subst">&#123;n2:02X&#125;</span> <span class="subst">&#123;v:02X&#125;</span> <span class="subst">&#123;<span class="built_in">chr</span>(v)&#125;</span>&#x27;</span></span><br><span class="line">        table += <span class="built_in">chr</span>(v)</span><br><span class="line">    <span class="keyword">elif</span> _<span class="built_in">type</span> == <span class="number">10</span>:</span><br><span class="line">        <span class="comment"># 10 代表 line[0x18]^line[0x20] 异或的 16 比特数</span></span><br><span class="line">        n1, n2 = line[<span class="number">0x18</span>], line[<span class="number">0x20</span>] </span><br><span class="line">        v = n1 ^ n2</span><br><span class="line">        s += <span class="string">f&#x27;, leshort: <span class="subst">&#123;n1:02X&#125;</span> <span class="subst">&#123;n2:02X&#125;</span> <span class="subst">&#123;v:02X&#125;</span> <span class="subst">&#123;v&#125;</span>&#x27;</span></span><br><span class="line">        indexes.append(v)</span><br><span class="line">    <span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>
<h3 id="byte2int"><a href="#byte2int" class="headerlink" title="byte2int"></a>byte2int</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s1 = <span class="string">b&#x27;\xf1\xff&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>.from_bytes(s1, byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>.from_bytes(s1, byteorder=<span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure>
<h3 id="int2byte"><a href="#int2byte" class="headerlink" title="int2byte"></a>int2byte</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">integer_val = <span class="number">5</span></span><br><span class="line">bytes_val = integer_val.to_bytes(<span class="number">2</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(bytes_val)</span><br></pre></td></tr></table></figure>

  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2023/08/02/about-lua/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> 上一页</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/07/30/starCTF2023/" type="button" class="btn btn-default ">下一页<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>


	<!-- comment -->
	
<section id="comment">
    <h2 class="title">留言</h2>

    <!-- 
    <div id="disqus_thread" class="ds-thread">
        <script type="text/javascript">
            /**
             * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
             */
                /*
                 var disqus_config = function () {
                 this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                 this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                 };
                 */
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = 'https://https-wd-2711-tech.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by
                Disqus.</a></noscript>
    </div> -->
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <div id="vcomments"></div>
    <script>
        new Valine({
            el: '#vcomments',
            appId: 'wLIJ70s3fPvW8WJPgVVAuWVR-gzGzoHsz',
            appKey: 'NVGqxhUkqtFv2CbwmXXWjCdR'
        })
    </script>

    
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-08-01 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/杂记/">杂记<span>13</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="toc-article-text">一些常用的脚本</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x00-idapython-ida7-7"><span class="toc-article-text">0x00 idapython-ida7.7</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#memory-dump"><span class="toc-article-text">memory_dump</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#array-dump"><span class="toc-article-text">array_dump</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x01-gdb-python%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95"><span class="toc-article-text">0x01 gdb+python自动化测试</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x02-Z3%E7%9B%B8%E5%85%B3script"><span class="toc-article-text">0x02 Z3相关script</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x03-%E5%AE%9E%E7%94%A8%E7%9A%84linux%E5%91%BD%E4%BB%A4"><span class="toc-article-text">0x03 实用的linux命令</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x04-%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E7%9B%B8%E5%85%B3%E8%84%9A%E6%9C%AC"><span class="toc-article-text">0x04 密码算法相关脚本</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#base64"><span class="toc-article-text">base64</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#xxtea-tea-xtea"><span class="toc-article-text">xxtea|tea|xtea</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#rc4"><span class="toc-article-text">rc4</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#AES%E7%9B%92%E6%B1%82%E9%80%86"><span class="toc-article-text">AES盒求逆</span></a></li></ol></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x05-%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92%E6%B1%82%E8%A7%A3"><span class="toc-article-text">0x05 线性规划求解</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x06-frida%E8%84%9A%E6%9C%AC"><span class="toc-article-text">0x06 frida脚本</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#proc-self-maps%E6%A3%80%E6%B5%8B"><span class="toc-article-text">&#x2F;proc&#x2F;self&#x2F;maps检测</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E6%89%93%E5%8D%B0%E5%86%85%E5%AD%98"><span class="toc-article-text">打印内存</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x07-%E5%85%B6%E4%BB%96"><span class="toc-article-text">0x07 其他</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#mgc-binary-to-mgc-code"><span class="toc-article-text">mgc binary to mgc code</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#byte2int"><span class="toc-article-text">byte2int</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#int2byte"><span class="toc-article-text">int2byte</span></a></li></ol></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>

	<!-- copyright -->
	<div>
    <ul class="post-copyright">
      <li class="post-copyright-author">
      <strong>作者:  </strong>wd-z711</a>
      </li>
      <li class="post-copyright-link">
      <strong>文章链接:  </strong>
      <a href="/" target="_blank" title="">https://wd-2711.tech/</a>
      </li>
      <li class="post-copyright-license">
        <strong>版权声明:   </strong>
        本博客所有文章除特别声明外，均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
        许可协议。转载请注明出处!
      </li>
    </ul>
  <div>
 	

		


</div><!-- row -->




	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2024 wd-z711
  
      <!-- with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a> and <a href="http://getbootstrap.com/" target="_blank">BOOTSTRA.386</a>. 
     <br> Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.     -->

     <!-- <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
      
      _st('install','aB-vgeB8gEDrnRJuhceL','2.0.0');
    </script> -->
    </p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
   </html>
