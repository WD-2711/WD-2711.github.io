<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>geekpwn2023 | wd-z711&#39;s B10g</title>
  <meta name="author" content="wd-z711">
  
  <meta name="description" content="Common student in China. Interested in web &amp; re.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="geekpwn2023"/>
  <meta property="og:site_name" content="wd-z711&#39;s B10g"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'G-YHJSKZDC3Y', 'auto');
  ga('send', 'pageview');
</script>




<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="wd-z711's B10g" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">wd-z711&#39;s B10g</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> geekpwn2023</h1>
		</div>
	



<div class="row post">

	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="巅峰极客挑战赛2023-逆向-amp-misc"><a href="#巅峰极客挑战赛2023-逆向-amp-misc" class="headerlink" title="巅峰极客挑战赛2023-逆向&amp;misc"></a>巅峰极客挑战赛2023-逆向&amp;misc</h1><p>&emsp;此次比赛复盘，m1_read、Misc-一起学生物是根据wp来做的，而goRe-U与ezlua则是自己尝试做一做。总的来说，里面好多题都没见过，尤其是m1_read与ezlua，这两道题让我发现自己的脚本能力（frida、gdb、z3等）还是比较差。继续加油吧。</p>
<span id="more"></span>
<h2 id="0x00-m1-read"><a href="#0x00-m1-read" class="headerlink" title="0x00 m1_read"></a>0x00 m1_read</h2><p>&emsp;这个题做完调试文件给删了…所以没在github上同步更新。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这个看起来是一个门禁系统的写卡程序，不过开发人员只写了半天并没有搞完，此外还有一个写卡程序相关的数据包</span><br></pre></td></tr></table></figure>
<p>&emsp;比赛中，这道题我看了一天。最后才知道是W&amp;M的师傅出的题。</p>
<h3 id="菜鸟的挣扎"><a href="#菜鸟的挣扎" class="headerlink" title="菜鸟的挣扎"></a>菜鸟的挣扎</h3><p>&emsp;这是一道RFID的门禁卡程序，分别给了m1_read.exe与out.bin，其中out.bin是RFID卡中存储的数据，m1_read.exe则是读写RFID卡的工具。</p>
<p><img src="/images/geekpwn2023/image-20230727093855149.png" alt="image-20230727093855149" style="zoom:67%;" /></p>
<p>&emsp;那天我的发现有：</p>
<p>（1）上图的hint。</p>
<p>（2）RFID的数据存储结构如下：</p>
<p><img src="/images/geekpwn2023/image-20230727094439818.png" alt="image-20230727094439818" style="zoom:67%;" /></p>
<p>&emsp;RFID卡共有16个扇区，每个扇区都有4个区块，共有1024个字节。</p>
<p>（3）RFID的数据块使用crypto-1算法加密（存疑），链接为：<a target="_blank" rel="noopener" href="https://github.com/jeeberhardt/crypto1">crypto算法</a></p>
<h3 id="大爹的wp-amp-自己的探索"><a href="#大爹的wp-amp-自己的探索" class="headerlink" title="大爹的wp&amp;自己的探索"></a>大爹的wp&amp;自己的探索</h3><p>&emsp;链接为<a target="_blank" rel="noopener" href="https://www.cnblogs.com/gaoyucan/p/17577858.html">wp</a>。其中，我并不理解为什么要用到AES加密，猜测是出题人将m1_read.exe魔改了，在其中读入读出数据时采用了加密处理。所以打算现在网上找到原始版本的程序。</p>
<p>&emsp;找到了32位的此程序，链接如下：<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=hWsd2Co77Os">链接</a>，这是youtube的链接，里面有相关的下载地址。关键是bindiff还出问题了，在ida7.7上总是有问题，最后降成ida7.5+bindiff6才行。然鹅，比较一看，根本木有重合。</p>
<p>&emsp;那这样的话，只能自己看m1_read.exe了。</p>
<p><img src="/images/geekpwn2023/image-20230727162941115.png" alt="image-20230727162941115" style="zoom:67%;" /></p>
<p>&emsp;通过ResourceHacker获得UpdateBlock控件的ID（因为要写文件），可以发现ID=0x3FC。在IDA中找0x3FC，<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6e75c5d58230">并筛选出rdata段中的条目</a>，并将其转为<a target="_blank" rel="noopener" href="https://www.cnblogs.com/h2zZhou/p/10593168.html">AFX_MSGMAP_ENTRY结构体</a>。最后可以获得消息映射表：</p>
<p><img src="/images/geekpwn2023/image-20230727185914187.png" alt="image-20230727185914187" style="zoom:67%;" /></p>
<p>&emsp;最后，可以定位到updateBlock对应的函数：sub_1400028A0。通过分析此函数，如下所示，其中hint函数比较重要，它控制着结果的输出：</p>
<p><img src="/images/geekpwn2023/image-20230727202014223.png" alt="image-20230727202014223" style="zoom:67%;" /></p>
<p>&emsp;于是跟进到hint函数（需要说明一下，这里我找到hint函数的过程有很大一部分原因是根据AES函数分析调用反推出来的，但是正常分析时，也可以分析到此函数，只不过花费的时间可能长一些），可以发现：</p>
<p><img src="/images/geekpwn2023/image-20230727202936534.png" alt="image-20230727202936534" style="zoom:67%;" /></p>
<p>&emsp;pbSendBuffer是向卡中写入的数据，且str1_copy与pbSendBuffer挨得很近，猜测是将pbSendBuffer与str1_copy一块写入到卡中。接下来，我们再来分析whiteAES函数（此函数名是我后来加的）。</p>
<p><img src="/images/geekpwn2023/image-20230727225615753.png" alt="image-20230727225615753" style="zoom:67%;" /></p>
<p>&emsp;由上图可以发现，先经过了一系列操作，最后经过异或，得出结果。</p>
<p>&emsp;看了大爹的wp，发现这一系列操作是AES白盒，目的是为了掩盖密钥。大爹的思路是：</p>
<p>（1）使用frida（<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1345684">windows下使用frida</a>，技能点get），随机生成数据并经过whiteAES，得到一系列数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># windows exe hook</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[%s] =&gt; %s&quot;</span> % (message, data))</span><br><span class="line"></span><br><span class="line">session = frida.attach(<span class="string">&quot;m1_read.exe&quot;</span>)</span><br><span class="line"></span><br><span class="line">script = session.create_script(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    var baseAddr = Module.findBaseAddress(&quot;m1_read.exe&quot;);</span></span><br><span class="line"><span class="string">    var f1 = baseAddr.add(0x4BF0);</span></span><br><span class="line"><span class="string">    var f2 = baseAddr.add(0x4C2C);</span></span><br><span class="line"><span class="string">    var whiteAES = new NativeFunction(f1, &quot;pointer&quot;, [&quot;pointer&quot;, &quot;pointer&quot;])</span></span><br><span class="line"><span class="string">    var count = 9;</span></span><br><span class="line"><span class="string">    Interceptor.attach(f2, &#123;</span></span><br><span class="line"><span class="string">        onEnter: function(args) &#123;</span></span><br><span class="line"><span class="string">            count++;</span></span><br><span class="line"><span class="string">            if(count == 9) &#123;</span></span><br><span class="line"><span class="string">                // 将rdi增加0-15，将rdi指向的地址随机写入数据</span></span><br><span class="line"><span class="string">                this.context.rdi.add(Math.floor(Math.random() * 16)).writeU8(Math.floor(Math.random() * 256))</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    for (let index = 0; index &lt; 33; index++) &#123;</span></span><br><span class="line"><span class="string">        // 1234567890abcdef 可任意修改</span></span><br><span class="line"><span class="string">        var l = Memory.allocAnsiString(&quot;1234567890abcdef&quot;);</span></span><br><span class="line"><span class="string">        var b = Memory.alloc(16);</span></span><br><span class="line"><span class="string">        whiteAES(l, b);</span></span><br><span class="line"><span class="string">        console.log(b.readByteArray(16));</span></span><br><span class="line"><span class="string">        count = 0;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line">script.on(<span class="string">&#x27;message&#x27;</span>, on_message)</span><br><span class="line">script.load()</span><br><span class="line">sys.stdin.read()</span><br><span class="line">session.detach()</span><br></pre></td></tr></table></figure>
<p>（2）将得到的数据异或66，就得到白盒操作后的数据。</p>
<p>（3）使用<a target="_blank" rel="noopener" href="https://python.hotexamples.com/examples/phoenixAES/-/crack_file/python-crack_file-function-examples.html">phoenixAES，例如第3个例子</a>处理数据，可以得到第N轮的密钥。再使用<a target="_blank" rel="noopener" href="https://github.com/SideChannelMarvels/Stark">Stark</a>反推出第1轮的密钥，为<code>00000000000000000000000000000000</code>。这一步其实有Hint，大爹没看到。</p>
<p>（4）用拿到的密钥解密out.bin中的数据：<code>0B987EF5D94DD679592C4D2FADD4EB89 ^ 0x66</code>。就可以得到<code>flag&#123;cddc8d28dabb4ea9&#125;</code>。</p>
<h2 id="0x01-g0Re-U"><a href="#0x01-g0Re-U" class="headerlink" title="0x01 g0Re-U"></a>0x01 g0Re-U</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gogogo</span><br></pre></td></tr></table></figure>
<p>&emsp;发现是UPX的壳。工具脱壳（UPX Unpacker）失败，打算动调找OEP。</p>
<h3 id="苦逼动调upx"><a href="#苦逼动调upx" class="headerlink" title="苦逼动调upx"></a>苦逼动调upx</h3><p><img src="/images/geekpwn2023/image-20230729110419250.png" alt="image-20230729110419250" style="zoom:67%;" /></p>
<p>&emsp;将上图所示内存dump下来，发现是ELF头部以及各种Go表，说明还未解密完。</p>
<p><img src="/images/geekpwn2023/image-20230729114118806.png" alt="image-20230729114118806" style="zoom:67%;" /></p>
<p>&emsp;sub_45D700貌似是一个解密函数，用于对上上图所示的内存进行解密。</p>
<p><img src="/images/geekpwn2023/image-20230729115123796.png" alt="image-20230729115123796" style="zoom:67%;" /></p>
<p>&emsp;F8上图出现”input flag”字样。之后跟进到sub_434C00函数，定位到sub_434CA0函数，发现：</p>
<p><img src="/images/geekpwn2023/image-20230729124346850.png" alt="image-20230729124346850" style="zoom:67%;" /></p>
<p>&emsp;记得之前Go程序的Start入口有这个函数，猜测我已找到OEP。将模块<code>0x400000-0x483000</code> dump出来，因为这是goRe原始模块的文件。如下图所示：</p>
<p><img src="/images/geekpwn2023/image-20230729134050910.png" alt="image-20230729134050910" style="zoom:67%;" /></p>
<p>&emsp;但是go_parser找不到first_moduledata，所以无法解析。那怎么办？</p>
<p>&emsp;一筹莫展之际，发现文件中有函数aes加密，如下图所示：</p>
<p><img src="/images/geekpwn2023/image-20230729150416292.png" alt="image-20230729150416292" style="zoom:67%;" /></p>
<p>&emsp;动态调试，发现为10轮AES加密。加密的明文是输入的字符串，扩展为16字节。加密密钥为：<code>wvgitbygwbk2b46d</code>。那么就可以猜测，本题是明文加密然后与某密文比较。</p>
<p>&emsp;如何找到密文呢？又一次一筹莫展之际，发现，如果将<code>0x400000-0x578580</code>dump出来，就可以正常运行go_parser脚本。这是偶然发现的，因为经过调试发现解密过程还包括<code>0x483000</code>后的内容。</p>
<h3 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h3><p>&emsp;经过分析，此程序共有3步：</p>
<p>（1）输入input，使用AES加密，密钥为：<code>wvgitbygwbk2b46d</code>，iv为0。（需要注意的是，这里的加密是按16字节作为一个Block加密）</p>
<p>（2）将加密结果使用Base64转换，Base64码表为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">456789&#125;#IJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123ABCDEFG</span><br></pre></td></tr></table></figure>
<p>（3）将转换后的结果做如下处理：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(step2_result[i]^0x1A)+key[i&amp;0xf]</span><br></pre></td></tr></table></figure>
<p>&emsp;最终可以得到wp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># @Time  : 2023/08/01 18:13:14</span></span><br><span class="line"><span class="string"># @Author: wd-2711</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Excerpt from https://blog.csdn.net/qq_42967398/article/details/101778364</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">My_base64_decode</span>(<span class="params">inputs</span>):</span><br><span class="line">	bin_str = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> inputs:</span><br><span class="line">		<span class="keyword">if</span> i != <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">			x = <span class="built_in">str</span>(<span class="built_in">bin</span>(s.index(i))).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">			bin_str.append(<span class="string">&#x27;&#123;:0&gt;6&#125;&#x27;</span>.<span class="built_in">format</span>(x))</span><br><span class="line">	outputs = <span class="string">&quot;&quot;</span></span><br><span class="line">	nums = inputs.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">	<span class="keyword">while</span> bin_str:</span><br><span class="line">		temp_list = bin_str[:<span class="number">4</span>]</span><br><span class="line">		temp_str = <span class="string">&quot;&quot;</span>.join(temp_list)</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">len</span>(temp_str) % <span class="number">8</span> != <span class="number">0</span>):</span><br><span class="line">			temp_str = temp_str[<span class="number">0</span>:-<span class="number">1</span> * nums * <span class="number">2</span>]</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">int</span>(<span class="built_in">len</span>(temp_str) / <span class="number">8</span>)):</span><br><span class="line">			outputs += <span class="built_in">chr</span>(<span class="built_in">int</span>(temp_str[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">		bin_str = bin_str[<span class="number">4</span>:]	</span><br><span class="line">	<span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step1: xor</span></span><br><span class="line">target = [<span class="string">b&#x27;\xe6&#x27;</span>, <span class="string">b&#x27;\xce&#x27;</span>, <span class="string">b&#x27;\x89&#x27;</span>, <span class="string">b&#x27;\xc8&#x27;</span>, <span class="string">b&#x27;\xcf&#x27;</span>, <span class="string">b&#x27;\xc5&#x27;</span>, <span class="string">b&#x27;\xf5&#x27;</span>, <span class="string">b&#x27;\xc9&#x27;</span>, <span class="string">b&#x27;\xd2&#x27;</span>, <span class="string">b&#x27;\xd9&#x27;</span>, <span class="string">b&#x27;\xc0&#x27;</span>, <span class="string">b&#x27;\x91&#x27;</span>, <span class="string">b&#x27;\xce&#x27;</span>, <span class="string">b&#x27;\x7f&#x27;</span>, <span class="string">b&#x27;\xac&#x27;</span>, <span class="string">b&#x27;\xcc&#x27;</span>, <span class="string">b&#x27;\xe9&#x27;</span>, <span class="string">b&#x27;\xcf&#x27;</span>, <span class="string">b&#x27;\xb7&#x27;</span>, <span class="string">b&#x27;\xc0&#x27;</span>, <span class="string">b&#x27;\x96&#x27;</span>, <span class="string">b&#x27;\xd4&#x27;</span>, <span class="string">b&#x27;\xea&#x27;</span>, <span class="string">b&#x27;\x92&#x27;</span>, <span class="string">b&#x27;\xe2&#x27;</span>, <span class="string">b&#x27;\xd7&#x27;</span>, <span class="string">b&#x27;\xdf&#x27;</span>, <span class="string">b&#x27;\x84&#x27;</span>, <span class="string">b&#x27;\xcb&#x27;</span>, <span class="string">b&#x27;\xa5&#x27;</span>, <span class="string">b&#x27;\xae&#x27;</span>, <span class="string">b&#x27;\x93&#x27;</span>, <span class="string">b&#x27;\xa6&#x27;</span>, <span class="string">b&#x27;\xca&#x27;</span>, <span class="string">b&#x27;\xbe&#x27;</span>, <span class="string">b&#x27;\x97&#x27;</span>, <span class="string">b&#x27;\xdf&#x27;</span>, <span class="string">b&#x27;\xce&#x27;</span>, <span class="string">b&#x27;\xf0&#x27;</span>, <span class="string">b&#x27;\xc9&#x27;</span>, <span class="string">b&#x27;\xb7&#x27;</span>, <span class="string">b&#x27;\xe1&#x27;</span>, <span class="string">b&#x27;\xae&#x27;</span>, <span class="string">b&#x27;k&#x27;</span>, <span class="string">b&#x27;\xc4&#x27;</span>, <span class="string">b&#x27;\xb1&#x27;</span>, <span class="string">b&#x27;e&#x27;</span>, <span class="string">b&#x27;\xdb&#x27;</span>, <span class="string">b&#x27;\xce&#x27;</span>, <span class="string">b&#x27;\xed&#x27;</span>, <span class="string">b&#x27;\x92&#x27;</span>, <span class="string">b&#x27;\x93&#x27;</span>, <span class="string">b&#x27;\xd6&#x27;</span>, <span class="string">b&#x27;\x8c&#x27;</span>, <span class="string">b&#x27;\xed&#x27;</span>, <span class="string">b&#x27;\xc3&#x27;</span>, <span class="string">b&#x27;\xa3&#x27;</span>, <span class="string">b&#x27;\xda&#x27;</span>, <span class="string">b&#x27;\x94&#x27;</span>, <span class="string">b&#x27;\xa5&#x27;</span>, <span class="string">b&#x27;\xaa&#x27;</span>, <span class="string">b&#x27;\xb2&#x27;</span>, <span class="string">b&#x27;\xb5&#x27;</span>, <span class="string">b&#x27;\xa7&#x27;</span>]</span><br><span class="line">key = <span class="string">&quot;wvgitbygwbk2b46d&quot;</span></span><br><span class="line">inp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(target)):</span><br><span class="line">    tmp = <span class="built_in">int</span>.from_bytes(target[i], byteorder=<span class="string">&#x27;big&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    inp += <span class="built_in">chr</span>((tmp - <span class="built_in">ord</span>(key[i&amp;<span class="number">0xf</span>]))^<span class="number">0x1A</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step2: base64_decode</span></span><br><span class="line">s = <span class="string">&quot;456789&#125;#IJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123ABCDEFGH&quot;</span></span><br><span class="line">output = My_base64_decode(inp)</span><br><span class="line">output = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> output]</span><br><span class="line">ciphertext = <span class="built_in">bytes</span>(output)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step3: AES_decrypt</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    key = <span class="string">b&#x27;wvgitbygwbk2b46d&#x27;</span></span><br><span class="line">    iv = <span class="string">b&quot;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;</span></span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    ciphertext_block = ciphertext[i*<span class="number">16</span>:(i+<span class="number">1</span>)*<span class="number">16</span>]</span><br><span class="line">    plaintext = cipher.decrypt(ciphertext_block)</span><br><span class="line">    <span class="built_in">print</span>(plaintext, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;g0_1s_th3_b3st_1anguage_1n_the_wOrld!_xxx&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="0x02-ezlua"><a href="#0x02-ezlua" class="headerlink" title="0x02 ezlua"></a>0x02 ezlua</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">luajit 5.1</span><br></pre></td></tr></table></figure>
<p>&emsp;之前没做过lua的题，lua是大多嵌入式环境使用的脚本语言，好多游戏也是Lua写的。64位文件。</p>
<p>&emsp;Hint为luajit，说明这是用针对lua5.1版本的jit编译器编译的（代码转为机器码）。luajit是保护lua代码的一种方式，可以使用<a target="_blank" rel="noopener" href="https://github.com/franko/luajit-lang-toolkit">luajit-lang-toolkit</a>进行反汇编。</p>
<p>&emsp;使用luajit对dump出的字节码进行反汇编，但是一直显示不兼容。</p>
<p>&emsp;准备看wp了，一直没找到兼容的版本啊。</p>
<p>&emsp;但是，今天看了一天<a href="https://wd-2711.tech/2023/08/02/about-lua/#more"><code>lualualua</code></a>，感觉和<code>picStore</code>那道题很像，只不过是<code>luajit</code>版本的。因此，很容易想到，是在加载lua字节码，即<code>LuaL_loadbuffer</code>函数中做了手脚，如下所示：</p>
<p><img src="/images/geekpwn2023/image-20230802212818568.png" alt="image-20230802212818568" style="zoom:67%;" /></p>
<h3 id="luaL-loadbuffer函数分析"><a href="#luaL-loadbuffer函数分析" class="headerlink" title="luaL_loadbuffer函数分析"></a>luaL_loadbuffer函数分析</h3><p>&emsp;首先，找到luaL_loadbuffer的源码，与反汇编后的代码比较：</p>
<p><img src="/images/geekpwn2023/image-20230803134835189.png" alt="image-20230803134835189" style="zoom:67%;" /></p>
<p>&emsp;容易发现，IDA反汇编结果实际上是将lua_loadx加载进了luaL_loadbuffer函数中（根据字符”?”）。因此，可以根据源码对函数进行命名。其中，cpparser作用是将 Lua 源代码解析为 Lua 函数，并将其保存在 Lua 虚拟机中，以供后续执行，于是跟进此函数：</p>
<p><img src="/images/geekpwn2023/image-20230803141520298.png" alt="image-20230803141520298" style="zoom:67%;" /></p>
<p>&emsp;在此判断加载的Buffer是binary文件还是text文件，由于是binary文件，于是跟进lj_bcread，与源代码比较如下：</p>
<p><img src="/images/geekpwn2023/image-20230803145553057.png" alt="image-20230803145553057" style="zoom:67%;" /></p>
<p>&emsp;跟进lj_bcread_proto，发现此函数可能被魔改了。经过分析，发现下左图红框的两行代码魔改为下右图红框的代码：</p>
<p><img src="/images/geekpwn2023/image-20230803155348688.png" alt="image-20230803155348688" style="zoom:67%;" /></p>
<p>&emsp;进一步分析，发现是在lj_bcread_proto中的bcread_bytecode函数中动了手脚，如下图所示：</p>
<p><img src="/images/geekpwn2023/image-20230803160914397.png" alt="image-20230803160914397" style="zoom:67%;" /></p>
<p>&emsp;源代码中，<code>bc[i]</code>为4字节，<code>lj_bswap</code>函数作用是改变字节序并返回。发现并没有魔改，寄！看来和picStore还不一样。</p>
<h3 id="佬的wp"><a href="#佬的wp" class="headerlink" title="佬的wp"></a>佬的wp</h3><p>&emsp;对输入打内存断点。若输入<code>1123456789112345678911234567891123456789</code>，则在luajit字节码区域为：</p>
<p><img src="/images/geekpwn2023/image-20230803182449497.png" alt="image-20230803182449497" style="zoom:67%;" /></p>
<p>&emsp;中间有0x3。对输入打断点，卡在了<code>bcread_uleb128</code>中，回溯发现在<code>bcread_kgc</code>函数中，这是一个加载常量的函数，如下所示：</p>
<p><img src="/images/geekpwn2023/image-20230803184456539.png" alt="image-20230803184456539" style="zoom:67%;" /></p>
<p>&emsp;在此补充一下uleb编码：uleb通过字节的最高位来决定是否用到下一个字节。如果最高位为1，则用到下一个字节，直到某个字节最高位为0或已经读取了5个字节为止。对于函数<code>bcread_uleb128</code>而言，它读取1-5字节。</p>
<p>&emsp;其实，能正常反编译，就是自己没找对版本和x86/x64的而已。具体看<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1378796-1-1.html">luajit常用的反编译方法</a>。</p>
<p><strong>Step1：</strong>dump出luajit字节码，<a target="_blank" rel="noopener" href="https://www.sweetscape.com/010editor/repository/files/LuaJIT.bt">使用bt模板解析</a>，但是在解析常量时报错。猜测原因是：输入也会改变字节码的值，具体是改变字节码中存储常量的部分。因此，要输入符合uleb128格式的输入，再dump字节码。此时输入可以为：<code>9999999911999999991199999999119999999911</code>。再解析，便成功了。发现Luajit版本为2，如下所示：</p>
<p><img src="/images/geekpwn2023/image-20230804143805212.png" alt="image-20230804143805212" style="zoom:67%;" /></p>
<p><strong>Step2：</strong>可以发现这是64位的luajit字节码文件，原因如下：第5字节为0x0E=b1110，其中采用2-slot frame info` 模式（FLAG_FR2 = 0b00001000），后者是 64 位引入的新特性。</p>
<p><strong>Step3：</strong>目前，反编译luajit字节码文件的工具有ljd与luajit-decomp，由于ljd并未找到x64版本的，所以使用luajit-decomp进行反编译，具体步骤见<a target="_blank" rel="noopener" href="https://www.52pojie.cn/thread-1378796-1-1.html">luajit反编译</a>。最后使用<a target="_blank" rel="noopener" href="https://github.com/Dr-MTN/luajit-decompiler">luajit-decompiler</a>进行反编译，但是出错了，如下所示：</p>
<p><img src="/images/geekpwn2023/image-20230804153504085.png" alt="image-20230804153504085" style="zoom:67%;" /></p>
<p>&emsp;猜测是输入的最后使用11，多占了1字节，于是将输入改为<code>9999999901999999990199999999019999999901</code>。还是报错：</p>
<p><img src="/images/geekpwn2023/image-20230804163519467.png" alt="image-20230804163519467" style="zoom:67%;" /></p>
<p>&emsp;这是去除中间项的代码，把这行注释掉，并开启<code>no_unwarp</code>，最终得到反汇编代码。但是有7000行代码，猜测是将去除中间项的代码注释掉的结果，妈的。</p>
<p>&emsp;看了佬的wp，他对于此错误的改进为：修改<code>./luajit-decompiler/ljd/rawdump/code.py</code>为：</p>
<p><img src="/images/geekpwn2023/image-20230804171242947.png" alt="image-20230804171242947" style="zoom:67%;" /></p>
<p>（注：由于我并不是先转汇编再转lua代码，因此并没有调试出是在CALL处除了错误，其实，我就算知道了CALL出了错误，也不知道怎么改，呜呜呜。）</p>
<p>&emsp;再运行，得到：</p>
<p><img src="/images/geekpwn2023/image-20230804171355119.png" alt="image-20230804171355119" style="zoom:67%;" /></p>
<p>&emsp;针对浮点数的情况，佬的改进如下：修改<code>./luajit-decompiler/ljd/rawdump/constants.py</code>为：</p>
<p><img src="/images/geekpwn2023/image-20230804171644260.png" alt="image-20230804171644260" style="zoom:67%;" /></p>
<p>&emsp;得到的结果<code>out.lua</code>为（其中slot1与slot0为输入的uleb128编码）：</p>
<p><img src="/images/geekpwn2023/image-20230804172838927.png" alt="image-20230804172838927" style="zoom:67%;" /></p>
<p>&emsp;其中，可以分析得出，slot2负责控制程序流。最后返回处理后的slot0与slot1。有一个很坑的点是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slot0 = bit.bxor(bit.bor(bit.lshift(slot0, 3), bit.rshift(slot0, 61)), bit.bxor(slot0 + bit.bor(bit.rshift(slot1, 8), bit.lshift(slot1, 56)), slot2))</span><br></pre></td></tr></table></figure>
<p>&emsp;上述式子的中间值slot1没赋值，应该是这样（也太坑了）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">slot1 = bor(rshift(slot1, 8), lshift(slot1, 56));</span><br><span class="line">slot1 = bxor(slot0 + slot1, slot2);</span><br><span class="line">slot0 = bor(lshift(slot0, 3), rshift(slot0, 61));</span><br><span class="line">slot0 = bxor(slot0, slot1);</span><br></pre></td></tr></table></figure>
<p>&emsp;再分析IDA反汇编代码，<code>luaL_checkcdata</code>函数表示从栈底开始取值，取到的分别是slot0与slot1，并判断是否是某个值。</p>
<p><img src="/images/geekpwn2023/image-20230804173219028.png" alt="image-20230804173219028" style="zoom:67%;" /></p>
<p><strong>Step4：</strong>通过运行<code>out.lua</code>，可以得到一共运行了32次上述4行代码，其中slot2都不同，最终可以写脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> leb128</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">_slot0, _slot1, _slot2</span>):</span><br><span class="line">    _slot0 ^= _slot1</span><br><span class="line">    _slot0 = ((_slot0 &gt;&gt; <span class="number">3</span>) | (_slot0 &lt;&lt; <span class="number">61</span>)) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">    slot1_and_slot0 = _slot1 ^ _slot2</span><br><span class="line">    _slot1 = slot1_and_slot0 - _slot0</span><br><span class="line">    _slot1 &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">    _slot1 = ((_slot1 &gt;&gt; <span class="number">56</span>) | (_slot1 &lt;&lt; <span class="number">8</span>)) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">    <span class="keyword">return</span> _slot0, _slot1</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u64_to_uleb128</span>(<span class="params">u</span>):</span><br><span class="line">    high = u &gt;&gt; <span class="number">32</span></span><br><span class="line">    low = u &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> leb128.u.encode(low).<span class="built_in">hex</span>() + leb128.u.encode(high).<span class="built_in">hex</span>()</span><br><span class="line"> </span><br><span class="line">slot2_array = [<span class="number">0xdeadbeef12345678</span>, <span class="number">0x28539dc5904d8141</span>, <span class="number">0xf2ac321ccf237a7b</span>, <span class="number">0xf03df21e866b1a36</span>, <span class="number">0x584cde754c325b4b</span>, <span class="number">0x97407269ac231f8b</span>,</span><br><span class="line"> <span class="number">0xd2960ba60ee82d09</span>, <span class="number">0xb34efc0e8d197592</span>, <span class="number">0x15011adba4d8613d</span>, <span class="number">0x1598470b72677cea</span>, <span class="number">0xb497efc6db87c606</span>, <span class="number">0xae0f3ba8a4eeb218</span>,</span><br><span class="line"> <span class="number">0xab6036ab64121254</span>, <span class="number">0x663ae5cc72c5eb7f</span>, <span class="number">0x71af0f7e9c371b0e</span>, <span class="number">0xeb97fc6b58f9eb33</span>, <span class="number">0x774108a83f7c75f6</span>, <span class="number">0x5a6542d5c9968681</span>,</span><br><span class="line"> <span class="number">0x5e6fb973117ccfb1</span>, <span class="number">0xea8134ba653ce534</span>, <span class="number">0xfc92946aa1cc9678</span>, <span class="number">0x38af8cc9553071e4</span>, <span class="number">0x99f7a1b258084992</span>, <span class="number">0x82e920e890bb99da</span>,</span><br><span class="line"> <span class="number">0xc67f72528ed05d6c</span>, <span class="number">0x4cab3a53d2598281</span>, <span class="number">0x517358620b3249f9</span>, <span class="number">0xcf3d41fd5e5e0786</span>, <span class="number">0x626be66ab995efe3</span>, <span class="number">0x24d85b01f54e2ab1</span>,</span><br><span class="line"> <span class="number">0xe9cd3a65e3f95992</span>, <span class="number">0x4bf5996751882d17</span>]</span><br><span class="line"></span><br><span class="line">slot2_array.reverse()</span><br><span class="line"> </span><br><span class="line">slot0 = <span class="number">0xdd26c29515a28396</span></span><br><span class="line">slot1 = <span class="number">0xbd722d4baf99b9c7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> slot2 <span class="keyword">in</span> slot2_array:</span><br><span class="line">    slot0, slot1 = decrypt(slot0, slot1, slot2)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(u64_to_uleb128(slot1) + u64_to_uleb128(slot0))</span><br><span class="line"><span class="comment"># b0e09cfb05e5e4fdaa07d4e2a8fa05f480fda206</span></span><br></pre></td></tr></table></figure>
<h2 id="0x03-Misc-一起学生物"><a href="#0x03-Misc-一起学生物" class="headerlink" title="0x03 Misc-一起学生物"></a>0x03 Misc-一起学生物</h2><p>To be continued…</p>

  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2023/07/23/Policy-compliant-signatures/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> 上一页</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/07/19/pdd-analysis-by-kaspersky/" type="button" class="btn btn-default ">下一页<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>


	<!-- comment -->
	
<section id="comment">
    <h2 class="title">留言</h2>

    <!-- 
    <div id="disqus_thread" class="ds-thread">
        <script type="text/javascript">
            /**
             * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
             */
                /*
                 var disqus_config = function () {
                 this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                 this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                 };
                 */
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = 'https://https-wd-2711-tech.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by
                Disqus.</a></noscript>
    </div> -->
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <div id="vcomments"></div>
    <script>
        new Valine({
            el: '#vcomments',
            appId: 'wLIJ70s3fPvW8WJPgVVAuWVR-gzGzoHsz',
            appKey: 'NVGqxhUkqtFv2CbwmXXWjCdR'
        })
    </script>

    
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-07-21 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/re/">re<span>37</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2%E6%8C%91%E6%88%98%E8%B5%9B2023-%E9%80%86%E5%90%91-amp-misc"><span class="toc-article-text">巅峰极客挑战赛2023-逆向&amp;misc</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x00-m1-read"><span class="toc-article-text">0x00 m1_read</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E8%8F%9C%E9%B8%9F%E7%9A%84%E6%8C%A3%E6%89%8E"><span class="toc-article-text">菜鸟的挣扎</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%A4%A7%E7%88%B9%E7%9A%84wp-amp-%E8%87%AA%E5%B7%B1%E7%9A%84%E6%8E%A2%E7%B4%A2"><span class="toc-article-text">大爹的wp&amp;自己的探索</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x01-g0Re-U"><span class="toc-article-text">0x01 g0Re-U</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E8%8B%A6%E9%80%BC%E5%8A%A8%E8%B0%83upx"><span class="toc-article-text">苦逼动调upx</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90"><span class="toc-article-text">程序分析</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x02-ezlua"><span class="toc-article-text">0x02 ezlua</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#luaL-loadbuffer%E5%87%BD%E6%95%B0%E5%88%86%E6%9E%90"><span class="toc-article-text">luaL_loadbuffer函数分析</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E4%BD%AC%E7%9A%84wp"><span class="toc-article-text">佬的wp</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x03-Misc-%E4%B8%80%E8%B5%B7%E5%AD%A6%E7%94%9F%E7%89%A9"><span class="toc-article-text">0x03 Misc-一起学生物</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>

	<!-- copyright -->
	<div>
    <ul class="post-copyright">
      <li class="post-copyright-author">
      <strong>作者:  </strong>wd-z711</a>
      </li>
      <li class="post-copyright-link">
      <strong>文章链接:  </strong>
      <a href="/" target="_blank" title="">https://wd-2711.tech/</a>
      </li>
      <li class="post-copyright-license">
        <strong>版权声明:   </strong>
        本博客所有文章除特别声明外，均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
        许可协议。转载请注明出处!
      </li>
    </ul>
  <div>
 	

		


</div><!-- row -->




	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2024 wd-z711
  
      <!-- with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a> and <a href="http://getbootstrap.com/" target="_blank">BOOTSTRA.386</a>. 
     <br> Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.     -->

     <!-- <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
      
      _st('install','aB-vgeB8gEDrnRJuhceL','2.0.0');
    </script> -->
    </p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
   </html>
