<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>祥云杯2022-re | wd-z711&#39;s B10g</title>
  <meta name="author" content="wd-z711">
  
  <meta name="description" content="Common student in China. Interested in web &amp; re.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="祥云杯2022-re"/>
  <meta property="og:site_name" content="wd-z711&#39;s B10g"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'G-YHJSKZDC3Y', 'auto');
  ga('send', 'pageview');
</script>




<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="wd-z711's B10g" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">wd-z711&#39;s B10g</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> 祥云杯2022-re</h1>
		</div>
	



<div class="row post">

	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="祥云杯2022-re-wp"><a href="#祥云杯2022-re-wp" class="headerlink" title="祥云杯2022-re-wp"></a>祥云杯2022-re-wp</h1><h2 id="engtom"><a href="#engtom" class="headerlink" title="engtom"></a>engtom</h2><p>​    终于让我见识到了真正的大赛题，哭了，我根本做不出来… 看 wp 也很难复现。</p>
<p>​    主要根据的 wp，有如下链接：</p>
<span id="more"></span>
<p>[1] <a target="_blank" rel="noopener" href="https://www.cnblogs.com/S1gMa/p/16846438.html">https://www.cnblogs.com/S1gMa/p/16846438.html</a></p>
<p>[2] <a target="_blank" rel="noopener" href="https://blog.wm-team.cn/index.php/archives/31/">https://blog.wm-team.cn/index.php/archives/31/</a></p>
<p>​    可以使用jerryscript得到如下字节码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br></pre></td><td class="code"><pre><span class="line">Byte code dump:</span><br><span class="line">  Maximum stack depth: 38</span><br><span class="line">  Flags: [small_lit_enc]</span><br><span class="line">  Argument range end: 0</span><br><span class="line">  Register range end: 5</span><br><span class="line">  Identifier range end: 30</span><br><span class="line">  Const literal range end: 91</span><br><span class="line">  Literal range end: 101</span><br><span class="line">   0 : CBC_CHECK_VAR ident:5-&gt;string(SboxTable)</span><br><span class="line">   2 : CBC_CHECK_VAR ident:6-&gt;string(CK)</span><br><span class="line">   4 : CBC_CHECK_VAR ident:7-&gt;string(FK)</span><br><span class="line">   6 : CBC_CHECK_VAR ident:8-&gt;string(bigxor)</span><br><span class="line">   8 : CBC_CHECK_VAR ident:9-&gt;string(leftshift)</span><br><span class="line">  10 : CBC_CHECK_VAR ident:10-&gt;string(prefixInteger)</span><br><span class="line">  12 : CBC_CHECK_VAR ident:11-&gt;string(sm4Sbox)</span><br><span class="line">  14 : CBC_CHECK_VAR ident:12-&gt;string(GET_ULONG_BE)</span><br><span class="line">  16 : CBC_CHECK_VAR ident:13-&gt;string(PUT_ULONG_BE)</span><br><span class="line">  18 : CBC_CHECK_VAR ident:14-&gt;string(sm4_getkey)</span><br><span class="line">  20 : CBC_CHECK_VAR ident:15-&gt;string(encrypt)</span><br><span class="line">  22 : CBC_CHECK_VAR ident:16-&gt;string(decrypt_sm4)</span><br><span class="line">  24 : CBC_CHECK_VAR ident:17-&gt;string(compare_array)</span><br><span class="line">  26 : CBC_CHECK_VAR ident:18-&gt;string(input)</span><br><span class="line">  28 : CBC_CHECK_VAR ident:19-&gt;string(num)</span><br><span class="line">  30 : CBC_CHECK_VAR ident:20-&gt;string(message)</span><br><span class="line">  32 : CBC_CHECK_VAR ident:21-&gt;string(count)</span><br><span class="line">  34 : CBC_CHECK_VAR ident:22-&gt;string(pad_len)</span><br><span class="line">  36 : CBC_CREATE_VAR_EVAL ident:5-&gt;string(SboxTable)</span><br><span class="line">  38 : CBC_CREATE_VAR_EVAL ident:6-&gt;string(CK)</span><br><span class="line">  40 : CBC_CREATE_VAR_EVAL ident:7-&gt;string(FK)</span><br><span class="line">  42 : CBC_CREATE_VAR_FUNC_EVAL lit:91 ident:8-&gt;string(bigxor)</span><br><span class="line">  45 : CBC_CREATE_VAR_FUNC_EVAL lit:92 ident:9-&gt;string(leftshift)</span><br><span class="line">  48 : CBC_CREATE_VAR_FUNC_EVAL lit:93 ident:10-&gt;string(prefixInteger)</span><br><span class="line">  51 : CBC_CREATE_VAR_FUNC_EVAL lit:94 ident:11-&gt;string(sm4Sbox)</span><br><span class="line">  54 : CBC_CREATE_VAR_FUNC_EVAL lit:95 ident:12-&gt;string(GET_ULONG_BE)</span><br><span class="line">  57 : CBC_CREATE_VAR_FUNC_EVAL lit:96 ident:13-&gt;string(PUT_ULONG_BE)</span><br><span class="line">  60 : CBC_CREATE_VAR_FUNC_EVAL lit:97 ident:14-&gt;string(sm4_getkey)</span><br><span class="line">  63 : CBC_CREATE_VAR_FUNC_EVAL lit:98 ident:15-&gt;string(encrypt)</span><br><span class="line">  66 : CBC_CREATE_VAR_FUNC_EVAL lit:99 ident:16-&gt;string(decrypt_sm4)</span><br><span class="line">  69 : CBC_CREATE_VAR_FUNC_EVAL lit:100 ident:17-&gt;string(compare_array)</span><br><span class="line">  72 : CBC_CREATE_VAR_EVAL ident:18-&gt;string(input)</span><br><span class="line">  74 : CBC_CREATE_VAR_EVAL ident:19-&gt;string(num)</span><br><span class="line">  76 : CBC_CREATE_VAR_EVAL ident:20-&gt;string(message)</span><br><span class="line">  78 : CBC_CREATE_VAR_EVAL ident:21-&gt;string(count)</span><br><span class="line">  80 : CBC_CREATE_VAR_EVAL ident:22-&gt;string(pad_len)</span><br><span class="line">  82 : CBC_PUSH_LITERAL ident:23-&gt;string(Array)</span><br><span class="line">  84 : CBC_NEW0</span><br><span class="line">  85 : CBC_ASSIGN_SET_IDENT ident:5-&gt;string(SboxTable)</span><br><span class="line">  87 : CBC_PUSH_LITERAL_PUSH_NUMBER_0 ident:5-&gt;string(SboxTable)</span><br><span class="line">  89 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:214</span><br><span class="line">  92 : CBC_PUSH_NUMBER_POS_BYTE number:144</span><br><span class="line">  94 : CBC_PUSH_NUMBER_POS_BYTE number:233</span><br><span class="line">  96 : CBC_PUSH_NUMBER_POS_BYTE number:254</span><br><span class="line">  98 : CBC_PUSH_NUMBER_POS_BYTE number:204</span><br><span class="line"> 100 : CBC_PUSH_NUMBER_POS_BYTE number:225</span><br><span class="line"> 102 : CBC_PUSH_NUMBER_POS_BYTE number:61</span><br><span class="line"> 104 : CBC_PUSH_NUMBER_POS_BYTE number:183</span><br><span class="line"> 106 : CBC_PUSH_NUMBER_POS_BYTE number:22</span><br><span class="line"> 108 : CBC_PUSH_NUMBER_POS_BYTE number:182</span><br><span class="line"> 110 : CBC_PUSH_NUMBER_POS_BYTE number:20</span><br><span class="line"> 112 : CBC_PUSH_NUMBER_POS_BYTE number:194</span><br><span class="line"> 114 : CBC_PUSH_NUMBER_POS_BYTE number:40</span><br><span class="line"> 116 : CBC_PUSH_NUMBER_POS_BYTE number:251</span><br><span class="line"> 118 : CBC_PUSH_NUMBER_POS_BYTE number:44</span><br><span class="line"> 120 : CBC_PUSH_NUMBER_POS_BYTE number:5</span><br><span class="line"> 122 : CBC_NEW byte_arg:16</span><br><span class="line"> 124 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 125 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:1</span><br><span class="line"> 128 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:43</span><br><span class="line"> 131 : CBC_PUSH_NUMBER_POS_BYTE number:103</span><br><span class="line"> 133 : CBC_PUSH_NUMBER_POS_BYTE number:154</span><br><span class="line"> 135 : CBC_PUSH_NUMBER_POS_BYTE number:118</span><br><span class="line"> 137 : CBC_PUSH_NUMBER_POS_BYTE number:42</span><br><span class="line"> 139 : CBC_PUSH_NUMBER_POS_BYTE number:190</span><br><span class="line"> 141 : CBC_PUSH_NUMBER_POS_BYTE number:4</span><br><span class="line"> 143 : CBC_PUSH_NUMBER_POS_BYTE number:195</span><br><span class="line"> 145 : CBC_PUSH_NUMBER_POS_BYTE number:170</span><br><span class="line"> 147 : CBC_PUSH_NUMBER_POS_BYTE number:68</span><br><span class="line"> 149 : CBC_PUSH_NUMBER_POS_BYTE number:19</span><br><span class="line"> 151 : CBC_PUSH_NUMBER_POS_BYTE number:38</span><br><span class="line"> 153 : CBC_PUSH_NUMBER_POS_BYTE number:73</span><br><span class="line"> 155 : CBC_PUSH_NUMBER_POS_BYTE number:134</span><br><span class="line"> 157 : CBC_PUSH_NUMBER_POS_BYTE number:6</span><br><span class="line"> 159 : CBC_PUSH_NUMBER_POS_BYTE number:153</span><br><span class="line"> 161 : CBC_NEW byte_arg:16</span><br><span class="line"> 163 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 164 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:2</span><br><span class="line"> 167 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:156</span><br><span class="line"> 170 : CBC_PUSH_NUMBER_POS_BYTE number:66</span><br><span class="line"> 172 : CBC_PUSH_NUMBER_POS_BYTE number:80</span><br><span class="line"> 174 : CBC_PUSH_NUMBER_POS_BYTE number:244</span><br><span class="line"> 176 : CBC_PUSH_NUMBER_POS_BYTE number:145</span><br><span class="line"> 178 : CBC_PUSH_NUMBER_POS_BYTE number:239</span><br><span class="line"> 180 : CBC_PUSH_NUMBER_POS_BYTE number:152</span><br><span class="line"> 182 : CBC_PUSH_NUMBER_POS_BYTE number:122</span><br><span class="line"> 184 : CBC_PUSH_NUMBER_POS_BYTE number:51</span><br><span class="line"> 186 : CBC_PUSH_NUMBER_POS_BYTE number:84</span><br><span class="line"> 188 : CBC_PUSH_NUMBER_POS_BYTE number:11</span><br><span class="line"> 190 : CBC_PUSH_NUMBER_POS_BYTE number:67</span><br><span class="line"> 192 : CBC_PUSH_NUMBER_POS_BYTE number:237</span><br><span class="line"> 194 : CBC_PUSH_NUMBER_POS_BYTE number:207</span><br><span class="line"> 196 : CBC_PUSH_NUMBER_POS_BYTE number:172</span><br><span class="line"> 198 : CBC_PUSH_NUMBER_POS_BYTE number:98</span><br><span class="line"> 200 : CBC_NEW byte_arg:16</span><br><span class="line"> 202 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 203 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:3</span><br><span class="line"> 206 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:228</span><br><span class="line"> 209 : CBC_PUSH_NUMBER_POS_BYTE number:179</span><br><span class="line"> 211 : CBC_PUSH_NUMBER_POS_BYTE number:28</span><br><span class="line"> 213 : CBC_PUSH_NUMBER_POS_BYTE number:169</span><br><span class="line"> 215 : CBC_PUSH_NUMBER_POS_BYTE number:201</span><br><span class="line"> 217 : CBC_PUSH_NUMBER_POS_BYTE number:8</span><br><span class="line"> 219 : CBC_PUSH_NUMBER_POS_BYTE number:232</span><br><span class="line"> 221 : CBC_PUSH_NUMBER_POS_BYTE number:149</span><br><span class="line"> 223 : CBC_PUSH_NUMBER_POS_BYTE number:128</span><br><span class="line"> 225 : CBC_PUSH_NUMBER_POS_BYTE number:223</span><br><span class="line"> 227 : CBC_PUSH_NUMBER_POS_BYTE number:148</span><br><span class="line"> 229 : CBC_PUSH_NUMBER_POS_BYTE number:250</span><br><span class="line"> 231 : CBC_PUSH_NUMBER_POS_BYTE number:117</span><br><span class="line"> 233 : CBC_PUSH_NUMBER_POS_BYTE number:143</span><br><span class="line"> 235 : CBC_PUSH_NUMBER_POS_BYTE number:63</span><br><span class="line"> 237 : CBC_PUSH_NUMBER_POS_BYTE number:166</span><br><span class="line"> 239 : CBC_NEW byte_arg:16</span><br><span class="line"> 241 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 242 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:4</span><br><span class="line"> 245 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:71</span><br><span class="line"> 248 : CBC_PUSH_NUMBER_POS_BYTE number:7</span><br><span class="line"> 250 : CBC_PUSH_NUMBER_POS_BYTE number:167</span><br><span class="line"> 252 : CBC_PUSH_NUMBER_POS_BYTE number:252</span><br><span class="line"> 254 : CBC_PUSH_NUMBER_POS_BYTE number:243</span><br><span class="line"> 256 : CBC_PUSH_NUMBER_POS_BYTE number:115</span><br><span class="line"> 258 : CBC_PUSH_NUMBER_POS_BYTE number:23</span><br><span class="line"> 260 : CBC_PUSH_NUMBER_POS_BYTE number:186</span><br><span class="line"> 262 : CBC_PUSH_NUMBER_POS_BYTE number:131</span><br><span class="line"> 264 : CBC_PUSH_NUMBER_POS_BYTE number:89</span><br><span class="line"> 266 : CBC_PUSH_NUMBER_POS_BYTE number:60</span><br><span class="line"> 268 : CBC_PUSH_NUMBER_POS_BYTE number:25</span><br><span class="line"> 270 : CBC_PUSH_NUMBER_POS_BYTE number:230</span><br><span class="line"> 272 : CBC_PUSH_NUMBER_POS_BYTE number:133</span><br><span class="line"> 274 : CBC_PUSH_NUMBER_POS_BYTE number:79</span><br><span class="line"> 276 : CBC_PUSH_NUMBER_POS_BYTE number:168</span><br><span class="line"> 278 : CBC_NEW byte_arg:16</span><br><span class="line"> 280 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 281 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:5</span><br><span class="line"> 284 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:104</span><br><span class="line"> 287 : CBC_PUSH_NUMBER_POS_BYTE number:107</span><br><span class="line"> 289 : CBC_PUSH_NUMBER_POS_BYTE number:129</span><br><span class="line"> 291 : CBC_PUSH_NUMBER_POS_BYTE number:178</span><br><span class="line"> 293 : CBC_PUSH_NUMBER_POS_BYTE number:113</span><br><span class="line"> 295 : CBC_PUSH_NUMBER_POS_BYTE number:100</span><br><span class="line"> 297 : CBC_PUSH_NUMBER_POS_BYTE number:218</span><br><span class="line"> 299 : CBC_PUSH_NUMBER_POS_BYTE number:139</span><br><span class="line"> 301 : CBC_PUSH_NUMBER_POS_BYTE number:248</span><br><span class="line"> 303 : CBC_PUSH_NUMBER_POS_BYTE number:235</span><br><span class="line"> 305 : CBC_PUSH_NUMBER_POS_BYTE number:15</span><br><span class="line"> 307 : CBC_PUSH_NUMBER_POS_BYTE number:75</span><br><span class="line"> 309 : CBC_PUSH_NUMBER_POS_BYTE number:112</span><br><span class="line"> 311 : CBC_PUSH_NUMBER_POS_BYTE number:86</span><br><span class="line"> 313 : CBC_PUSH_NUMBER_POS_BYTE number:157</span><br><span class="line"> 315 : CBC_PUSH_NUMBER_POS_BYTE number:53</span><br><span class="line"> 317 : CBC_NEW byte_arg:16</span><br><span class="line"> 319 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 320 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:6</span><br><span class="line"> 323 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:30</span><br><span class="line"> 326 : CBC_PUSH_NUMBER_POS_BYTE number:36</span><br><span class="line"> 328 : CBC_PUSH_NUMBER_POS_BYTE number:14</span><br><span class="line"> 330 : CBC_PUSH_NUMBER_POS_BYTE number:94</span><br><span class="line"> 332 : CBC_PUSH_NUMBER_POS_BYTE number:99</span><br><span class="line"> 334 : CBC_PUSH_NUMBER_POS_BYTE number:88</span><br><span class="line"> 336 : CBC_PUSH_NUMBER_POS_BYTE number:209</span><br><span class="line"> 338 : CBC_PUSH_NUMBER_POS_BYTE number:162</span><br><span class="line"> 340 : CBC_PUSH_NUMBER_POS_BYTE number:37</span><br><span class="line"> 342 : CBC_PUSH_NUMBER_POS_BYTE number:34</span><br><span class="line"> 344 : CBC_PUSH_NUMBER_POS_BYTE number:124</span><br><span class="line"> 346 : CBC_PUSH_NUMBER_POS_BYTE number:59</span><br><span class="line"> 348 : CBC_PUSH_NUMBER_POS_BYTE number:1</span><br><span class="line"> 350 : CBC_PUSH_NUMBER_POS_BYTE number:33</span><br><span class="line"> 352 : CBC_PUSH_NUMBER_POS_BYTE number:120</span><br><span class="line"> 354 : CBC_PUSH_NUMBER_POS_BYTE number:135</span><br><span class="line"> 356 : CBC_NEW byte_arg:16</span><br><span class="line"> 358 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 359 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:7</span><br><span class="line"> 362 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:212</span><br><span class="line"> 365 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 366 : CBC_PUSH_NUMBER_POS_BYTE number:70</span><br><span class="line"> 368 : CBC_PUSH_NUMBER_POS_BYTE number:87</span><br><span class="line"> 370 : CBC_PUSH_NUMBER_POS_BYTE number:159</span><br><span class="line"> 372 : CBC_PUSH_NUMBER_POS_BYTE number:211</span><br><span class="line"> 374 : CBC_PUSH_NUMBER_POS_BYTE number:39</span><br><span class="line"> 376 : CBC_PUSH_NUMBER_POS_BYTE number:82</span><br><span class="line"> 378 : CBC_PUSH_NUMBER_POS_BYTE number:76</span><br><span class="line"> 380 : CBC_PUSH_NUMBER_POS_BYTE number:54</span><br><span class="line"> 382 : CBC_PUSH_NUMBER_POS_BYTE number:2</span><br><span class="line"> 384 : CBC_PUSH_NUMBER_POS_BYTE number:231</span><br><span class="line"> 386 : CBC_PUSH_NUMBER_POS_BYTE number:160</span><br><span class="line"> 388 : CBC_PUSH_NUMBER_POS_BYTE number:196</span><br><span class="line"> 390 : CBC_PUSH_NUMBER_POS_BYTE number:200</span><br><span class="line"> 392 : CBC_PUSH_NUMBER_POS_BYTE number:158</span><br><span class="line"> 394 : CBC_NEW byte_arg:16</span><br><span class="line"> 396 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 397 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:8</span><br><span class="line"> 400 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:234</span><br><span class="line"> 403 : CBC_PUSH_NUMBER_POS_BYTE number:191</span><br><span class="line"> 405 : CBC_PUSH_NUMBER_POS_BYTE number:138</span><br><span class="line"> 407 : CBC_PUSH_NUMBER_POS_BYTE number:210</span><br><span class="line"> 409 : CBC_PUSH_NUMBER_POS_BYTE number:64</span><br><span class="line"> 411 : CBC_PUSH_NUMBER_POS_BYTE number:199</span><br><span class="line"> 413 : CBC_PUSH_NUMBER_POS_BYTE number:56</span><br><span class="line"> 415 : CBC_PUSH_NUMBER_POS_BYTE number:181</span><br><span class="line"> 417 : CBC_PUSH_NUMBER_POS_BYTE number:163</span><br><span class="line"> 419 : CBC_PUSH_NUMBER_POS_BYTE number:247</span><br><span class="line"> 421 : CBC_PUSH_NUMBER_POS_BYTE number:242</span><br><span class="line"> 423 : CBC_PUSH_NUMBER_POS_BYTE number:206</span><br><span class="line"> 425 : CBC_PUSH_NUMBER_POS_BYTE number:249</span><br><span class="line"> 427 : CBC_PUSH_NUMBER_POS_BYTE number:97</span><br><span class="line"> 429 : CBC_PUSH_NUMBER_POS_BYTE number:21</span><br><span class="line"> 431 : CBC_PUSH_NUMBER_POS_BYTE number:161</span><br><span class="line"> 433 : CBC_NEW byte_arg:16</span><br><span class="line"> 435 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 436 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:9</span><br><span class="line"> 439 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:224</span><br><span class="line"> 442 : CBC_PUSH_NUMBER_POS_BYTE number:174</span><br><span class="line"> 444 : CBC_PUSH_NUMBER_POS_BYTE number:93</span><br><span class="line"> 446 : CBC_PUSH_NUMBER_POS_BYTE number:164</span><br><span class="line"> 448 : CBC_PUSH_NUMBER_POS_BYTE number:155</span><br><span class="line"> 450 : CBC_PUSH_NUMBER_POS_BYTE number:52</span><br><span class="line"> 452 : CBC_PUSH_NUMBER_POS_BYTE number:26</span><br><span class="line"> 454 : CBC_PUSH_NUMBER_POS_BYTE number:85</span><br><span class="line"> 456 : CBC_PUSH_NUMBER_POS_BYTE number:173</span><br><span class="line"> 458 : CBC_PUSH_NUMBER_POS_BYTE number:147</span><br><span class="line"> 460 : CBC_PUSH_NUMBER_POS_BYTE number:50</span><br><span class="line"> 462 : CBC_PUSH_NUMBER_POS_BYTE number:48</span><br><span class="line"> 464 : CBC_PUSH_NUMBER_POS_BYTE number:245</span><br><span class="line"> 466 : CBC_PUSH_NUMBER_POS_BYTE number:140</span><br><span class="line"> 468 : CBC_PUSH_NUMBER_POS_BYTE number:177</span><br><span class="line"> 470 : CBC_PUSH_NUMBER_POS_BYTE number:227</span><br><span class="line"> 472 : CBC_NEW byte_arg:16</span><br><span class="line"> 474 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 475 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:10</span><br><span class="line"> 478 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:29</span><br><span class="line"> 481 : CBC_PUSH_NUMBER_POS_BYTE number:246</span><br><span class="line"> 483 : CBC_PUSH_NUMBER_POS_BYTE number:226</span><br><span class="line"> 485 : CBC_PUSH_NUMBER_POS_BYTE number:46</span><br><span class="line"> 487 : CBC_PUSH_NUMBER_POS_BYTE number:130</span><br><span class="line"> 489 : CBC_PUSH_NUMBER_POS_BYTE number:102</span><br><span class="line"> 491 : CBC_PUSH_NUMBER_POS_BYTE number:202</span><br><span class="line"> 493 : CBC_PUSH_NUMBER_POS_BYTE number:96</span><br><span class="line"> 495 : CBC_PUSH_NUMBER_POS_BYTE number:192</span><br><span class="line"> 497 : CBC_PUSH_NUMBER_POS_BYTE number:41</span><br><span class="line"> 499 : CBC_PUSH_NUMBER_POS_BYTE number:35</span><br><span class="line"> 501 : CBC_PUSH_NUMBER_POS_BYTE number:171</span><br><span class="line"> 503 : CBC_PUSH_NUMBER_POS_BYTE number:13</span><br><span class="line"> 505 : CBC_PUSH_NUMBER_POS_BYTE number:83</span><br><span class="line"> 507 : CBC_PUSH_NUMBER_POS_BYTE number:78</span><br><span class="line"> 509 : CBC_PUSH_NUMBER_POS_BYTE number:111</span><br><span class="line"> 511 : CBC_NEW byte_arg:16</span><br><span class="line"> 513 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 514 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:11</span><br><span class="line"> 517 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:213</span><br><span class="line"> 520 : CBC_PUSH_NUMBER_POS_BYTE number:219</span><br><span class="line"> 522 : CBC_PUSH_NUMBER_POS_BYTE number:55</span><br><span class="line"> 524 : CBC_PUSH_NUMBER_POS_BYTE number:69</span><br><span class="line"> 526 : CBC_PUSH_NUMBER_POS_BYTE number:222</span><br><span class="line"> 528 : CBC_PUSH_NUMBER_POS_BYTE number:253</span><br><span class="line"> 530 : CBC_PUSH_NUMBER_POS_BYTE number:142</span><br><span class="line"> 532 : CBC_PUSH_NUMBER_POS_BYTE number:47</span><br><span class="line"> 534 : CBC_PUSH_NUMBER_POS_BYTE number:3</span><br><span class="line"> 536 : CBC_PUSH_NUMBER_POS_BYTE number:255</span><br><span class="line"> 538 : CBC_PUSH_NUMBER_POS_BYTE number:106</span><br><span class="line"> 540 : CBC_PUSH_NUMBER_POS_BYTE number:114</span><br><span class="line"> 542 : CBC_PUSH_NUMBER_POS_BYTE number:109</span><br><span class="line"> 544 : CBC_PUSH_NUMBER_POS_BYTE number:108</span><br><span class="line"> 546 : CBC_PUSH_NUMBER_POS_BYTE number:91</span><br><span class="line"> 548 : CBC_PUSH_NUMBER_POS_BYTE number:81</span><br><span class="line"> 550 : CBC_NEW byte_arg:16</span><br><span class="line"> 552 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 553 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:12</span><br><span class="line"> 556 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:141</span><br><span class="line"> 559 : CBC_PUSH_NUMBER_POS_BYTE number:27</span><br><span class="line"> 561 : CBC_PUSH_NUMBER_POS_BYTE number:175</span><br><span class="line"> 563 : CBC_PUSH_NUMBER_POS_BYTE number:146</span><br><span class="line"> 565 : CBC_PUSH_NUMBER_POS_BYTE number:187</span><br><span class="line"> 567 : CBC_PUSH_NUMBER_POS_BYTE number:221</span><br><span class="line"> 569 : CBC_PUSH_NUMBER_POS_BYTE number:188</span><br><span class="line"> 571 : CBC_PUSH_NUMBER_POS_BYTE number:127</span><br><span class="line"> 573 : CBC_PUSH_NUMBER_POS_BYTE number:17</span><br><span class="line"> 575 : CBC_PUSH_NUMBER_POS_BYTE number:217</span><br><span class="line"> 577 : CBC_PUSH_NUMBER_POS_BYTE number:92</span><br><span class="line"> 579 : CBC_PUSH_NUMBER_POS_BYTE number:65</span><br><span class="line"> 581 : CBC_PUSH_NUMBER_POS_BYTE number:31</span><br><span class="line"> 583 : CBC_PUSH_NUMBER_POS_BYTE number:16</span><br><span class="line"> 585 : CBC_PUSH_NUMBER_POS_BYTE number:90</span><br><span class="line"> 587 : CBC_PUSH_NUMBER_POS_BYTE number:216</span><br><span class="line"> 589 : CBC_NEW byte_arg:16</span><br><span class="line"> 591 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 592 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:13</span><br><span class="line"> 595 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:10</span><br><span class="line"> 598 : CBC_PUSH_NUMBER_POS_BYTE number:193</span><br><span class="line"> 600 : CBC_PUSH_NUMBER_POS_BYTE number:49</span><br><span class="line"> 602 : CBC_PUSH_NUMBER_POS_BYTE number:136</span><br><span class="line"> 604 : CBC_PUSH_NUMBER_POS_BYTE number:165</span><br><span class="line"> 606 : CBC_PUSH_NUMBER_POS_BYTE number:205</span><br><span class="line"> 608 : CBC_PUSH_NUMBER_POS_BYTE number:123</span><br><span class="line"> 610 : CBC_PUSH_NUMBER_POS_BYTE number:189</span><br><span class="line"> 612 : CBC_PUSH_NUMBER_POS_BYTE number:45</span><br><span class="line"> 614 : CBC_PUSH_NUMBER_POS_BYTE number:116</span><br><span class="line"> 616 : CBC_PUSH_NUMBER_POS_BYTE number:208</span><br><span class="line"> 618 : CBC_PUSH_NUMBER_POS_BYTE number:18</span><br><span class="line"> 620 : CBC_PUSH_NUMBER_POS_BYTE number:184</span><br><span class="line"> 622 : CBC_PUSH_NUMBER_POS_BYTE number:229</span><br><span class="line"> 624 : CBC_PUSH_NUMBER_POS_BYTE number:180</span><br><span class="line"> 626 : CBC_PUSH_NUMBER_POS_BYTE number:176</span><br><span class="line"> 628 : CBC_NEW byte_arg:16</span><br><span class="line"> 630 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 631 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:14</span><br><span class="line"> 634 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:137</span><br><span class="line"> 637 : CBC_PUSH_NUMBER_POS_BYTE number:105</span><br><span class="line"> 639 : CBC_PUSH_NUMBER_POS_BYTE number:151</span><br><span class="line"> 641 : CBC_PUSH_NUMBER_POS_BYTE number:74</span><br><span class="line"> 643 : CBC_PUSH_NUMBER_POS_BYTE number:12</span><br><span class="line"> 645 : CBC_PUSH_NUMBER_POS_BYTE number:150</span><br><span class="line"> 647 : CBC_PUSH_NUMBER_POS_BYTE number:119</span><br><span class="line"> 649 : CBC_PUSH_NUMBER_POS_BYTE number:126</span><br><span class="line"> 651 : CBC_PUSH_NUMBER_POS_BYTE number:101</span><br><span class="line"> 653 : CBC_PUSH_NUMBER_POS_BYTE number:185</span><br><span class="line"> 655 : CBC_PUSH_NUMBER_POS_BYTE number:241</span><br><span class="line"> 657 : CBC_PUSH_NUMBER_POS_BYTE number:9</span><br><span class="line"> 659 : CBC_PUSH_NUMBER_POS_BYTE number:197</span><br><span class="line"> 661 : CBC_PUSH_NUMBER_POS_BYTE number:110</span><br><span class="line"> 663 : CBC_PUSH_NUMBER_POS_BYTE number:198</span><br><span class="line"> 665 : CBC_PUSH_NUMBER_POS_BYTE number:132</span><br><span class="line"> 667 : CBC_NEW byte_arg:16</span><br><span class="line"> 669 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 670 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:5-&gt;string(SboxTable) number:15</span><br><span class="line"> 673 : CBC_PUSH_LITERAL_PUSH_NUMBER_POS_BYTE ident:23-&gt;string(Array) number:24</span><br><span class="line"> 676 : CBC_PUSH_NUMBER_POS_BYTE number:240</span><br><span class="line"> 678 : CBC_PUSH_NUMBER_POS_BYTE number:125</span><br><span class="line"> 680 : CBC_PUSH_NUMBER_POS_BYTE number:236</span><br><span class="line"> 682 : CBC_PUSH_NUMBER_POS_BYTE number:58</span><br><span class="line"> 684 : CBC_PUSH_NUMBER_POS_BYTE number:220</span><br><span class="line"> 686 : CBC_PUSH_NUMBER_POS_BYTE number:77</span><br><span class="line"> 688 : CBC_PUSH_NUMBER_POS_BYTE number:32</span><br><span class="line"> 690 : CBC_PUSH_NUMBER_POS_BYTE number:121</span><br><span class="line"> 692 : CBC_PUSH_NUMBER_POS_BYTE number:238</span><br><span class="line"> 694 : CBC_PUSH_NUMBER_POS_BYTE number:95</span><br><span class="line"> 696 : CBC_PUSH_NUMBER_POS_BYTE number:62</span><br><span class="line"> 698 : CBC_PUSH_NUMBER_POS_BYTE number:215</span><br><span class="line"> 700 : CBC_PUSH_NUMBER_POS_BYTE number:203</span><br><span class="line"> 702 : CBC_PUSH_NUMBER_POS_BYTE number:57</span><br><span class="line"> 704 : CBC_PUSH_NUMBER_POS_BYTE number:72</span><br><span class="line"> 706 : CBC_NEW byte_arg:16</span><br><span class="line"> 708 : CBC_ASSIGN_BLOCK</span><br><span class="line"> 709 : CBC_PUSH_THREE_LITERALS ident:23-&gt;string(Array) const:30-&gt;number(462357) const:31-&gt;number(472066609)</span><br><span class="line"> 713 : CBC_PUSH_THREE_LITERALS const:32-&gt;number(943670861) const:33-&gt;number(1415275113) const:34-&gt;number(1886879365)</span><br><span class="line"> 717 : CBC_PUSH_THREE_LITERALS const:35-&gt;number(2358483617) const:36-&gt;number(2830087869) const:37-&gt;number(3301692121)</span><br><span class="line"> 721 : CBC_PUSH_THREE_LITERALS const:38-&gt;number(3773296373) const:39-&gt;number(4228057617) const:40-&gt;number(404694573)</span><br><span class="line"> 725 : CBC_PUSH_THREE_LITERALS const:41-&gt;number(876298825) const:42-&gt;number(1347903077) const:43-&gt;number(1819507329)</span><br><span class="line"> 729 : CBC_PUSH_THREE_LITERALS const:44-&gt;number(2291111581) const:45-&gt;number(2762715833) const:46-&gt;number(3234320085)</span><br><span class="line"> 733 : CBC_PUSH_THREE_LITERALS const:47-&gt;number(3705924337) const:48-&gt;number(4177462797) const:49-&gt;number(337322537)</span><br><span class="line"> 737 : CBC_PUSH_THREE_LITERALS const:50-&gt;number(808926789) const:51-&gt;number(1280531041) const:52-&gt;number(1752135293)</span><br><span class="line"> 741 : CBC_PUSH_THREE_LITERALS const:53-&gt;number(2223739545) const:54-&gt;number(2695343797) const:55-&gt;number(3166948049)</span><br><span class="line"> 745 : CBC_PUSH_THREE_LITERALS const:56-&gt;number(3638552301) const:57-&gt;number(4110090761) const:58-&gt;number(269950501)</span><br><span class="line"> 749 : CBC_PUSH_THREE_LITERALS const:59-&gt;number(741554753) const:60-&gt;number(1213159005) const:61-&gt;number(1684763257)</span><br><span class="line"> 753 : CBC_NEW byte_arg:32</span><br><span class="line"> 755 : CBC_ASSIGN_SET_IDENT ident:6-&gt;string(CK)</span><br><span class="line"> 757 : CBC_PUSH_THREE_LITERALS ident:23-&gt;string(Array) const:62-&gt;number(2746333894) const:63-&gt;number(1453994832)</span><br><span class="line"> 761 : CBC_PUSH_TWO_LITERALS const:64-&gt;number(1736282519) const:65-&gt;number(2993693404)</span><br><span class="line"> 764 : CBC_NEW byte_arg:4</span><br><span class="line"> 766 : CBC_ASSIGN_SET_IDENT ident:7-&gt;string(FK)</span><br><span class="line"> 768 : CBC_PUSH_LITERAL const:66-&gt;string(ctf&#123;this_is_an_example&#125;)</span><br><span class="line"> 770 : CBC_ASSIGN_SET_IDENT ident:18-&gt;string(input)</span><br><span class="line"> 772 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 773 : CBC_ASSIGN_SET_IDENT ident:19-&gt;string(num)</span><br><span class="line"> 775 : CBC_PUSH_LITERAL ident:23-&gt;string(Array)</span><br><span class="line"> 777 : CBC_NEW0</span><br><span class="line"> 778 : CBC_ASSIGN_SET_IDENT ident:20-&gt;string(message)</span><br><span class="line"> 780 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 781 : CBC_MOV_IDENT reg:1</span><br><span class="line"> 783 : CBC_JUMP_FORWARD offset:32(-&gt;815)</span><br><span class="line"> 785 : CBC_MULTIPLY_TWO_LITERALS ident:19-&gt;string(num) const:67-&gt;number(256)</span><br><span class="line"> 788 : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:18-&gt;string(input) const:68-&gt;string(charCodeAt)</span><br><span class="line"> 791 : CBC_PUSH_LITERAL reg:1</span><br><span class="line"> 793 : CBC_CALL1_PROP_PUSH_RESULT</span><br><span class="line"> 794 : CBC_ADD</span><br><span class="line"> 795 : CBC_ASSIGN_SET_IDENT_BLOCK ident:19-&gt;string(num)</span><br><span class="line"> 797 : CBC_MODULO_TWO_LITERALS reg:1 const:69-&gt;number(4)</span><br><span class="line"> 800 : CBC_EQUAL_RIGHT_LITERAL const:70-&gt;number(3)</span><br><span class="line"> 802 : CBC_BRANCH_IF_FALSE_FORWARD offset:11(-&gt;813)</span><br><span class="line"> 804 : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:20-&gt;string(message) const:71-&gt;string(push)</span><br><span class="line"> 807 : CBC_PUSH_LITERAL ident:19-&gt;string(num)</span><br><span class="line"> 809 : CBC_CALL1_PROP_BLOCK</span><br><span class="line"> 810 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 811 : CBC_ASSIGN_SET_IDENT_BLOCK ident:19-&gt;string(num)</span><br><span class="line"> 813 : CBC_PRE_INCR_IDENT reg:1</span><br><span class="line"> 815 : CBC_PUSH_TWO_LITERALS reg:1 ident:18-&gt;string(input)</span><br><span class="line"> 818 : CBC_PUSH_PROP_LITERAL const:72-&gt;string(length)</span><br><span class="line"> 820 : CBC_LESS</span><br><span class="line"> 821 : CBC_BRANCH_IF_TRUE_BACKWARD offset:36(-&gt;785)</span><br><span class="line"> 823 : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:24-&gt;string(Math) const:73-&gt;string(ceil)</span><br><span class="line"> 826 : CBC_PUSH_PROP_LITERAL_LITERAL ident:20-&gt;string(message) const:72-&gt;string(length)</span><br><span class="line"> 829 : CBC_DIVIDE_RIGHT_LITERAL const:69-&gt;number(4)</span><br><span class="line"> 831 : CBC_CALL1_PROP_PUSH_RESULT</span><br><span class="line"> 832 : CBC_ASSIGN_SET_IDENT ident:21-&gt;string(count)</span><br><span class="line"> 834 : CBC_MULTIPLY_TWO_LITERALS ident:21-&gt;string(count) const:69-&gt;number(4)</span><br><span class="line"> 837 : CBC_ASSIGN_SET_IDENT ident:22-&gt;string(pad_len)</span><br><span class="line"> 839 : CBC_JUMP_FORWARD offset:7(-&gt;846)</span><br><span class="line"> 841 : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:20-&gt;string(message) const:71-&gt;string(push)</span><br><span class="line"> 844 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 845 : CBC_CALL1_PROP_BLOCK</span><br><span class="line"> 846 : CBC_PUSH_PROP_LITERAL_LITERAL ident:20-&gt;string(message) const:72-&gt;string(length)</span><br><span class="line"> 849 : CBC_LESS_RIGHT_LITERAL ident:22-&gt;string(pad_len)</span><br><span class="line"> 851 : CBC_BRANCH_IF_TRUE_BACKWARD offset:10(-&gt;841)</span><br><span class="line"> 853 : CBC_PUSH_THREE_LITERALS ident:23-&gt;string(Array) const:74-&gt;number(19088743) const:75-&gt;number(2309737967)</span><br><span class="line"> 857 : CBC_PUSH_TWO_LITERALS const:76-&gt;number(4275878552) const:77-&gt;number(1985229328)</span><br><span class="line"> 860 : CBC_NEW byte_arg:4</span><br><span class="line"> 862 : CBC_ASSIGN_SET_IDENT_BLOCK ident:25-&gt;string(key)</span><br><span class="line"> 864 : CBC_PUSH_THREE_LITERALS ident:23-&gt;string(Array) const:78-&gt;number(1605062385) const:79-&gt;number(-642825121)</span><br><span class="line"> 868 : CBC_PUSH_THREE_LITERALS const:80-&gt;number(2061445208) const:81-&gt;number(1405610911) const:82-&gt;number(1713399267)</span><br><span class="line"> 872 : CBC_PUSH_THREE_LITERALS const:83-&gt;number(1396669315) const:84-&gt;number(1081797168) const:85-&gt;number(605181189)</span><br><span class="line"> 876 : CBC_PUSH_THREE_LITERALS const:86-&gt;number(1824766525) const:87-&gt;number(1196148725) const:88-&gt;number(763423307)</span><br><span class="line"> 880 : CBC_PUSH_LITERAL const:89-&gt;number(1125925868)</span><br><span class="line"> 882 : CBC_NEW byte_arg:12</span><br><span class="line"> 884 : CBC_ASSIGN_SET_IDENT_BLOCK ident:26-&gt;string(ans)</span><br><span class="line"> 886 : CBC_PUSH_LITERAL ident:23-&gt;string(Array)</span><br><span class="line"> 888 : CBC_NEW0</span><br><span class="line"> 889 : CBC_ASSIGN_SET_IDENT_BLOCK ident:27-&gt;string(message_c)</span><br><span class="line"> 891 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 892 : CBC_MOV_IDENT reg:1</span><br><span class="line"> 894 : CBC_JUMP_FORWARD offset:47(-&gt;941)</span><br><span class="line"> 896 : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:20-&gt;string(message) const:90-&gt;string(splice)</span><br><span class="line"> 899 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 900 : CBC_PUSH_NUMBER_POS_BYTE number:4</span><br><span class="line"> 902 : CBC_CALL2_PROP_PUSH_RESULT</span><br><span class="line"> 903 : CBC_MOV_IDENT reg:2</span><br><span class="line"> 905 : CBC_PUSH_THREE_LITERALS ident:15-&gt;string(encrypt) reg:2 ident:25-&gt;string(key)</span><br><span class="line"> 909 : CBC_CALL2_PUSH_RESULT</span><br><span class="line"> 910 : CBC_MOV_IDENT reg:3</span><br><span class="line"> 912 : CBC_PUSH_NUMBER_0</span><br><span class="line"> 913 : CBC_MOV_IDENT reg:4</span><br><span class="line"> 915 : CBC_JUMP_FORWARD offset:16(-&gt;931)</span><br><span class="line"> 917 : CBC_PUSH_PROP_LITERAL_LITERAL_REFERENCE ident:27-&gt;string(message_c) const:71-&gt;string(push)</span><br><span class="line"> 920 : CBC_PUSH_THREE_LITERALS ident:28-&gt;string(parseInt) reg:3 reg:4</span><br><span class="line"> 924 : CBC_PUSH_PROP</span><br><span class="line"> 925 : CBC_PUSH_NUMBER_POS_BYTE number:16</span><br><span class="line"> 927 : CBC_CALL2_PUSH_RESULT</span><br><span class="line"> 928 : CBC_CALL1_PROP_BLOCK</span><br><span class="line"> 929 : CBC_PRE_INCR_IDENT reg:4</span><br><span class="line"> 931 : CBC_PUSH_TWO_LITERALS reg:4 reg:3</span><br><span class="line"> 934 : CBC_PUSH_PROP_LITERAL const:72-&gt;string(length)</span><br><span class="line"> 936 : CBC_LESS</span><br><span class="line"> 937 : CBC_BRANCH_IF_TRUE_BACKWARD offset:20(-&gt;917)</span><br><span class="line"> 939 : CBC_PRE_INCR_IDENT reg:1</span><br><span class="line"> 941 : CBC_LESS_TWO_LITERALS reg:1 ident:21-&gt;string(count)</span><br><span class="line"> 944 : CBC_BRANCH_IF_TRUE_BACKWARD offset:48(-&gt;896)</span><br><span class="line"> 946 : CBC_PUSH_LITERAL ident:27-&gt;string(message_c)</span><br><span class="line"> 948 : CBC_BRANCH_IF_FALSE_FORWARD offset:10(-&gt;958)</span><br><span class="line"> 950 : CBC_PUSH_THREE_LITERALS ident:29-&gt;string(print) ident:17-&gt;string(compare_array) ident:27-&gt;string(message_c)</span><br><span class="line"> 954 : CBC_PUSH_LITERAL ident:26-&gt;string(ans)</span><br><span class="line"> 956 : CBC_CALL2_PUSH_RESULT</span><br><span class="line"> 957 : CBC_CALL1_BLOCK</span><br><span class="line"> 958 : CBC_RETURN_FUNCTION_END</span><br></pre></td></tr></table></figure>
<p>​    之后，里面有SM4的模块，推测使用SM4加密。可以找到SM4的源码：（找了好久，这个可以，针对CBC的SM4加密）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*! sm4-1.0.js (c) Windard Yang | &lt;https://www.windard.com/&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * sm4-1.0.js</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Copyright (c) 2014 Windard Yang (www.windard.com)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@fileOverview</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@name</span> <span class="variable">sm4</span>-1.0.js</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Windard (www.windard.com)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 1.0.0 (2016-11-17)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/* this is sm4 in javascript by windard , today is 2016 11-17 ,</span></span><br><span class="line"><span class="comment"> *I&#x27;m afraid that can I finished this project , but after all</span></span><br><span class="line"><span class="comment"> *in December, everything will be done , that&#x27;s prefect</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * garbage , rubbish programe language, should havn&#x27;t big decimal number</span></span><br><span class="line"><span class="comment"> * can&#x27;t circular bitwise left shift, can do xor well</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * fuck it at all , finally finished it , and there has many other works need to do</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">SboxTable</span> = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">0</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0xd6</span>, <span class="number">0x90</span>, <span class="number">0xe9</span>, <span class="number">0xfe</span>, <span class="number">0xcc</span>, <span class="number">0xe1</span>, <span class="number">0x3d</span>, <span class="number">0xb7</span>, <span class="number">0x16</span>, <span class="number">0xb6</span>, <span class="number">0x14</span>, <span class="number">0xc2</span>, <span class="number">0x28</span>, <span class="number">0xfb</span>, <span class="number">0x2c</span>, <span class="number">0x05</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">1</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x2b</span>, <span class="number">0x67</span>, <span class="number">0x9a</span>, <span class="number">0x76</span>, <span class="number">0x2a</span>, <span class="number">0xbe</span>, <span class="number">0x04</span>, <span class="number">0xc3</span>, <span class="number">0xaa</span>, <span class="number">0x44</span>, <span class="number">0x13</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x86</span>, <span class="number">0x06</span>, <span class="number">0x99</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">2</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x9c</span>, <span class="number">0x42</span>, <span class="number">0x50</span>, <span class="number">0xf4</span>, <span class="number">0x91</span>, <span class="number">0xef</span>, <span class="number">0x98</span>, <span class="number">0x7a</span>, <span class="number">0x33</span>, <span class="number">0x54</span>, <span class="number">0x0b</span>, <span class="number">0x43</span>, <span class="number">0xed</span>, <span class="number">0xcf</span>, <span class="number">0xac</span>, <span class="number">0x62</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">3</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0xe4</span>, <span class="number">0xb3</span>, <span class="number">0x1c</span>, <span class="number">0xa9</span>, <span class="number">0xc9</span>, <span class="number">0x08</span>, <span class="number">0xe8</span>, <span class="number">0x95</span>, <span class="number">0x80</span>, <span class="number">0xdf</span>, <span class="number">0x94</span>, <span class="number">0xfa</span>, <span class="number">0x75</span>, <span class="number">0x8f</span>, <span class="number">0x3f</span>, <span class="number">0xa6</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">4</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x47</span>, <span class="number">0x07</span>, <span class="number">0xa7</span>, <span class="number">0xfc</span>, <span class="number">0xf3</span>, <span class="number">0x73</span>, <span class="number">0x17</span>, <span class="number">0xba</span>, <span class="number">0x83</span>, <span class="number">0x59</span>, <span class="number">0x3c</span>, <span class="number">0x19</span>, <span class="number">0xe6</span>, <span class="number">0x85</span>, <span class="number">0x4f</span>, <span class="number">0xa8</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">5</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x68</span>, <span class="number">0x6b</span>, <span class="number">0x81</span>, <span class="number">0xb2</span>, <span class="number">0x71</span>, <span class="number">0x64</span>, <span class="number">0xda</span>, <span class="number">0x8b</span>, <span class="number">0xf8</span>, <span class="number">0xeb</span>, <span class="number">0x0f</span>, <span class="number">0x4b</span>, <span class="number">0x70</span>, <span class="number">0x56</span>, <span class="number">0x9d</span>, <span class="number">0x35</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">6</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x1e</span>, <span class="number">0x24</span>, <span class="number">0x0e</span>, <span class="number">0x5e</span>, <span class="number">0x63</span>, <span class="number">0x58</span>, <span class="number">0xd1</span>, <span class="number">0xa2</span>, <span class="number">0x25</span>, <span class="number">0x22</span>, <span class="number">0x7c</span>, <span class="number">0x3b</span>, <span class="number">0x01</span>, <span class="number">0x21</span>, <span class="number">0x78</span>, <span class="number">0x87</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">7</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0xd4</span>, <span class="number">0x00</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0x9f</span>, <span class="number">0xd3</span>, <span class="number">0x27</span>, <span class="number">0x52</span>, <span class="number">0x4c</span>, <span class="number">0x36</span>, <span class="number">0x02</span>, <span class="number">0xe7</span>, <span class="number">0xa0</span>, <span class="number">0xc4</span>, <span class="number">0xc8</span>, <span class="number">0x9e</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">8</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0xea</span>, <span class="number">0xbf</span>, <span class="number">0x8a</span>, <span class="number">0xd2</span>, <span class="number">0x40</span>, <span class="number">0xc7</span>, <span class="number">0x38</span>, <span class="number">0xb5</span>, <span class="number">0xa3</span>, <span class="number">0xf7</span>, <span class="number">0xf2</span>, <span class="number">0xce</span>, <span class="number">0xf9</span>, <span class="number">0x61</span>, <span class="number">0x15</span>, <span class="number">0xa1</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">9</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0xe0</span>, <span class="number">0xae</span>, <span class="number">0x5d</span>, <span class="number">0xa4</span>, <span class="number">0x9b</span>, <span class="number">0x34</span>, <span class="number">0x1a</span>, <span class="number">0x55</span>, <span class="number">0xad</span>, <span class="number">0x93</span>, <span class="number">0x32</span>, <span class="number">0x30</span>, <span class="number">0xf5</span>, <span class="number">0x8c</span>, <span class="number">0xb1</span>, <span class="number">0xe3</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">10</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x1d</span>, <span class="number">0xf6</span>, <span class="number">0xe2</span>, <span class="number">0x2e</span>, <span class="number">0x82</span>, <span class="number">0x66</span>, <span class="number">0xca</span>, <span class="number">0x60</span>, <span class="number">0xc0</span>, <span class="number">0x29</span>, <span class="number">0x23</span>, <span class="number">0xab</span>, <span class="number">0x0d</span>, <span class="number">0x53</span>, <span class="number">0x4e</span>, <span class="number">0x6f</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">11</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0xd5</span>, <span class="number">0xdb</span>, <span class="number">0x37</span>, <span class="number">0x45</span>, <span class="number">0xde</span>, <span class="number">0xfd</span>, <span class="number">0x8e</span>, <span class="number">0x2f</span>, <span class="number">0x03</span>, <span class="number">0xff</span>, <span class="number">0x6a</span>, <span class="number">0x72</span>, <span class="number">0x6d</span>, <span class="number">0x6c</span>, <span class="number">0x5b</span>, <span class="number">0x51</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">12</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x8d</span>, <span class="number">0x1b</span>, <span class="number">0xaf</span>, <span class="number">0x92</span>, <span class="number">0xbb</span>, <span class="number">0xdd</span>, <span class="number">0xbc</span>, <span class="number">0x7f</span>, <span class="number">0x11</span>, <span class="number">0xd9</span>, <span class="number">0x5c</span>, <span class="number">0x41</span>, <span class="number">0x1f</span>, <span class="number">0x10</span>, <span class="number">0x5a</span>, <span class="number">0xd8</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">13</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x0a</span>, <span class="number">0xc1</span>, <span class="number">0x31</span>, <span class="number">0x88</span>, <span class="number">0xa5</span>, <span class="number">0xcd</span>, <span class="number">0x7b</span>, <span class="number">0xbd</span>, <span class="number">0x2d</span>, <span class="number">0x74</span>, <span class="number">0xd0</span>, <span class="number">0x12</span>, <span class="number">0xb8</span>, <span class="number">0xe5</span>, <span class="number">0xb4</span>, <span class="number">0xb0</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">14</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x89</span>, <span class="number">0x69</span>, <span class="number">0x97</span>, <span class="number">0x4a</span>, <span class="number">0x0c</span>, <span class="number">0x96</span>, <span class="number">0x77</span>, <span class="number">0x7e</span>, <span class="number">0x65</span>, <span class="number">0xb9</span>, <span class="number">0xf1</span>, <span class="number">0x09</span>, <span class="number">0xc5</span>, <span class="number">0x6e</span>, <span class="number">0xc6</span>, <span class="number">0x84</span>);</span><br><span class="line"><span class="title class_">SboxTable</span>[<span class="number">15</span>] = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0x18</span>, <span class="number">0xf0</span>, <span class="number">0x7d</span>, <span class="number">0xec</span>, <span class="number">0x3a</span>, <span class="number">0xdc</span>, <span class="number">0x4d</span>, <span class="number">0x20</span>, <span class="number">0x79</span>, <span class="number">0xee</span>, <span class="number">0x5f</span>, <span class="number">0x3e</span>, <span class="number">0xd7</span>, <span class="number">0xcb</span>, <span class="number">0x39</span>, <span class="number">0x48</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">CK</span> = <span class="keyword">new</span> <span class="title class_">Array</span>(</span><br><span class="line">    <span class="number">0x00070e15</span>, <span class="number">0x1c232a31</span>, <span class="number">0x383f464d</span>, <span class="number">0x545b6269</span>,</span><br><span class="line">    <span class="number">0x70777e85</span>, <span class="number">0x8c939aa1</span>, <span class="number">0xa8afb6bd</span>, <span class="number">0xc4cbd2d9</span>,</span><br><span class="line">    <span class="number">0xe0e7eef5</span>, <span class="number">0xfc030a11</span>, <span class="number">0x181f262d</span>, <span class="number">0x343b4249</span>,</span><br><span class="line">    <span class="number">0x50575e65</span>, <span class="number">0x6c737a81</span>, <span class="number">0x888f969d</span>, <span class="number">0xa4abb2b9</span>,</span><br><span class="line">    <span class="number">0xc0c7ced5</span>, <span class="number">0xdce3eaf1</span>, <span class="number">0xf8ff060d</span>, <span class="number">0x141b2229</span>,</span><br><span class="line">    <span class="number">0x30373e45</span>, <span class="number">0x4c535a61</span>, <span class="number">0x686f767d</span>, <span class="number">0x848b9299</span>,</span><br><span class="line">    <span class="number">0xa0a7aeb5</span>, <span class="number">0xbcc3cad1</span>, <span class="number">0xd8dfe6ed</span>, <span class="number">0xf4fb0209</span>,</span><br><span class="line">    <span class="number">0x10171e25</span>, <span class="number">0x2c333a41</span>, <span class="number">0x484f565d</span>, <span class="number">0x646b7279</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">FK</span> = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">0xa3b1bac6</span>, <span class="number">0x56aa3350</span>, <span class="number">0x677d9197</span>, <span class="number">0xb27022dc</span>);</span><br><span class="line"><span class="comment">// function bigxor(a, b) &#123;</span></span><br><span class="line"><span class="comment">//  if (a.toString(2).length &lt; 33 &amp;&amp; b.toString(2).length &lt; 33)&#123;</span></span><br><span class="line"><span class="comment">//      return a ^ b</span></span><br><span class="line"><span class="comment">//  &#125;</span></span><br><span class="line"><span class="comment">//  var abin = a.toString(2);</span></span><br><span class="line"><span class="comment">//  var bbin = b.toString(2);</span></span><br><span class="line"><span class="comment">//  var loggest = abin.length &gt;= bbin.length ? abin.length : bbin.length;</span></span><br><span class="line"><span class="comment">//  abin = abin.length == loggest ? abin :&quot;0&quot;.repeat(loggest - abin.length) + abin;</span></span><br><span class="line"><span class="comment">//  bbin = bbin.length == loggest ? bbin :&quot;0&quot;.repeat(loggest - bbin.length) + bbin;</span></span><br><span class="line"><span class="comment">//  var result = &quot;&quot;;</span></span><br><span class="line"><span class="comment">//  for (var i = loggest - 1; i &gt;= 0; i--) &#123;</span></span><br><span class="line"><span class="comment">//      result = abin[i] == bbin[i] ? &#x27;0&#x27;+result : &#x27;1&#x27;+result;</span></span><br><span class="line"><span class="comment">//  &#125;;</span></span><br><span class="line"><span class="comment">//  return parseInt(result, 2);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bigxor</span>(<span class="params">a, b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a ^ b</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// function leftshift(a, n, size=32) &#123;</span></span><br><span class="line"><span class="comment">//  var result = new Array(size);</span></span><br><span class="line"><span class="comment">//  result.fill(0);</span></span><br><span class="line"><span class="comment">//  var bin = a.toString(2);</span></span><br><span class="line"><span class="comment">//  bin = bin.length == size ? bin :&quot;0&quot;.repeat(size - bin.length) + bin;</span></span><br><span class="line"><span class="comment">//  for (var i = bin.length - 1; i &gt;= 0; i--) &#123;</span></span><br><span class="line"><span class="comment">//      result[(i - n + size)%size] = bin[i];</span></span><br><span class="line"><span class="comment">//  &#125;;</span></span><br><span class="line"><span class="comment">//  result = result.join(&quot;&quot;);</span></span><br><span class="line"><span class="comment">//  return parseInt(result, 2);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">leftshift</span>(<span class="params">a, n, size = <span class="number">32</span></span>) &#123;</span><br><span class="line">    n = n % size</span><br><span class="line">    <span class="keyword">return</span> (a &lt;&lt; n) | (a &gt;&gt;&gt; (size - n))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">prefixInteger</span>(<span class="params">str, length</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>(length + <span class="number">1</span>).<span class="title function_">join</span>(<span class="string">&quot;0&quot;</span>).<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>).<span class="title function_">concat</span>(<span class="title class_">String</span>(str).<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>))</span><br><span class="line">        .<span class="title function_">slice</span>(-length).<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// function sm4Sbox(a) &#123;</span></span><br><span class="line"><span class="comment">//  var a1 = prefixInteger(a.toString(16),8).slice(0,2);</span></span><br><span class="line"><span class="comment">//  var a2 = prefixInteger(a.toString(16),8).slice(2,4);</span></span><br><span class="line"><span class="comment">//  var a3 = prefixInteger(a.toString(16),8).slice(4,6);</span></span><br><span class="line"><span class="comment">//  var a4 = prefixInteger(a.toString(16),8).slice(6,8);</span></span><br><span class="line"><span class="comment">//  var b1 = SboxTable[parseInt(a1[0], 16)][parseInt(a1[1], 16)];</span></span><br><span class="line"><span class="comment">//  var b2 = SboxTable[parseInt(a2[0], 16)][parseInt(a2[1], 16)];</span></span><br><span class="line"><span class="comment">//  var b3 = SboxTable[parseInt(a3[0], 16)][parseInt(a3[1], 16)];</span></span><br><span class="line"><span class="comment">//  var b4 = SboxTable[parseInt(a4[0], 16)][parseInt(a4[1], 16)];</span></span><br><span class="line"><span class="comment">//  return parseInt(prefixInteger(b1.toString(16), 2) + prefixInteger(b2.toString(16), 2) + prefixInteger(b3.toString(16), 2) + prefixInteger(b4.toString(16), 2) , 16)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sm4Sbox</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> b1 = <span class="title class_">SboxTable</span>[(a &amp; <span class="number">0xf0000000</span>) &gt;&gt;&gt; <span class="number">28</span>][(a &amp; <span class="number">0x0f000000</span>) &gt;&gt;&gt; <span class="number">24</span>]</span><br><span class="line">    <span class="keyword">var</span> b2 = <span class="title class_">SboxTable</span>[(a &amp; <span class="number">0x00f00000</span>) &gt;&gt;&gt; <span class="number">20</span>][(a &amp; <span class="number">0x000f0000</span>) &gt;&gt;&gt; <span class="number">16</span>]</span><br><span class="line">    <span class="keyword">var</span> b3 = <span class="title class_">SboxTable</span>[(a &amp; <span class="number">0x0000f000</span>) &gt;&gt;&gt; <span class="number">12</span>][(a &amp; <span class="number">0x00000f00</span>) &gt;&gt;&gt; <span class="number">8</span>]</span><br><span class="line">    <span class="keyword">var</span> b4 = <span class="title class_">SboxTable</span>[(a &amp; <span class="number">0x000000f0</span>) &gt;&gt;&gt; <span class="number">4</span>][(a &amp; <span class="number">0x0000000f</span>) &gt;&gt;&gt; <span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> (b1 &lt;&lt; <span class="number">24</span>) | (b2 &lt;&lt; <span class="number">16</span>) | (b3 &lt;&lt; <span class="number">8</span>) | (b4 &lt;&lt; <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">GET_ULONG_BE</span>(<span class="params">a</span>) &#123;</span><br><span class="line">    a = <span class="title function_">sm4Sbox</span>(a)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">bigxor</span>(<span class="title function_">bigxor</span>(<span class="title function_">bigxor</span>(a, <span class="title function_">leftshift</span>(a, <span class="number">2</span>)), <span class="title function_">bigxor</span>(<span class="title function_">leftshift</span>(a, <span class="number">10</span>), <span class="title function_">leftshift</span>(a, <span class="number">18</span>))), <span class="title function_">leftshift</span>(a, <span class="number">24</span>))</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">PUT_ULONG_BE</span>(<span class="params">b</span>) &#123;</span><br><span class="line">    b = <span class="title function_">sm4Sbox</span>(b)</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">bigxor</span>(b, <span class="title function_">bigxor</span>(<span class="title function_">leftshift</span>(b, <span class="number">13</span>), <span class="title function_">leftshift</span>(b, <span class="number">23</span>)));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sm4_getkey</span>(<span class="params">MK</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> K = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">    <span class="keyword">var</span> rk = <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">    K[<span class="number">0</span>] = <span class="title function_">bigxor</span>(<span class="variable constant_">MK</span>[<span class="number">0</span>], <span class="variable constant_">FK</span>[<span class="number">0</span>]);</span><br><span class="line">    K[<span class="number">1</span>] = <span class="title function_">bigxor</span>(<span class="variable constant_">MK</span>[<span class="number">1</span>], <span class="variable constant_">FK</span>[<span class="number">1</span>]);</span><br><span class="line">    K[<span class="number">2</span>] = <span class="title function_">bigxor</span>(<span class="variable constant_">MK</span>[<span class="number">2</span>], <span class="variable constant_">FK</span>[<span class="number">2</span>]);</span><br><span class="line">    K[<span class="number">3</span>] = <span class="title function_">bigxor</span>(<span class="variable constant_">MK</span>[<span class="number">3</span>], <span class="variable constant_">FK</span>[<span class="number">3</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        K[i + <span class="number">4</span>] = <span class="title function_">bigxor</span>(K[i], <span class="title function_">PUT_ULONG_BE</span>(<span class="title function_">bigxor</span>(<span class="title function_">bigxor</span>(K[i + <span class="number">1</span>], K[i + <span class="number">2</span>]), <span class="title function_">bigxor</span>(K[i + <span class="number">3</span>], <span class="variable constant_">CK</span>[i]))));</span><br><span class="line">        rk[i] = K[i + <span class="number">4</span>].<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">    <span class="keyword">return</span> rk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">KJUR_encrypt_sm4</span>(<span class="params">messsage, key, method = <span class="string">&quot;cbc&quot;</span></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable constant_">MK</span> = key;</span><br><span class="line">    <span class="keyword">var</span> X = messsage;</span><br><span class="line">    <span class="keyword">var</span> rk = <span class="title function_">sm4_getkey</span>(<span class="variable constant_">MK</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        X[i + <span class="number">4</span>] = <span class="title function_">bigxor</span>(X[i], <span class="title function_">GET_ULONG_BE</span>(<span class="title function_">bigxor</span>(<span class="title function_">bigxor</span>(X[i + <span class="number">1</span>], X[i + <span class="number">2</span>]), <span class="title function_">bigxor</span>(X[i + <span class="number">3</span>], <span class="built_in">parseInt</span>(rk[i], <span class="number">16</span>)))))</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">    <span class="keyword">var</span> Y = <span class="keyword">new</span> <span class="title class_">Array</span>(X[<span class="number">35</span>].<span class="title function_">toString</span>(<span class="number">16</span>), X[<span class="number">34</span>].<span class="title function_">toString</span>(<span class="number">16</span>), X[<span class="number">33</span>].<span class="title function_">toString</span>(<span class="number">16</span>), X[<span class="number">32</span>].<span class="title function_">toString</span>(<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> Y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">KJUR_decrypt_sm4</span>(<span class="params">ciphertext, key, method = <span class="string">&quot;cbc&quot;</span></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable constant_">MK</span> = key;</span><br><span class="line">    <span class="keyword">var</span> X = ciphertext;</span><br><span class="line">    <span class="keyword">var</span> frk = <span class="title function_">sm4_getkey</span>(<span class="variable constant_">MK</span>);</span><br><span class="line">    <span class="keyword">var</span> rk = <span class="keyword">new</span> <span class="title class_">Array</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = frk.<span class="property">length</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        rk[frk.<span class="property">length</span> - <span class="number">1</span> - i] = frk[i]</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        X[i + <span class="number">4</span>] = <span class="title function_">bigxor</span>(X[i], <span class="title function_">GET_ULONG_BE</span>(<span class="title function_">bigxor</span>(<span class="title function_">bigxor</span>(X[i + <span class="number">1</span>], X[i + <span class="number">2</span>]), <span class="title function_">bigxor</span>(X[i + <span class="number">3</span>], <span class="built_in">parseInt</span>(rk[i], <span class="number">16</span>)))))</span><br><span class="line">    &#125;</span><br><span class="line">    ;</span><br><span class="line">    <span class="keyword">var</span> Y = <span class="keyword">new</span> <span class="title class_">Array</span>(X[<span class="number">35</span>].<span class="title function_">toString</span>(<span class="number">16</span>), X[<span class="number">34</span>].<span class="title function_">toString</span>(<span class="number">16</span>), X[<span class="number">33</span>].<span class="title function_">toString</span>(<span class="number">16</span>), X[<span class="number">32</span>].<span class="title function_">toString</span>(<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> Y;</span><br><span class="line">&#125;</span><br><span class="line">ciphertext = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1605062385</span>, -<span class="number">642825121</span>, <span class="number">2061445208</span>, <span class="number">1405610911</span>);</span><br><span class="line">ciphertext2 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1713399267</span>, <span class="number">1396669315</span>, <span class="number">1081797168</span>, <span class="number">605181189</span>)</span><br><span class="line">ciphertext3 = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1824766525</span>, <span class="number">1196148725</span>, <span class="number">763423307</span>, <span class="number">1125925868</span>)</span><br><span class="line">key = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">19088743</span>, <span class="number">2309737967</span>, <span class="number">4275878552</span>, <span class="number">1985229328</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">KJUR_decrypt_sm4</span>(ciphertext, key))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">KJUR_decrypt_sm4</span>(ciphertext2, key))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">KJUR_decrypt_sm4</span>(ciphertext3, key))</span><br></pre></td></tr></table></figure>
<p>​    运行 node sm4-1.0.js，得到：</p>
<p><img src="/images/%E7%A5%A5%E4%BA%91%E6%9D%AF2022-re/image-20221113212835559.png" alt="image-20221113212835559" style="zoom:70%;" /></p>
<p>​    之后解析一下得到“ctf{w3_f0und_1t_112ug31vjhe121f21fas”：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据nodejs的结果，可以得到：</span></span><br><span class="line"><span class="comment"># [ &#x27;6374667b&#x27;, &#x27;77335f66&#x27;, &#x27;30756e64&#x27;, &#x27;5f31745f&#x27; ]</span></span><br><span class="line"><span class="comment"># [ &#x27;31313275&#x27;, &#x27;67333176&#x27;, &#x27;6a686531&#x27;, &#x27;32316632&#x27; ]</span></span><br><span class="line"><span class="comment"># [ &#x27;31666173&#x27;, &#x27;0&#x27;, &#x27;0&#x27;, &#x27;0&#x27; ]</span></span><br><span class="line"></span><br><span class="line">ans = [ <span class="string">&#x27;6374667b&#x27;</span>, <span class="string">&#x27;77335f66&#x27;</span>, <span class="string">&#x27;30756e64&#x27;</span>, <span class="string">&#x27;5f31745f&#x27;</span>, <span class="string">&#x27;31313275&#x27;</span>, <span class="string">&#x27;67333176&#x27;</span>, <span class="string">&#x27;6a686531&#x27;</span>, <span class="string">&#x27;32316632&#x27;</span>, <span class="string">&#x27;31666173&#x27;</span>]</span><br><span class="line">ans = <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="keyword">lambda</span> x: x, ans)) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ans)//<span class="number">2</span>):</span><br><span class="line">    ii = ans[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(ii,<span class="number">16</span>)), end = <span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><strong>知识点1：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># [1] map 的使用</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">square</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x*x</span><br><span class="line">end=<span class="built_in">list</span>(<span class="built_in">map</span>(square,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</span><br><span class="line"><span class="built_in">print</span>(end)</span><br><span class="line"><span class="comment"># [1, 4, 9]</span></span><br><span class="line"><span class="comment"># [2] lambda 的使用</span></span><br><span class="line">p = <span class="keyword">lambda</span> x,y:x+y</span><br><span class="line"><span class="built_in">print</span>(p(<span class="number">4</span>,<span class="number">6</span>))</span><br></pre></td></tr></table></figure>

  
	</div>

	<div>
  	<center>
	<div class="pagination">

    
    
    <a href="/2022/11/13/echo-server-wp/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> 上一页</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2022/11/08/p2p-vedio/" type="button" class="btn btn-default ">下一页<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>


	<!-- comment -->
	
<section id="comment">
    <h2 class="title">留言</h2>

    <!-- 
    <div id="disqus_thread" class="ds-thread">
        <script type="text/javascript">
            /**
             * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
             */
                /*
                 var disqus_config = function () {
                 this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                 this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                 };
                 */
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document, s = d.createElement('script');

                s.src = 'https://https-wd-2711-tech.disqus.com/embed.js';

                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by
                Disqus.</a></noscript>
    </div> -->
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <div id="vcomments"></div>
    <script>
        new Valine({
            el: '#vcomments',
            appId: 'wLIJ70s3fPvW8WJPgVVAuWVR-gzGzoHsz',
            appKey: 'NVGqxhUkqtFv2CbwmXXWjCdR'
        })
    </script>

    
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2022-11-09 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/re/">re<span>41</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>

	<!-- copyright -->
	<div>
    <ul class="post-copyright">
      <li class="post-copyright-author">
      <strong>作者:  </strong>wd-z711</a>
      </li>
      <li class="post-copyright-link">
      <strong>文章链接:  </strong>
      <a href="/" target="_blank" title="">https://wd-2711.tech/</a>
      </li>
      <li class="post-copyright-license">
        <strong>版权声明:   </strong>
        本博客所有文章除特别声明外，均采用 <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
        许可协议。转载请注明出处!
      </li>
    </ul>
  <div>
 	

		


</div><!-- row -->




	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2024 wd-z711
  
      <!-- with help from <a href="http://hexo.io/" target="_blank">Hexo</a>,<a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>,<a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a> and <a href="http://getbootstrap.com/" target="_blank">BOOTSTRA.386</a>. 
     <br> Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind.386</a>.     -->

     <!-- <script type="text/javascript">
      (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
      (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
      e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
      })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
      
      _st('install','aB-vgeB8gEDrnRJuhceL','2.0.0');
    </script> -->
    </p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
